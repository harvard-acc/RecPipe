Sun Jul 25 18:50:13 UTC 2021
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  7.11126208305
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.00854002821445465, 0.010893261432647704)
('****Total time: ', 2.814847989797592, 5.29225355386734)
('****Preprocess time: ', 0.001066666841506958, 0.0014401435852050776)
('****Data time: ', 0.0002219144105911255, 0.0002560615539550781)
('****Fetch time: ', 6.637704372406006e-05, 7.486343383789062e-05)
('****Sort time: ', 0.0003104742765426636, 0.0003899097442626948)
****Stage 0 average time 0.00670364022255
****Stage 1 average time 0.00350182056427
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945782787984
****DCGs @ 8: 0.920200391568
****DCGs @ 16: 0.876429290892
****DCGs @ 32: 0.81651160662
****DCGs @ 64: 0.72610984561
****Error : 0.35630078125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.08382296562
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.008251587629318238, 0.01054030656814575)
('****Total time: ', 2.3458779493570328, 4.395446324348449)
('****Preprocess time: ', 0.0010400183200836182, 0.0013527989387512205)
('****Data time: ', 0.00021446335315704345, 0.0002491474151611328)
('****Fetch time: ', 6.321799755096436e-05, 7.200241088867188e-05)
('****Sort time: ', 0.00030484259128570556, 0.00039414167404174785)
****Stage 0 average time 0.00639887487888
****Stage 1 average time 0.00347525501251
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947083845874
****DCGs @ 8: 0.920585578538
****DCGs @ 16: 0.877280844693
****DCGs @ 32: 0.816975644095
****DCGs @ 64: 0.726085518135
****Error : 0.3564375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.23949813843
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008170164704322814, 0.01010894775390625)
('****Total time: ', 1.916868566274643, 3.560299658775329)
('****Preprocess time: ', 0.0010349388122558594, 0.0012951374053955076)
('****Data time: ', 0.00021323227882385254, 0.0002391338348388672)
('****Fetch time: ', 6.272339820861817e-05, 7.104873657226562e-05)
('****Sort time: ', 0.00030900609493255614, 0.00038695335388183594)
****Stage 0 average time 0.00624051439762
****Stage 1 average time 0.00354955089092
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946125562496
****DCGs @ 8: 0.920297045278
****DCGs @ 16: 0.876836344207
****DCGs @ 32: 0.817390765162
****DCGs @ 64: 0.726411544151
****Error : 0.35613671875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.50917220116
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.008147032499313355, 0.010005736351013185)
('****Total time: ', 1.5157535663843156, 2.8209440827369687)
('****Preprocess time: ', 0.0010360358953475951, 0.001307404041290281)
('****Data time: ', 0.00021189999580383301, 0.00023608207702636693)
('****Fetch time: ', 6.255662441253663e-05, 7.176399230957031e-05)
('****Sort time: ', 0.0003120687007904053, 0.0003911018371582026)
****Stage 0 average time 0.00606238031387
****Stage 1 average time 0.00370721340179
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946512929933
****DCGs @ 8: 0.920738001073
****DCGs @ 16: 0.877320330775
****DCGs @ 32: 0.816817951031
****DCGs @ 64: 0.72639074002
****Error : 0.35630859375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.16146278381
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.008060772061347962, 0.009959995746612549)
('****Total time: ', 0.3009014617204666, 0.5502162218093872)
('****Preprocess time: ', 0.0010104250907897949, 0.001239335536956787)
('****Data time: ', 0.0002128995656967163, 0.0002338886260986328)
('****Fetch time: ', 5.90437650680542e-05, 6.508827209472656e-05)
('****Sort time: ', 0.00031388306617736815, 0.00037317276000976536)
****Stage 0 average time 0.00612899291515
****Stage 1 average time 0.00352803063393
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945648242376
****DCGs @ 8: 0.920112707838
****DCGs @ 16: 0.876929528873
****DCGs @ 32: 0.816742948051
****DCGs @ 64: 0.726137527032
****Error : 0.3565625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.69608688354
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.008215016484260559, 0.009953296184539794)
('****Total time: ', 0.02059664511680603, 0.054987335205078064)
('****Preprocess time: ', 0.0010333343744277953, 0.0012762546539306628)
('****Data time: ', 0.0002137610912322998, 0.0002398610115051269)
('****Fetch time: ', 6.080484390258789e-05, 6.890296936035156e-05)
('****Sort time: ', 0.0003267124891281128, 0.0003609657287597656)
****Stage 0 average time 0.0059890447855
****Stage 1 average time 0.00386058449745
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947084721657
****DCGs @ 8: 0.920523955144
****DCGs @ 16: 0.876879827521
****DCGs @ 32: 0.81701902065
****DCGs @ 64: 0.726021057223
****Error : 0.35625390625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.5970611572
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007998058795928955, 0.009024810791015622)
('****Total time: ', 0.012001971602439881, 0.015885841846466058)
('****Preprocess time: ', 0.0010141103267669678, 0.001224088668823242)
('****Data time: ', 0.00021205663681030272, 0.0002410411834716797)
('****Fetch time: ', 6.069159507751465e-05, 6.890296936035156e-05)
('****Sort time: ', 0.000316152811050415, 0.00038604736328124974)
****Stage 0 average time 0.00586291527748
****Stage 1 average time 0.00373815488815
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946035609813
****DCGs @ 8: 0.920725699449
****DCGs @ 16: 0.876951336714
****DCGs @ 32: 0.817154180396
****DCGs @ 64: 0.726549433262
****Error : 0.3562734375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.6754858494
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.007838198900222778, 0.008988738059997555)
('****Total time: ', 0.011159420847892761, 0.013493299484252923)
('****Preprocess time: ', 0.000996917724609375, 0.0012161731719970703)
('****Data time: ', 0.0002136934995651245, 0.00023794174194335938)
('****Fetch time: ', 6.0475826263427734e-05, 6.890296936035156e-05)
('****Sort time: ', 0.000311830997467041, 0.00037508010864257786)
****Stage 0 average time 0.0057434194088
****Stage 1 average time 0.00367769753933
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947164649923
****DCGs @ 8: 0.920784269572
****DCGs @ 16: 0.877303812862
****DCGs @ 32: 0.817086216083
****DCGs @ 64: 0.726351734733
****Error : 0.35638671875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.6539978981
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007642863154411316, 0.008635878562927246)
('****Total time: ', 0.010703808307647705, 0.012028133869171141)
('****Preprocess time: ', 0.0009674738645553589, 0.0011263132095336913)
('****Data time: ', 0.0002119312286376953, 0.0002319812774658203)
('****Fetch time: ', 5.805826187133789e-05, 6.417036056518535e-05)
('****Sort time: ', 0.00031529653072357176, 0.0003879189491271972)
****Stage 0 average time 0.00568681621552
****Stage 1 average time 0.00350880682468
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945430125365
****DCGs @ 8: 0.919813996124
****DCGs @ 16: 0.876494321482
****DCGs @ 32: 0.816555795089
****DCGs @ 64: 0.726027980973
****Error : 0.356265625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.8047788143
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.007617993354797363, 0.008704197406768798)
('****Total time: ', 0.010534990310668945, 0.011762154102325438)
('****Preprocess time: ', 0.000941464900970459, 0.001005899906158447)
('****Data time: ', 0.00020749735832214356, 0.00022603273391723626)
('****Fetch time: ', 5.728459358215332e-05, 6.29425048828125e-05)
('****Sort time: ', 0.0003028098344802856, 0.00034381151199340814)
****Stage 0 average time 0.00569831252098
****Stage 1 average time 0.00342873752117
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.94619935474
****DCGs @ 8: 0.920521330887
****DCGs @ 16: 0.877398551697
****DCGs @ 32: 0.817166618369
****DCGs @ 64: 0.726477719055
****Error : 0.356390625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.5362269878
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.0076121664047241215, 0.008752405643463133)
('****Total time: ', 0.010591565847396851, 0.011728048324584961)
('****Preprocess time: ', 0.0009341441392898559, 0.0009930133819580078)
('****Data time: ', 0.00020774471759796144, 0.0002241492271423338)
('****Fetch time: ', 5.7025551795959474e-05, 6.29425048828125e-05)
('****Sort time: ', 0.0003100327253341675, 0.000364100933074951)
****Stage 0 average time 0.0056959965229
****Stage 1 average time 0.00342511701584
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947256108913
****DCGs @ 8: 0.920990667598
****DCGs @ 16: 0.877169910133
****DCGs @ 32: 0.817185534302
****DCGs @ 64: 0.726138100099
****Error : 0.3564453125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  30.7626619339
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.007583208203315735, 0.008712255954742431)
('****Total time: ', 0.010481617093086242, 0.011668968200683595)
('****Preprocess time: ', 0.0009320131540298462, 0.000993978977203369)
('****Data time: ', 0.00020884525775909424, 0.00022602081298828125)
('****Fetch time: ', 5.7448506355285646e-05, 6.318092346191406e-05)
('****Sort time: ', 0.0003030414581298828, 0.0003409504890441894)
****Stage 0 average time 0.00566173553467
****Stage 1 average time 0.00342282104492
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945427112751
****DCGs @ 8: 0.920237119503
****DCGs @ 16: 0.876479545155
****DCGs @ 32: 0.816681023486
****DCGs @ 64: 0.72626654973
****Error : 0.35609765625
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  1.61282396317
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.010006494522094726, 0.013021719455718995)
('****Total time: ', 0.014383065462112427, 0.019085431098937983)
('****Preprocess time: ', 0.001205894947052002, 0.001655137538909912)
('****Data time: ', 0.00027205121517181395, 0.0003230929374694822)
('****Fetch time: ', 5.862748622894287e-05, 6.818771362304688e-05)
('****Sort time: ', 0.00035548079013824463, 0.0004880785942077635)
****Stage 0 average time 0.00694626152515
****Stage 1 average time 0.00495228743553
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945782787984
****DCGs @ 8: 0.920200391568
****DCGs @ 16: 0.876429290892
****DCGs @ 32: 0.81651160662
****DCGs @ 64: 0.72610984561
****Error : 0.35630078125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  2.54802489281
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.009802462697029115, 0.012889313697814939)
('****Total time: ', 0.013860412120819092, 0.018113100528717042)
('****Preprocess time: ', 0.0011960573196411132, 0.0015922307968139634)
('****Data time: ', 0.0002724640369415283, 0.0003159165382385253)
('****Fetch time: ', 5.401468276977539e-05, 6.580352783203125e-05)
('****Sort time: ', 0.0003365699052810669, 0.0004429817199707031)
****Stage 0 average time 0.00689310419559
****Stage 1 average time 0.00476846444607
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947083845874
****DCGs @ 8: 0.920585578538
****DCGs @ 16: 0.877280844693
****DCGs @ 32: 0.816975644095
****DCGs @ 64: 0.726085518135
****Error : 0.3564375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  3.56128191948
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.009148488759994506, 0.011292421817779527)
('****Total time: ', 0.013014216661453247, 0.015931534767150864)
('****Preprocess time: ', 0.001136141300201416, 0.0014522552490234372)
('****Data time: ', 0.0002642613649368286, 0.00030184984207153314)
('****Fetch time: ', 4.930698871612549e-05, 5.91278076171875e-05)
('****Sort time: ', 0.00034309697151184085, 0.0004339814186096188)
****Stage 0 average time 0.00634882116318
****Stage 1 average time 0.00459247422218
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946125562496
****DCGs @ 8: 0.920297045278
****DCGs @ 16: 0.876836344207
****DCGs @ 32: 0.817390765162
****DCGs @ 64: 0.726411544151
****Error : 0.35613671875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.62644791603
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.009436061024665833, 0.011928832530975337)
('****Total time: ', 0.013259408593177795, 0.016340363025665283)
('****Preprocess time: ', 0.001188190221786499, 0.001581001281738281)
('****Data time: ', 0.0002735668420791626, 0.00030803680419921875)
('****Fetch time: ', 4.94312047958374e-05, 5.91278076171875e-05)
('****Sort time: ', 0.0003386882543563843, 0.0004210829734802244)
****Stage 0 average time 0.00661112773418
****Stage 1 average time 0.0046748098135
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946512929933
****DCGs @ 8: 0.920738001073
****DCGs @ 16: 0.877320330775
****DCGs @ 32: 0.816817951031
****DCGs @ 64: 0.72639074002
****Error : 0.35630859375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  6.63391494751
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.008764835238456727, 0.01083412170410156)
('****Total time: ', 0.012683704257011414, 0.015085887908935542)
('****Preprocess time: ', 0.0011193249225616455, 0.0013849735260009766)
('****Data time: ', 0.0002542757987976074, 0.00028204917907714844)
('****Fetch time: ', 4.282748699188232e-05, 5.1021575927734375e-05)
('****Sort time: ', 0.0003275982141494751, 0.00039386749267578125)
****Stage 0 average time 0.00615971684456
****Stage 1 average time 0.0043491448164
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945648242376
****DCGs @ 8: 0.920112707838
****DCGs @ 16: 0.876929528873
****DCGs @ 32: 0.816742948051
****DCGs @ 64: 0.726137527032
****Error : 0.3565625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.6990878582
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.008908656120300293, 0.01050724983215332)
('****Total time: ', 0.012362121343612672, 0.014358460903167721)
('****Preprocess time: ', 0.0011537073850631714, 0.0013759613037109372)
('****Data time: ', 0.00026691722869873045, 0.0002949357032775878)
('****Fetch time: ', 4.50904369354248e-05, 5.1975250244140625e-05)
('****Sort time: ', 0.0003352402448654175, 0.00038505792617797845)
****Stage 0 average time 0.00629000914097
****Stage 1 average time 0.00441960227489
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947084721657
****DCGs @ 8: 0.920523955144
****DCGs @ 16: 0.876879827521
****DCGs @ 32: 0.81701902065
****DCGs @ 64: 0.726021057223
****Error : 0.35625390625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.5656011105
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008329391717910766, 0.009653186798095698)
('****Total time: ', 0.011739587068557739, 0.01337534189224243)
('****Preprocess time: ', 0.0010978316068649293, 0.001242411136627197)
('****Data time: ', 0.00025492727756500246, 0.00028514862060546875)
('****Fetch time: ', 4.0346264839172365e-05, 4.887580871582031e-05)
('****Sort time: ', 0.0003266468048095703, 0.0003650546073913572)
****Stage 0 average time 0.00584363853931
****Stage 1 average time 0.00420550513268
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946035609813
****DCGs @ 8: 0.920725699449
****DCGs @ 16: 0.876951336714
****DCGs @ 32: 0.817154180396
****DCGs @ 64: 0.726549433262
****Error : 0.3562734375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.6740260124
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.008463131308555603, 0.009777188301086424)
('****Total time: ', 0.011878089427947998, 0.013497328758239738)
('****Preprocess time: ', 0.0011183305978775023, 0.0012788891792297362)
('****Data time: ', 0.00025936317443847655, 0.00028613805770874004)
('****Fetch time: ', 4.157817363739014e-05, 4.982948303222656e-05)
('****Sort time: ', 0.0003299283981323242, 0.00037288665771484375)
****Stage 0 average time 0.00588884150982
****Stage 1 average time 0.00432349014282
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947164649923
****DCGs @ 8: 0.920784269572
****DCGs @ 16: 0.877303812862
****DCGs @ 32: 0.817086216083
****DCGs @ 64: 0.726351734733
****Error : 0.35638671875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.7085120678
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008680038332939148, 0.010397005081176757)
('****Total time: ', 0.012150617241859436, 0.014005947113037109)
('****Preprocess time: ', 0.001143886089324951, 0.0013189315795898438)
('****Data time: ', 0.00027316498756408693, 0.0002968430519104003)
('****Fetch time: ', 4.226255416870117e-05, 4.982948303222656e-05)
('****Sort time: ', 0.00034287095069885254, 0.0003650188446044922)
****Stage 0 average time 0.00616058945656
****Stage 1 average time 0.00432163345814
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945430125365
****DCGs @ 8: 0.919813996124
****DCGs @ 16: 0.876494321482
****DCGs @ 32: 0.816555795089
****DCGs @ 64: 0.726027980973
****Error : 0.356265625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.8164401054
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.008204887151718139, 0.009360837936401366)
('****Total time: ', 0.011608795285224915, 0.01294119358062744)
('****Preprocess time: ', 0.001095517635345459, 0.0012350559234619138)
('****Data time: ', 0.0002533489465713501, 0.0002770423889160156)
('****Fetch time: ', 4.066812992095947e-05, 4.8160552978515625e-05)
('****Sort time: ', 0.0003304535150527954, 0.0003707528114318847)
****Stage 0 average time 0.00570159745216
****Stage 1 average time 0.00422327792645
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.94619935474
****DCGs @ 8: 0.920521330887
****DCGs @ 16: 0.877398551697
****DCGs @ 32: 0.817166618369
****DCGs @ 64: 0.726477719055
****Error : 0.356390625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.6872320175
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.008440231800079346, 0.009468758106231686)
('****Total time: ', 0.011893042922019958, 0.013116121292114258)
('****Preprocess time: ', 0.0011328839063644409, 0.0013197660446166984)
('****Data time: ', 0.00026453208923339844, 0.0002849102020263672)
('****Fetch time: ', 4.32201623916626e-05, 4.9114227294921875e-05)
('****Sort time: ', 0.00032655394077301026, 0.0003631114959716797)
****Stage 0 average time 0.00599116957188
****Stage 1 average time 0.00421625232697
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947256108913
****DCGs @ 8: 0.920990667598
****DCGs @ 16: 0.877169910133
****DCGs @ 32: 0.817185534302
****DCGs @ 64: 0.726138100099
****Error : 0.3564453125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  30.7653620243
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.008483770489692687, 0.009265053272247314)
('****Total time: ', 0.011905240058898927, 0.012906217575073242)
('****Preprocess time: ', 0.0011442734003067018, 0.0013051390647888183)
('****Data time: ', 0.0002709507942199707, 0.00029206275939941406)
('****Fetch time: ', 4.2132973670959474e-05, 4.792213439941406e-05)
('****Sort time: ', 0.0003180065155029297, 0.0003612041473388672)
****Stage 0 average time 0.00604878532887
****Stage 1 average time 0.00421034884453
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945427112751
****DCGs @ 8: 0.920237119503
****DCGs @ 16: 0.876479545155
****DCGs @ 32: 0.816681023486
****DCGs @ 64: 0.72626654973
****Error : 0.35609765625
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
****Total experiment time (s):  8.23226499557
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.006766731023788452, 0.00830017328262329)
('****Total time: ', 3.452664575457573, 6.5513236045837395)
('****Preprocess time: ', 0.0010115190744400023, 0.0012541294097900388)
('****Data time: ', 0.00020708787441253663, 0.00023821592330932598)
('****Fetch time: ', 6.0037970542907714e-05, 6.604194641113281e-05)
('****Sort time: ', 0.00031180810928344726, 0.000335705280303955)
****Stage 0 average time 0.00407538068295
****Stage 1 average time 0.00428180336952
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945782787984
****DCGs @ 8: 0.920200391568
****DCGs @ 16: 0.876429290892
****DCGs @ 32: 0.81651160662
****DCGs @ 64: 0.72610984561
****Error : 0.35630078125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.19470405579
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.006632223010063171, 0.007935106754302977)
('****Total time: ', 2.924655508875847, 5.54761711359024)
('****Preprocess time: ', 0.0010049396753311157, 0.0011920928955078125)
('****Data time: ', 0.0002026749849319458, 0.0002310633659362791)
('****Fetch time: ', 5.9247970581054685e-05, 6.4849853515625e-05)
('****Sort time: ', 0.0003341817855834961, 0.0003368854522705078)
****Stage 0 average time 0.00406256937981
****Stage 1 average time 0.00417069804668
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947083845874
****DCGs @ 8: 0.920585578538
****DCGs @ 16: 0.877280844693
****DCGs @ 32: 0.816975644095
****DCGs @ 64: 0.726085518135
****Error : 0.3564375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.14361405373
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.006660019874572754, 0.007978093624114987)
('****Total time: ', 2.3778525484800337, 4.505016446113586)
('****Preprocess time: ', 0.0010229151248931886, 0.0011501789093017576)
('****Data time: ', 0.00020031988620758056, 0.00022507905960083)
('****Fetch time: ', 5.818629264831543e-05, 6.390810012817376e-05)
('****Sort time: ', 0.000313559889793396, 0.0003409385681152344)
****Stage 0 average time 0.00404339456558
****Stage 1 average time 0.00421160650253
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946125562496
****DCGs @ 8: 0.920297045278
****DCGs @ 16: 0.876836344207
****DCGs @ 32: 0.817390765162
****DCGs @ 64: 0.726411544151
****Error : 0.35613671875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.01859402657
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.0065712018013000485, 0.007200109958648681)
('****Total time: ', 1.7873947352170945, 3.396788191795349)
('****Preprocess time: ', 0.000987388014793396, 0.001098203659057617)
('****Data time: ', 0.00020531702041625977, 0.0002238750457763672)
('****Fetch time: ', 5.885040760040283e-05, 6.29425048828125e-05)
('****Sort time: ', 0.0003175612688064575, 0.00034691095352172845)
****Stage 0 average time 0.00399659347534
****Stage 1 average time 0.00414372503757
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946512929933
****DCGs @ 8: 0.920738001073
****DCGs @ 16: 0.877320330775
****DCGs @ 32: 0.816817951031
****DCGs @ 64: 0.72639074002
****Error : 0.35630859375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.96471309662
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.006591079711914062, 0.00721313953399658)
('****Total time: ', 0.7606554542779922, 1.4160133600234983)
('****Preprocess time: ', 0.0009938958883285523, 0.0010979175567626953)
('****Data time: ', 0.00020011615753173827, 0.00021886825561523438)
('****Fetch time: ', 5.766367912292481e-05, 6.200075149536126e-05)
('****Sort time: ', 0.00031446576118469236, 0.0003321528434753416)
****Stage 0 average time 0.00395376813412
****Stage 1 average time 0.00420345306396
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945648242376
****DCGs @ 8: 0.920112707838
****DCGs @ 16: 0.876929528873
****DCGs @ 32: 0.816742948051
****DCGs @ 64: 0.726137527032
****Error : 0.3565625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.26025295258
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.007114436388015747, 0.007816159725189209)
('****Total time: ', 0.31086782717704775, 0.6645376324653621)
('****Preprocess time: ', 0.0010049464702606202, 0.0010829091072082518)
('****Data time: ', 0.00021038460731506348, 0.00022792816162109375)
('****Fetch time: ', 6.113779544830322e-05, 6.508827209472656e-05)
('****Sort time: ', 0.00032681822776794436, 0.0003550171852111816)
****Stage 0 average time 0.00460253190994
****Stage 1 average time 0.00411519157887
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947084721657
****DCGs @ 8: 0.920523955144
****DCGs @ 16: 0.876879827521
****DCGs @ 32: 0.81701902065
****DCGs @ 64: 0.726021057223
****Error : 0.35625390625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.5702149868
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.006652163505554199, 0.007505667209625241)
('****Total time: ', 0.010826833605766296, 0.015072751045227047)
('****Preprocess time: ', 0.0009710520505905151, 0.0010998725891113279)
('****Data time: ', 0.00019969356060028077, 0.0002200603485107422)
('****Fetch time: ', 5.776214599609375e-05, 6.389617919921875e-05)
('****Sort time: ', 0.00032025146484375, 0.00034381151199340814)
****Stage 0 average time 0.00401782822609
****Stage 1 average time 0.0041830945015
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946035609813
****DCGs @ 8: 0.920725699449
****DCGs @ 16: 0.876951336714
****DCGs @ 32: 0.817154180396
****DCGs @ 64: 0.726549433262
****Error : 0.3562734375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.6400399208
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.006887208461761474, 0.008399009704589844)
('****Total time: ', 0.01057545042037964, 0.013642668724060055)
('****Preprocess time: ', 0.0010083401203155517, 0.001287269592285156)
('****Data time: ', 0.0002071657180786133, 0.00023102760314941406)
('****Fetch time: ', 5.975401401519775e-05, 6.818771362304688e-05)
('****Sort time: ', 0.00031930458545684817, 0.00037384033203125)
****Stage 0 average time 0.00411748254299
****Stage 1 average time 0.00436429035664
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947164649923
****DCGs @ 8: 0.920784269572
****DCGs @ 16: 0.877303812862
****DCGs @ 32: 0.817086216083
****DCGs @ 64: 0.726351734733
****Error : 0.35638671875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.6895089149
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.006549760580062867, 0.007368063926696776)
('****Total time: ', 0.009657144904136657, 0.01121330261230468)
('****Preprocess time: ', 0.000960446834564209, 0.0011332392692565917)
('****Data time: ', 0.00020626580715179442, 0.00023317337036132812)
('****Fetch time: ', 5.807805061340332e-05, 6.4849853515625e-05)
('****Sort time: ', 0.0003118317127227783, 0.00037598609924316406)
****Stage 0 average time 0.00395846915245
****Stage 1 average time 0.00412791383266
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945430125365
****DCGs @ 8: 0.919813996124
****DCGs @ 16: 0.876494321482
****DCGs @ 32: 0.816555795089
****DCGs @ 64: 0.726027980973
****Error : 0.356265625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.7437357903
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.006646606802940369, 0.0076703667640686014)
('****Total time: ', 0.009744207978248596, 0.011094129085540767)
('****Preprocess time: ', 0.0009678902626037598, 0.0012378811836242674)
('****Data time: ', 0.00020307123661041259, 0.00022983551025390625)
('****Fetch time: ', 5.890524387359619e-05, 6.508827209472656e-05)
('****Sort time: ', 0.00032342052459716794, 0.0004010200500488281)
****Stage 0 average time 0.003978905797
****Stage 1 average time 0.00422098827362
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.94619935474
****DCGs @ 8: 0.920521330887
****DCGs @ 16: 0.877398551697
****DCGs @ 32: 0.817166618369
****DCGs @ 64: 0.726477719055
****Error : 0.356390625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.4829609394
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.006552903890609741, 0.007546949386596679)
('****Total time: ', 0.009656088232994079, 0.010932266712188719)
('****Preprocess time: ', 0.000980793833732605, 0.0011881589889526348)
('****Data time: ', 0.00020520901679992675, 0.0002308011054992675)
('****Fetch time: ', 5.7802796363830565e-05, 6.413459777832031e-05)
('****Sort time: ', 0.00031379961967468263, 0.00038913488388061504)
****Stage 0 average time 0.00397665083408
****Stage 1 average time 0.0041338583231
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947256108913
****DCGs @ 8: 0.920990667598
****DCGs @ 16: 0.877169910133
****DCGs @ 32: 0.817185534302
****DCGs @ 64: 0.726138100099
****Error : 0.3564453125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  30.7250890732
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.006541748881340027, 0.007397985458374023)
('****Total time: ', 0.009655680537223816, 0.010808038711547851)
('****Preprocess time: ', 0.0009731582403182984, 0.0011200904846191406)
('****Data time: ', 0.00020796000957489012, 0.0002253293991088866)
('****Fetch time: ', 5.9676647186279295e-05, 6.390810012817376e-05)
('****Sort time: ', 0.00031591379642486575, 0.0003931879997253416)
****Stage 0 average time 0.00397938382626
****Stage 1 average time 0.00411907374859
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945427112751
****DCGs @ 8: 0.920237119503
****DCGs @ 16: 0.876479545155
****DCGs @ 32: 0.816681023486
****DCGs @ 64: 0.72626654973
****Error : 0.35609765625
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  8.02610087395
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.009131668925285339, 0.012083613872528072)
('****Total time: ', 3.235759778022766, 6.100475192070006)
('****Preprocess time: ', 0.0013114373683929443, 0.0017290472984313964)
('****Data time: ', 0.0002481389045715332, 0.00029587745666503906)
('****Fetch time: ', 7.500004768371582e-05, 8.797645568847656e-05)
('****Sort time: ', 0.00037771475315093997, 0.000476837158203125)
****Stage 0 average time 0.00716992008686
****Stage 1 average time 0.00397403991222
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945698724216
****DCGs @ 8: 0.920191956232
****DCGs @ 16: 0.876298604041
****DCGs @ 32: 0.816603863116
****DCGs @ 64: 0.726521028823
****Error : 0.292462890625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.00527119637
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.009047984480857849, 0.01106464862823486)
('****Total time: ', 3.3270090401172636, 6.220490467548369)
('****Preprocess time: ', 0.0012224935293197632, 0.0015349745750427245)
('****Data time: ', 0.0002389364242553711, 0.00026988983154296875)
('****Fetch time: ', 7.24644660949707e-05, 8.177757263183594e-05)
('****Sort time: ', 0.0004107630252838135, 0.00042728185653686504)
****Stage 0 average time 0.00654112315178
****Stage 1 average time 0.00445151877403
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947083845874
****DCGs @ 8: 0.920420203686
****DCGs @ 16: 0.877045545452
****DCGs @ 32: 0.817033502336
****DCGs @ 64: 0.726675768952
****Error : 0.29228515625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.07257604599
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008909696221351623, 0.010804533958435055)
('****Total time: ', 2.8009295511245726, 5.28634259700775)
('****Preprocess time: ', 0.0012252900600433349, 0.0015330314636230469)
('****Data time: ', 0.00023524808883666992, 0.00026488304138183594)
('****Fetch time: ', 7.030367851257324e-05, 7.891654968261719e-05)
('****Sort time: ', 0.00034806954860687255, 0.0003998398780822753)
****Stage 0 average time 0.00628616511822
****Stage 1 average time 0.00450244247913
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946125562496
****DCGs @ 8: 0.920300288032
****DCGs @ 16: 0.876732740413
****DCGs @ 32: 0.817495980281
****DCGs @ 64: 0.726858445719
****Error : 0.2923203125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.03853201866
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.008785555005073548, 0.01042760610580444)
('****Total time: ', 2.2825164202451704, 4.275709891319274)
('****Preprocess time: ', 0.0012097264528274536, 0.0015020489692687974)
('****Data time: ', 0.00023344171047210693, 0.00026106834411621094)
('****Fetch time: ', 6.911718845367432e-05, 7.700920104980469e-05)
('****Sort time: ', 0.0003563883304595947, 0.00041012763977050755)
****Stage 0 average time 0.00616687262058
****Stage 1 average time 0.0044873560667
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946344802396
****DCGs @ 8: 0.920680250225
****DCGs @ 16: 0.877163256618
****DCGs @ 32: 0.81687408708
****DCGs @ 64: 0.726863918822
****Error : 0.292412109375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.04110407829
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.008669942140579224, 0.010264408588409423)
('****Total time: ', 1.2757153693437577, 2.345913052558899)
('****Preprocess time: ', 0.0011930361986160279, 0.001304399967193602)
('****Data time: ', 0.0002335301637649536, 0.0002570152282714844)
('****Fetch time: ', 6.762874126434327e-05, 7.605552673339844e-05)
('****Sort time: ', 0.0003588411808013916, 0.0004051089286804197)
****Stage 0 average time 0.00603374481201
****Stage 1 average time 0.00448923361301
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945648242376
****DCGs @ 8: 0.919989490103
****DCGs @ 16: 0.876715011375
****DCGs @ 32: 0.816864687217
****DCGs @ 64: 0.726665274393
****Error : 0.292513671875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.02458405495
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.008527867197990417, 0.009507846832275384)
('****Total time: ', 0.17207747209072113, 0.3673997163772577)
('****Preprocess time: ', 0.001184364080429077, 0.0013111114501953122)
('****Data time: ', 0.00023114287853240968, 0.0002579689025878906)
('****Fetch time: ', 6.64219856262207e-05, 7.295608520507812e-05)
('****Sort time: ', 0.0003672956228256226, 0.00041276216506957975)
****Stage 0 average time 0.00590449595451
****Stage 1 average time 0.00447259581089
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947084721657
****DCGs @ 8: 0.920523322105
****DCGs @ 16: 0.876752397824
****DCGs @ 32: 0.817109954086
****DCGs @ 64: 0.726465481878
****Error : 0.292310546875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.597258091
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008431048274040223, 0.00970121622085571)
('****Total time: ', 0.01402210521697998, 0.019968223571777344)
('****Preprocess time: ', 0.001176476240158081, 0.0012841701507568357)
('****Data time: ', 0.00023170602321624756, 0.0002598762512207031)
('****Fetch time: ', 6.611227989196778e-05, 7.390975952148438e-05)
('****Sort time: ', 0.0003643816709518433, 0.00041011571884155254)
****Stage 0 average time 0.0058060157299
****Stage 1 average time 0.00446370875835
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945951546044
****DCGs @ 8: 0.920680259731
****DCGs @ 16: 0.87682316189
****DCGs @ 32: 0.817188125047
****DCGs @ 64: 0.72707167646
****Error : 0.29227734375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.6550321579
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.008392775058746338, 0.009367632865905758)
('****Total time: ', 0.01227584707736969, 0.015476346015930174)
('****Preprocess time: ', 0.0011596577167510987, 0.0012619614601135254)
('****Data time: ', 0.00023137474060058594, 0.00026106834411621094)
('****Fetch time: ', 6.581532955169678e-05, 7.104873657226562e-05)
('****Sort time: ', 0.0003653291463851929, 0.0004069805145263672)
****Stage 0 average time 0.00578311109543
****Stage 1 average time 0.00443184089661
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947080586154
****DCGs @ 8: 0.920697666506
****DCGs @ 16: 0.877089085488
****DCGs @ 32: 0.817194234985
****DCGs @ 64: 0.726860380879
****Error : 0.292341796875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.6638870239
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008137698531150818, 0.00953686237335205)
('****Total time: ', 0.011673468708992005, 0.013541281223297117)
('****Preprocess time: ', 0.001164663791656494, 0.0013339996337890622)
('****Data time: ', 0.00022858190536499023, 0.0002598762512207031)
('****Fetch time: ', 6.596827507019042e-05, 7.368326187133783e-05)
('****Sort time: ', 0.000369542121887207, 0.00043420791625976536)
****Stage 0 average time 0.00583415424824
****Stage 1 average time 0.00413230037689
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945430125365
****DCGs @ 8: 0.919771205968
****DCGs @ 16: 0.876444549942
****DCGs @ 32: 0.816657713611
****DCGs @ 64: 0.726461904186
****Error : 0.2925
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.8440668583
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.008057993531227112, 0.009412932395935053)
('****Total time: ', 0.011550933599472046, 0.013294124603271484)
('****Preprocess time: ', 0.001196816921234131, 0.0015289902687072754)
('****Data time: ', 0.00023022007942199708, 0.0002627372741699219)
('****Fetch time: ', 6.544864177703858e-05, 7.200241088867188e-05)
('****Sort time: ', 0.00037717461585998533, 0.00044798851013183594)
****Stage 0 average time 0.00578889107704
****Stage 1 average time 0.00413876271248
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946115290972
****DCGs @ 8: 0.920433101012
****DCGs @ 16: 0.877188430103
****DCGs @ 32: 0.817220274128
****DCGs @ 64: 0.726976571285
****Error : 0.292337890625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.4681448936
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.0077364064455032345, 0.008825075626373292)
('****Total time: ', 0.010955685138702393, 0.012084054946899413)
('****Preprocess time: ', 0.0011064348220825196, 0.0011859059333801268)
('****Data time: ', 0.0002185627222061157, 0.0002448558807373047)
('****Fetch time: ', 6.203365325927734e-05, 6.818771362304688e-05)
('****Sort time: ', 0.0003624911308288574, 0.00040411949157714844)
****Stage 0 average time 0.00573261141777
****Stage 1 average time 0.00375331735611
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947172045145
****DCGs @ 8: 0.92098385907
****DCGs @ 16: 0.877055936059
****DCGs @ 32: 0.817294864796
****DCGs @ 64: 0.726692898988
****Error : 0.2923671875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  30.5473480225
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.007631865859031677, 0.008653974533081055)
('****Total time: ', 0.010817640900611877, 0.011888980865478516)
('****Preprocess time: ', 0.0010959982872009277, 0.0011548995971679688)
('****Data time: ', 0.00021786844730377198, 0.0002410411834716797)
('****Fetch time: ', 6.179451942443848e-05, 6.794929504394531e-05)
('****Sort time: ', 0.0003624908924102783, 0.0003998279571533203)
****Stage 0 average time 0.00570601153374
****Stage 1 average time 0.00366400647163
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945343048983
****DCGs @ 8: 0.920228684167
****DCGs @ 16: 0.876307038401
****DCGs @ 32: 0.81674958527
****DCGs @ 64: 0.726659499264
****Error : 0.292265625
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  1.66302990913
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.012544087171554565, 0.016603446006774897)
('****Total time: ', 0.01779085075855255, 0.024005520343780517)
('****Preprocess time: ', 0.0014113014936447143, 0.0019491076469421384)
('****Data time: ', 0.00030382859706878663, 0.00036716461181640625)
('****Fetch time: ', 6.567394733428955e-05, 7.82012939453125e-05)
('****Sort time: ', 0.0004479732513427734, 0.0006239891052246091)
****Stage 0 average time 0.0073657720089
****Stage 1 average time 0.00740709245205
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945698724216
****DCGs @ 8: 0.920191956232
****DCGs @ 16: 0.876298604041
****DCGs @ 32: 0.816603863116
****DCGs @ 64: 0.726521028823
****Error : 0.292462890625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  2.62554502487
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.011645962715148925, 0.014868271350860595)
('****Total time: ', 0.017173285961151124, 0.02140301465988159)
('****Preprocess time: ', 0.0013572275638580322, 0.0018149495124816888)
('****Data time: ', 0.0002961456775665283, 0.0003478527069091797)
('****Fetch time: ', 6.286275386810303e-05, 7.418394088745098e-05)
('****Sort time: ', 0.0004431852102279663, 0.0005362033843994141)
****Stage 0 average time 0.00701267707348
****Stage 1 average time 0.00679270684719
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947083845874
****DCGs @ 8: 0.920420203686
****DCGs @ 16: 0.877045545452
****DCGs @ 32: 0.817033502336
****DCGs @ 64: 0.726675768952
****Error : 0.29228515625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  3.59744906425
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011105125904083251, 0.014013445377349845)
('****Total time: ', 0.015345483899116516, 0.01900397539138794)
('****Preprocess time: ', 0.0013100712299346925, 0.0016929745674133289)
('****Data time: ', 0.0002846989631652832, 0.000328075885772705)
('****Fetch time: ', 5.788445472717285e-05, 6.985664367675781e-05)
('****Sort time: ', 0.0004121795892715454, 0.000532007217407226)
****Stage 0 average time 0.00664767003059
****Stage 1 average time 0.00652229011059
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946125562496
****DCGs @ 8: 0.920300288032
****DCGs @ 16: 0.876732740413
****DCGs @ 32: 0.817495980281
****DCGs @ 64: 0.726858445719
****Error : 0.2923203125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.66279888153
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.010719749212265015, 0.013229656219482421)
('****Total time: ', 0.014706417560577393, 0.01761804819107056)
('****Preprocess time: ', 0.0012831423282623291, 0.001684916019439697)
('****Data time: ', 0.00027386975288391113, 0.0003108978271484375)
('****Fetch time: ', 5.329537391662598e-05, 6.389617919921875e-05)
('****Sort time: ', 0.0004063875675201416, 0.0005190730094909666)
****Stage 0 average time 0.00636101520061
****Stage 1 average time 0.00637542903423
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946344802396
****DCGs @ 8: 0.920680250225
****DCGs @ 16: 0.877163256618
****DCGs @ 32: 0.81687408708
****DCGs @ 64: 0.726863918822
****Error : 0.292412109375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  6.68867111206
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.010431622505187988, 0.012605655193328853)
('****Total time: ', 0.014302303910255432, 0.01690356731414794)
('****Preprocess time: ', 0.0012874674797058105, 0.001578831672668457)
('****Data time: ', 0.00028503799438476564, 0.00031377077102661126)
('****Fetch time: ', 5.098044872283935e-05, 6.103515625e-05)
('****Sort time: ', 0.00040715038776397707, 0.0004918694496154785)
****Stage 0 average time 0.00627065086365
****Stage 1 average time 0.00619160795212
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945648242376
****DCGs @ 8: 0.919989490103
****DCGs @ 16: 0.876715011375
****DCGs @ 32: 0.816864687217
****DCGs @ 64: 0.726665274393
****Error : 0.292513671875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.73242282867
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.010395649433135987, 0.012651121616363526)
('****Total time: ', 0.014104206085205078, 0.016623318195343018)
('****Preprocess time: ', 0.0012690085172653198, 0.0016358971595764155)
('****Data time: ', 0.00027145349979400637, 0.00030493736267089844)
('****Fetch time: ', 4.958057403564453e-05, 5.60402870178222e-05)
('****Sort time: ', 0.00040741038322448733, 0.0004749417304992675)
****Stage 0 average time 0.00611123073101
****Stage 1 average time 0.00628187167645
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947084721657
****DCGs @ 8: 0.920523322105
****DCGs @ 16: 0.876752397824
****DCGs @ 32: 0.817109954086
****DCGs @ 64: 0.726465481878
****Error : 0.292310546875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.6649858952
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.010283779382705688, 0.012441778182983393)
('****Total time: ', 0.014070340514183044, 0.016510307788848877)
('****Preprocess time: ', 0.0012698138952255248, 0.0016211152076721184)
('****Data time: ', 0.00027296626567840574, 0.0003108978271484375)
('****Fetch time: ', 4.7009944915771486e-05, 5.507469177246094e-05)
('****Sort time: ', 0.0003995018005371094, 0.0004618287086486816)
****Stage 0 average time 0.00609490525723
****Stage 1 average time 0.00617816603184
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945951546044
****DCGs @ 8: 0.920680259731
****DCGs @ 16: 0.87682316189
****DCGs @ 32: 0.817188125047
****DCGs @ 64: 0.72707167646
****Error : 0.29227734375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.7144339085
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.009947708129882812, 0.011461365222930906)
('****Total time: ', 0.013567766427993774, 0.015401041507720948)
('****Preprocess time: ', 0.0012713245153427124, 0.0014782309532165526)
('****Data time: ', 0.0002767356634140015, 0.00031113624572753906)
('****Fetch time: ', 4.6345949172973635e-05, 5.507469177246094e-05)
('****Sort time: ', 0.0003938344717025757, 0.0004551410675048828)
****Stage 0 average time 0.0060462846756
****Stage 1 average time 0.00588966405392
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947080586154
****DCGs @ 8: 0.920697666506
****DCGs @ 16: 0.877089085488
****DCGs @ 32: 0.817194234985
****DCGs @ 64: 0.726860380879
****Error : 0.292341796875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.7091569901
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.009964311957359313, 0.012009489536285396)
('****Total time: ', 0.013512261867523193, 0.015666055679321285)
('****Preprocess time: ', 0.0012414972782135009, 0.0015272736549377431)
('****Data time: ', 0.0002698768377304077, 0.0002963781356811522)
('****Fetch time: ', 4.4811606407165525e-05, 5.1975250244140625e-05)
('****Sort time: ', 0.00040231156349182127, 0.0004611015319824219)
****Stage 0 average time 0.00588255441189
****Stage 1 average time 0.00604025483131
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945430125365
****DCGs @ 8: 0.919771205968
****DCGs @ 16: 0.876444549942
****DCGs @ 32: 0.816657713611
****DCGs @ 64: 0.726461904186
****Error : 0.2925
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.8328070641
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.009896687865257263, 0.011736369132995604)
('****Total time: ', 0.01348171079158783, 0.015580618381500242)
('****Preprocess time: ', 0.0012693309783935547, 0.001600027084350586)
('****Data time: ', 0.00027207303047180174, 0.0003008961677551269)
('****Fetch time: ', 4.430484771728516e-05, 5.1021575927734375e-05)
('****Sort time: ', 0.00040221524238586424, 0.0004410743713378906)
****Stage 0 average time 0.00585110008717
****Stage 1 average time 0.00603351187706
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946115290972
****DCGs @ 8: 0.920433101012
****DCGs @ 16: 0.877188430103
****DCGs @ 32: 0.817220274128
****DCGs @ 64: 0.726976571285
****Error : 0.292337890625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.5961940289
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.009709291934967041, 0.011296033859252924)
('****Total time: ', 0.01332694149017334, 0.015092909336090088)
('****Preprocess time: ', 0.0012510063648223876, 0.0015699982643127442)
('****Data time: ', 0.0002696547508239746, 0.0002968311309814453)
('****Fetch time: ', 4.502761363983154e-05, 5.1021575927734375e-05)
('****Sort time: ', 0.00041624224185943606, 0.0004367828369140625)
****Stage 0 average time 0.0057027670145
****Stage 1 average time 0.00598845589161
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947172045145
****DCGs @ 8: 0.92098385907
****DCGs @ 16: 0.877055936059
****DCGs @ 32: 0.817294864796
****DCGs @ 64: 0.726692898988
****Error : 0.2923671875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  30.8199398518
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.009760556101799012, 0.011053347587585447)
('****Total time: ', 0.013465544104576111, 0.015027987957000721)
('****Preprocess time: ', 0.0012548424005508422, 0.0014288544654846192)
('****Data time: ', 0.0002737357616424561, 0.0003077983856201172)
('****Fetch time: ', 4.428493976593017e-05, 5.2928924560546875e-05)
('****Sort time: ', 0.0004054532051086426, 0.00045326948165893535)
****Stage 0 average time 0.00582319092751
****Stage 1 average time 0.00591568148136
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945343048983
****DCGs @ 8: 0.920228684167
****DCGs @ 16: 0.876307038401
****DCGs @ 32: 0.81674958527
****DCGs @ 64: 0.726659499264
****Error : 0.292265625
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
****Total experiment time (s):  8.35987782478
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008195463180541993, 0.00915628671646118)
('****Total time: ', 3.6027122504711153, 6.709894120693206)
('****Preprocess time: ', 0.0011536147594451904, 0.001231229305267334)
('****Data time: ', 0.0002166999578475952, 0.0002360463142395019)
('****Fetch time: ', 6.630706787109376e-05, 7.414817810058594e-05)
('****Sort time: ', 0.0003838822841644287, 0.00040820837020874004)
****Stage 0 average time 0.0041804125309
****Stage 1 average time 0.00583555471897
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945698724216
****DCGs @ 8: 0.920191956232
****DCGs @ 16: 0.876298604041
****DCGs @ 32: 0.816603998695
****DCGs @ 64: 0.726521158716
****Error : 0.292462890625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.58523201942
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.00873833978176117, 0.009151029586791991)
('****Total time: ', 3.633382054448128, 6.869203948974608)
('****Preprocess time: ', 0.001184980869293213, 0.0012791156768798828)
('****Data time: ', 0.000227591872215271, 0.0002460598945617675)
('****Fetch time: ', 6.95122480392456e-05, 7.295608520507812e-05)
('****Sort time: ', 0.0003847637176513672, 0.00040912628173828125)
****Stage 0 average time 0.00479725646973
****Stage 1 average time 0.00580793201923
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947083845874
****DCGs @ 8: 0.920420203686
****DCGs @ 16: 0.877045545452
****DCGs @ 32: 0.817033502336
****DCGs @ 64: 0.726675768952
****Error : 0.29228515625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.51546406746
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008653823733329773, 0.009061098098754883)
('****Total time: ', 3.0199450833797457, 5.711190664768218)
('****Preprocess time: ', 0.0011888685226440429, 0.0012973189353942868)
('****Data time: ', 0.00022684800624847413, 0.00024199485778808594)
('****Fetch time: ', 6.709539890289307e-05, 7.104873657226562e-05)
('****Sort time: ', 0.0003836708068847656, 0.0004119873046875)
****Stage 0 average time 0.00476118445396
****Stage 1 average time 0.00575912201405
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946125562496
****DCGs @ 8: 0.920300288032
****DCGs @ 16: 0.876732740413
****DCGs @ 32: 0.81749611586
****DCGs @ 64: 0.726858575612
****Error : 0.2923203125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.52396392822
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.008757691979408264, 0.009734618663787838)
('****Total time: ', 2.53837443113327, 4.836231684684753)
('****Preprocess time: ', 0.0011829978227615356, 0.001255035400390625)
('****Data time: ', 0.00022658789157867432, 0.0002429604530334472)
('****Fetch time: ', 6.778275966644287e-05, 7.368326187133783e-05)
('****Sort time: ', 0.0003797295093536377, 0.0004050731658935547)
****Stage 0 average time 0.00476408171654
****Stage 1 average time 0.00585070824623
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946344802396
****DCGs @ 8: 0.920680250225
****DCGs @ 16: 0.877163256618
****DCGs @ 32: 0.816874222659
****DCGs @ 64: 0.726864048715
****Error : 0.292412109375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.86732411385
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.00851997196674347, 0.009578084945678711)
('****Total time: ', 1.3968629528284073, 2.322626173496246)
('****Preprocess time: ', 0.001167724370956421, 0.0012710571289062497)
('****Data time: ', 0.0002194356918334961, 0.00023984909057617188)
('****Fetch time: ', 6.525158882141113e-05, 7.176399230957031e-05)
('****Sort time: ', 0.0003816254138946533, 0.0004150867462158203)
****Stage 0 average time 0.00443657696247
****Stage 1 average time 0.00591743206978
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945648242376
****DCGs @ 8: 0.919989490103
****DCGs @ 16: 0.876715011375
****DCGs @ 32: 0.816864687217
****DCGs @ 64: 0.726665274393
****Error : 0.292513671875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.48493003845
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.00866840147972107, 0.009212982654571534)
('****Total time: ', 0.4532656843662262, 0.9165055632591245)
('****Preprocess time: ', 0.0011816517114639283, 0.0012738704681396484)
('****Data time: ', 0.0002228776216506958, 0.00023794174194335938)
('****Fetch time: ', 6.684839725494385e-05, 7.295608520507812e-05)
('****Sort time: ', 0.0003929562568664551, 0.0003979206085205078)
****Stage 0 average time 0.00473931562901
****Stage 1 average time 0.00579341983795
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947084721657
****DCGs @ 8: 0.920523322105
****DCGs @ 16: 0.876752397824
****DCGs @ 32: 0.817110089665
****DCGs @ 64: 0.726465611771
****Error : 0.292310546875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.5986051559
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.00819357979297638, 0.009482240676879883)
('****Total time: ', 0.012606630682945251, 0.01662592887878418)
('****Preprocess time: ', 0.0011220901012420654, 0.0012548565864562984)
('****Data time: ', 0.00021129679679870607, 0.00023603439331054688)
('****Fetch time: ', 6.347262859344482e-05, 7.082223892211908e-05)
('****Sort time: ', 0.0003722329139709473, 0.00041103363037109375)
****Stage 0 average time 0.00401944482327
****Stage 1 average time 0.00594322741032
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945951546044
****DCGs @ 8: 0.920680259731
****DCGs @ 16: 0.87682316189
****DCGs @ 32: 0.817188260626
****DCGs @ 64: 0.727071806353
****Error : 0.29227734375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.6569199562
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.00813441789150238, 0.009473741054534909)
('****Total time: ', 0.011709251880645751, 0.0146242618560791)
('****Preprocess time: ', 0.0011027472019195556, 0.0012920975685119622)
('****Data time: ', 0.00021646618843078612, 0.0002448678016662597)
('****Fetch time: ', 6.365680694580078e-05, 7.226467132568346e-05)
('****Sort time: ', 0.0003780527114868164, 0.0004189014434814453)
****Stage 0 average time 0.00399443995953
****Stage 1 average time 0.00590090084076
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947080586154
****DCGs @ 8: 0.920697666506
****DCGs @ 16: 0.877089085488
****DCGs @ 32: 0.817194234985
****DCGs @ 64: 0.726860380879
****Error : 0.292341796875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.650190115
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008149863481521606, 0.00940744876861572)
('****Total time: ', 0.011580424666404724, 0.013346004486083984)
('****Preprocess time: ', 0.0011234936714172364, 0.0012770771980285638)
('****Data time: ', 0.00022131097316741943, 0.00024819374084472656)
('****Fetch time: ', 6.447112560272217e-05, 7.201433181762689e-05)
('****Sort time: ', 0.0003791908025741577, 0.0004429817199707031)
****Stage 0 average time 0.00408316469193
****Stage 1 average time 0.00585516536236
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945430125365
****DCGs @ 8: 0.919771205968
****DCGs @ 16: 0.876444549942
****DCGs @ 32: 0.81665784919
****DCGs @ 64: 0.726462034079
****Error : 0.2925
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.8372249603
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.008025500059127808, 0.009373950958251952)
('****Total time: ', 0.011367475152015687, 0.01299958229064941)
('****Preprocess time: ', 0.0011021865606307983, 0.0012660622596740718)
('****Data time: ', 0.00021917331218719482, 0.0002460479736328125)
('****Fetch time: ', 6.730735301971436e-05, 7.295608520507812e-05)
('****Sort time: ', 0.0003776516914367676, 0.0004439473152160644)
****Stage 0 average time 0.0039961963892
****Stage 1 average time 0.0057956225872
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946115290972
****DCGs @ 8: 0.920433101012
****DCGs @ 16: 0.877188430103
****DCGs @ 32: 0.817220274128
****DCGs @ 64: 0.726976571285
****Error : 0.292337890625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.552531004
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.008008614540100097, 0.009188342094421384)
('****Total time: ', 0.011469160437583923, 0.012935078144073487)
('****Preprocess time: ', 0.0011227656602859498, 0.0013288736343383782)
('****Data time: ', 0.00021785211563110353, 0.0002463221549987791)
('****Fetch time: ', 6.306827068328857e-05, 7.009506225585938e-05)
('****Sort time: ', 0.0003751275539398193, 0.0004482269287109375)
****Stage 0 average time 0.00399212360382
****Stage 1 average time 0.00579530453682
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947172045145
****DCGs @ 8: 0.92098385907
****DCGs @ 16: 0.877055936059
****DCGs @ 32: 0.817295000375
****DCGs @ 64: 0.72669302888
****Error : 0.2923671875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  30.7575800419
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.00805667006969452, 0.009351277351379396)
('****Total time: ', 0.011430593252182007, 0.012955141067504877)
('****Preprocess time: ', 0.001112263560295105, 0.001317799091339111)
('****Data time: ', 0.0002200063467025757, 0.0002482295036315916)
('****Fetch time: ', 6.528961658477783e-05, 7.272958755493158e-05)
('****Sort time: ', 0.0003778576850891113, 0.0004511356353759763)
****Stage 0 average time 0.00406916975975
****Stage 1 average time 0.00576291751862
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945343048983
****DCGs @ 8: 0.920228684167
****DCGs @ 16: 0.876307038401
****DCGs @ 32: 0.816749720849
****DCGs @ 64: 0.726659629156
****Error : 0.292265625
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  7.18682098389
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.012499045491218566, 0.01658402681350708)
('****Total time: ', 2.666632238864899, 5.02525874376297)
('****Preprocess time: ', 0.0018689886331558227, 0.002539026737213134)
('****Data time: ', 0.0002797136306762695, 0.00033211708068847656)
('****Fetch time: ', 7.686817646026611e-05, 8.58306884765625e-05)
('****Sort time: ', 0.0003427577018737793, 0.00041203498840332005)
****Stage 0 average time 0.0115291587114
****Stage 1 average time 0.00353821492195
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971405334172
****DCGs @ 8: 0.948429715248
****DCGs @ 16: 0.923278471854
****DCGs @ 32: 0.878986105087
****DCGs @ 64: 0.815480953094
****Error : 0.32310546875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.32287406921
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.011697496891021729, 0.015140080451965311)
('****Total time: ', 2.3081741877794264, 4.322596907615661)
('****Preprocess time: ', 0.0017586549520492553, 0.002364349365234374)
('****Data time: ', 0.0002690553665161133, 0.00031280517578125)
('****Fetch time: ', 7.166612148284912e-05, 8.296966552734375e-05)
('****Sort time: ', 0.00034239590167999266, 0.0004138946533203125)
****Stage 0 average time 0.0105380017757
****Stage 1 average time 0.00360126745701
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.970021090143
****DCGs @ 8: 0.949351090702
****DCGs @ 16: 0.923541124173
****DCGs @ 32: 0.879581999241
****DCGs @ 64: 0.815910779865
****Error : 0.32307421875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.14522790909
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.0112077716588974, 0.012741577625274655)
('****Total time: ', 1.7005035227537155, 3.150553095340728)
('****Preprocess time: ', 0.001675652027130127, 0.0019858360290527237)
('****Data time: ', 0.00025730955600738526, 0.0002892017364501953)
('****Fetch time: ', 6.83753490447998e-05, 7.605552673339844e-05)
('****Sort time: ', 0.0003514219522476196, 0.0004170060157775878)
****Stage 0 average time 0.0100411424637
****Stage 1 average time 0.00351938807964
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.967881778509
****DCGs @ 8: 0.948029530279
****DCGs @ 16: 0.922794104739
****DCGs @ 32: 0.87830174154
****DCGs @ 64: 0.815478230449
****Error : 0.32283984375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.15227985382
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.011325401186943054, 0.01418853998184204)
('****Total time: ', 1.1339636895656586, 2.1325828075408935)
('****Preprocess time: ', 0.0016805806159973144, 0.002179205417633056)
('****Data time: ', 0.00025493896007537843, 0.00028587579727172845)
('****Fetch time: ', 6.752526760101318e-05, 7.605552673339844e-05)
('****Sort time: ', 0.0003537474870681763, 0.0004072546958923338)
****Stage 0 average time 0.0101574524641
****Stage 1 average time 0.00352474105358
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971702501818
****DCGs @ 8: 0.94863831638
****DCGs @ 16: 0.92363430652
****DCGs @ 32: 0.879290663182
****DCGs @ 64: 0.815760292396
****Error : 0.32291015625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.1624751091
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.010922460913658142, 0.012635481357574457)
('****Total time: ', 0.1181618515253067, 0.19853527545928953)
('****Preprocess time: ', 0.0016405713558197022, 0.0017609596252441406)
('****Data time: ', 0.0002527657747268677, 0.00028014183044433594)
('****Fetch time: ', 6.48970603942871e-05, 7.295608520507812e-05)
('****Sort time: ', 0.00035361552238464357, 0.0003979206085205078)
****Stage 0 average time 0.00971232283115
****Stage 1 average time 0.00352198779583
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.968790072412
****DCGs @ 8: 0.948818297064
****DCGs @ 16: 0.923010198731
****DCGs @ 32: 0.879219461426
****DCGs @ 64: 0.815763042594
****Error : 0.32307421875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.07348799706
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.010968043446540832, 0.012960588932037352)
('****Total time: ', 0.016794510364532472, 0.022209417819976804)
('****Preprocess time: ', 0.0016469016075134277, 0.0018021225929260244)
('****Data time: ', 0.00025144243240356445, 0.0002808570861816406)
('****Fetch time: ', 6.588065624237061e-05, 7.176399230957031e-05)
('****Sort time: ', 0.00037424039840698245, 0.00039005279541015625)
****Stage 0 average time 0.00977046847343
****Stage 1 average time 0.00353604006767
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.968666921218
****DCGs @ 8: 0.948186298474
****DCGs @ 16: 0.923147719251
****DCGs @ 32: 0.878642871213
****DCGs @ 64: 0.815602402928
****Error : 0.32278125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.9674561024
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011068066596984864, 0.013525462150573727)
('****Total time: ', 0.01565127170085907, 0.01941334009170532)
('****Preprocess time: ', 0.0016263004541397096, 0.0017792701721191396)
('****Data time: ', 0.0002473357915878296, 0.00027298927307128906)
('****Fetch time: ', 6.346070766448974e-05, 7.081031799316406e-05)
('****Sort time: ', 0.0003533310890197754, 0.0003979802131652829)
****Stage 0 average time 0.00985293006897
****Stage 1 average time 0.00350556457043
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971824146705
****DCGs @ 8: 0.949044909966
****DCGs @ 16: 0.923467413879
****DCGs @ 32: 0.879126637139
****DCGs @ 64: 0.815755329409
****Error : 0.32295703125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.0430459976
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.010825249552726745, 0.01281898021697998)
('****Total time: ', 0.014943591237068177, 0.017346584796905515)
('****Preprocess time: ', 0.0016019927263259887, 0.0017331123352050779)
('****Data time: ', 0.0002486259937286377, 0.0002758502960205078)
('****Fetch time: ', 6.363224983215331e-05, 7.082223892211908e-05)
('****Sort time: ', 0.00035225403308868406, 0.00039196014404296875)
****Stage 0 average time 0.00960833895206
****Stage 1 average time 0.00348341560364
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.968037881108
****DCGs @ 8: 0.948516052138
****DCGs @ 16: 0.923017855859
****DCGs @ 32: 0.879231224142
****DCGs @ 64: 0.815867376806
****Error : 0.32311328125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.9879238605
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.010538753390312195, 0.012192022800445556)
('****Total time: ', 0.014420742392539978, 0.016332662105560298)
('****Preprocess time: ', 0.0015834548473358154, 0.0016830086708068846)
('****Data time: ', 0.0002455869913101196, 0.0002758622169494628)
('****Fetch time: ', 6.26215934753418e-05, 6.914138793945312e-05)
('****Sort time: ', 0.00034702467918395997, 0.00038695335388183594)
****Stage 0 average time 0.00930909383297
****Stage 1 average time 0.00346834766865
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.969684835071
****DCGs @ 8: 0.9480828198
****DCGs @ 16: 0.923204565213
****DCGs @ 32: 0.878470384628
****DCGs @ 64: 0.815446141629
****Error : 0.322703125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.18394804
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.0108678560256958, 0.012559235095977781)
('****Total time: ', 0.014962180495262146, 0.016884446144104)
('****Preprocess time: ', 0.0016534366607666015, 0.0019860744476318357)
('****Data time: ', 0.0002591733932495117, 0.0002987504005432128)
('****Fetch time: ', 6.605660915374756e-05, 7.414817810058594e-05)
('****Sort time: ', 0.00035960865020751953, 0.0004291534423828125)
****Stage 0 average time 0.00927726316452
****Stage 1 average time 0.00392886817455
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971487891633
****DCGs @ 8: 0.949451598698
****DCGs @ 16: 0.92353469854
****DCGs @ 32: 0.879544459376
****DCGs @ 64: 0.815949843633
****Error : 0.32309375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.9303729534
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.011150296807289123, 0.01292735338211059)
('****Total time: ', 0.015181732654571534, 0.017167019844055175)
('****Preprocess time: ', 0.001685451865196228, 0.0018260478973388672)
('****Data time: ', 0.0002735917568206787, 0.0002970695495605469)
('****Fetch time: ', 6.601715087890625e-05, 7.510185241699219e-05)
('****Sort time: ', 0.0003584989309310913, 0.00040794610977172845)
****Stage 0 average time 0.00978278470039
****Stage 1 average time 0.00375107181072
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.967588993471
****DCGs @ 8: 0.94813165589
****DCGs @ 16: 0.923030859724
****DCGs @ 32: 0.878650789189
****DCGs @ 64: 0.815648882274
****Error : 0.32283203125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  31.1364309788
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.010679158210754394, 0.011974442005157463)
('****Total time: ', 0.014566709995269775, 0.016058421134948726)
('****Preprocess time: ', 0.0015908721685409545, 0.0016751646995544433)
('****Data time: ', 0.00024392175674438476, 0.0002739548683166503)
('****Fetch time: ', 6.213915348052978e-05, 6.890296936035156e-05)
('****Sort time: ', 0.00034546518325805667, 0.0003910064697265625)
****Stage 0 average time 0.00946165132523
****Stage 1 average time 0.00345990514755
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.970903827865
****DCGs @ 8: 0.94841304589
****DCGs @ 16: 0.923291190568
****DCGs @ 32: 0.879051791886
****DCGs @ 64: 0.815689528959
****Error : 0.3229296875
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  1.9785721302
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.013456109523773194, 0.017629277706146234)
('****Total time: ', 0.019027325510978698, 0.02546535730361938)
('****Preprocess time: ', 0.0019162877798080443, 0.0026231765747070307)
('****Data time: ', 0.0003275463581085205, 0.0003979325294494628)
('****Fetch time: ', 6.0535430908203124e-05, 7.177591323852533e-05)
('****Sort time: ', 0.00041375303268432616, 0.0005529046058654785)
****Stage 0 average time 0.0112764142752
****Stage 1 average time 0.00489781785011
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971405334172
****DCGs @ 8: 0.948429715248
****DCGs @ 16: 0.923278471854
****DCGs @ 32: 0.878986105087
****DCGs @ 64: 0.815480953094
****Error : 0.32310546875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  2.91686892509
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.012680594325065613, 0.016672289371490474)
('****Total time: ', 0.017476301670074464, 0.022048795223236075)
('****Preprocess time: ', 0.0018055883646011352, 0.0023902893066406242)
('****Data time: ', 0.00030878305435180667, 0.0003631114959716797)
('****Fetch time: ', 5.45198917388916e-05, 6.604194641113281e-05)
('****Sort time: ', 0.0003768912553787231, 0.0004839897155761719)
****Stage 0 average time 0.0104995368719
****Stage 1 average time 0.00472684001923
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.970021090143
****DCGs @ 8: 0.949351090702
****DCGs @ 16: 0.923541124173
****DCGs @ 32: 0.879581999241
****DCGs @ 64: 0.815910779865
****Error : 0.32307421875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  3.95658802986
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01297955024242401, 0.016082346439361572)
('****Total time: ', 0.0179259592294693, 0.021608483791351316)
('****Preprocess time: ', 0.0018770363330841064, 0.002525103092193602)
('****Data time: ', 0.0003280829191207886, 0.0003722071647644041)
('****Fetch time: ', 5.751180648803711e-05, 6.725788116455065e-05)
('****Sort time: ', 0.00039058959484100344, 0.00048568248748779284)
****Stage 0 average time 0.0107149835825
****Stage 1 average time 0.00491778731346
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.967881778509
****DCGs @ 8: 0.948029530279
****DCGs @ 16: 0.922794104739
****DCGs @ 32: 0.87830174154
****DCGs @ 64: 0.815478230449
****Error : 0.32283984375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.93734192848
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.011965222001075745, 0.014763844013214112)
('****Total time: ', 0.016419331669807434, 0.019902098178863525)
('****Preprocess time: ', 0.0017584071159362793, 0.002291059494018554)
('****Data time: ', 0.0002969282865524292, 0.00033402442932128906)
('****Fetch time: ', 4.82562780380249e-05, 5.699396133422845e-05)
('****Sort time: ', 0.00037323951721191407, 0.00045090913772582975)
****Stage 0 average time 0.010090790987
****Stage 1 average time 0.0043512622118
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971702501818
****DCGs @ 8: 0.94863831638
****DCGs @ 16: 0.92363430652
****DCGs @ 32: 0.879290663182
****DCGs @ 64: 0.815760292396
****Error : 0.32291015625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  6.98598599434
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.01148280155658722, 0.013608932495117182)
('****Total time: ', 0.01598263871669769, 0.01854956150054931)
('****Preprocess time: ', 0.0017217718362808228, 0.0020922422409057596)
('****Data time: ', 0.0002959420680999756, 0.0003299713134765625)
('****Fetch time: ', 4.4626712799072265e-05, 5.3882598876953125e-05)
('****Sort time: ', 0.00038296449184417727, 0.00044490098953247064)
****Stage 0 average time 0.00974056661129
****Stage 1 average time 0.00418754005432
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.968790072412
****DCGs @ 8: 0.948818297064
****DCGs @ 16: 0.923010198731
****DCGs @ 32: 0.879219461426
****DCGs @ 64: 0.815763042594
****Error : 0.32307421875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.07669210434
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.011375879287719727, 0.013317596912384022)
('****Total time: ', 0.015730976581573488, 0.018034029006958007)
('****Preprocess time: ', 0.00173066246509552, 0.0019861698150634758)
('****Data time: ', 0.00029403281211853025, 0.00032929182052612285)
('****Fetch time: ', 4.487872123718262e-05, 5.1021575927734375e-05)
('****Sort time: ', 0.00037594103813171385, 0.00043082237243652344)
****Stage 0 average time 0.00951221859455
****Stage 1 average time 0.00430917572975
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.968666921218
****DCGs @ 8: 0.948186298474
****DCGs @ 16: 0.923147719251
****DCGs @ 32: 0.878642871213
****DCGs @ 64: 0.815602402928
****Error : 0.32278125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.9749600887
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.012000842094421387, 0.014226973056793211)
('****Total time: ', 0.01635238230228424, 0.018740761280059803)
('****Preprocess time: ', 0.0018036104440689088, 0.0022900342941284168)
('****Data time: ', 0.0003076357841491699, 0.0003407120704650878)
('****Fetch time: ', 4.5577168464660645e-05, 5.3882598876953125e-05)
('****Sort time: ', 0.0003695238828659058, 0.0004258155822753906)
****Stage 0 average time 0.0101356884241
****Stage 1 average time 0.00439150094986
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971824146705
****DCGs @ 8: 0.949044909966
****DCGs @ 16: 0.923467413879
****DCGs @ 32: 0.879126637139
****DCGs @ 64: 0.815755329409
****Error : 0.32295703125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.0646049976
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.01176375949382782, 0.013973927497863763)
('****Total time: ', 0.01607541811466217, 0.018482065200805663)
('****Preprocess time: ', 0.0017883920669555665, 0.002117347717285155)
('****Data time: ', 0.0003076009750366211, 0.0003359436988830566)
('****Fetch time: ', 4.4137001037597655e-05, 5.1021575927734375e-05)
('****Sort time: ', 0.0003686220645904541, 0.00043109655380249004)
****Stage 0 average time 0.0100206403732
****Stage 1 average time 0.00425187122822
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.968037881108
****DCGs @ 8: 0.948516052138
****DCGs @ 16: 0.923017855859
****DCGs @ 32: 0.879231224142
****DCGs @ 64: 0.815867376806
****Error : 0.32311328125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.0665481091
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01176414179801941, 0.013876259326934813)
('****Total time: ', 0.0160902681350708, 0.018467044830322268)
('****Preprocess time: ', 0.001777611494064331, 0.002169215679168701)
('****Data time: ', 0.0003059366941452026, 0.0003390431404113769)
('****Fetch time: ', 4.3549180030822755e-05, 4.982948303222656e-05)
('****Sort time: ', 0.000386763334274292, 0.0004141569137573241)
****Stage 0 average time 0.0100051072836
****Stage 1 average time 0.00427289521694
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.969684835071
****DCGs @ 8: 0.9480828198
****DCGs @ 16: 0.923204565213
****DCGs @ 32: 0.878470384628
****DCGs @ 64: 0.815446141629
****Error : 0.322703125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.1841681004
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.01129648506641388, 0.012857913970947266)
('****Total time: ', 0.015571176052093506, 0.0174134612083435)
('****Preprocess time: ', 0.0017454593181610108, 0.001972341537475585)
('****Data time: ', 0.00029873478412628174, 0.00032901763916015625)
('****Fetch time: ', 4.2441248893737796e-05, 4.8160552978515625e-05)
('****Sort time: ', 0.00036312246322631837, 0.0004232287406921385)
****Stage 0 average time 0.00958412432671
****Stage 1 average time 0.00416211855412
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971487891633
****DCGs @ 8: 0.949451598698
****DCGs @ 16: 0.92353469854
****DCGs @ 32: 0.879544459376
****DCGs @ 64: 0.815949843633
****Error : 0.32309375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.8268420696
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.01131823194026947, 0.012852263450622556)
('****Total time: ', 0.015352306246757508, 0.01704212427139282)
('****Preprocess time: ', 0.001737641453742981, 0.0019307374954223632)
('****Data time: ', 0.0002970930337905884, 0.0003256797790527344)
('****Fetch time: ', 4.20297384262085e-05, 4.792213439941406e-05)
('****Sort time: ', 0.00036194133758544924, 0.00039887428283691406)
****Stage 0 average time 0.00964881658554
****Stage 1 average time 0.00410812091827
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.967588993471
****DCGs @ 8: 0.94813165589
****DCGs @ 16: 0.923030859724
****DCGs @ 32: 0.878650789189
****DCGs @ 64: 0.815648882274
****Error : 0.32283203125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.0776810646
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.011204447269439697, 0.012664091587066651)
('****Total time: ', 0.015277898907661437, 0.01700836420059204)
('****Preprocess time: ', 0.001705472230911255, 0.0018542170524597167)
('****Data time: ', 0.0002973117828369141, 0.00032711029052734375)
('****Fetch time: ', 4.229962825775146e-05, 4.792213439941406e-05)
('****Sort time: ', 0.0003635674715042114, 0.0004007935523986816)
****Stage 0 average time 0.00952066552639
****Stage 1 average time 0.00409243285656
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.970903827865
****DCGs @ 8: 0.94841304589
****DCGs @ 16: 0.923291190568
****DCGs @ 32: 0.879051791886
****DCGs @ 64: 0.815689528959
****Error : 0.3229296875
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
****Total experiment time (s):  11.1859090328
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007472747445106506, 0.008093035221099852)
('****Total time: ', 4.826114539265633, 9.13739433288574)
('****Preprocess time: ', 0.0016051095724105835, 0.0017422556877136222)
('****Data time: ', 0.00023268747329711914, 0.00024796724319458)
('****Fetch time: ', 6.713533401489258e-05, 7.226467132568346e-05)
('****Sort time: ', 0.0003442326784133911, 0.00037384033203125)
****Stage 0 average time 0.00559372413158
****Stage 1 average time 0.00412818837166
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971405334172
****DCGs @ 8: 0.948429715248
****DCGs @ 16: 0.923278471854
****DCGs @ 32: 0.878986105087
****DCGs @ 64: 0.815480953094
****Error : 0.32310546875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.6511490345
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.006734975576400757, 0.007318067550659179)
('****Total time: ', 3.55003301179409, 6.725796568393707)
('****Preprocess time: ', 0.0015551891326904296, 0.0016591906547546384)
('****Data time: ', 0.00021802389621734618, 0.00023794174194335938)
('****Fetch time: ', 6.075608730316162e-05, 6.63042068481444e-05)
('****Sort time: ', 0.0003508281707763672, 0.00038005113601684564)
****Stage 0 average time 0.00483925974369
****Stage 1 average time 0.0040805131197
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.970021090143
****DCGs @ 8: 0.949351090702
****DCGs @ 16: 0.923541124173
****DCGs @ 32: 0.879581999241
****DCGs @ 64: 0.815910779865
****Error : 0.32307421875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.64856100082
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.006741588711738586, 0.0071940898895263665)
('****Total time: ', 2.989649723172188, 5.661723399162291)
('****Preprocess time: ', 0.0015465546846389771, 0.001639938354492187)
('****Data time: ', 0.00021653366088867187, 0.0002319812774658203)
('****Fetch time: ', 6.015443801879883e-05, 6.794929504394531e-05)
('****Sort time: ', 0.00037926340103149416, 0.00038123130798339844)
****Stage 0 average time 0.00483903050423
****Stage 1 average time 0.00410506439209
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.967881778509
****DCGs @ 8: 0.948029530279
****DCGs @ 16: 0.922794104739
****DCGs @ 32: 0.87830174154
****DCGs @ 64: 0.815478230449
****Error : 0.32283984375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.2678930759
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.007511975169181824, 0.008870363235473633)
('****Total time: ', 3.246281447529793, 6.181555831432342)
('****Preprocess time: ', 0.001617623209953308, 0.0017822265624999997)
('****Data time: ', 0.00023734164237976073, 0.0002579689025878906)
('****Fetch time: ', 6.430041790008544e-05, 7.104873657226562e-05)
('****Sort time: ', 0.0003467440605163574, 0.00037003755569458)
****Stage 0 average time 0.00564023017883
****Stage 1 average time 0.0041377543211
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971702501818
****DCGs @ 8: 0.94863831638
****DCGs @ 16: 0.92363430652
****DCGs @ 32: 0.879290663182
****DCGs @ 64: 0.815760292396
****Error : 0.32291015625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.61503601074
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.006739828824996948, 0.0071712017059326165)
('****Total time: ', 1.4660845402479172, 2.7417396783828734)
('****Preprocess time: ', 0.001534294843673706, 0.0015947937965393067)
('****Data time: ', 0.0002152998447418213, 0.0002319812774658203)
('****Fetch time: ', 5.9769392013549805e-05, 6.699562072753906e-05)
('****Sort time: ', 0.000347102165222168, 0.0003781318664550781)
****Stage 0 average time 0.00481608998775
****Stage 1 average time 0.00408020508289
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.968790072412
****DCGs @ 8: 0.948818297064
****DCGs @ 16: 0.923010198731
****DCGs @ 32: 0.879219461426
****DCGs @ 64: 0.815763042594
****Error : 0.32307421875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.62760591507
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.006716729044914245, 0.00717625617980957)
('****Total time: ', 0.3462767940759659, 0.7029481530189511)
('****Preprocess time: ', 0.0015364185571670533, 0.0015990853309631346)
('****Data time: ', 0.00021742904186248778, 0.0002319812774658203)
('****Fetch time: ', 5.9844136238098146e-05, 6.604194641113281e-05)
('****Sort time: ', 0.0003497316837310791, 0.0003848195075988769)
****Stage 0 average time 0.00482675147057
****Stage 1 average time 0.00405340099335
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.968666921218
****DCGs @ 8: 0.948186298474
****DCGs @ 16: 0.923147719251
****DCGs @ 32: 0.878642871213
****DCGs @ 64: 0.815602402928
****Error : 0.32278125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.1759829521
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007384344696998596, 0.007901227474212647)
('****Total time: ', 0.18018262600898743, 0.32868233919143675)
('****Preprocess time: ', 0.0016061323881149292, 0.0017419338226318357)
('****Data time: ', 0.00023245728015899657, 0.00024819374084472656)
('****Fetch time: ', 6.407535076141358e-05, 7.104873657226562e-05)
('****Sort time: ', 0.0003458589315414429, 0.0003719329833984375)
****Stage 0 average time 0.00556520855427
****Stage 1 average time 0.00406766009331
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971824146705
****DCGs @ 8: 0.949044909966
****DCGs @ 16: 0.923467413879
****DCGs @ 32: 0.879126637139
****DCGs @ 64: 0.815755329409
****Error : 0.32295703125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.9186630249
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.006765963077545166, 0.007548868656158446)
('****Total time: ', 0.011328323960304261, 0.01535851955413818)
('****Preprocess time: ', 0.0015264079570770264, 0.001697158813476562)
('****Data time: ', 0.00022330451011657714, 0.00024700164794921875)
('****Fetch time: ', 6.104207038879394e-05, 6.818771362304688e-05)
('****Sort time: ', 0.0003509951829910278, 0.0003941059112548828)
****Stage 0 average time 0.00489487481117
****Stage 1 average time 0.00403283798695
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.968037881108
****DCGs @ 8: 0.948516052138
****DCGs @ 16: 0.923017855859
****DCGs @ 32: 0.879231224142
****DCGs @ 64: 0.815867376806
****Error : 0.32311328125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.9736821651
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007281155467033386, 0.00894418954849243)
('****Total time: ', 0.01165434968471527, 0.014791655540466306)
('****Preprocess time: ', 0.0016478208303451539, 0.002173101902008056)
('****Data time: ', 0.0002357097864151001, 0.0002871036529541013)
('****Fetch time: ', 6.270503997802735e-05, 7.272958755493158e-05)
('****Sort time: ', 0.0003785243034362793, 0.0004279613494873047)
****Stage 0 average time 0.00528951609135
****Stage 1 average time 0.00431639933586
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.969684835071
****DCGs @ 8: 0.9480828198
****DCGs @ 16: 0.923204565213
****DCGs @ 32: 0.878470384628
****DCGs @ 64: 0.815446141629
****Error : 0.322703125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.1284730434
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.006904085755348206, 0.00795297622680664)
('****Total time: ', 0.010790890574455262, 0.012213039398193359)
('****Preprocess time: ', 0.0015451796054840089, 0.0017991423606872558)
('****Data time: ', 0.00023055708408355714, 0.0002620220184326172)
('****Fetch time: ', 6.131970882415771e-05, 6.985664367675781e-05)
('****Sort time: ', 0.00034658324718475343, 0.00041294097900390625)
****Stage 0 average time 0.00495130550861
****Stage 1 average time 0.00413641989231
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971487891633
****DCGs @ 8: 0.949451598698
****DCGs @ 16: 0.92353469854
****DCGs @ 32: 0.879544459376
****DCGs @ 64: 0.815949843633
****Error : 0.32309375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.8387489319
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.006800214409828186, 0.007817900180816647)
('****Total time: ', 0.010647570729255677, 0.01207904815673828)
('****Preprocess time: ', 0.001522627830505371, 0.0017021059989929196)
('****Data time: ', 0.00022893595695495605, 0.00026702880859375)
('****Fetch time: ', 6.167352199554444e-05, 6.940364837646471e-05)
('****Sort time: ', 0.0003472905158996582, 0.00041794776916503906)
****Stage 0 average time 0.00488579308987
****Stage 1 average time 0.00407494914532
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.967588993471
****DCGs @ 8: 0.94813165589
****DCGs @ 16: 0.923030859724
****DCGs @ 32: 0.878650789189
****DCGs @ 64: 0.815648882274
****Error : 0.32283203125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.0579099655
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.0068381808996200565, 0.007820832729339599)
('****Total time: ', 0.010685183763504028, 0.012006998062133789)
('****Preprocess time: ', 0.0015099208354949951, 0.0016878366470336908)
('****Data time: ', 0.00022536349296569825, 0.0002589225769042969)
('****Fetch time: ', 6.117355823516845e-05, 6.890296936035156e-05)
('****Sort time: ', 0.0003545447587966919, 0.0004420638084411619)
****Stage 0 average time 0.00491086959839
****Stage 1 average time 0.00407831394672
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.970903827865
****DCGs @ 8: 0.94841304589
****DCGs @ 16: 0.923291190568
****DCGs @ 32: 0.879051791886
****DCGs @ 64: 0.815689528959
****Error : 0.3229296875
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  8.76502919197
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.013378707766532898, 0.017985153198242183)
('****Total time: ', 3.5416986618041992, 6.520956826210021)
('****Preprocess time: ', 0.0023617806434631347, 0.0030620574951171872)
('****Data time: ', 0.0003213543891906738, 0.0003840923309326172)
('****Fetch time: ', 8.067858219146728e-05, 9.393692016601562e-05)
('****Sort time: ', 0.0005382895469665527, 0.0006859302520751953)
****Stage 0 average time 0.0122862987518
****Stage 1 average time 0.00439451217651
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971405334172
****DCGs @ 8: 0.948429715248
****DCGs @ 16: 0.923242475579
****DCGs @ 32: 0.879222151323
****DCGs @ 64: 0.816175768156
****Error : 0.292474609375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.77319002151
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.012044216513633728, 0.015957152843475333)
('****Total time: ', 3.0738368791341784, 5.669961261749267)
('****Preprocess time: ', 0.0021936750411987306, 0.0028381466865539536)
('****Data time: ', 0.00029765558242797854, 0.00035191774368286126)
('****Fetch time: ', 7.56540298461914e-05, 8.797645568847656e-05)
('****Sort time: ', 0.000565508484840393, 0.0007129311561584469)
****Stage 0 average time 0.010771214962
****Stage 1 average time 0.00440549468994
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.970021090143
****DCGs @ 8: 0.949311193433
****DCGs @ 16: 0.923556467518
****DCGs @ 32: 0.879696217488
****DCGs @ 64: 0.816506709372
****Error : 0.292553710937
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.61677384377
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011453314661979675, 0.013602674007415768)
('****Total time: ', 2.4560385414361954, 4.528290772438049)
('****Preprocess time: ', 0.002128388524055481, 0.0026591181755065917)
('****Data time: ', 0.00029272186756134033, 0.0003299713134765625)
('****Fetch time: ', 7.067739963531494e-05, 8.082389831542969e-05)
('****Sort time: ', 0.0005354056358337402, 0.0006618618965148925)
****Stage 0 average time 0.0101528737545
****Stage 1 average time 0.00432763433456
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.967881778509
****DCGs @ 8: 0.947944583006
****DCGs @ 16: 0.922825542547
****DCGs @ 32: 0.878561118736
****DCGs @ 64: 0.816168070543
****Error : 0.292522460938
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.56242799759
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.011170623064041138, 0.01248643398284912)
('****Total time: ', 1.8865761951208115, 3.538891208171844)
('****Preprocess time: ', 0.002057907223701477, 0.0022528767585754395)
('****Data time: ', 0.0002905054092407227, 0.00032210350036621094)
('****Fetch time: ', 6.871342658996582e-05, 7.605552673339844e-05)
('****Sort time: ', 0.0005490449666976929, 0.0006859421730041503)
****Stage 0 average time 0.0098387260437
****Stage 1 average time 0.00429806804657
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971702501818
****DCGs @ 8: 0.948683366384
****DCGs @ 16: 0.923601829133
****DCGs @ 32: 0.879549681091
****DCGs @ 64: 0.816418819554
****Error : 0.29242578125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.79270410538
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.011164021492004395, 0.012583363056182859)
('****Total time: ', 0.94527425968647, 1.7797050237655638)
('****Preprocess time: ', 0.00213399076461792, 0.0025830745697021486)
('****Data time: ', 0.0002798755168914795, 0.0003139972686767578)
('****Fetch time: ', 6.922638416290283e-05, 7.891654968261719e-05)
('****Sort time: ', 0.0005415440797805787, 0.0006552100181579588)
****Stage 0 average time 0.00976746177673
****Stage 1 average time 0.00442119646072
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.968790072412
****DCGs @ 8: 0.948778399795
****DCGs @ 16: 0.92308625814
****DCGs @ 32: 0.87929399265
****DCGs @ 64: 0.816337724958
****Error : 0.292600585937
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.02224493027
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.011063855051994323, 0.012405133247375487)
('****Total time: ', 0.02757514476776123, 0.06349442005157468)
('****Preprocess time: ', 0.002105444073677063, 0.002349102497100829)
('****Data time: ', 0.00027295541763305663, 0.0003070831298828125)
('****Fetch time: ', 6.737720966339112e-05, 7.295608520507812e-05)
('****Sort time: ', 0.000543048620223999, 0.0006239891052246091)
****Stage 0 average time 0.00971728110313
****Stage 1 average time 0.00433539927006
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.968666921218
****DCGs @ 8: 0.948146401204
****DCGs @ 16: 0.923124360737
****DCGs @ 32: 0.878937408856
****DCGs @ 64: 0.81631254437
****Error : 0.292436523437
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.9311249256
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011033957242965698, 0.012459683418273918)
('****Total time: ', 0.017240798473358153, 0.02193752527236938)
('****Preprocess time: ', 0.0021280744075775145, 0.0025208711624145506)
('****Data time: ', 0.00027731382846832276, 0.00031567811965942376)
('****Fetch time: ', 6.719553470611573e-05, 7.513761520385723e-05)
('****Sort time: ', 0.0005355436801910401, 0.0006142735481262201)
****Stage 0 average time 0.00963788473606
****Stage 1 average time 0.00440419995785
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971824146705
****DCGs @ 8: 0.949044909966
****DCGs @ 16: 0.923469621713
****DCGs @ 32: 0.879327983613
****DCGs @ 64: 0.816414140111
****Error : 0.292534179688
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.9474618435
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.011001785039901733, 0.01233537197113037)
('****Total time: ', 0.01622130262851715, 0.01925312280654907)
('****Preprocess time: ', 0.0020964916944503785, 0.00243016481399536)
('****Data time: ', 0.0002784618139266968, 0.00031713247299194316)
('****Fetch time: ', 6.66431188583374e-05, 7.605552673339844e-05)
('****Sort time: ', 0.0005260488986968994, 0.0006079792976379394)
****Stage 0 average time 0.00961418998241
****Stage 1 average time 0.00435524058342
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.968037881108
****DCGs @ 8: 0.948516052138
****DCGs @ 16: 0.923069558034
****DCGs @ 32: 0.87934519243
****DCGs @ 64: 0.816457965513
****Error : 0.292521484375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.0067110062
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011088470816612244, 0.012551403045654294)
('****Total time: ', 0.015985876321792603, 0.018210184574127198)
('****Preprocess time: ', 0.002091114640235901, 0.002354383468627929)
('****Data time: ', 0.00028415918350219724, 0.0003337979316711425)
('****Fetch time: ', 6.756758689880371e-05, 7.605552673339844e-05)
('****Sort time: ', 0.0005362218618392944, 0.0005919933319091797)
****Stage 0 average time 0.0095879342556
****Stage 1 average time 0.00447959983349
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.969684835071
****DCGs @ 8: 0.948005918148
****DCGs @ 16: 0.923166863373
****DCGs @ 32: 0.8787892122
****DCGs @ 64: 0.816135680434
****Error : 0.292557617188
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.1942028999
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.011169201850891113, 0.01286476850509643)
('****Total time: ', 0.015950900554656984, 0.018086159229278562)
('****Preprocess time: ', 0.0021036142110824585, 0.0024323821067810058)
('****Data time: ', 0.0002874385118484497, 0.0003397583961486816)
('****Fetch time: ', 6.97411298751831e-05, 7.823705673217754e-05)
('****Sort time: ', 0.0005273633003234863, 0.0006020545959472654)
****Stage 0 average time 0.00954193377495
****Stage 1 average time 0.00461542522907
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971487891633
****DCGs @ 8: 0.949446445963
****DCGs @ 16: 0.923571616096
****DCGs @ 32: 0.879690136296
****DCGs @ 64: 0.816590545616
****Error : 0.292411132812
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.8891658783
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.01116132354736328, 0.013026475906372069)
('****Total time: ', 0.015886598587036133, 0.01813031435012817)
('****Preprocess time: ', 0.002104413628578186, 0.002419996261596679)
('****Data time: ', 0.0002905609607696533, 0.00033475160598754876)
('****Fetch time: ', 6.832396984100342e-05, 7.891654968261719e-05)
('****Sort time: ', 0.0005246844291687012, 0.0005908131599426269)
****Stage 0 average time 0.00952349877357
****Stage 1 average time 0.00462580776215
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.967588993471
****DCGs @ 8: 0.948094018468
****DCGs @ 16: 0.923044436058
****DCGs @ 32: 0.878838096354
****DCGs @ 64: 0.816234429571
****Error : 0.292622070312
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  31.1022458076
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.011010945200920105, 0.01288340091705322)
('****Total time: ', 0.015735631346702576, 0.017885017395019527)
('****Preprocess time: ', 0.002082074284553528, 0.0023849487304687497)
('****Data time: ', 0.00028212463855743406, 0.00032930374145507786)
('****Fetch time: ', 6.775760650634766e-05, 7.772445678710938e-05)
('****Sort time: ', 0.0005266529321670532, 0.0005870342254638669)
****Stage 0 average time 0.00937926054001
****Stage 1 average time 0.0045902941227
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.970903827865
****DCGs @ 8: 0.948415938778
****DCGs @ 16: 0.923256670352
****DCGs @ 32: 0.879300708277
****DCGs @ 64: 0.816376349846
****Error : 0.292380859375
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  2.02807211876
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.020869245290756226, 0.027845454216003415)
('****Total time: ', 0.030012045860290527, 0.04180831909179683)
('****Preprocess time: ', 0.002675342321395874, 0.0036125898361206023)
('****Data time: ', 0.00040729987621307374, 0.000515031814575195)
('****Fetch time: ', 8.162951469421387e-05, 9.298324584960938e-05)
('****Sort time: ', 0.0006806416511535645, 0.0009288907051086425)
****Stage 0 average time 0.0126507622004
****Stage 1 average time 0.0120633964539
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971405334172
****DCGs @ 8: 0.948429715248
****DCGs @ 16: 0.923242475579
****DCGs @ 32: 0.879222151323
****DCGs @ 64: 0.816175768156
****Error : 0.292474609375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  3.09699988365
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.019350126028060913, 0.025178337097167967)
('****Total time: ', 0.02640588045120239, 0.0341549277305603)
('****Preprocess time: ', 0.0025782060623168947, 0.003591489791870116)
('****Data time: ', 0.0003776390552520752, 0.0004470467567443847)
('****Fetch time: ', 7.22508430480957e-05, 8.106231689453125e-05)
('****Sort time: ', 0.0006298127174377442, 0.0008481025695800779)
****Stage 0 average time 0.0115565671921
****Stage 1 average time 0.011451467514
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.970021090143
****DCGs @ 8: 0.949311193433
****DCGs @ 16: 0.923556467518
****DCGs @ 32: 0.879696217488
****DCGs @ 64: 0.816506709372
****Error : 0.292553710937
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.02267885208
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.018192310690879822, 0.02307802438735962)
('****Total time: ', 0.023962887167930602, 0.02961982488632202)
('****Preprocess time: ', 0.0024724425077438353, 0.0034203648567199697)
('****Data time: ', 0.000359433650970459, 0.0004100799560546875)
('****Fetch time: ', 6.454408168792724e-05, 7.510185241699219e-05)
('****Sort time: ', 0.0006063578128814697, 0.0007730126380920407)
****Stage 0 average time 0.0109452731609
****Stage 1 average time 0.0107498155832
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.967881778509
****DCGs @ 8: 0.947944583006
****DCGs @ 16: 0.922825542547
****DCGs @ 32: 0.878561118736
****DCGs @ 64: 0.816168070543
****Error : 0.292522460938
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.00436687469
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.01791146981716156, 0.022723281383514402)
('****Total time: ', 0.023490851759910582, 0.029115152359008783)
('****Preprocess time: ', 0.0024256945848464967, 0.0031822443008422837)
('****Data time: ', 0.000362884521484375, 0.0004248738288879394)
('****Fetch time: ', 6.538426876068115e-05, 7.605552673339844e-05)
('****Sort time: ', 0.0006037318706512451, 0.0007501006126403807)
****Stage 0 average time 0.0109217182398
****Stage 1 average time 0.0104474468231
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971702501818
****DCGs @ 8: 0.948683366384
****DCGs @ 16: 0.923601829133
****DCGs @ 32: 0.879549681091
****DCGs @ 64: 0.816418819554
****Error : 0.29242578125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.07348704338
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.016890853762626647, 0.020779144763946534)
('****Total time: ', 0.022175019979476927, 0.02640700340270996)
('****Preprocess time: ', 0.002305582642555237, 0.0029249310493469237)
('****Data time: ', 0.0003443204164505005, 0.0003840923309326172)
('****Fetch time: ', 5.909037590026855e-05, 6.794929504394531e-05)
('****Sort time: ', 0.0005997461080551147, 0.0007430195808410639)
****Stage 0 average time 0.0102398636341
****Stage 1 average time 0.00995972967148
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.968790072412
****DCGs @ 8: 0.948778399795
****DCGs @ 16: 0.92308625814
****DCGs @ 32: 0.87929399265
****DCGs @ 64: 0.816337724958
****Error : 0.292600585937
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.09601902962
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.016528052806854248, 0.020077526569366448)
('****Total time: ', 0.021744386076927184, 0.02565481662750244)
('****Preprocess time: ', 0.002280690312385559, 0.0028462767601013183)
('****Data time: ', 0.00033817219734191893, 0.000383174419403076)
('****Fetch time: ', 5.621504783630371e-05, 6.604194641113281e-05)
('****Sort time: ', 0.0005958548784255981, 0.0007131457328796385)
****Stage 0 average time 0.00997717642784
****Stage 1 average time 0.009821808815
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.968666921218
****DCGs @ 8: 0.948146401204
****DCGs @ 16: 0.923124360737
****DCGs @ 32: 0.878937408856
****DCGs @ 64: 0.81631254437
****Error : 0.292436523437
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.0293059349
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.016400986790657043, 0.01945269107818603)
('****Total time: ', 0.021649116158485412, 0.025055181980133054)
('****Preprocess time: ', 0.002260874032974243, 0.0027492642402648913)
('****Data time: ', 0.00033454930782318113, 0.0003762245178222656)
('****Fetch time: ', 5.3818702697753906e-05, 6.29425048828125e-05)
('****Sort time: ', 0.0006158847808837891, 0.0007228851318359375)
****Stage 0 average time 0.00988016211987
****Stage 1 average time 0.00978595149517
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971824146705
****DCGs @ 8: 0.949044909966
****DCGs @ 16: 0.923469621713
****DCGs @ 32: 0.879327983613
****DCGs @ 64: 0.816414140111
****Error : 0.292534179688
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.0900218487
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.01627622389793396, 0.019459009170532227)
('****Total time: ', 0.021356725692749025, 0.024892783164978026)
('****Preprocess time: ', 0.0022565170526504517, 0.0027824521064758285)
('****Data time: ', 0.00033052587509155274, 0.0003719329833984375)
('****Fetch time: ', 5.220949649810791e-05, 6.103515625e-05)
('****Sort time: ', 0.0005876151323318482, 0.0006682395935058583)
****Stage 0 average time 0.00979040801525
****Stage 1 average time 0.00971268343925
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.968037881108
****DCGs @ 8: 0.948516052138
****DCGs @ 16: 0.923069558034
****DCGs @ 32: 0.87934519243
****DCGs @ 64: 0.816457965513
****Error : 0.292521484375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.1155869961
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.016054258704185486, 0.019106960296630855)
('****Total time: ', 0.021131736040115357, 0.024505400657653803)
('****Preprocess time: ', 0.0022440576553344727, 0.002713310718536375)
('****Data time: ', 0.0003280836343765259, 0.0003669261932373047)
('****Fetch time: ', 5.122494697570801e-05, 5.793571472167969e-05)
('****Sort time: ', 0.0005940895080566406, 0.0007021427154541016)
****Stage 0 average time 0.009714168787
****Stage 1 average time 0.00955754566193
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.969684835071
****DCGs @ 8: 0.948005918148
****DCGs @ 16: 0.923166863373
****DCGs @ 32: 0.8787892122
****DCGs @ 64: 0.816135680434
****Error : 0.292557617188
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.2730209827
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.015626476168632508, 0.0176874041557312)
('****Total time: ', 0.02063310730457306, 0.022982215881347648)
('****Preprocess time: ', 0.0021923521757125854, 0.0024368762969970703)
('****Data time: ', 0.0003310799598693848, 0.0003581047058105469)
('****Fetch time: ', 5.089235305786133e-05, 5.602836608886719e-05)
('****Sort time: ', 0.0005875457525253296, 0.0006380081176757812)
****Stage 0 average time 0.00942194318771
****Stage 1 average time 0.00936640322208
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971487891633
****DCGs @ 8: 0.949446445963
****DCGs @ 16: 0.923571616096
****DCGs @ 32: 0.879690136296
****DCGs @ 64: 0.816590545616
****Error : 0.292411132812
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.9777100086
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.015183344006538391, 0.01727815866470337)
('****Total time: ', 0.020156374096870423, 0.0224283218383789)
('****Preprocess time: ', 0.0021803760528564453, 0.0024381637573242182)
('****Data time: ', 0.00032303142547607423, 0.0003550410270690916)
('****Fetch time: ', 4.853641986846924e-05, 5.602836608886719e-05)
('****Sort time: ', 0.0006055052280426025, 0.0006330013275146484)
****Stage 0 average time 0.00914399409294
****Stage 1 average time 0.00919679903984
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.967588993471
****DCGs @ 8: 0.948094018468
****DCGs @ 16: 0.923044436058
****DCGs @ 32: 0.878838096354
****DCGs @ 64: 0.816234429571
****Error : 0.292622070312
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.223115921
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.01501659882068634, 0.016895031929016112)
('****Total time: ', 0.019988936424255373, 0.022075212001800536)
('****Preprocess time: ', 0.0021679431200027468, 0.0023921489715576167)
('****Data time: ', 0.0003215997219085693, 0.0003478646278381347)
('****Fetch time: ', 4.7645807266235354e-05, 5.412101745605469e-05)
('****Sort time: ', 0.0005776100158691406, 0.0006272792816162109)
****Stage 0 average time 0.00907897365093
****Stage 1 average time 0.0090524238348
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.970903827865
****DCGs @ 8: 0.948415938778
****DCGs @ 16: 0.923256670352
****DCGs @ 32: 0.879300708277
****DCGs @ 64: 0.816376349846
****Error : 0.292380859375
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
****Total experiment time (s):  11.203275919
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.012054150819778443, 0.014327871799468988)
('****Total time: ', 4.774718044519425, 9.16190949678421)
('****Preprocess time: ', 0.002105219841003418, 0.0023574829101562487)
('****Data time: ', 0.00027107954025268555, 0.00029397010803222656)
('****Fetch time: ', 6.999278068542481e-05, 7.724761962890625e-05)
('****Sort time: ', 0.0005682129859924316, 0.000621795654296875)
****Stage 0 average time 0.00569685983658
****Stage 1 average time 0.00937179613113
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971405334172
****DCGs @ 8: 0.948429715248
****DCGs @ 16: 0.923242475579
****DCGs @ 32: 0.879222151323
****DCGs @ 64: 0.816175768156
****Error : 0.292474609375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.0305440426
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.011352146863937379, 0.012883412837982175)
('****Total time: ', 3.73890833234787, 7.069157683849333)
('****Preprocess time: ', 0.0020730594396591185, 0.002140045166015625)
('****Data time: ', 0.0002696408033370972, 0.00029087066650390625)
('****Fetch time: ', 6.9260835647583e-05, 7.581710815429688e-05)
('****Sort time: ', 0.0005690989494323731, 0.0006151556968688963)
****Stage 0 average time 0.00511511588097
****Stage 1 average time 0.00921809101105
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.970021090143
****DCGs @ 8: 0.949311193433
****DCGs @ 16: 0.923556467518
****DCGs @ 32: 0.879696217488
****DCGs @ 64: 0.816506709372
****Error : 0.292553710937
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.1134421825
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011917411804199219, 0.014200639724731444)
('****Total time: ', 3.909144834280014, 7.010558640956877)
('****Preprocess time: ', 0.002145653486251831, 0.0025260567665100096)
('****Data time: ', 0.0002787783145904541, 0.00030994415283203125)
('****Fetch time: ', 7.286489009857178e-05, 8.20159912109375e-05)
('****Sort time: ', 0.0005651921033859253, 0.0006209015846252438)
****Stage 0 average time 0.00565104019642
****Stage 1 average time 0.00932886040211
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.967881778509
****DCGs @ 8: 0.947944583006
****DCGs @ 16: 0.922825542547
****DCGs @ 32: 0.878561118736
****DCGs @ 64: 0.816168070543
****Error : 0.292522460938
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.4897720814
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.011928330183029174, 0.012769508361816402)
('****Total time: ', 3.377380098223686, 6.428070962429046)
('****Preprocess time: ', 0.0021059076786041258, 0.0021908402442932127)
('****Data time: ', 0.0002826269865036011, 0.0003070831298828125)
('****Fetch time: ', 7.220816612243652e-05, 8.106231689453125e-05)
('****Sort time: ', 0.0005690035820007324, 0.0006098747253417969)
****Stage 0 average time 0.00583006894588
****Stage 1 average time 0.00912800765038
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971702501818
****DCGs @ 8: 0.948683366384
****DCGs @ 16: 0.923601829133
****DCGs @ 32: 0.879549681091
****DCGs @ 64: 0.816418819554
****Error : 0.29242578125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.4349222183
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.011850035071372986, 0.013244307041168212)
('****Total time: ', 2.3443831996917726, 4.412474429607391)
('****Preprocess time: ', 0.002107762575149536, 0.002199888229370117)
('****Data time: ', 0.00028299367427825925, 0.0003058910369873047)
('****Fetch time: ', 7.071292400360107e-05, 7.796287536621094e-05)
('****Sort time: ', 0.0005604212284088135, 0.0006000995635986328)
****Stage 0 average time 0.00580152642727
****Stage 1 average time 0.00907039904594
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.968790072412
****DCGs @ 8: 0.948778399795
****DCGs @ 16: 0.92308625814
****DCGs @ 32: 0.87929399265
****DCGs @ 64: 0.816337724958
****Error : 0.292600585937
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.8321750164
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.011304881691932679, 0.01347192525863647)
('****Total time: ', 0.4507418302297592, 0.9176345825195308)
('****Preprocess time: ', 0.002081896185874939, 0.002253293991088867)
('****Data time: ', 0.00026367056369781496, 0.00029206275939941406)
('****Fetch time: ', 6.732881069183349e-05, 7.510185241699219e-05)
('****Sort time: ', 0.0005708431005477905, 0.0006740450859069822)
****Stage 0 average time 0.00502010142803
****Stage 1 average time 0.00926851892471
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.968666921218
****DCGs @ 8: 0.948146401204
****DCGs @ 16: 0.923124360737
****DCGs @ 32: 0.878937408856
****DCGs @ 64: 0.81631254437
****Error : 0.292436523437
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.3479909897
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011759312987327577, 0.013060116767883293)
('****Total time: ', 0.2852040332555771, 0.5871040582656859)
('****Preprocess time: ', 0.0021023340225219725, 0.0022511839866638183)
('****Data time: ', 0.0002754673957824707, 0.00030112266540527344)
('****Fetch time: ', 6.93058967590332e-05, 7.414817810058594e-05)
('****Sort time: ', 0.0005695677995681763, 0.0005888938903808594)
****Stage 0 average time 0.00571245741844
****Stage 1 average time 0.00906353068352
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971824146705
****DCGs @ 8: 0.949044909966
****DCGs @ 16: 0.923469621713
****DCGs @ 32: 0.879327983613
****DCGs @ 64: 0.816414140111
****Error : 0.292534179688
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.9316399097
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.01143875277042389, 0.013447153568267822)
('****Total time: ', 0.016973773837089538, 0.02134519815444945)
('****Preprocess time: ', 0.0020490875244140623, 0.0022208690643310547)
('****Data time: ', 0.00026518237590789795, 0.0002970695495605469)
('****Fetch time: ', 6.823182106018066e-05, 7.486343383789062e-05)
('****Sort time: ', 0.0005634503364562989, 0.0006539821624755859)
****Stage 0 average time 0.00503815591335
****Stage 1 average time 0.00934654891491
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.968037881108
****DCGs @ 8: 0.948516052138
****DCGs @ 16: 0.923069558034
****DCGs @ 32: 0.87934519243
****DCGs @ 64: 0.816457965513
****Error : 0.292521484375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.9474480152
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011383697390556335, 0.013450229167938232)
('****Total time: ', 0.01621879851818085, 0.01918568611145019)
('****Preprocess time: ', 0.0020388402938842773, 0.0022248983383178697)
('****Data time: ', 0.0002672827243804932, 0.00029397010803222656)
('****Fetch time: ', 6.732535362243652e-05, 7.390975952148438e-05)
('****Sort time: ', 0.0005490802526473999, 0.0005939006805419922)
****Stage 0 average time 0.00505050122738
****Stage 1 average time 0.00925572478771
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.969684835071
****DCGs @ 8: 0.948005918148
****DCGs @ 16: 0.923166863373
****DCGs @ 32: 0.8787892122
****DCGs @ 64: 0.816135680434
****Error : 0.292557617188
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.0061330795
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.011178329825401305, 0.012897157669067382)
('****Total time: ', 0.015721189618110656, 0.01786969900131225)
('****Preprocess time: ', 0.0020066741704940797, 0.002187049388885498)
('****Data time: ', 0.00026242458820343017, 0.0002911090850830078)
('****Fetch time: ', 6.718206405639648e-05, 7.295608520507812e-05)
('****Sort time: ', 0.0005487951040267945, 0.0005981922149658203)
****Stage 0 average time 0.00501610279083
****Stage 1 average time 0.00904730296135
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971487891633
****DCGs @ 8: 0.949446445963
****DCGs @ 16: 0.923571616096
****DCGs @ 32: 0.879690136296
****DCGs @ 64: 0.816590545616
****Error : 0.292411132812
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.7545330524
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.011112582683563233, 0.012771916389465322)
('****Total time: ', 0.0156728333234787, 0.017520201206207276)
('****Preprocess time: ', 0.0020064640045166014, 0.0021691679954528808)
('****Data time: ', 0.00026080286502838136, 0.0002899169921875)
('****Fetch time: ', 6.737995147705079e-05, 7.319450378417969e-05)
('****Sort time: ', 0.0005596543550491332, 0.0006091952323913572)
****Stage 0 average time 0.00501898884773
****Stage 1 average time 0.0089878950119
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.967588993471
****DCGs @ 8: 0.948094018468
****DCGs @ 16: 0.923044436058
****DCGs @ 32: 0.878838096354
****DCGs @ 64: 0.816234429571
****Error : 0.292622070312
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.10967803
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.011144669532775878, 0.012851142883300781)
('****Total time: ', 0.015838411927223205, 0.017772960662841796)
('****Preprocess time: ', 0.0020422965288162233, 0.0023640751838684072)
('****Data time: ', 0.0002689388990402222, 0.00030493736267089844)
('****Fetch time: ', 6.710982322692871e-05, 7.486343383789062e-05)
('****Sort time: ', 0.0005471545457839966, 0.0006117820739746094)
****Stage 0 average time 0.00504707205296
****Stage 1 average time 0.00902309727669
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.970903827865
****DCGs @ 8: 0.948415938778
****DCGs @ 16: 0.923256670352
****DCGs @ 32: 0.879300708277
****DCGs @ 64: 0.816376349846
****Error : 0.292380859375
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  7.52813196182
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01662956702709198, 0.022640550136566157)
('****Total time: ', 2.736774840593338, 5.001145458221435)
('****Preprocess time: ', 0.0028254657983779905, 0.003864014148712157)
('****Data time: ', 0.0003769780397415161, 0.00045609474182128906)
('****Fetch time: ', 7.644331455230713e-05, 8.916854858398438e-05)
('****Sort time: ', 0.00039796578884124755, 0.0005118966102600097)
****Stage 0 average time 0.0166404105425
****Stage 1 average time 0.00366600942612
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.33926391602
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.015210922837257385, 0.020386588573455808)
('****Total time: ', 2.1781496804952623, 3.975755810737609)
('****Preprocess time: ', 0.002558437466621399, 0.0034942150115966786)
('****Data time: ', 0.0003370095491409302, 0.00039386749267578125)
('****Fetch time: ', 7.202732563018798e-05, 8.037090301513659e-05)
('****Sort time: ', 0.0004165579080581665, 0.0005252718925476072)
****Stage 0 average time 0.0149907972813
****Stage 1 average time 0.00360415780544
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.33074808121
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.014540420770645142, 0.017360126972198485)
('****Total time: ', 1.6192482937574386, 2.9949569344520564)
('****Preprocess time: ', 0.0024584972858428954, 0.0032462596893310536)
('****Data time: ', 0.0003224143981933594, 0.00036815404891967754)
('****Fetch time: ', 6.99474811553955e-05, 7.796287536621094e-05)
('****Sort time: ', 0.00041704416275024415, 0.000507378578186035)
****Stage 0 average time 0.0142072136402
****Stage 1 average time 0.00360111045837
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.30492401123
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.014242966771125793, 0.01612136363983154)
('****Total time: ', 1.04982965362072, 1.9543066263198854)
('****Preprocess time: ', 0.0024030190706253052, 0.002725172042846679)
('****Data time: ', 0.0003157970905303955, 0.00035909414291381816)
('****Fetch time: ', 6.775581836700439e-05, 7.510185241699219e-05)
('****Sort time: ', 0.0004225140810012817, 0.0005240917205810544)
****Stage 0 average time 0.0138548512459
****Stage 1 average time 0.00359720158577
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.3567738533
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.014034448742866516, 0.01563138961791992)
('****Total time: ', 0.04831676232814789, 0.07631406784057616)
('****Preprocess time: ', 0.0023956507444381713, 0.0027003169059753407)
('****Data time: ', 0.0003101238012313843, 0.00035477876663208)
('****Fetch time: ', 6.625282764434815e-05, 7.271766662597656e-05)
('****Sort time: ', 0.0004223123788833618, 0.0004871249198913572)
****Stage 0 average time 0.0136561447382
****Stage 1 average time 0.00357264375687
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.44032812119
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.013956810593605042, 0.015722680091857906)
('****Total time: ', 0.020415610074996947, 0.025885200500488283)
('****Preprocess time: ', 0.002377188205718994, 0.002683305740356444)
('****Data time: ', 0.00031198608875274657, 0.0003559589385986328)
('****Fetch time: ', 6.741321086883545e-05, 7.414817810058594e-05)
('****Sort time: ', 0.00043404221534729007, 0.00046588182449340814)
****Stage 0 average time 0.0135024013519
****Stage 1 average time 0.00364503896236
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.2733871937
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.014091788411140442, 0.01651979684829712)
('****Total time: ', 0.019769646763801576, 0.023595142364501956)
('****Preprocess time: ', 0.0023885178565979004, 0.0027180790901184075)
('****Data time: ', 0.00031479954719543457, 0.0003600120544433594)
('****Fetch time: ', 6.683170795440674e-05, 7.891654968261719e-05)
('****Sort time: ', 0.00041815948486328123, 0.0004649162292480469)
****Stage 0 average time 0.013562322855
****Stage 1 average time 0.00371777415276
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.4110598564
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.014095598578453064, 0.01635740995407104)
('****Total time: ', 0.019341607213020324, 0.022231197357177733)
('****Preprocess time: ', 0.0023861292600631714, 0.002853369712829587)
('****Data time: ', 0.00031359076499938967, 0.00035717487335205065)
('****Fetch time: ', 6.71694278717041e-05, 7.82012939453125e-05)
('****Sort time: ', 0.00042029798030853273, 0.0004749417304992675)
****Stage 0 average time 0.0135305857658
****Stage 1 average time 0.00375220024586
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.3711419106
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.013840494990348815, 0.015840566158294673)
('****Total time: ', 0.018906535148620604, 0.02140542268753051)
('****Preprocess time: ', 0.0023475308418273925, 0.0025780677795410154)
('****Data time: ', 0.0003124755620956421, 0.0003559589385986328)
('****Fetch time: ', 6.631112098693848e-05, 7.700920104980469e-05)
('****Sort time: ', 0.0004111894369125366, 0.0004551410675048828)
****Stage 0 average time 0.0132537320852
****Stage 1 average time 0.00372426986694
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.3943190575
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.013819249033927918, 0.01592708826065062)
('****Total time: ', 0.01852958035469055, 0.020967352390289302)
('****Preprocess time: ', 0.002348842144012451, 0.0026810169219970703)
('****Data time: ', 0.0003138902187347412, 0.0003581404685974119)
('****Fetch time: ', 6.577599048614502e-05, 7.414817810058594e-05)
('****Sort time: ', 0.0004197734594345093, 0.0004639625549316406)
****Stage 0 average time 0.0132515022755
****Stage 1 average time 0.00371602857113
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.2555031776
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.01370056712627411, 0.015932130813598632)
('****Total time: ', 0.01852666461467743, 0.02088208198547362)
('****Preprocess time: ', 0.002319677948951721, 0.0025444746017456023)
('****Data time: ', 0.0003110733032226563, 0.00035309791564941406)
('****Fetch time: ', 6.487667560577393e-05, 7.200241088867188e-05)
('****Sort time: ', 0.000402045726776123, 0.0004661083221435547)
****Stage 0 average time 0.0131246782541
****Stage 1 average time 0.0036735625267
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  31.5177440643
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.01363519811630249, 0.015449094772338866)
('****Total time: ', 0.01856475865840912, 0.02059202194213867)
('****Preprocess time: ', 0.002316177010536194, 0.002539014816284179)
('****Data time: ', 0.0003089897632598877, 0.00035309791564941406)
('****Fetch time: ', 6.452035903930664e-05, 7.224082946777344e-05)
('****Sort time: ', 0.000405769944190979, 0.00045013427734375)
****Stage 0 average time 0.0130632164478
****Stage 1 average time 0.0036674387455
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  2.3489151001
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017404261708259584, 0.023116719722747786)
('****Total time: ', 0.025451903462409973, 0.033603167533874496)
('****Preprocess time: ', 0.0027416821718215943, 0.003912937641143799)
('****Data time: ', 0.00040283763408660887, 0.0004911780357360838)
('****Fetch time: ', 6.261706352233887e-05, 7.486343383789062e-05)
('****Sort time: ', 0.00044388222694396974, 0.0005861401557922357)
****Stage 0 average time 0.01585714221
****Stage 1 average time 0.00519813859463
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  3.27389907837
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.01687749695777893, 0.02212837934494018)
('****Total time: ', 0.023140777945518495, 0.029162657260894752)
('****Preprocess time: ', 0.0026750123500823976, 0.0037244439125061015)
('****Data time: ', 0.000386150598526001, 0.00044989585876464844)
('****Fetch time: ', 6.343793869018554e-05, 7.200241088867188e-05)
('****Sort time: ', 0.0004451644420623779, 0.000553131103515625)
****Stage 0 average time 0.0154726096392
****Stage 1 average time 0.00497465264797
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.22573280334
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.016217947840690614, 0.019768941402435285)
('****Total time: ', 0.02180132007598877, 0.02644134759902954)
('****Preprocess time: ', 0.0026076854467391966, 0.003387033939361572)
('****Data time: ', 0.0003852518796920776, 0.00043992996215820286)
('****Fetch time: ', 5.890917778015137e-05, 6.890296936035156e-05)
('****Sort time: ', 0.00044286775588989256, 0.0005383849143981932)
****Stage 0 average time 0.0148655021191
****Stage 1 average time 0.00484715998173
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.39184188843
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.016176262974739074, 0.019458365440368646)
('****Total time: ', 0.022041117906570436, 0.025874280929565407)
('****Preprocess time: ', 0.002614048957824707, 0.00362122058868408)
('****Data time: ', 0.0003761235475540161, 0.00042510032653808594)
('****Fetch time: ', 5.552935600280762e-05, 6.580352783203125e-05)
('****Sort time: ', 0.0004353322982788086, 0.0005191326141357417)
****Stage 0 average time 0.0147082821131
****Stage 1 average time 0.00494901502132
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.44269800186
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.015463407874107361, 0.01849285364151001)
('****Total time: ', 0.021425273537635802, 0.02466533184051513)
('****Preprocess time: ', 0.002518032193183899, 0.003120148181915282)
('****Data time: ', 0.00036538159847259523, 0.0004112720489501953)
('****Fetch time: ', 5.103445053100586e-05, 6.17623329162597e-05)
('****Sort time: ', 0.0004727011919021606, 0.0005028247833251953)
****Stage 0 average time 0.0142630786896
****Stage 1 average time 0.00460747861862
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.44534015656
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.014973963141441345, 0.017396938800811765)
('****Total time: ', 0.020337286949157714, 0.02325693368911743)
('****Preprocess time: ', 0.002485297918319702, 0.002892017364501953)
('****Data time: ', 0.00035999977588653564, 0.0004050731658935547)
('****Fetch time: ', 5.049264430999756e-05, 5.817413330078125e-05)
('****Sort time: ', 0.0004344221353530884, 0.00048804283142089844)
****Stage 0 average time 0.0137954528332
****Stage 1 average time 0.00450872278214
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.3805248737
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01509991216659546, 0.01810891628265381)
('****Total time: ', 0.020460725307464598, 0.02386232614517212)
('****Preprocess time: ', 0.0024803004264831543, 0.002869105339050292)
('****Data time: ', 0.0003594688177108765, 0.0004032015800476072)
('****Fetch time: ', 4.905164241790772e-05, 5.793571472167969e-05)
('****Sort time: ', 0.00043633437156677244, 0.0004892706871032713)
****Stage 0 average time 0.0138729237318
****Stage 1 average time 0.00455214369297
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.4722750187
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.01493616008758545, 0.01764973402023315)
('****Total time: ', 0.020264609813690184, 0.023289418220520018)
('****Preprocess time: ', 0.0024479336738586427, 0.0027512431144714336)
('****Data time: ', 0.00035002076625823973, 0.0003962516784667969)
('****Fetch time: ', 4.8288702964782713e-05, 5.626678466796875e-05)
('****Sort time: ', 0.0004383504390716553, 0.0004902243614196775)
****Stage 0 average time 0.0136737420559
****Stage 1 average time 0.00454701161385
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.4279749393
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.014833189368247986, 0.017436146736145016)
('****Total time: ', 0.020067795157432556, 0.022961103916168214)
('****Preprocess time: ', 0.0024536771774291994, 0.0027840137481689453)
('****Data time: ', 0.00034894633293151855, 0.0003998398780822753)
('****Fetch time: ', 4.7584056854248045e-05, 5.626678466796875e-05)
('****Sort time: ', 0.0004406287670135498, 0.0004790306091308591)
****Stage 0 average time 0.0135459589958
****Stage 1 average time 0.00457806670666
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.6296761036
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.014685251355171203, 0.017043006420135492)
('****Total time: ', 0.019968434333801268, 0.022611236572265624)
('****Preprocess time: ', 0.0024306365251541137, 0.002667391300201415)
('****Data time: ', 0.000353224515914917, 0.00039696693420410156)
('****Fetch time: ', 4.7451019287109375e-05, 5.507469177246094e-05)
('****Sort time: ', 0.00043368136882781985, 0.00046898126602172845)
****Stage 0 average time 0.0133964978456
****Stage 1 average time 0.00455374693871
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.3473460674
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.014035355925559998, 0.016152071952819824)
('****Total time: ', 0.019301558017730713, 0.021624135971069335)
('****Preprocess time: ', 0.0023999419212341307, 0.002572786808013916)
('****Data time: ', 0.0003490842580795288, 0.0003948330879211425)
('****Fetch time: ', 4.656994342803955e-05, 5.2928924560546875e-05)
('****Sort time: ', 0.0004356275796890259, 0.0004780292510986328)
****Stage 0 average time 0.0128895421028
****Stage 1 average time 0.00437703752518
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.5513300896
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.014337472200393676, 0.016821289062499998)
('****Total time: ', 0.01955614900588989, 0.022328531742095946)
('****Preprocess time: ', 0.002393300414085388, 0.002596163749694823)
('****Data time: ', 0.0003474154472351074, 0.00039315223693847656)
('****Fetch time: ', 4.620528221130371e-05, 5.507469177246094e-05)
('****Sort time: ', 0.0004376649856567383, 0.00047087669372558594)
****Stage 0 average time 0.0130615653992
****Stage 1 average time 0.00450049293041
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  13.0018482208
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007710314154624939, 0.00848642587661743)
('****Total time: ', 5.629512912631035, 10.636843287944792)
('****Preprocess time: ', 0.002202428936958313, 0.0022790789604187007)
('****Data time: ', 0.0002596898078918457, 0.0002804040908813475)
('****Fetch time: ', 6.459927558898926e-05, 7.009506225585938e-05)
('****Sort time: ', 0.0004139727354049683, 0.00043511390686035156)
****Stage 0 average time 0.00657186627388
****Stage 1 average time 0.00407913863659
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.4673359394
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.006932458162307739, 0.007248926162719727)
('****Total time: ', 4.328131388306618, 8.21710842847824)
('****Preprocess time: ', 0.002162519097328186, 0.0022092223167419433)
('****Data time: ', 0.00024161267280578614, 0.0002598762512207031)
('****Fetch time: ', 5.991911888122558e-05, 6.508827209472656e-05)
('****Sort time: ', 0.0003988485336303711, 0.0004260540008544922)
****Stage 0 average time 0.00579562473297
****Stage 1 average time 0.00399973285198
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.6955919266
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.006976026058197022, 0.007282078266143799)
('****Total time: ', 3.905450380086899, 7.37950837612152)
('****Preprocess time: ', 0.002263068914413452, 0.002314138412475586)
('****Data time: ', 0.0002413119077682495, 0.0002620220184326172)
('****Fetch time: ', 5.9441685676574705e-05, 6.771087646484375e-05)
('****Sort time: ', 0.0004706269502639771, 0.0005002379417419432)
****Stage 0 average time 0.00598104989529
****Stage 1 average time 0.00402942562103
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.846834898
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.007519101858139038, 0.007887172698974609)
('****Total time: ', 3.8679909319877623, 7.445200204849241)
('****Preprocess time: ', 0.002200709581375122, 0.002248048782348633)
('****Data time: ', 0.00025731801986694336, 0.00028014183044433594)
('****Fetch time: ', 6.247329711914062e-05, 6.699562072753906e-05)
('****Sort time: ', 0.0003946292400360107, 0.0004198670387268066)
****Stage 0 average time 0.0064863679409
****Stage 1 average time 0.00394786405563
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.420799017
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.006866031765937805, 0.007194817066192627)
('****Total time: ', 2.202301771402359, 4.126433312892914)
('****Preprocess time: ', 0.0021552654504776, 0.002270984649658203)
('****Data time: ', 0.00024187397956848146, 0.0002620220184326172)
('****Fetch time: ', 6.026136875152588e-05, 6.604194641113281e-05)
('****Sort time: ', 0.00040272164344787596, 0.00047588348388671875)
****Stage 0 average time 0.00576853466034
****Stage 1 average time 0.00395761954784
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.9252610207
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.007596144556999206, 0.007991135120391846)
('****Total time: ', 1.8801216895580293, 3.6092327952384937)
('****Preprocess time: ', 0.002199072003364563, 0.002254962921142578)
('****Data time: ', 0.0002581312656402588, 0.0002791881561279297)
('****Fetch time: ', 6.318509578704834e-05, 6.794929504394531e-05)
('****Sort time: ', 0.0003955456018447876, 0.0004267811775207519)
****Stage 0 average time 0.00651942646503
****Stage 1 average time 0.0039926520586
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.9022090435
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.0075666775703430176, 0.008016109466552734)
('****Total time: ', 0.9061742718219757, 1.7170060396194458)
('****Preprocess time: ', 0.002199620246887207, 0.0022449612617492674)
('****Data time: ', 0.0002594939470291138, 0.0002808570861816406)
('****Fetch time: ', 6.276059150695801e-05, 6.699562072753906e-05)
('****Sort time: ', 0.000400365948677063, 0.00045418739318847656)
****Stage 0 average time 0.00651004505157
****Stage 1 average time 0.00397887325287
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.250483036
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.007031921148300171, 0.007903409004211423)
('****Total time: ', 0.014590126752853394, 0.026066458225250236)
('****Preprocess time: ', 0.0021749181747436524, 0.0023208737373352044)
('****Data time: ', 0.0002555156946182251, 0.00028395652770996094)
('****Fetch time: ', 6.0170888900756836e-05, 6.63042068481444e-05)
('****Sort time: ', 0.000395199179649353, 0.00044871568679809564)
****Stage 0 average time 0.00587699186802
****Stage 1 average time 0.00404073321819
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.2188370228
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007029825448989868, 0.007850217819213866)
('****Total time: ', 0.01210698676109314, 0.015301930904388413)
('****Preprocess time: ', 0.002148371458053589, 0.002326107025146484)
('****Data time: ', 0.00025889718532562254, 0.00029397010803222656)
('****Fetch time: ', 6.191158294677734e-05, 6.63042068481444e-05)
('****Sort time: ', 0.00039605093002319334, 0.0004570484161376953)
****Stage 0 average time 0.00584034788609
****Stage 1 average time 0.00405470871925
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.4315748215
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.006997625231742859, 0.007858455181121817)
('****Total time: ', 0.0116421058177948, 0.013212776184082026)
('****Preprocess time: ', 0.0021072211265563963, 0.0023119926452636716)
('****Data time: ', 0.00026026391983032226, 0.00030303001403808594)
('****Fetch time: ', 6.0807108879089354e-05, 6.890296936035156e-05)
('****Sort time: ', 0.0003995559215545654, 0.0004787564277648925)
****Stage 0 average time 0.00580401992798
****Stage 1 average time 0.00402145338058
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.1283650398
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.007057689785957336, 0.007959520816802977)
('****Total time: ', 0.011632104635238647, 0.013002526760101316)
('****Preprocess time: ', 0.0021159820556640625, 0.002344059944152831)
('****Data time: ', 0.00025888752937316896, 0.00030622482299804635)
('****Fetch time: ', 6.302762031555176e-05, 6.914138793945312e-05)
('****Sort time: ', 0.0003941464424133301, 0.0004640221595764157)
****Stage 0 average time 0.00582351148129
****Stage 1 average time 0.00406622195244
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.3864328861
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.006982011556625366, 0.008011102676391602)
('****Total time: ', 0.011651361346244811, 0.0130115270614624)
('****Preprocess time: ', 0.002101361870765686, 0.0023410797119140622)
('****Data time: ', 0.00025803327560424804, 0.0003061652183532713)
('****Fetch time: ', 6.164371967315674e-05, 6.985664367675781e-05)
('****Sort time: ', 0.00039674675464630124, 0.0004789948463439941)
****Stage 0 average time 0.00579418492317
****Stage 1 average time 0.00400561225414
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.975328580349
****DCGs @ 8: 0.965494779598
****DCGs @ 16: 0.940843493683
****DCGs @ 32: 0.910423673304
****DCGs @ 64: 0.858094216681
****Error : 0.2660625
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  8.87518501282
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017388604164123536, 0.023976087570190412)
('****Total time: ', 3.4478114360570906, 6.249594509601593)
('****Preprocess time: ', 0.0032636135816574096, 0.0042969822883605945)
('****Data time: ', 0.0003901439905166626, 0.00047780275344848626)
('****Fetch time: ', 8.172011375427246e-05, 0.00010277032852172845)
('****Sort time: ', 0.0006153479814529418, 0.0008299469947814941)
****Stage 0 average time 0.0173081662655
****Stage 1 average time 0.00443126356602
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.8486969471
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.01542915403842926, 0.020265924930572502)
('****Total time: ', 3.00355552315712, 5.436179304122923)
('****Preprocess time: ', 0.0029905664920806883, 0.003952980041503906)
('****Data time: ', 0.000350333571434021, 0.00041295289993286126)
('****Fetch time: ', 7.511579990386962e-05, 8.893013000488281e-05)
('****Sort time: ', 0.0006344739198684692, 0.0007899761199951167)
****Stage 0 average time 0.0150304883718
****Stage 1 average time 0.00444915544987
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.69308114052
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01477666163444519, 0.017649042606353756)
('****Total time: ', 2.384892962217331, 4.36415022611618)
('****Preprocess time: ', 0.002887497067451477, 0.0036437153816223124)
('****Data time: ', 0.0003417226076126099, 0.0003931879997253416)
('****Fetch time: ', 7.54704475402832e-05, 8.177757263183594e-05)
('****Sort time: ', 0.0006297279596328736, 0.0007898926734924316)
****Stage 0 average time 0.014321385622
****Stage 1 average time 0.00438969409466
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.87673902512
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.014343950986862183, 0.016396808624267567)
('****Total time: ', 1.9317813119888305, 3.548186445236206)
('****Preprocess time: ', 0.0028261924982070923, 0.003200256824493407)
('****Data time: ', 0.0003334740400314331, 0.0003800392150878906)
('****Fetch time: ', 7.118260860443116e-05, 8.20159912109375e-05)
('****Sort time: ', 0.000643712043762207, 0.0007701396942138669)
****Stage 0 average time 0.0137336708307
****Stage 1 average time 0.00448484134674
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.01433396339
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.014380078077316285, 0.01712113618850707)
('****Total time: ', 0.9472100410461426, 1.70580780506134)
('****Preprocess time: ', 0.0028528053760528563, 0.0033215999603271474)
('****Data time: ', 0.00033164823055267334, 0.00037766695022583)
('****Fetch time: ', 7.186269760131836e-05, 8.392333984375e-05)
('****Sort time: ', 0.0006354125738143921, 0.0007751107215881347)
****Stage 0 average time 0.0137348564863
****Stage 1 average time 0.00453695046902
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.39556789398
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.01450451135635376, 0.017391562461853017)
('****Total time: ', 0.03359354472160339, 0.07030313014984128)
('****Preprocess time: ', 0.0028536280393600465, 0.003398382663726804)
('****Data time: ', 0.000339709997177124, 0.000383174419403076)
('****Fetch time: ', 7.080686092376709e-05, 8.20159912109375e-05)
('****Sort time: ', 0.0006093767881393433, 0.0007231235504150391)
****Stage 0 average time 0.0138878047466
****Stage 1 average time 0.00449022829533
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.3387150764
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.014438353300094605, 0.01742737293243407)
('****Total time: ', 0.021998092889785766, 0.028893005847930895)
('****Preprocess time: ', 0.0028696980476379396, 0.0035611629486083977)
('****Data time: ', 0.00033460772037506104, 0.0003819465637207031)
('****Fetch time: ', 7.15247392654419e-05, 8.202791213989251e-05)
('****Sort time: ', 0.0005932859182357788, 0.0006471037864685057)
****Stage 0 average time 0.0137733137608
****Stage 1 average time 0.00453415596485
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.3950498104
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.014284296751022338, 0.0165042519569397)
('****Total time: ', 0.020379666566848757, 0.023675906658172603)
('****Preprocess time: ', 0.0028052401542663576, 0.0031533360481262197)
('****Data time: ', 0.0003335639238357544, 0.0003750324249267578)
('****Fetch time: ', 6.97704553604126e-05, 7.606744766235345e-05)
('****Sort time: ', 0.0005978671312332153, 0.00065995454788208)
****Stage 0 average time 0.0136626223326
****Stage 1 average time 0.00442811608315
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.4051609039
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.013958891153335571, 0.015929949283599854)
('****Total time: ', 0.01981875729560852, 0.02259927988052368)
('****Preprocess time: ', 0.002802294135093689, 0.0030780315399169915)
('****Data time: ', 0.000336181640625, 0.00038604736328124974)
('****Fetch time: ', 6.91901445388794e-05, 8.0108642578125e-05)
('****Sort time: ', 0.00061015784740448, 0.0006558895111083984)
****Stage 0 average time 0.0132947587967
****Stage 1 average time 0.00448195612431
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.5273551941
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.014081070184707641, 0.01576712131500244)
('****Total time: ', 0.019627761125564577, 0.021618974208831784)
('****Preprocess time: ', 0.002793243408203125, 0.0029900193214416502)
('****Data time: ', 0.00033819353580474853, 0.00037125349044799785)
('****Fetch time: ', 6.912064552307129e-05, 7.510185241699219e-05)
('****Sort time: ', 0.0005940980911254883, 0.0006480336189270019)
****Stage 0 average time 0.0135134760141
****Stage 1 average time 0.00436224985123
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.1143062115
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.01409835934638977, 0.0161409854888916)
('****Total time: ', 0.019490936875343323, 0.021744167804718016)
('****Preprocess time: ', 0.002794776678085327, 0.0031862735748291013)
('****Data time: ', 0.00034303510189056396, 0.00038313865661621094)
('****Fetch time: ', 6.832265853881835e-05, 7.987022399902344e-05)
('****Sort time: ', 0.000609190821647644, 0.0006549358367919922)
****Stage 0 average time 0.0134594812393
****Stage 1 average time 0.00445420336723
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  31.2460520267
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.013701802611351014, 0.01525192260742187)
('****Total time: ', 0.01891402542591095, 0.02067484855651855)
('****Preprocess time: ', 0.002734440088272095, 0.002915906906127929)
('****Data time: ', 0.0003387446403503418, 0.00037316083908081035)
('****Fetch time: ', 6.658172607421875e-05, 7.201433181762689e-05)
('****Sort time: ', 0.0006085312366485595, 0.0006537556648254394)
****Stage 0 average time 0.0131343125105
****Stage 1 average time 0.00431578779221
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  2.42649006844
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.025623233199119567, 0.03458003997802734)
('****Total time: ', 0.04487626326084137, 0.07830885648727416)
('****Preprocess time: ', 0.0036292974948883058, 0.005079174041748046)
('****Data time: ', 0.00047629833221435547, 0.0005980610847473139)
('****Fetch time: ', 7.75519609451294e-05, 9.084939956665033e-05)
('****Sort time: ', 0.0007375186681747437, 0.0010411739349365234)
****Stage 0 average time 0.0178886893988
****Stage 1 average time 0.0126552102566
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  3.33663702011
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.0221363867521286, 0.02845762968063354)
('****Total time: ', 0.029174432992935182, 0.03690090179443358)
('****Preprocess time: ', 0.00323606276512146, 0.004294979572296142)
('****Data time: ', 0.0004259476661682129, 0.0004873633384704588)
('****Fetch time: ', 7.346415519714355e-05, 8.107423782348626e-05)
('****Sort time: ', 0.0006904081106185913, 0.0009310245513916016)
****Stage 0 average time 0.0156737241745
****Stage 1 average time 0.0108885452747
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.27154183388
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.021252959847450258, 0.027172732353210445)
('****Total time: ', 0.028003483533859255, 0.03441311120986938)
('****Preprocess time: ', 0.0031344685554504396, 0.004091596603393553)
('****Data time: ', 0.0004062709808349609, 0.0004699230194091797)
('****Fetch time: ', 6.309783458709717e-05, 7.605552673339844e-05)
('****Sort time: ', 0.0006623045206069946, 0.0008607029914855956)
****Stage 0 average time 0.015234739542
****Stage 1 average time 0.0102843621969
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.30519390106
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.020140791416168213, 0.024740970134735103)
('****Total time: ', 0.026487101793289183, 0.03170961141586303)
('****Preprocess time: ', 0.0030004849433898926, 0.003644561767578123)
('****Data time: ', 0.0003938716650009155, 0.0004558682441711425)
('****Fetch time: ', 6.162869930267334e-05, 7.295608520507812e-05)
('****Sort time: ', 0.0006563676595687867, 0.0008130550384521482)
****Stage 0 average time 0.0142806680202
****Stage 1 average time 0.00997247636318
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.36802792549
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.01958511483669281, 0.023141157627105707)
('****Total time: ', 0.025765357732772828, 0.029918456077575657)
('****Preprocess time: ', 0.0029731123447418214, 0.0035446882247924774)
('****Data time: ', 0.0003895745277404785, 0.0004439353942871094)
('****Fetch time: ', 5.861175060272217e-05, 6.818771362304688e-05)
('****Sort time: ', 0.000649075984954834, 0.000759172439575195)
****Stage 0 average time 0.0141487796307
****Stage 1 average time 0.00950670981407
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.54891085625
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.01967245030403137, 0.02368476390838622)
('****Total time: ', 0.025894065618515014, 0.030516386032104485)
('****Preprocess time: ', 0.003020530104637146, 0.00393533706665039)
('****Data time: ', 0.00039141511917114256, 0.0004439353942871094)
('****Fetch time: ', 5.589807033538818e-05, 6.604194641113281e-05)
('****Sort time: ', 0.0006521269083023071, 0.0007841587066650391)
****Stage 0 average time 0.013843958497
****Stage 1 average time 0.00994846200943
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.435959816
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.019484089970588685, 0.02285597324371337)
('****Total time: ', 0.02568846118450165, 0.02943360805511474)
('****Preprocess time: ', 0.002992903470993042, 0.0038761138916015617)
('****Data time: ', 0.00038636064529418943, 0.0004341602325439453)
('****Fetch time: ', 5.514800548553467e-05, 6.389617919921875e-05)
('****Sort time: ', 0.0006660058498382568, 0.000753247737884521)
****Stage 0 average time 0.0136291885376
****Stage 1 average time 0.0099553194046
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.4479119778
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.019107912421226503, 0.023025357723236085)
('****Total time: ', 0.025234574556350708, 0.02983900308609008)
('****Preprocess time: ', 0.003004555583000183, 0.003919863700866695)
('****Data time: ', 0.00038191652297973633, 0.00043511390686035156)
('****Fetch time: ', 5.377769470214844e-05, 6.29425048828125e-05)
('****Sort time: ', 0.0006414155960083008, 0.0007360458374023435)
****Stage 0 average time 0.013332922101
****Stage 1 average time 0.0098566557169
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.4602398872
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.018019934296607972, 0.020240545272827145)
('****Total time: ', 0.024021528959274292, 0.026447963714599603)
('****Preprocess time: ', 0.0028728559017181395, 0.003042078018188476)
('****Data time: ', 0.00038027048110961915, 0.0004162788391113281)
('****Fetch time: ', 4.936599731445313e-05, 5.5789947509765625e-05)
('****Sort time: ', 0.0006568143367767334, 0.0007312774658203122)
****Stage 0 average time 0.0128922529221
****Stage 1 average time 0.00908698809147
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.5532870293
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.018411713123321533, 0.020634889602661133)
('****Total time: ', 0.024276584863662718, 0.02675063610076904)
('****Preprocess time: ', 0.0028903204202651977, 0.0031698346138000484)
('****Data time: ', 0.0003774092197418213, 0.0004210472106933594)
('****Fetch time: ', 5.134105682373047e-05, 5.6290626525878776e-05)
('****Sort time: ', 0.0006393790245056152, 0.0006931304931640622)
****Stage 0 average time 0.0129514918327
****Stage 1 average time 0.00941867101192
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.4283180237
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.01810484850406647, 0.02032623291015625)
('****Total time: ', 0.024137160301208497, 0.02663055658340454)
('****Preprocess time: ', 0.002896913528442383, 0.0032461643218994135)
('****Data time: ', 0.0003814889192581177, 0.0004298686981201172)
('****Fetch time: ', 5.113649368286133e-05, 5.698204040527344e-05)
('****Sort time: ', 0.0006643015146255493, 0.0007078766822814941)
****Stage 0 average time 0.012701089263
****Stage 1 average time 0.00939759969711
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.5987229347
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.01733825623989105, 0.019483137130737304)
('****Total time: ', 0.023287468671798706, 0.025715935230255126)
('****Preprocess time: ', 0.0028341981172561644, 0.0030050277709960938)
('****Data time: ', 0.0003710615634918213, 0.0004239082336425781)
('****Fetch time: ', 4.8328876495361325e-05, 5.3882598876953125e-05)
('****Sort time: ', 0.0006419652700424194, 0.0007000446319580076)
****Stage 0 average time 0.0122514791489
****Stage 1 average time 0.00898233091831
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  13.3423829079
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.012140618205070496, 0.013867270946502685)
('****Total time: ', 5.795991785526276, 10.96529140472412)
('****Preprocess time: ', 0.0027505085468292234, 0.002987611293792721)
('****Data time: ', 0.00031274640560150147, 0.0003380775451660156)
('****Fetch time: ', 7.531070709228515e-05, 8.106231689453125e-05)
('****Sort time: ', 0.0006208733320236206, 0.0006558895111083984)
****Stage 0 average time 0.00680672907829
****Stage 1 average time 0.00909332811832
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.2689878941
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.012050262689590453, 0.013629066944122314)
('****Total time: ', 5.257362825989723, 9.953275108337401)
('****Preprocess time: ', 0.002723587393760681, 0.002797901630401611)
('****Data time: ', 0.0003088723421096802, 0.0003337860107421875)
('****Fetch time: ', 7.629299163818359e-05, 7.891654968261719e-05)
('****Sort time: ', 0.000620668888092041, 0.0006678223609924316)
****Stage 0 average time 0.00677602756023
****Stage 1 average time 0.00900365674496
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.0908689499
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011591679453849792, 0.01450587511062622)
('****Total time: ', 4.087542552232742, 7.713372957706451)
('****Preprocess time: ', 0.0027444263696670534, 0.003368854522705078)
('****Data time: ', 0.00030086255073547366, 0.00033093690872192376)
('****Fetch time: ', 6.950092315673828e-05, 7.510185241699219e-05)
('****Sort time: ', 0.0006298923492431641, 0.0007312655448913572)
****Stage 0 average time 0.00619287610054
****Stage 1 average time 0.00914348554611
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.2469370365
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.012003848314285278, 0.013113892078399657)
('****Total time: ', 4.129715374588966, 7.852270936965941)
('****Preprocess time: ', 0.0027058804035186767, 0.0027871489524841308)
('****Data time: ', 0.00030563807487487795, 0.0003330707550048828)
('****Fetch time: ', 7.269477844238281e-05, 7.940530776977533e-05)
('****Sort time: ', 0.000624945878982544, 0.0007531642913818359)
****Stage 0 average time 0.00676834869385
****Stage 1 average time 0.00894465875626
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.7795269489
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.011316781282424927, 0.01264994144439697)
('****Total time: ', 2.3757210725545885, 4.48700566291809)
('****Preprocess time: ', 0.0026767165660858154, 0.002778828144073486)
('****Data time: ', 0.0003043183088302612, 0.00033211708068847656)
('****Fetch time: ', 6.864893436431885e-05, 7.226467132568346e-05)
('****Sort time: ', 0.000634059190750122, 0.0007679581642150878)
****Stage 0 average time 0.00604052042961
****Stage 1 average time 0.00896000385284
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.1774709225
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.011922344326972962, 0.012778091430664062)
('****Total time: ', 2.011808379769325, 3.8627612113952625)
('****Preprocess time: ', 0.0027045851945877077, 0.002778780460357666)
('****Data time: ', 0.00030280029773712157, 0.0003292560577392578)
('****Fetch time: ', 7.166850566864013e-05, 7.605552673339844e-05)
('****Sort time: ', 0.0006249862909317017, 0.0007719993591308594)
****Stage 0 average time 0.00673271179199
****Stage 1 average time 0.00889367282391
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.7136280537
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011233503699302674, 0.012220394611358642)
('****Total time: ', 0.3476358996629715, 0.6417676568031311)
('****Preprocess time: ', 0.0026637817621231077, 0.0027330279350280757)
('****Data time: ', 0.00029383325576782225, 0.00032283067703247064)
('****Fetch time: ', 6.718862056732178e-05, 7.200241088867188e-05)
('****Sort time: ', 0.0006493000984191895, 0.0007429599761962888)
****Stage 0 average time 0.00599932718277
****Stage 1 average time 0.00890828025341
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.2650840282
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.011278916120529175, 0.012836289405822751)
('****Total time: ', 0.018550586462020874, 0.024692702293395985)
('****Preprocess time: ', 0.0026156349182128906, 0.002762806415557861)
('****Data time: ', 0.0002894468307495117, 0.0003197312355041503)
('****Fetch time: ', 6.76199197769165e-05, 7.295608520507812e-05)
('****Sort time: ', 0.0006088151931762695, 0.0006730675697326646)
****Stage 0 average time 0.0058772342205
****Stage 1 average time 0.00898319876194
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.2994511127
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011267218828201295, 0.012546432018280027)
('****Total time: ', 0.017083727717399598, 0.019885826110839836)
('****Preprocess time: ', 0.00262230384349823, 0.002819108963012695)
('****Data time: ', 0.0002922426462173462, 0.00032693147659301725)
('****Fetch time: ', 6.774532794952392e-05, 7.390975952148438e-05)
('****Sort time: ', 0.0006107405424118042, 0.0006830692291259766)
****Stage 0 average time 0.00592400145531
****Stage 1 average time 0.00893624973297
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.4352920055
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.011340460777282714, 0.01296908855438232)
('****Total time: ', 0.016812496423721315, 0.018966770172119136)
('****Preprocess time: ', 0.002614163875579834, 0.0027900695800781245)
('****Data time: ', 0.00029323315620422366, 0.0003230571746826172)
('****Fetch time: ', 6.829679012298584e-05, 7.605552673339844e-05)
('****Sort time: ', 0.0006040222644805908, 0.0006549358367919922)
****Stage 0 average time 0.00595207953453
****Stage 1 average time 0.00896809732914
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.1066858768
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.011371339321136474, 0.01326949596405029)
('****Total time: ', 0.016758589267730713, 0.0189213752746582)
('****Preprocess time: ', 0.0026024603843688965, 0.0028300762176513665)
('****Data time: ', 0.0002928035259246826, 0.0003440380096435547)
('****Fetch time: ', 6.879222393035889e-05, 7.796287536621094e-05)
('****Sort time: ', 0.0006173571348190307, 0.000654017925262451)
****Stage 0 average time 0.00595846879482
****Stage 1 average time 0.00899428379536
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.4242079258
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.011265338778495788, 0.013114285469055173)
('****Total time: ', 0.016736185669898988, 0.018943309783935543)
('****Preprocess time: ', 0.002607226014137268, 0.0028629422187805174)
('****Data time: ', 0.00029617977142333985, 0.00033936500549316354)
('****Fetch time: ', 6.974744796752929e-05, 7.796287536621094e-05)
('****Sort time: ', 0.0005990707874298096, 0.0006618618965148925)
****Stage 0 average time 0.00596796274185
****Stage 1 average time 0.0088696000576
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941266207391
****DCGs @ 32: 0.91098418454
****DCGs @ 64: 0.858742225939
****Error : 0.34175
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  7.6693649292
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.020681963205337526, 0.029307866096496573)
('****Total time: ', 2.6946022753715515, 4.801345026493072)
('****Preprocess time: ', 0.003540311932563782, 0.004890167713165282)
('****Data time: ', 0.0004299437999725342, 0.0005250573158264157)
('****Fetch time: ', 8.61670970916748e-05, 0.00010323524475097656)
('****Sort time: ', 0.0004637361764907837, 0.0006380081176757812)
****Stage 0 average time 0.0214657702446
****Stage 1 average time 0.00373635196686
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983681191933
****DCGs @ 8: 0.971468582197
****DCGs @ 16: 0.949317677523
****DCGs @ 32: 0.924247625545
****DCGs @ 64: 0.879596321432
****Error : 0.234140625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.42521190643
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.017655808091163634, 0.022772336006164535)
('****Total time: ', 2.1035561430454255, 3.9075498938560487)
('****Preprocess time: ', 0.003108607530593872, 0.004201948642730713)
('****Data time: ', 0.00036699652671813967, 0.00041794776916503906)
('****Fetch time: ', 7.777869701385499e-05, 8.511543273925781e-05)
('****Sort time: ', 0.0004736369848251343, 0.0005970597267150876)
****Stage 0 average time 0.0180388525724
****Stage 1 average time 0.00364397525787
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.982975483277
****DCGs @ 8: 0.971328757314
****DCGs @ 16: 0.94954571003
****DCGs @ 32: 0.924073276451
****DCGs @ 64: 0.879559733439
****Error : 0.23411328125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.33600401878
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01709730100631714, 0.020998585224151604)
('****Total time: ', 1.526706683397293, 2.7864458799362177)
('****Preprocess time: ', 0.003033855438232422, 0.0040002346038818335)
('****Data time: ', 0.0003571114540100098, 0.0004050731658935547)
('****Fetch time: ', 7.381737232208252e-05, 8.227825164794909e-05)
('****Sort time: ', 0.00046876072883605957, 0.000573921203613281)
****Stage 0 average time 0.0174278894663
****Stage 1 average time 0.00360295653343
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983100251573
****DCGs @ 8: 0.971193635374
****DCGs @ 16: 0.949280647025
****DCGs @ 32: 0.923944788654
****DCGs @ 64: 0.879333938153
****Error : 0.234078125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.24512696266
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.01689292097091675, 0.020816576480865455)
('****Total time: ', 0.8655846148729325, 1.667443299293518)
('****Preprocess time: ', 0.003016085147857666, 0.0038175821304321264)
('****Data time: ', 0.00035273349285125735, 0.0004019737243652344)
('****Fetch time: ', 7.144010066986084e-05, 7.915496826171875e-05)
('****Sort time: ', 0.00046796810626983644, 0.000572240352630615)
****Stage 0 average time 0.0172258874178
****Stage 1 average time 0.00357526040077
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983344936861
****DCGs @ 8: 0.97135920528
****DCGs @ 16: 0.949401837456
****DCGs @ 32: 0.924355506307
****DCGs @ 64: 0.879624929821
****Error : 0.23409375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.66868877411
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.016674865961074828, 0.01961010694503784)
('****Total time: ', 0.11887777292728424, 0.18544917106628417)
('****Preprocess time: ', 0.0030004231929779052, 0.0034200787544250476)
('****Data time: ', 0.00034983038902282717, 0.00039578676223754876)
('****Fetch time: ', 7.182550430297851e-05, 8.416175842285156e-05)
('****Sort time: ', 0.0004757462739944458, 0.0005598068237304688)
****Stage 0 average time 0.016803147912
****Stage 1 average time 0.00376954340935
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983181191933
****DCGs @ 8: 0.971357423828
****DCGs @ 16: 0.949476161096
****DCGs @ 32: 0.924071598938
****DCGs @ 64: 0.879496846776
****Error : 0.23409375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.77165603638
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.016815154552459716, 0.019754886627197266)
('****Total time: ', 0.024842638731002807, 0.031419694423675516)
('****Preprocess time: ', 0.002976179599761963, 0.0033078312873840335)
('****Data time: ', 0.00035595476627349855, 0.00040794610977172845)
('****Fetch time: ', 7.24332332611084e-05, 8.58306884765625e-05)
('****Sort time: ', 0.00046587955951690675, 0.0005259513854980469)
****Stage 0 average time 0.0168856633902
****Stage 1 average time 0.00379993832111
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983244329234
****DCGs @ 8: 0.971329440153
****DCGs @ 16: 0.949467665353
****DCGs @ 32: 0.924163373417
****DCGs @ 64: 0.879447802215
****Error : 0.234078125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.6032068729
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.016419870018959046, 0.01928797960281372)
('****Total time: ', 0.022926300168037414, 0.027172589302062983)
('****Preprocess time: ', 0.0029506345987319947, 0.0032970190048217766)
('****Data time: ', 0.0003520662784576416, 0.0004010200500488281)
('****Fetch time: ', 7.07937479019165e-05, 8.107423782348626e-05)
('****Sort time: ', 0.0004674903154373169, 0.0005252361297607422)
****Stage 0 average time 0.0164989974499
****Stage 1 average time 0.00376185750961
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.982858468105
****DCGs @ 8: 0.971113923605
****DCGs @ 16: 0.949294231286
****DCGs @ 32: 0.924062547161
****DCGs @ 64: 0.879484790569
****Error : 0.23406640625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.7068088055
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.01660026478767395, 0.019451832771301265)
('****Total time: ', 0.02273788321018219, 0.026286387443542475)
('****Preprocess time: ', 0.002954853057861328, 0.0032378435134887687)
('****Data time: ', 0.00036208415031433106, 0.00041222572326660156)
('****Fetch time: ', 7.20590353012085e-05, 8.296966552734375e-05)
('****Sort time: ', 0.00046495819091796873, 0.0005162000656127928)
****Stage 0 average time 0.0166726183891
****Stage 1 average time 0.00378160083294
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983607646796
****DCGs @ 8: 0.971556757408
****DCGs @ 16: 0.949469824264
****DCGs @ 32: 0.924209166407
****DCGs @ 64: 0.879580374916
****Error : 0.23415625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.6927959919
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.016444979548454284, 0.01893497705459594)
('****Total time: ', 0.02234128999710083, 0.025133776664733883)
('****Preprocess time: ', 0.0029230990409851074, 0.0032441973686218257)
('****Data time: ', 0.000354120135307312, 0.0004031658172607422)
('****Fetch time: ', 7.037627696990967e-05, 8.106231689453125e-05)
('****Sort time: ', 0.00045472121238708497, 0.0004999637603759766)
****Stage 0 average time 0.0164803842306
****Stage 1 average time 0.00376691198349
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983304343127
****DCGs @ 8: 0.971326462451
****DCGs @ 16: 0.949567917514
****DCGs @ 32: 0.924211159937
****DCGs @ 64: 0.879480462994
****Error : 0.234125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.8317210674
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.0164268559217453, 0.019101095199584958)
('****Total time: ', 0.022206226110458374, 0.02527029514312744)
('****Preprocess time: ', 0.002921272873878479, 0.0032570719718933105)
('****Data time: ', 0.00035334098339080813, 0.0004029273986816406)
('****Fetch time: ', 6.912457942962647e-05, 7.823705673217754e-05)
('****Sort time: ', 0.0004788062572479248, 0.0005240559577941894)
****Stage 0 average time 0.0165110846758
****Stage 1 average time 0.0037383159399
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.982856961798
****DCGs @ 8: 0.971284797104
****DCGs @ 16: 0.949414432263
****DCGs @ 32: 0.924172889369
****DCGs @ 64: 0.879546177544
****Error : 0.2340703125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.4730491638
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.01633380091190338, 0.018576371669769283)
('****Total time: ', 0.021983105540275574, 0.0245611310005188)
('****Preprocess time: ', 0.0029465346336364747, 0.003384888172149658)
('****Data time: ', 0.00035434484481811524, 0.0004010200500488281)
('****Fetch time: ', 6.919896602630615e-05, 7.891654968261719e-05)
('****Sort time: ', 0.00047585344314575196, 0.0005397915840148925)
****Stage 0 average time 0.016434087038
****Stage 1 average time 0.00374564576149
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983296947905
****DCGs @ 8: 0.971240610176
****DCGs @ 16: 0.949312723169
****DCGs @ 32: 0.92399874148
****DCGs @ 64: 0.879414496754
****Error : 0.2341015625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  31.6290040016
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.016089786410331725, 0.01839247941970825)
('****Total time: ', 0.021645955324172975, 0.024268972873687743)
('****Preprocess time: ', 0.0029021695852279664, 0.0032721161842346187)
('****Data time: ', 0.00035261523723602295, 0.0004100799560546875)
('****Fetch time: ', 6.813633441925048e-05, 7.605552673339844e-05)
('****Sort time: ', 0.00046956253051757814, 0.0005159854888916013)
****Stage 0 average time 0.0161248627901
****Stage 1 average time 0.00375740730762
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983518953313
****DCGs @ 8: 0.971330321914
****DCGs @ 16: 0.949460032244
****DCGs @ 32: 0.924213846414
****DCGs @ 64: 0.879616172427
****Error : 0.234125
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  2.55073881149
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.020158239245414735, 0.02767833471298216)
('****Total time: ', 0.039955289840698245, 0.05148581266403198)
('****Preprocess time: ', 0.0032802308797836304, 0.004741287231445312)
('****Data time: ', 0.00044199955463409423, 0.0005400180816650391)
('****Fetch time: ', 6.692969799041748e-05, 7.319450378417969e-05)
('****Sort time: ', 0.0005013618469238281, 0.0006840348243713378)
****Stage 0 average time 0.019175118804
****Stage 1 average time 0.00527364242077
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983681191933
****DCGs @ 8: 0.971468582197
****DCGs @ 16: 0.949317677523
****DCGs @ 32: 0.924247625545
****DCGs @ 64: 0.879596321432
****Error : 0.234140625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  3.57662892342
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.01914941155910492, 0.024497854709625243)
('****Total time: ', 0.02629653561115265, 0.03348736763000487)
('****Preprocess time: ', 0.0032351769208908083, 0.004587042331695556)
('****Data time: ', 0.000429579496383667, 0.0005049705505371094)
('****Fetch time: ', 5.864977836608887e-05, 6.890296936035156e-05)
('****Sort time: ', 0.00048658788204193116, 0.0006289958953857419)
****Stage 0 average time 0.018506739378
****Stage 1 average time 0.00485266625881
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.982975483277
****DCGs @ 8: 0.971328757314
****DCGs @ 16: 0.94954571003
****DCGs @ 32: 0.924073276451
****DCGs @ 64: 0.879559733439
****Error : 0.23411328125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.59200596809
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01881879413127899, 0.023681116104125967)
('****Total time: ', 0.025575366854667665, 0.031676650047302246)
('****Preprocess time: ', 0.0031952718496322634, 0.00433429479598999)
('****Data time: ', 0.0004232769012451172, 0.0004839897155761719)
('****Fetch time: ', 5.550837516784668e-05, 6.676912307739251e-05)
('****Sort time: ', 0.0004773682355880737, 0.000573921203613281)
****Stage 0 average time 0.0182577034235
****Stage 1 average time 0.00471251606941
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983100251573
****DCGs @ 8: 0.971193635374
****DCGs @ 16: 0.949280647025
****DCGs @ 32: 0.923944788654
****DCGs @ 64: 0.879333938153
****Error : 0.234078125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.62849187851
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.01837509262561798, 0.02200685739517211)
('****Total time: ', 0.024975624203681945, 0.02938305139541626)
('****Preprocess time: ', 0.0031607346534729005, 0.004291057586669922)
('****Data time: ', 0.0004129068851470947, 0.0004820823669433594)
('****Fetch time: ', 5.372786521911621e-05, 6.413459777832031e-05)
('****Sort time: ', 0.0004798916578292847, 0.0005657792091369628)
****Stage 0 average time 0.0177480018139
****Stage 1 average time 0.0047343518734
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983344936861
****DCGs @ 8: 0.97135920528
****DCGs @ 16: 0.949401837456
****DCGs @ 32: 0.924355506307
****DCGs @ 64: 0.879624929821
****Error : 0.23409375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.62128210068
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.017641123175621033, 0.020728278160095207)
('****Total time: ', 0.023905866146087647, 0.02770315408706665)
('****Preprocess time: ', 0.0030687884092330934, 0.0036272048950195305)
('****Data time: ', 0.00040335214138031007, 0.00045709609985351536)
('****Fetch time: ', 4.93931770324707e-05, 5.91278076171875e-05)
('****Sort time: ', 0.0005003442764282227, 0.0005390644073486328)
****Stage 0 average time 0.0172545785904
****Stage 1 average time 0.0044084225893
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983181191933
****DCGs @ 8: 0.971357423828
****DCGs @ 16: 0.949476161096
****DCGs @ 32: 0.924071598938
****DCGs @ 64: 0.879496846776
****Error : 0.23409375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.79774403572
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.017758089303970336, 0.021056854724884028)
('****Total time: ', 0.02395273768901825, 0.02783622741699219)
('****Preprocess time: ', 0.0030477876663208008, 0.004088985919952392)
('****Data time: ', 0.00039613962173461913, 0.00044727325439453125)
('****Fetch time: ', 4.915010929107666e-05, 5.793571472167969e-05)
('****Sort time: ', 0.0004852573871612549, 0.000547254085540771)
****Stage 0 average time 0.0172015429735
****Stage 1 average time 0.00453488111496
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983244329234
****DCGs @ 8: 0.971329440153
****DCGs @ 16: 0.949467665353
****DCGs @ 32: 0.924163373417
****DCGs @ 64: 0.879447802215
****Error : 0.234078125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.6870877743
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01722299337387085, 0.020013141632080077)
('****Total time: ', 0.023268951177597044, 0.026713418960571285)
('****Preprocess time: ', 0.003008486747741699, 0.0039025425910949674)
('****Data time: ', 0.0003889204263687134, 0.0004398822784423828)
('****Fetch time: ', 4.8517942428588866e-05, 5.5789947509765625e-05)
('****Sort time: ', 0.000485405445098877, 0.0005478978157043456)
****Stage 0 average time 0.01670010221
****Stage 1 average time 0.00445422172546
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.982858468105
****DCGs @ 8: 0.971113923605
****DCGs @ 16: 0.949294231286
****DCGs @ 32: 0.924062547161
****DCGs @ 64: 0.879484790569
****Error : 0.23406640625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.6953599453
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.017204280614852904, 0.020085346698760984)
('****Total time: ', 0.02322404134273529, 0.02654099464416504)
('****Preprocess time: ', 0.0029975764751434325, 0.0036352753639221124)
('****Data time: ', 0.0003820360898971558, 0.0004291534423828125)
('****Fetch time: ', 4.7550082206726076e-05, 5.5336952209472526e-05)
('****Sort time: ', 0.0004856182336807251, 0.000535738468170166)
****Stage 0 average time 0.0166078034639
****Stage 1 average time 0.00450925803185
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983607646796
****DCGs @ 8: 0.971556757408
****DCGs @ 16: 0.949469824264
****DCGs @ 32: 0.924209166407
****DCGs @ 64: 0.879580374916
****Error : 0.23415625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.753136158
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01646896278858185, 0.01880937814712524)
('****Total time: ', 0.022477328300476076, 0.025065493583679196)
('****Preprocess time: ', 0.0029206310510635374, 0.003113770484924316)
('****Data time: ', 0.0003846510648727417, 0.0004279613494873047)
('****Fetch time: ', 4.549431800842285e-05, 5.2237510681152214e-05)
('****Sort time: ', 0.0004902067184448242, 0.0005300164222717285)
****Stage 0 average time 0.0161161205769
****Stage 1 average time 0.00419382536411
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983304343127
****DCGs @ 8: 0.971326462451
****DCGs @ 16: 0.949567917514
****DCGs @ 32: 0.924211159937
****DCGs @ 64: 0.879480462994
****Error : 0.234125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.917755127
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.015959731221199036, 0.01777254343032837)
('****Total time: ', 0.021958231806755067, 0.023977136611938475)
('****Preprocess time: ', 0.0029123272895812988, 0.0030698776245117188)
('****Data time: ', 0.0003809010982513428, 0.00042724609375)
('****Fetch time: ', 4.318773746490479e-05, 4.887580871582031e-05)
('****Sort time: ', 0.0004869319200515747, 0.0005252361297607422)
****Stage 0 average time 0.0157269883156
****Stage 1 average time 0.00405609095097
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.982856961798
****DCGs @ 8: 0.971284797104
****DCGs @ 16: 0.949414432263
****DCGs @ 32: 0.924172889369
****DCGs @ 64: 0.879546177544
****Error : 0.2340703125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.6554038525
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.015742130517959595, 0.01772797107696533)
('****Total time: ', 0.021675796866416932, 0.0238924503326416)
('****Preprocess time: ', 0.0028829708099365236, 0.0030551314353942866)
('****Data time: ', 0.00037732172012329104, 0.0004260540008544922)
('****Fetch time: ', 4.359304904937744e-05, 4.817247390747064e-05)
('****Sort time: ', 0.00047929370403289795, 0.0005257248878479003)
****Stage 0 average time 0.0154948551655
****Stage 1 average time 0.00403045463562
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983296947905
****DCGs @ 8: 0.971240610176
****DCGs @ 16: 0.949312723169
****DCGs @ 32: 0.92399874148
****DCGs @ 64: 0.879414496754
****Error : 0.2341015625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.7964940071
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.01609066963195801, 0.01828210353851318)
('****Total time: ', 0.022004655957221984, 0.024278926849365234)
('****Preprocess time: ', 0.002928857207298279, 0.0031231403350830073)
('****Data time: ', 0.0003862510919570923, 0.00043702125549316406)
('****Fetch time: ', 4.487979412078857e-05, 4.982948303222656e-05)
('****Sort time: ', 0.0004773710966110229, 0.0005240440368652344)
****Stage 0 average time 0.015843526125
****Stage 1 average time 0.00408450269699
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983518953313
****DCGs @ 8: 0.971330321914
****DCGs @ 16: 0.949460032244
****DCGs @ 32: 0.924213846414
****DCGs @ 64: 0.879616172427
****Error : 0.234125
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  12.8647119999
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.00732642650604248, 0.007966816425323486)
('****Total time: ', 5.4402445114850995, 10.282864093780516)
('****Preprocess time: ', 0.0026476649045944216, 0.002722024917602539)
('****Data time: ', 0.00027345108985900876, 0.00029587745666503906)
('****Fetch time: ', 6.411099433898926e-05, 7.200241088867188e-05)
('****Sort time: ', 0.00044412410259246827, 0.00046706199645996094)
****Stage 0 average time 0.00653453946114
****Stage 1 average time 0.00422123813629
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983681191933
****DCGs @ 8: 0.971468582197
****DCGs @ 16: 0.949317677523
****DCGs @ 32: 0.924247625545
****DCGs @ 64: 0.879596321432
****Error : 0.234140625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.9368100166
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.007395639061927795, 0.00834512710571289)
('****Total time: ', 4.985531612277031, 9.442760205268858)
('****Preprocess time: ', 0.002688174366950989, 0.0028995394706726038)
('****Data time: ', 0.0002693030834197998, 0.0002920985221862791)
('****Fetch time: ', 6.392431259155273e-05, 7.224082946777344e-05)
('****Sort time: ', 0.00043966817855834963, 0.0004639625549316406)
****Stage 0 average time 0.00656595158577
****Stage 1 average time 0.00429075741768
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.982975483277
****DCGs @ 8: 0.971328757314
****DCGs @ 16: 0.94954571003
****DCGs @ 32: 0.924073276451
****DCGs @ 64: 0.879559733439
****Error : 0.23411328125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.9228389263
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007379877209663391, 0.00831218957901001)
('****Total time: ', 4.40269744515419, 8.36318986415863)
('****Preprocess time: ', 0.0026745949983596803, 0.002757108211517334)
('****Data time: ', 0.0002682915925979614, 0.00029397010803222656)
('****Fetch time: ', 6.391489505767823e-05, 7.200241088867188e-05)
('****Sort time: ', 0.00043774187564849854, 0.0004601478576660156)
****Stage 0 average time 0.00656174325943
****Stage 1 average time 0.0042626773119
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983100251573
****DCGs @ 8: 0.971193635374
****DCGs @ 16: 0.949280647025
****DCGs @ 32: 0.923944788654
****DCGs @ 64: 0.879333938153
****Error : 0.234078125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.1579070091
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.007842993259429932, 0.008340120315551758)
('****Total time: ', 4.412328743934632, 8.51072665452957)
('****Preprocess time: ', 0.002663409113883972, 0.002727985382080078)
('****Data time: ', 0.00028245437145233153, 0.0002958893775939941)
('****Fetch time: ', 6.390249729156494e-05, 6.890296936035156e-05)
('****Sort time: ', 0.00043237841129302977, 0.0004570484161376953)
****Stage 0 average time 0.00717565095425
****Stage 1 average time 0.0041094866991
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983344936861
****DCGs @ 8: 0.97135920528
****DCGs @ 16: 0.949401837456
****DCGs @ 32: 0.924355506307
****DCGs @ 64: 0.879624929821
****Error : 0.23409375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.2067029476
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.007872676730155945, 0.008361148834228517)
('****Total time: ', 3.450170145392418, 6.567952060699462)
('****Preprocess time: ', 0.00266851007938385, 0.0027346849441528317)
('****Data time: ', 0.00028337669372558593, 0.0002951622009277344)
('****Fetch time: ', 6.396043300628662e-05, 6.890296936035156e-05)
('****Sort time: ', 0.00042940545082092286, 0.00045299530029296875)
****Stage 0 average time 0.00720149493217
****Stage 1 average time 0.00411643445492
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983181191933
****DCGs @ 8: 0.971357423828
****DCGs @ 16: 0.949476161096
****DCGs @ 32: 0.924071598938
****DCGs @ 64: 0.879496846776
****Error : 0.23409375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.7371160984
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.007237651348114014, 0.007765257358551024)
('****Total time: ', 1.6569475506544113, 3.189719521999359)
('****Preprocess time: ', 0.002636864423751831, 0.0027013063430786134)
('****Data time: ', 0.0002686278820037842, 0.0002841949462890625)
('****Fetch time: ', 6.512844562530517e-05, 7.510185241699219e-05)
('****Sort time: ', 0.00043387508392333986, 0.0004589557647705078)
****Stage 0 average time 0.0064755166769
****Stage 1 average time 0.00416663050652
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983244329234
****DCGs @ 8: 0.971329440153
****DCGs @ 16: 0.949467665353
****DCGs @ 32: 0.924163373417
****DCGs @ 64: 0.879447802215
****Error : 0.234078125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.8889069557
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007647518157958984, 0.008149969577789306)
('****Total time: ', 1.2586514736413956, 2.5436303257942194)
('****Preprocess time: ', 0.002625428557395935, 0.002718210220336914)
('****Data time: ', 0.0002736226320266724, 0.0002911090850830078)
('****Fetch time: ', 6.346344947814941e-05, 6.699562072753906e-05)
('****Sort time: ', 0.000443456768989563, 0.00047016143798828125)
****Stage 0 average time 0.0070552996397
****Stage 1 average time 0.00399818992615
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.982858468105
****DCGs @ 8: 0.971113923605
****DCGs @ 16: 0.949294231286
****DCGs @ 32: 0.924062547161
****DCGs @ 64: 0.879484790569
****Error : 0.23406640625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.097137928
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.007654329657554627, 0.008192098140716553)
('****Total time: ', 0.3223129754066467, 0.7167046070098874)
('****Preprocess time: ', 0.0026186026334762574, 0.0027239799499511716)
('****Data time: ', 0.00027436542510986327, 0.00029278993606567376)
('****Fetch time: ', 6.202924251556397e-05, 6.794929504394531e-05)
('****Sort time: ', 0.0004459425210952759, 0.0004820942878723144)
****Stage 0 average time 0.00703713190556
****Stage 1 average time 0.0040181375742
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983607646796
****DCGs @ 8: 0.971556757408
****DCGs @ 16: 0.949469824264
****DCGs @ 32: 0.924209166407
****DCGs @ 64: 0.879580374916
****Error : 0.23415625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.5380868912
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007272536873817444, 0.008128929138183593)
('****Total time: ', 0.01344570529460907, 0.017879211902618406)
('****Preprocess time: ', 0.002625330924987793, 0.0028189420700073234)
('****Data time: ', 0.00027938055992126465, 0.0003180503845214844)
('****Fetch time: ', 6.195282936096191e-05, 7.009506225585938e-05)
('****Sort time: ', 0.0004435356855392456, 0.0004911422729492188)
****Stage 0 average time 0.0064948335886
****Stage 1 average time 0.00418790328503
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983304343127
****DCGs @ 8: 0.971326462451
****DCGs @ 16: 0.949567917514
****DCGs @ 32: 0.924211159937
****DCGs @ 64: 0.879480462994
****Error : 0.234125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.6897900105
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.007362980008125305, 0.00840601921081543)
('****Total time: ', 0.012692622303962708, 0.014619302749633783)
('****Preprocess time: ', 0.0026055370569229128, 0.0028582930564880365)
('****Data time: ', 0.0002815592288970947, 0.0003431320190429685)
('****Fetch time: ', 6.237947940826417e-05, 7.128715515136719e-05)
('****Sort time: ', 0.00042888510227203367, 0.0004890441894531247)
****Stage 0 average time 0.00652121436596
****Stage 1 average time 0.00422012650967
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.982856961798
****DCGs @ 8: 0.971284797104
****DCGs @ 16: 0.949414432263
****DCGs @ 32: 0.924172889369
****DCGs @ 64: 0.879546177544
****Error : 0.2340703125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.3986229897
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.007397932410240174, 0.008442163467407227)
('****Total time: ', 0.012634670615196228, 0.014207637310028066)
('****Preprocess time: ', 0.0026185173988342286, 0.0028682589530944816)
('****Data time: ', 0.00028137195110321044, 0.0003359436988830566)
('****Fetch time: ', 6.278431415557861e-05, 7.200241088867188e-05)
('****Sort time: ', 0.000434067964553833, 0.0004990220069885253)
****Stage 0 average time 0.00656304776669
****Stage 1 average time 0.0042316262722
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983296947905
****DCGs @ 8: 0.971240610176
****DCGs @ 16: 0.949312723169
****DCGs @ 32: 0.92399874148
****DCGs @ 64: 0.879414496754
****Error : 0.2341015625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.5720949173
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.007373189210891724, 0.008631396293640134)
('****Total time: ', 0.012528263568878173, 0.0141481876373291)
('****Preprocess time: ', 0.0025900974273681643, 0.0029030561447143536)
('****Data time: ', 0.00028073537349700926, 0.0003478765487670897)
('****Fetch time: ', 6.283891201019287e-05, 7.200241088867188e-05)
('****Sort time: ', 0.00044030213356018066, 0.0005300045013427734)
****Stage 0 average time 0.00652584683895
****Stage 1 average time 0.00422131621838
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983518953313
****DCGs @ 8: 0.971330321914
****DCGs @ 16: 0.949460032244
****DCGs @ 32: 0.924213846414
****DCGs @ 64: 0.879616172427
****Error : 0.234125
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  8.66383099556
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.020740307211875916, 0.0287684679031372)
('****Total time: ', 3.1211115876436235, 5.664874875545501)
('****Preprocess time: ', 0.003995854377746582, 0.005332982540130615)
('****Data time: ', 0.00042276406288146973, 0.0005078434944152831)
('****Fetch time: ', 8.288323879241943e-05, 9.60946083068847e-05)
('****Sort time: ', 0.0006298874616622925, 0.0007867813110351562)
****Stage 0 average time 0.0215132800341
****Stage 1 average time 0.00435841631889
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983681191933
****DCGs @ 8: 0.971627538235
****DCGs @ 16: 0.949358941344
****DCGs @ 32: 0.924486984785
****DCGs @ 64: 0.879887260841
****Error : 0.356268554688
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.87980294228
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.018709786891937256, 0.024949049949645977)
('****Total time: ', 2.8745229746103287, 5.243614125251769)
('****Preprocess time: ', 0.0036692068576812745, 0.004956269264221192)
('****Data time: ', 0.00040672254562377927, 0.0004878163337707519)
('****Fetch time: ', 8.155345916748047e-05, 9.512901306152344e-05)
('****Sort time: ', 0.0006741670370101929, 0.00088123083114624)
****Stage 0 average time 0.0190717995167
****Stage 1 average time 0.00446963727474
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983059547046
****DCGs @ 8: 0.971575943227
****DCGs @ 16: 0.949579104731
****DCGs @ 32: 0.924432376386
****DCGs @ 64: 0.879787716152
****Error : 0.356284179687
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.52070498466
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.018132275700569155, 0.02347363233566284)
('****Total time: ', 2.086290791749954, 3.8671464085578915)
('****Preprocess time: ', 0.003565287113189697, 0.004749250411987304)
('****Data time: ', 0.0003890146017074585, 0.0004379749298095703)
('****Fetch time: ', 7.511043548583984e-05, 8.488893508911126e-05)
('****Sort time: ', 0.0006657426357269288, 0.0007619857788085938)
****Stage 0 average time 0.018524409771
****Stage 1 average time 0.00430302071571
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983184315341
****DCGs @ 8: 0.971361659787
****DCGs @ 16: 0.949376690542
****DCGs @ 32: 0.92429871986
****DCGs @ 64: 0.879661017992
****Error : 0.356318359375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.5411939621
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.017835545420646668, 0.022551560401916502)
('****Total time: ', 1.583665911078453, 2.930914211273193)
('****Preprocess time: ', 0.003519730567932129, 0.004706227779388427)
('****Data time: ', 0.0003753511905670166, 0.00042510032653808594)
('****Fetch time: ', 7.441294193267822e-05, 8.392333984375e-05)
('****Sort time: ', 0.0006647787094116211, 0.0007529258728027344)
****Stage 0 average time 0.0181450722218
****Stage 1 average time 0.00432474660873
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983344936861
****DCGs @ 8: 0.971474388255
****DCGs @ 16: 0.949442503258
****DCGs @ 32: 0.924560675631
****DCGs @ 64: 0.879898492612
****Error : 0.356262695312
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.5866560936
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.01765864598751068, 0.022108805179595948)
('****Total time: ', 0.5735453786849976, 1.031177496910095)
('****Preprocess time: ', 0.0034455337524414062, 0.004395306110382078)
('****Data time: ', 0.00036965453624725344, 0.000411999225616455)
('****Fetch time: ', 7.1913480758667e-05, 8.20159912109375e-05)
('****Sort time: ', 0.0006494954824447632, 0.0007801055908203125)
****Stage 0 average time 0.0178799859285
****Stage 1 average time 0.00431525731087
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983265255701
****DCGs @ 8: 0.971611378421
****DCGs @ 16: 0.949512797635
****DCGs @ 32: 0.924485846143
****DCGs @ 64: 0.879743740417
****Error : 0.356274414062
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.77367401123
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.01720514702796936, 0.02045536041259765)
('****Total time: ', 0.02745514488220215, 0.03652809858322143)
('****Preprocess time: ', 0.0033801399469375612, 0.0037523388862609848)
('****Data time: ', 0.0003628242015838623, 0.00040602684020996094)
('****Fetch time: ', 7.276594638824463e-05, 8.225440979003906e-05)
('****Sort time: ', 0.0006420769691467285, 0.0007529377937316894)
****Stage 0 average time 0.0173182674646
****Stage 1 average time 0.00434468662739
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983328393003
****DCGs @ 8: 0.971534468948
****DCGs @ 16: 0.949541559704
****DCGs @ 32: 0.924452653327
****DCGs @ 64: 0.879757084132
****Error : 0.356325195313
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.6997299194
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017436092495918275, 0.02154091596603393)
('****Total time: ', 0.026555289387702942, 0.03509812355041502)
('****Preprocess time: ', 0.003511732459068298, 0.004379093647003167)
('****Data time: ', 0.0003765077590942383, 0.00043582916259765625)
('****Fetch time: ', 7.577002048492432e-05, 8.894205093383783e-05)
('****Sort time: ', 0.0006353108882904052, 0.0007079124450683591)
****Stage 0 average time 0.0172389514446
****Stage 1 average time 0.00479646217823
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.982858468105
****DCGs @ 8: 0.97122910658
****DCGs @ 16: 0.949355916643
****DCGs @ 32: 0.924341899266
****DCGs @ 64: 0.87972073109
****Error : 0.3562578125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.7360949516
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.01680029034614563, 0.019943237304687493)
('****Total time: ', 0.02365086007118225, 0.02741051912307738)
('****Preprocess time: ', 0.0033073941469192506, 0.0036220550537109375)
('****Data time: ', 0.00035161936283111575, 0.0004001021385192869)
('****Fetch time: ', 7.203531265258789e-05, 7.797479629516595e-05)
('****Sort time: ', 0.0006211451292037963, 0.0006878495216369628)
****Stage 0 average time 0.0168681880236
****Stage 1 average time 0.00428429627419
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983691710564
****DCGs @ 8: 0.971768554883
****DCGs @ 16: 0.949526034884
****DCGs @ 32: 0.924570754671
****DCGs @ 64: 0.879897155939
****Error : 0.35631640625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.7050228119
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.016653547763824463, 0.019132459163665766)
('****Total time: ', 0.023066928744316102, 0.025951755046844473)
('****Preprocess time: ', 0.0032743550539016722, 0.003487026691436767)
('****Data time: ', 0.00034767818450927735, 0.00039578676223754876)
('****Fetch time: ', 6.938505172729492e-05, 7.609128952026348e-05)
('****Sort time: ', 0.0006260091066360474, 0.0007257580757141113)
****Stage 0 average time 0.0167067528963
****Stage 1 average time 0.00426422226429
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983304343127
****DCGs @ 8: 0.971565213028
****DCGs @ 16: 0.949614259891
****DCGs @ 32: 0.924486024057
****DCGs @ 64: 0.879744717784
****Error : 0.356294921875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.8994040489
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.01676714825630188, 0.01981250047683715)
('****Total time: ', 0.023221158385276795, 0.026445198059082034)
('****Preprocess time: ', 0.003322357892990112, 0.003644311428070068)
('****Data time: ', 0.00036100852489471435, 0.0004139065742492675)
('****Fetch time: ', 7.127964496612549e-05, 7.987022399902344e-05)
('****Sort time: ', 0.0006244872808456421, 0.00069810152053833)
****Stage 0 average time 0.0166743081808
****Stage 1 average time 0.00447197341919
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.982941025566
****DCGs @ 8: 0.971408415416
****DCGs @ 16: 0.949463770827
****DCGs @ 32: 0.924436593802
****DCGs @ 64: 0.879785036046
****Error : 0.356293945313
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.6126749516
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.01620389771461487, 0.018916749954223627)
('****Total time: ', 0.022372157335281372, 0.025364601612091062)
('****Preprocess time: ', 0.003230516195297241, 0.0034681797027587887)
('****Data time: ', 0.00034936141967773437, 0.0004088997840881347)
('****Fetch time: ', 6.872570514678955e-05, 7.414817810058594e-05)
('****Sort time: ', 0.0006056902408599854, 0.0006709098815917969)
****Stage 0 average time 0.0161797261238
****Stage 1 average time 0.00427846515179
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983381011673
****DCGs @ 8: 0.971412510383
****DCGs @ 16: 0.949408298626
****DCGs @ 32: 0.924349417226
****DCGs @ 64: 0.8797135507
****Error : 0.356293945313
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  31.6168100834
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.016136226892471312, 0.018830108642578124)
('****Total time: ', 0.022047077298164366, 0.024888932704925527)
('****Preprocess time: ', 0.003218602538108826, 0.003400230407714843)
('****Data time: ', 0.0003455860614776611, 0.0004038810729980469)
('****Fetch time: ', 6.758081912994385e-05, 7.392168045043939e-05)
('****Sort time: ', 0.0006085795164108277, 0.0006718754768371581)
****Stage 0 average time 0.016134018302
****Stage 1 average time 0.00424255752563
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983518953313
****DCGs @ 8: 0.97156907249
****DCGs @ 16: 0.949482200877
****DCGs @ 32: 0.924475448898
****DCGs @ 64: 0.879913765478
****Error : 0.356271484375
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  2.79455208778
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.02864805805683136, 0.03765380382537841)
('****Total time: ', 0.08435082340240478, 0.12938508987426756)
('****Preprocess time: ', 0.004372563362121582, 0.006324267387390134)
('****Data time: ', 0.0005105969905853272, 0.000634920597076416)
('****Fetch time: ', 7.812511920928955e-05, 9.083747863769531e-05)
('****Sort time: ', 0.0007583191394805908, 0.0010448098182678218)
****Stage 0 average time 0.0212640447617
****Stage 1 average time 0.0131036179066
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983681191933
****DCGs @ 8: 0.971627538235
****DCGs @ 16: 0.949358941344
****DCGs @ 32: 0.924486984785
****DCGs @ 64: 0.879887260841
****Error : 0.356268554688
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  3.70152592659
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.02485461723804474, 0.0318297266960144)
('****Total time: ', 0.033265620589256285, 0.041582095623016346)
('****Preprocess time: ', 0.003917474389076233, 0.005404961109161377)
('****Data time: ', 0.0004727554321289063, 0.0005457520484924316)
('****Fetch time: ', 6.950271129608154e-05, 8.178949356079095e-05)
('****Sort time: ', 0.0007431482076644898, 0.0010040283203124997)
****Stage 0 average time 0.0190309981108
****Stage 1 average time 0.0110264998674
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983059547046
****DCGs @ 8: 0.971575943227
****DCGs @ 16: 0.949579104731
****DCGs @ 32: 0.924432376386
****DCGs @ 64: 0.879787716152
****Error : 0.356284179687
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.57442307472
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.023635385394096375, 0.02956107854843139)
('****Total time: ', 0.03142953014373779, 0.038126337528228756)
('****Preprocess time: ', 0.003785823464393616, 0.005037939548492431)
('****Data time: ', 0.0004473826885223389, 0.0005121231079101562)
('****Fetch time: ', 6.496036052703858e-05, 7.796287536621094e-05)
('****Sort time: ', 0.0007000967264175416, 0.0008710384368896479)
****Stage 0 average time 0.0181674352884
****Stage 1 average time 0.0104662133455
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983184315341
****DCGs @ 8: 0.971361659787
****DCGs @ 16: 0.949376690542
****DCGs @ 32: 0.92429871986
****DCGs @ 64: 0.879661017992
****Error : 0.356318359375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.56377410889
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.02372215747833252, 0.029671275615692137)
('****Total time: ', 0.031030698657035827, 0.03746825456619262)
('****Preprocess time: ', 0.003827260136604309, 0.005127096176147461)
('****Data time: ', 0.00046316254138946536, 0.0005300045013427734)
('****Fetch time: ', 6.559073925018311e-05, 7.796287536621094e-05)
('****Sort time: ', 0.0006902298927307129, 0.0008302211761474607)
****Stage 0 average time 0.0184055213928
****Stage 1 average time 0.0103628793955
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983344936861
****DCGs @ 8: 0.971474388255
****DCGs @ 16: 0.949442503258
****DCGs @ 32: 0.924560675631
****DCGs @ 64: 0.879898492612
****Error : 0.356262695312
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.71652698517
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.02256119239330292, 0.026962769031524638)
('****Total time: ', 0.0296800297498703, 0.03478293418884277)
('****Preprocess time: ', 0.0036553226709365844, 0.004767167568206782)
('****Data time: ', 0.00043113505840301514, 0.000486171245574951)
('****Fetch time: ', 6.0745954513549806e-05, 7.106065750122064e-05)
('****Sort time: ', 0.000693352222442627, 0.0008108615875244141)
****Stage 0 average time 0.0174932398796
****Stage 1 average time 0.00990850841999
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983265255701
****DCGs @ 8: 0.971611378421
****DCGs @ 16: 0.949512797635
****DCGs @ 32: 0.924485846143
****DCGs @ 64: 0.879743740417
****Error : 0.356274414062
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.86985206604
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.021811214208602905, 0.02489786148071289)
('****Total time: ', 0.028867210388183594, 0.032702493667602535)
('****Preprocess time: ', 0.003561273455619812, 0.004110288619995116)
('****Data time: ', 0.0004231747388839722, 0.0004780411720275878)
('****Fetch time: ', 5.871498584747314e-05, 6.890296936035156e-05)
('****Sort time: ', 0.0006983003616333008, 0.0008061408996582029)
****Stage 0 average time 0.016938762784
****Stage 1 average time 0.00961391496658
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983328393003
****DCGs @ 8: 0.971534468948
****DCGs @ 16: 0.949541559704
****DCGs @ 32: 0.924452653327
****DCGs @ 64: 0.879757084132
****Error : 0.356325195313
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.7070600986
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.021463245034217836, 0.024945068359374992)
('****Total time: ', 0.028511703133583068, 0.03238188028335571)
('****Preprocess time: ', 0.0035247128009796144, 0.00391606092453003)
('****Data time: ', 0.0004190745353698731, 0.0004718303680419922)
('****Fetch time: ', 5.6984543800354006e-05, 6.604194641113281e-05)
('****Sort time: ', 0.0007192147970199585, 0.0007970333099365234)
****Stage 0 average time 0.0166362603903
****Stage 1 average time 0.00954697132111
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.982858468105
****DCGs @ 8: 0.97122910658
****DCGs @ 16: 0.949355916643
****DCGs @ 32: 0.924341899266
****DCGs @ 64: 0.87972073109
****Error : 0.3562578125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.73864007
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.021569446682929993, 0.02524722814559936)
('****Total time: ', 0.02850941014289856, 0.03299683332443236)
('****Preprocess time: ', 0.003560332417488098, 0.004487085342407227)
('****Data time: ', 0.0004159564971923828, 0.0004658699035644531)
('****Fetch time: ', 5.62669038772583e-05, 6.535053253173815e-05)
('****Sort time: ', 0.0006937777996063232, 0.0007777333259582519)
****Stage 0 average time 0.0168084286451
****Stage 1 average time 0.00948735165596
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983691710564
****DCGs @ 8: 0.971768554883
****DCGs @ 16: 0.949526034884
****DCGs @ 32: 0.924570754671
****DCGs @ 64: 0.879897155939
****Error : 0.35631640625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.8411459923
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.021081827640533447, 0.023919236660003663)
('****Total time: ', 0.028001498222351075, 0.03120704889297485)
('****Preprocess time: ', 0.003493466019630432, 0.0038382053375244137)
('****Data time: ', 0.0004163895845413208, 0.00045827627182006816)
('****Fetch time: ', 5.484247207641602e-05, 6.222724914550781e-05)
('****Sort time: ', 0.0006932694911956787, 0.0007450699806213378)
****Stage 0 average time 0.0164196109772
****Stage 1 average time 0.0093201842308
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983304343127
****DCGs @ 8: 0.971565213028
****DCGs @ 16: 0.949614259891
****DCGs @ 32: 0.924486024057
****DCGs @ 64: 0.879744717784
****Error : 0.356294921875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.8184919357
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.02110416829586029, 0.02401554584503173)
('****Total time: ', 0.027851096510887147, 0.031302225589752194)
('****Preprocess time: ', 0.0035356900691986084, 0.00419439077377319)
('****Data time: ', 0.00041407060623168947, 0.00047115087509155254)
('****Fetch time: ', 5.5299878120422364e-05, 6.198883056640625e-05)
('****Sort time: ', 0.0006794153451919556, 0.0007369518280029297)
****Stage 0 average time 0.0163505427837
****Stage 1 average time 0.00943810141087
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.982941025566
****DCGs @ 8: 0.971408415416
****DCGs @ 16: 0.949463770827
****DCGs @ 32: 0.924436593802
****DCGs @ 64: 0.879785036046
****Error : 0.356293945313
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.6545059681
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.02074338698387146, 0.02379451990127563)
('****Total time: ', 0.02758095633983612, 0.0311355710029602)
('****Preprocess time: ', 0.003493009924888611, 0.003897047042846679)
('****Data time: ', 0.0004106649160385132, 0.0004589676856994628)
('****Fetch time: ', 5.348527431488037e-05, 6.103515625e-05)
('****Sort time: ', 0.0007116719484329224, 0.0007391095161437988)
****Stage 0 average time 0.0160890902281
****Stage 1 average time 0.00932312881947
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983381011673
****DCGs @ 8: 0.971412510383
****DCGs @ 16: 0.949408298626
****DCGs @ 32: 0.924349417226
****DCGs @ 64: 0.8797135507
****Error : 0.356293945313
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.9396641254
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.020684587836265565, 0.02389287948608398)
('****Total time: ', 0.027494987964630128, 0.031062340736389155)
('****Preprocess time: ', 0.003474732041358948, 0.003925347328186032)
('****Data time: ', 0.0004083794355392456, 0.00045778751373291)
('****Fetch time: ', 5.423450469970703e-05, 6.079673767089844e-05)
('****Sort time: ', 0.0006766482591629028, 0.000734126567840576)
****Stage 0 average time 0.0159477418661
****Stage 1 average time 0.00935084021091
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983518953313
****DCGs @ 8: 0.97156907249
****DCGs @ 16: 0.949482200877
****DCGs @ 32: 0.924475448898
****DCGs @ 64: 0.879913765478
****Error : 0.356271484375
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  13.022906065
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011297160267829894, 0.011941981315612794)
('****Total time: ', 5.510645535349846, 10.46413196325302)
('****Preprocess time: ', 0.003150676727294922, 0.0032491683959960938)
('****Data time: ', 0.0002995126247406006, 0.0003211498260498047)
('****Fetch time: ', 6.711554527282715e-05, 7.295608520507812e-05)
('****Sort time: ', 0.0006503764390945434, 0.0006890296936035156)
****Stage 0 average time 0.00669475698471
****Stage 1 average time 0.00877008461952
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983681191933
****DCGs @ 8: 0.971627538235
****DCGs @ 16: 0.949358941344
****DCGs @ 32: 0.924486984785
****DCGs @ 64: 0.879887263953
****Error : 0.356268554688
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.8741500378
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.011235651969909667, 0.01186232566833496)
('****Total time: ', 4.956715458273887, 9.39292833805084)
('****Preprocess time: ', 0.003111615777015686, 0.0032160282135009766)
('****Data time: ', 0.00029930901527404786, 0.0003170967102050781)
('****Fetch time: ', 6.669604778289795e-05, 7.414817810058594e-05)
('****Sort time: ', 0.0006573058366775513, 0.0006847381591796875)
****Stage 0 average time 0.00662839257717
****Stage 1 average time 0.00874218606949
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983059547046
****DCGs @ 8: 0.971575943227
****DCGs @ 16: 0.949579104731
****DCGs @ 32: 0.924432376386
****DCGs @ 64: 0.879787774651
****Error : 0.356284179687
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.9628021717
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011290714621543884, 0.012035155296325682)
('****Total time: ', 4.430395933747292, 8.46202677488327)
('****Preprocess time: ', 0.0031443549394607542, 0.0032382249832153317)
('****Data time: ', 0.0002996995449066162, 0.0003199577331542969)
('****Fetch time: ', 6.738197803497314e-05, 7.581710815429688e-05)
('****Sort time: ', 0.0006589183807373047, 0.0006852149963378906)
****Stage 0 average time 0.00667353391647
****Stage 1 average time 0.00878753554821
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983184315341
****DCGs @ 8: 0.971361659787
****DCGs @ 16: 0.949376690542
****DCGs @ 32: 0.92429871986
****DCGs @ 64: 0.879660926258
****Error : 0.356318359375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.8162140846
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.01155309534072876, 0.013527023792266845)
('****Total time: ', 3.815256769180298, 7.337758004665374)
('****Preprocess time: ', 0.0031195459365844728, 0.003500986099243164)
('****Data time: ', 0.0003009916543960571, 0.00032520294189453125)
('****Fetch time: ', 6.934332847595214e-05, 7.796287536621094e-05)
('****Sort time: ', 0.0006647640466690063, 0.0007851123809814453)
****Stage 0 average time 0.0065961278677
****Stage 1 average time 0.00911161243916
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983344936861
****DCGs @ 8: 0.971474388255
****DCGs @ 16: 0.949442503258
****DCGs @ 32: 0.924560675631
****DCGs @ 64: 0.879898495724
****Error : 0.356262695312
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.8875739574
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.011595636963844299, 0.013597464561462401)
('****Total time: ', 2.8220220054388045, 5.439343380928039)
('****Preprocess time: ', 0.0031161328554153442, 0.00341522693634033)
('****Data time: ', 0.00030753231048583985, 0.0003521442413330078)
('****Fetch time: ', 7.282483577728271e-05, 7.867813110351562e-05)
('****Sort time: ', 0.0006640472412109375, 0.0008090019226074216)
****Stage 0 average time 0.00662522482872
****Stage 1 average time 0.00913094937801
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983265255701
****DCGs @ 8: 0.971611378421
****DCGs @ 16: 0.949512797635
****DCGs @ 32: 0.924485846143
****DCGs @ 64: 0.879743798917
****Error : 0.356274414062
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.7154757977
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.011451863884925842, 0.01304079294204712)
('****Total time: ', 1.7181197445392609, 3.3554909110069264)
('****Preprocess time: ', 0.003078901171684265, 0.0031910419464111326)
('****Data time: ', 0.00029455316066741944, 0.0003170967102050781)
('****Fetch time: ', 6.92594051361084e-05, 7.724761962890625e-05)
('****Sort time: ', 0.0006487483978271484, 0.0006859898567199704)
****Stage 0 average time 0.00654044938087
****Stage 1 average time 0.00900287663937
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983328393003
****DCGs @ 8: 0.971534468948
****DCGs @ 16: 0.949541559704
****DCGs @ 32: 0.924452653327
****DCGs @ 64: 0.879756992398
****Error : 0.356325195313
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.1777179241
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01176294183731079, 0.013638329505920409)
('****Total time: ', 0.9877831103801727, 1.9025470733642578)
('****Preprocess time: ', 0.003182266116142273, 0.003337061405181884)
('****Data time: ', 0.00031855559349060057, 0.0003566861152648925)
('****Fetch time: ', 6.94671869277954e-05, 7.700920104980469e-05)
('****Sort time: ', 0.0006500412225723266, 0.0007030963897705078)
****Stage 0 average time 0.0067775759697
****Stage 1 average time 0.00920569598675
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.982858468105
****DCGs @ 8: 0.97122910658
****DCGs @ 16: 0.949355916643
****DCGs @ 32: 0.924341899266
****DCGs @ 64: 0.879720734202
****Error : 0.3562578125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.5844130516
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.011579383730888366, 0.012745869159698487)
('****Total time: ', 0.023492151498794557, 0.0358382225036621)
('****Preprocess time: ', 0.0031228495836257936, 0.0032077074050903317)
('****Data time: ', 0.00030540716648101804, 0.00034717321395874004)
('****Fetch time: ', 6.750977039337158e-05, 7.390975952148438e-05)
('****Sort time: ', 0.0006381779909133911, 0.0006909370422363281)
****Stage 0 average time 0.00665431010723
****Stage 1 average time 0.00905901813507
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983691710564
****DCGs @ 8: 0.971768554883
****DCGs @ 16: 0.949526034884
****DCGs @ 32: 0.924570754671
****DCGs @ 64: 0.879897137766
****Error : 0.35631640625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.5479938984
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01174298095703125, 0.01306986808776855)
('****Total time: ', 0.018645870447158812, 0.02284839153289794)
('****Preprocess time: ', 0.003123693227767944, 0.0032198429107666016)
('****Data time: ', 0.000319225549697876, 0.0003561973571777344)
('****Fetch time: ', 6.898868083953858e-05, 7.416009902954095e-05)
('****Sort time: ', 0.0006429533958435059, 0.0007030963897705078)
****Stage 0 average time 0.00674528348446
****Stage 1 average time 0.00915255832672
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983304343127
****DCGs @ 8: 0.971565213028
****DCGs @ 16: 0.949614259891
****DCGs @ 32: 0.924486024057
****DCGs @ 64: 0.879744720897
****Error : 0.356294921875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.6005218029
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.011843976974487304, 0.013930308818817136)
('****Total time: ', 0.017866266012191774, 0.02049204111099243)
('****Preprocess time: ', 0.003148257851600647, 0.0034810185432434075)
('****Data time: ', 0.0003267178535461426, 0.00039105415344238255)
('****Fetch time: ', 6.955599784851074e-05, 7.700920104980469e-05)
('****Sort time: ', 0.0006434680223464966, 0.0007040977478027341)
****Stage 0 average time 0.00681405103207
****Stage 1 average time 0.00921792566776
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.982941025566
****DCGs @ 8: 0.971408415416
****DCGs @ 16: 0.949463770827
****DCGs @ 32: 0.924436593802
****DCGs @ 64: 0.879785094545
****Error : 0.356293945313
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.5452649593
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.011686810493469238, 0.01323304176330566)
('****Total time: ', 0.017703865051269533, 0.019608318805694577)
('****Preprocess time: ', 0.003099908709526062, 0.0032505512237548818)
('****Data time: ', 0.0003231099843978882, 0.0003650188446044922)
('****Fetch time: ', 6.872916221618653e-05, 7.581710815429688e-05)
('****Sort time: ', 0.0006404819488525391, 0.0006988048553466797)
****Stage 0 average time 0.00669759750366
****Stage 1 average time 0.0091214427948
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983381011673
****DCGs @ 8: 0.971412510383
****DCGs @ 16: 0.949408298626
****DCGs @ 32: 0.924349417226
****DCGs @ 64: 0.879713458966
****Error : 0.356293945313
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.6206660271
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.011355908751487733, 0.012723612785339353)
('****Total time: ', 0.017183735966682434, 0.018707811832427975)
('****Preprocess time: ', 0.003009443998336792, 0.0031422138214111323)
('****Data time: ', 0.00029880523681640624, 0.00032806396484375)
('****Fetch time: ', 6.884276866912842e-05, 7.605552673339844e-05)
('****Sort time: ', 0.000633849024772644, 0.000673067569732666)
****Stage 0 average time 0.00649165511131
****Stage 1 average time 0.00887519466877
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983518953313
****DCGs @ 8: 0.97156907249
****DCGs @ 16: 0.949482200877
****DCGs @ 32: 0.924475448898
****DCGs @ 64: 0.879913768591
****Error : 0.356271484375
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  10.5875840187
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.02144999372959137, 0.029558205604553196)
('****Total time: ', 4.040906056046486, 7.507195615768433)
('****Preprocess time: ', 0.004574573516845703, 0.0059149861335754395)
('****Data time: ', 0.00045160019397735596, 0.0005388379096984863)
('****Fetch time: ', 8.184993267059326e-05, 9.608268737792969e-05)
('****Sort time: ', 0.0008749041557312012, 0.0011167645454406737)
****Stage 0 average time 0.0219658179283
****Stage 1 average time 0.0054671036005
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983597128165
****DCGs @ 8: 0.971674797376
****DCGs @ 16: 0.949364184945
****DCGs @ 32: 0.92458517052
****DCGs @ 64: 0.879939888054
****Error : 0.292595214844
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.8494501114
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.019318873643875124, 0.025992989540100087)
('****Total time: ', 3.7994791132211687, 7.032054197788238)
('****Preprocess time: ', 0.004257592678070068, 0.005560231208801268)
('****Data time: ', 0.00041743004322052004, 0.0004940032958984375)
('****Fetch time: ', 7.997798919677734e-05, 9.421110153198223e-05)
('****Sort time: ', 0.0008676482439041138, 0.001013040542602539)
****Stage 0 average time 0.0193403648138
****Stage 1 average time 0.00560115778446
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.982975483277
****DCGs @ 8: 0.971572660626
****DCGs @ 16: 0.949577126256
****DCGs @ 32: 0.924413313918
****DCGs @ 64: 0.879860254333
****Error : 0.292583984375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.8255779743
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.018742607593536378, 0.024726021289825414)
('****Total time: ', 3.279081076860428, 6.003741526603697)
('****Preprocess time: ', 0.004132061362266541, 0.0052628636360168455)
('****Data time: ', 0.0004094623327255249, 0.00047307014465332005)
('****Fetch time: ', 7.819569110870361e-05, 9.084939956665033e-05)
('****Sort time: ', 0.0009023940563201904, 0.0011031985282897946)
****Stage 0 average time 0.01867520082
****Stage 1 average time 0.00558952021599
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983016187805
****DCGs @ 8: 0.97140274344
****DCGs @ 16: 0.949334415509
****DCGs @ 32: 0.924300161539
****DCGs @ 64: 0.879710722312
****Error : 0.292600585937
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.6471920013
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.01828243613243103, 0.02313199043273925)
('****Total time: ', 2.6302060452699663, 4.889894115924833)
('****Preprocess time: ', 0.004038965940475464, 0.005067229270935057)
('****Data time: ', 0.00039878833293914795, 0.0004470348358154297)
('****Fetch time: ', 7.54859447479248e-05, 8.511543273925781e-05)
('****Sort time: ', 0.0008779658079147339, 0.0009871006011962888)
****Stage 0 average time 0.0181660830975
****Stage 1 average time 0.00550755906105
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983260873092
****DCGs @ 8: 0.971521647397
****DCGs @ 16: 0.949448143342
****DCGs @ 32: 0.924650267304
****DCGs @ 64: 0.879941274337
****Error : 0.29259765625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.6130559444
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.01791792333126068, 0.021848583221435545)
('****Total time: ', 1.562984854578972, 2.8900600314140314)
('****Preprocess time: ', 0.003988109707832336, 0.004568600654602048)
('****Data time: ', 0.00039261484146118166, 0.00043582916259765625)
('****Fetch time: ', 7.379603385925294e-05, 8.296966552734375e-05)
('****Sort time: ', 0.0008697457313537598, 0.000982046127319336)
****Stage 0 average time 0.0177580903769
****Stage 1 average time 0.00548409926891
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983181191933
****DCGs @ 8: 0.971602310046
****DCGs @ 16: 0.94948678939
****DCGs @ 32: 0.924444471795
****DCGs @ 64: 0.879820682801
****Error : 0.292583007813
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.580919981
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.017793715834617616, 0.021708738803863526)
('****Total time: ', 0.4527568097114563, 0.8781059384346005)
('****Preprocess time: ', 0.0039766494035720825, 0.004441034793853759)
('****Data time: ', 0.0003862776756286621, 0.0004303455352783203)
('****Fetch time: ', 7.283103466033936e-05, 8.177757263183594e-05)
('****Sort time: ', 0.0008719283342361451, 0.0010040402412414546)
****Stage 0 average time 0.0176209356785
****Stage 1 average time 0.00548046660423
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983160265466
****DCGs @ 8: 0.971578445488
****DCGs @ 16: 0.949542906759
****DCGs @ 32: 0.924465664255
****DCGs @ 64: 0.879807926332
****Error : 0.292595703125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.4481790066
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.018068301677703857, 0.02236922979354858)
('****Total time: ', 0.032305474400520326, 0.04695690870285034)
('****Preprocess time: ', 0.003986149549484253, 0.004726874828338613)
('****Data time: ', 0.0003871488571166992, 0.0004360675811767578)
('****Fetch time: ', 7.35774040222168e-05, 8.487701416015625e-05)
('****Sort time: ', 0.0008817846775054932, 0.0009958863258361815)
****Stage 0 average time 0.0178953390121
****Stage 1 average time 0.00550162315369
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.982774404337
****DCGs @ 8: 0.971272489929
****DCGs @ 16: 0.949316301487
****DCGs @ 32: 0.924397123499
****DCGs @ 64: 0.87976085215
****Error : 0.292609863281
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.7779819965
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.01744520080089569, 0.020809400081634517)
('****Total time: ', 0.026236869812011718, 0.03271188735961912)
('****Preprocess time: ', 0.003902547240257263, 0.004204082489013672)
('****Data time: ', 0.0003799939155578613, 0.0004279613494873047)
('****Fetch time: ', 7.327830791473388e-05, 8.392333984375e-05)
('****Sort time: ', 0.0008679996728897095, 0.0010021209716796872)
****Stage 0 average time 0.0171972653866
****Stage 1 average time 0.00547175455093
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983607646796
****DCGs @ 8: 0.971763362301
****DCGs @ 16: 0.949503248914
****DCGs @ 32: 0.924563431506
****DCGs @ 64: 0.879976424028
****Error : 0.292601074219
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.7783949375
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017160990953445435, 0.019823968410491933)
('****Total time: ', 0.024801240205764772, 0.028214764595031725)
('****Preprocess time: ', 0.0038702378273010253, 0.004094219207763671)
('****Data time: ', 0.00038016319274902343, 0.00043010711669921875)
('****Fetch time: ', 7.282674312591552e-05, 7.987022399902344e-05)
('****Sort time: ', 0.0008629387617111206, 0.0010028004646301268)
****Stage 0 average time 0.0168683609962
****Stage 1 average time 0.00547879648209
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983220279359
****DCGs @ 8: 0.971614732017
****DCGs @ 16: 0.949639100661
****DCGs @ 32: 0.924530744928
****DCGs @ 64: 0.879801434947
****Error : 0.292616210938
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.840775013
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.016721702694892884, 0.01925927400588989)
('****Total time: ', 0.023787787318229676, 0.02673131227493286)
('****Preprocess time: ', 0.0038203980922698975, 0.004041910171508789)
('****Data time: ', 0.0003726232051849365, 0.00042510032653808594)
('****Fetch time: ', 7.026517391204834e-05, 7.700920104980469e-05)
('****Sort time: ', 0.00083885657787323, 0.0009220123291015622)
****Stage 0 average time 0.0164243689775
****Stage 1 average time 0.00539947676659
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.98277289803
****DCGs @ 8: 0.971443363428
****DCGs @ 16: 0.949439298141
****DCGs @ 32: 0.924478542527
****DCGs @ 64: 0.879834357865
****Error : 0.292599121094
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.6496880054
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.017367356777191163, 0.019675350189208973)
('****Total time: ', 0.024771307706832887, 0.02743356227874755)
('****Preprocess time: ', 0.003990322113037109, 0.004142045974731445)
('****Data time: ', 0.0004185450077056885, 0.0004520416259765625)
('****Fetch time: ', 7.592141628265381e-05, 8.392333984375e-05)
('****Sort time: ', 0.000888651728630066, 0.0009632110595703125)
****Stage 0 average time 0.0170706260204
****Stage 1 average time 0.00567017102242
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983296947905
****DCGs @ 8: 0.971410210687
****DCGs @ 16: 0.949364863072
****DCGs @ 32: 0.92433236295
****DCGs @ 64: 0.879792743195
****Error : 0.292582519531
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  31.8078291416
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.017210880041122437, 0.019190096855163572)
('****Total time: ', 0.024463499546051027, 0.026733207702636718)
('****Preprocess time: ', 0.003986505389213562, 0.004165291786193845)
('****Data time: ', 0.0004133692979812622, 0.0004451632499694822)
('****Fetch time: ', 7.459187507629394e-05, 8.0108642578125e-05)
('****Sort time: ', 0.0008974683284759522, 0.0010662436485290526)
****Stage 0 average time 0.0169170998335
****Stage 1 average time 0.00566571509838
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983434889544
****DCGs @ 8: 0.971616331632
****DCGs @ 16: 0.949508306949
****DCGs @ 32: 0.924541589862
****DCGs @ 64: 0.879965243185
****Error : 0.292599609375
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  2.83683109283
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.037080297112464904, 0.050525760650634764)
('****Total time: ', 0.27712518465518954, 0.43677670955657955)
('****Preprocess time: ', 0.0052282711267471315, 0.007529020309448242)
('****Data time: ', 0.0005836669206619263, 0.0007479190826416016)
('****Fetch time: ', 8.877503871917724e-05, 0.0001010894775390625)
('****Sort time: ', 0.0011634923219680786, 0.0016579627990722656)
****Stage 0 average time 0.0222507029772
****Stage 1 average time 0.0218937995434
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983597128165
****DCGs @ 8: 0.971674797376
****DCGs @ 16: 0.949364184945
****DCGs @ 32: 0.92458517052
****DCGs @ 64: 0.879939888054
****Error : 0.292595214844
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  3.7225561142
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.0339535391330719, 0.044922256469726564)
('****Total time: ', 0.043764414072036746, 0.056049728393554675)
('****Preprocess time: ', 0.004947518229484558, 0.006728041172027587)
('****Data time: ', 0.0005567466020584106, 0.0006678700447082516)
('****Fetch time: ', 7.90942907333374e-05, 8.797645568847656e-05)
('****Sort time: ', 0.001013765811920166, 0.0014024138450622558)
****Stage 0 average time 0.0204285181761
****Stage 1 average time 0.0201221458912
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.982975483277
****DCGs @ 8: 0.971572660626
****DCGs @ 16: 0.949577126256
****DCGs @ 32: 0.924413313918
****DCGs @ 64: 0.879860254333
****Error : 0.292583984375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.60713601112
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.031540061116218564, 0.03941534757614134)
('****Total time: ', 0.040421110033988954, 0.04997966289520263)
('****Preprocess time: ', 0.004688435196876526, 0.006238114833831785)
('****Data time: ', 0.0005167007446289062, 0.0006010532379150391)
('****Fetch time: ', 7.406723499298096e-05, 8.296966552734375e-05)
('****Sort time: ', 0.000983934998512268, 0.0013180255889892576)
****Stage 0 average time 0.0190448660851
****Stage 1 average time 0.0187583332062
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983016187805
****DCGs @ 8: 0.97140274344
****DCGs @ 16: 0.949334415509
****DCGs @ 32: 0.924300161539
****DCGs @ 64: 0.879710722312
****Error : 0.292600585937
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.73504590988
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.030173731088638307, 0.03692355155944824)
('****Total time: ', 0.03871649396419525, 0.04633388519287107)
('****Preprocess time: ', 0.004532049894332885, 0.005877566337585441)
('****Data time: ', 0.000509114146232605, 0.000579845905303955)
('****Fetch time: ', 6.714379787445069e-05, 7.796287536621094e-05)
('****Sort time: ', 0.0009698768854141236, 0.0012390613555908203)
****Stage 0 average time 0.0184122825861
****Stage 1 average time 0.0178396332264
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983260873092
****DCGs @ 8: 0.971521647397
****DCGs @ 16: 0.949448143342
****DCGs @ 32: 0.924650267304
****DCGs @ 64: 0.879941274337
****Error : 0.29259765625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.75156807899
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.02929265260696411, 0.03561077117919922)
('****Total time: ', 0.03771734607219696, 0.04540094137191772)
('****Preprocess time: ', 0.004501036643981934, 0.005950272083282464)
('****Data time: ', 0.00049305260181427, 0.0005629062652587891)
('****Fetch time: ', 6.423020362854004e-05, 7.510185241699219e-05)
('****Sort time: ', 0.0009637120962142945, 0.0011321067810058589)
****Stage 0 average time 0.0179088151455
****Stage 1 average time 0.0174058690071
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983181191933
****DCGs @ 8: 0.971602310046
****DCGs @ 16: 0.94948678939
****DCGs @ 32: 0.924444471795
****DCGs @ 64: 0.879820682801
****Error : 0.292583007813
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.70885705948
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.02948898673057556, 0.03639378547668455)
('****Total time: ', 0.037684136748313904, 0.04562311172485351)
('****Preprocess time: ', 0.004535282969474793, 0.006336712837219235)
('****Data time: ', 0.0004930913448333741, 0.0005638599395751953)
('****Fetch time: ', 6.476104259490967e-05, 7.605552673339844e-05)
('****Sort time: ', 0.0009595528841018677, 0.0011819005012512205)
****Stage 0 average time 0.0182094756365
****Stage 1 average time 0.0173321993351
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983160265466
****DCGs @ 8: 0.971578445488
****DCGs @ 16: 0.949542906759
****DCGs @ 32: 0.924465664255
****DCGs @ 64: 0.879807926332
****Error : 0.292595703125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.6832399368
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.027931531190872192, 0.032635939121246335)
('****Total time: ', 0.03594357907772064, 0.04135924577713012)
('****Preprocess time: ', 0.004332350373268128, 0.0053541421890258775)
('****Data time: ', 0.00047979521751403807, 0.0005481600761413572)
('****Fetch time: ', 6.161975860595703e-05, 7.104873657226562e-05)
('****Sort time: ', 0.0009508044719696045, 0.0011311054229736326)
****Stage 0 average time 0.0173342932463
****Stage 1 average time 0.016421807766
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.982774404337
****DCGs @ 8: 0.971272489929
****DCGs @ 16: 0.949316301487
****DCGs @ 32: 0.924397123499
****DCGs @ 64: 0.87976085215
****Error : 0.292609863281
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.5515580177
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.02751441764831543, 0.03196556568145751)
('****Total time: ', 0.03537902820110321, 0.04037908315658569)
('****Preprocess time: ', 0.004284134030342102, 0.005079817771911621)
('****Data time: ', 0.00047740721702575685, 0.0005431175231933594)
('****Fetch time: ', 5.9958815574645997e-05, 7.009506225585938e-05)
('****Sort time: ', 0.0009438462257385253, 0.0010521888732910154)
****Stage 0 average time 0.0168669804335
****Stage 1 average time 0.0164127835035
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983607646796
****DCGs @ 8: 0.971763362301
****DCGs @ 16: 0.949503248914
****DCGs @ 32: 0.924563431506
****DCGs @ 64: 0.879976424028
****Error : 0.292601074219
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.7822449207
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.02777051329612732, 0.03262792825698852)
('****Total time: ', 0.03579357182979584, 0.04132237434387205)
('****Preprocess time: ', 0.004301944851875305, 0.005211079120635985)
('****Data time: ', 0.00047837233543396, 0.000541698932647705)
('****Fetch time: ', 6.196284294128418e-05, 7.104873657226562e-05)
('****Sort time: ', 0.0009608120918273926, 0.0011608600616455078)
****Stage 0 average time 0.0170678005219
****Stage 1 average time 0.0165058048964
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983220279359
****DCGs @ 8: 0.971614732017
****DCGs @ 16: 0.949639100661
****DCGs @ 32: 0.924530744928
****DCGs @ 64: 0.879801434947
****Error : 0.292616210938
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.8906259537
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.0277052321434021, 0.032447409629821775)
('****Total time: ', 0.03567831015586853, 0.04106928110122679)
('****Preprocess time: ', 0.004329288363456726, 0.005441296100616453)
('****Data time: ', 0.0004824864864349365, 0.0005393266677856444)
('****Fetch time: ', 5.95473051071167e-05, 6.890296936035156e-05)
('****Sort time: ', 0.000950657844543457, 0.0010994672775268546)
****Stage 0 average time 0.017196762085
****Stage 1 average time 0.016330450058
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.98277289803
****DCGs @ 8: 0.971443363428
****DCGs @ 16: 0.949439298141
****DCGs @ 32: 0.924478542527
****DCGs @ 64: 0.879834357865
****Error : 0.292599121094
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.6742520332
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.02719811975955963, 0.030864799022674555)
('****Total time: ', 0.0350445431470871, 0.039058578014373777)
('****Preprocess time: ', 0.004212730050086975, 0.00478825569152832)
('****Data time: ', 0.0004710659980773926, 0.0005250453948974607)
('****Fetch time: ', 5.87608814239502e-05, 6.699562072753906e-05)
('****Sort time: ', 0.0009584789276123047, 0.001116037368774414)
****Stage 0 average time 0.0167225304842
****Stage 1 average time 0.0161766251326
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983296947905
****DCGs @ 8: 0.971410210687
****DCGs @ 16: 0.949364863072
****DCGs @ 32: 0.92433236295
****DCGs @ 64: 0.879792743195
****Error : 0.292582519531
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.7680380344
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.027402933716773988, 0.0327039361000061)
('****Total time: ', 0.03516646659374237, 0.04115504026412963)
('****Preprocess time: ', 0.004272811770439148, 0.005122244358062742)
('****Data time: ', 0.00046953833103179933, 0.0005240440368652344)
('****Fetch time: ', 5.850470066070557e-05, 6.604194641113281e-05)
('****Sort time: ', 0.0009415161609649658, 0.0009961485862731933)
****Stage 0 average time 0.0169336535931
****Stage 1 average time 0.0162116510868
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983434889544
****DCGs @ 8: 0.971616331632
****DCGs @ 16: 0.949508306949
****DCGs @ 32: 0.924541589862
****DCGs @ 64: 0.879965243185
****Error : 0.292599609375
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  13.3542449474
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01820081865787506, 0.022360587120056147)
('****Total time: ', 5.7602483884096145, 10.767119514942168)
('****Preprocess time: ', 0.0038695559501647947, 0.004614901542663573)
('****Data time: ', 0.0003585275411605835, 0.00041413307189941406)
('****Fetch time: ', 7.68507719039917e-05, 8.392333984375e-05)
('****Sort time: ', 0.0009548616409301758, 0.0011751651763916016)
****Stage 0 average time 0.00697034728527
****Stage 1 average time 0.0164902672768
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983597128165
****DCGs @ 8: 0.971674797376
****DCGs @ 16: 0.949364184945
****DCGs @ 32: 0.92458517052
****DCGs @ 64: 0.879939866322
****Error : 0.292595214844
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.0441539288
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.01769327175617218, 0.019379699230194086)
('****Total time: ', 5.5237232075929645, 10.481562507152555)
('****Preprocess time: ', 0.0039649102687835695, 0.004075086116790771)
('****Data time: ', 0.00041502702236175535, 0.0004489421844482422)
('****Fetch time: ', 7.935130596160889e-05, 8.606910705566406e-05)
('****Sort time: ', 0.0009796247482299805, 0.0012265682220458938)
****Stage 0 average time 0.0073088157177
****Stage 1 average time 0.0158233693838
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.982975483277
****DCGs @ 8: 0.971572660626
****DCGs @ 16: 0.949577126256
****DCGs @ 32: 0.924413313918
****DCGs @ 64: 0.879860232602
****Error : 0.292583984375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.445376873
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01825061082839966, 0.02119908332824707)
('****Total time: ', 5.69234481883049, 10.813377547264098)
('****Preprocess time: ', 0.003995623707771301, 0.004236984252929688)
('****Data time: ', 0.0004245268106460571, 0.0004608750343322753)
('****Fetch time: ', 8.503520488739014e-05, 9.299516677856439e-05)
('****Sort time: ', 0.0009720464944839478, 0.001159226894378662)
****Stage 0 average time 0.00798394322395
****Stage 1 average time 0.0157438998222
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983016187805
****DCGs @ 8: 0.97140274344
****DCGs @ 16: 0.949334415509
****DCGs @ 32: 0.924300161539
****DCGs @ 64: 0.879710722312
****Error : 0.292600585937
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.6657910347
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.01802226483821869, 0.021431374549865722)
('****Total time: ', 4.907461498022079, 9.080577743053436)
('****Preprocess time: ', 0.003968643069267273, 0.004219090938568115)
('****Data time: ', 0.0004180551767349243, 0.00045108795166015625)
('****Fetch time: ', 8.109235763549804e-05, 8.988380432128906e-05)
('****Sort time: ', 0.0009743127822875976, 0.0011670589447021484)
****Stage 0 average time 0.00760766851902
****Stage 1 average time 0.0158566997051
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983260873092
****DCGs @ 8: 0.971521647397
****DCGs @ 16: 0.949448143342
****DCGs @ 32: 0.924650267304
****DCGs @ 64: 0.879941252605
****Error : 0.29259765625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.8002481461
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.017627023339271547, 0.020572352409362792)
('****Total time: ', 3.2501416100263594, 6.151312613487243)
('****Preprocess time: ', 0.003921295523643494, 0.0042453289031982415)
('****Data time: ', 0.0004002953767776489, 0.00043728351593017565)
('****Fetch time: ', 7.618772983551026e-05, 8.296966552734375e-05)
('****Sort time: ', 0.000984043002128601, 0.0011834025382995597)
****Stage 0 average time 0.00719978833199
****Stage 1 average time 0.0158090566397
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983181191933
****DCGs @ 8: 0.971602310046
****DCGs @ 16: 0.94948678939
****DCGs @ 32: 0.924444471795
****DCGs @ 64: 0.879820661069
****Error : 0.292583007813
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.701004982
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.017376162886619567, 0.02000877857208251)
('****Total time: ', 2.1515259901285173, 4.172774839401244)
('****Preprocess time: ', 0.003917422652244568, 0.004164314270019531)
('****Data time: ', 0.0003986126184463501, 0.00043392181396484375)
('****Fetch time: ', 7.586121559143066e-05, 8.392333984375e-05)
('****Sort time: ', 0.0009588680267333985, 0.0010232925415039062)
****Stage 0 average time 0.00713598978519
****Stage 1 average time 0.0155909376144
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983160265466
****DCGs @ 8: 0.971578445488
****DCGs @ 16: 0.949542906759
****DCGs @ 32: 0.924465664255
****DCGs @ 64: 0.879807926332
****Error : 0.292595703125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.6901259422
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01745486843585968, 0.01995311975479126)
('****Total time: ', 1.2035051665306091, 2.323198616504669)
('****Preprocess time: ', 0.003919174909591675, 0.004152929782867431)
('****Data time: ', 0.0003998578786849976, 0.00043201446533203125)
('****Fetch time: ', 7.614076137542725e-05, 8.227825164794909e-05)
('****Sort time: ', 0.000985136866569519, 0.0011899471282958984)
****Stage 0 average time 0.00714169108868
****Stage 1 average time 0.0156934877634
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.982774404337
****DCGs @ 8: 0.971272489929
****DCGs @ 16: 0.949316301487
****DCGs @ 32: 0.924397123499
****DCGs @ 64: 0.879760830419
****Error : 0.292609863281
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.9510660172
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.01787900710105896, 0.021565699577331544)
('****Total time: ', 0.2786907931566238, 0.6200142025947567)
('****Preprocess time: ', 0.004001955270767212, 0.004813623428344723)
('****Data time: ', 0.000397355318069458, 0.0004439353942871094)
('****Fetch time: ', 7.549917697906494e-05, 8.774995803833001e-05)
('****Sort time: ', 0.0009794294834136962, 0.0012059211730957031)
****Stage 0 average time 0.00721989548206
****Stage 1 average time 0.0161133508682
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983607646796
****DCGs @ 8: 0.971763362301
****DCGs @ 16: 0.949503248914
****DCGs @ 32: 0.924563431506
****DCGs @ 64: 0.879976424028
****Error : 0.292601074219
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.3892591
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017898842930793763, 0.02107772827148437)
('****Total time: ', 0.02636976385116577, 0.03307138681411743)
('****Preprocess time: ', 0.0038488720655441284, 0.004395103454589843)
('****Data time: ', 0.000376622200012207, 0.0004611015319824219)
('****Fetch time: ', 7.630860805511475e-05, 8.487701416015625e-05)
('****Sort time: ', 0.0009670860767364502, 0.00115586519241333)
****Stage 0 average time 0.00693501245975
****Stage 1 average time 0.0162327194214
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983220279359
****DCGs @ 8: 0.971614732017
****DCGs @ 16: 0.949639100661
****DCGs @ 32: 0.924530744928
****DCGs @ 64: 0.879801413215
****Error : 0.292616210938
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.5537810326
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.017618730783462523, 0.020699274539947507)
('****Total time: ', 0.024928968906402588, 0.028511285781860338)
('****Preprocess time: ', 0.003783249855041504, 0.004160535335540771)
('****Data time: ', 0.0003820410966873169, 0.00047278404235839844)
('****Fetch time: ', 7.498908042907715e-05, 8.53776931762694e-05)
('****Sort time: ', 0.0009850634336471557, 0.001107978820800781)
****Stage 0 average time 0.00695879924297
****Stage 1 average time 0.0158852750063
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.98277289803
****DCGs @ 8: 0.971443363428
****DCGs @ 16: 0.949439298141
****DCGs @ 32: 0.924478542527
****DCGs @ 64: 0.879834336133
****Error : 0.292599121094
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.2949800491
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.017557613492012025, 0.02078299522399902)
('****Total time: ', 0.024589728951454164, 0.028121089935302733)
('****Preprocess time: ', 0.0037670093774795532, 0.004116058349609375)
('****Data time: ', 0.00037611818313598635, 0.0004580497741699216)
('****Fetch time: ', 7.484018802642822e-05, 8.296966552734375e-05)
('****Sort time: ', 0.0009281769990921021, 0.0009971141815185544)
****Stage 0 average time 0.00692871749401
****Stage 1 average time 0.0157750407457
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983296947905
****DCGs @ 8: 0.971410210687
****DCGs @ 16: 0.949364863072
****DCGs @ 32: 0.92433236295
****DCGs @ 64: 0.879792743195
****Error : 0.292582519531
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.4159111977
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.017316761732101442, 0.02038494348526001)
('****Total time: ', 0.024260655879974367, 0.02752430438995361)
('****Preprocess time: ', 0.00377433443069458, 0.00409388542175293)
('****Data time: ', 0.0003802615404129028, 0.0004640102386474607)
('****Fetch time: ', 7.595396041870117e-05, 8.369684219360345e-05)
('****Sort time: ', 0.000928386926651001, 0.0009871125221252437)
****Stage 0 average time 0.00701983654499
****Stage 1 average time 0.0154558620453
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983434889544
****DCGs @ 8: 0.971616331632
****DCGs @ 16: 0.949508306949
****DCGs @ 32: 0.924541589862
****DCGs @ 64: 0.879965221453
****Error : 0.292599609375
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  7.92561793327
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.028678181886672975, 0.040361011028289775)
('****Total time: ', 2.483594321846962, 4.415191853046418)
('****Preprocess time: ', 0.005326015949249268, 0.007741880416870113)
('****Data time: ', 0.000530794620513916, 0.0006499290466308594)
('****Fetch time: ', 9.427130222320556e-05, 0.00011614561080932598)
('****Sort time: ', 0.00061605966091156, 0.0008221149444580076)
****Stage 0 average time 0.0313902164698
****Stage 1 average time 0.00385510694981
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.57822179794
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.025304261922836305, 0.03384662866592403)
('****Total time: ', 1.9545412784814835, 3.480656802654266)
('****Preprocess time: ', 0.004784921526908874, 0.00685549974441528)
('****Data time: ', 0.00047416460514068605, 0.0005631446838378906)
('****Fetch time: ', 8.358466625213623e-05, 9.679794311523438e-05)
('****Sort time: ', 0.0005958232879638672, 0.0007398724555969235)
****Stage 0 average time 0.0275201468468
****Stage 1 average time 0.00372260916233
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.44050717354
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.02415536892414093, 0.029224312305450424)
('****Total time: ', 1.2673588345050812, 2.2860535621643066)
('****Preprocess time: ', 0.0045447183847427365, 0.006045794486999509)
('****Data time: ', 0.0004503662586212158, 0.0005359768867492675)
('****Fetch time: ', 8.053302764892577e-05, 9.393692016601562e-05)
('****Sort time: ', 0.0006128445863723754, 0.0007298111915588378)
****Stage 0 average time 0.0262102508545
****Stage 1 average time 0.00363358032703
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.44835400581
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.024267349123954774, 0.030157458782196035)
('****Total time: ', 0.6374245642423629, 1.212785232067108)
('****Preprocess time: ', 0.004545840501785278, 0.006052160263061523)
('****Data time: ', 0.0004442096948623657, 0.0005202531814575194)
('****Fetch time: ', 8.00778865814209e-05, 8.989572525024408e-05)
('****Sort time: ', 0.0005845775604248047, 0.0006887912750244141)
****Stage 0 average time 0.0262701966763
****Stage 1 average time 0.00365185809135
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.30643892288
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.023439070105552674, 0.026984012126922592)
('****Total time: ', 0.036208267211914065, 0.049706268310546815)
('****Preprocess time: ', 0.004434061408042908, 0.004845964908599853)
('****Data time: ', 0.00043929052352905274, 0.0005140304565429688)
('****Fetch time: ', 8.092737197875977e-05, 8.797645568847656e-05)
('****Sort time: ', 0.0005812805891036988, 0.0006559014320373535)
****Stage 0 average time 0.0252959941626
****Stage 1 average time 0.00367863583565
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.3243849277
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.023802639603614808, 0.030193281173706035)
('****Total time: ', 0.03358901953697205, 0.042905402183532705)
('****Preprocess time: ', 0.004501681804656982, 0.006006848812103262)
('****Data time: ', 0.0004491448402404785, 0.0005240440368652344)
('****Fetch time: ', 8.020007610321046e-05, 9.417533874511719e-05)
('****Sort time: ', 0.0005841820240020752, 0.0006549835205078122)
****Stage 0 average time 0.0255012505054
****Stage 1 average time 0.00391659784317
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.98898983
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.023407161831855774, 0.028202140331268312)
('****Total time: ', 0.03182915771007538, 0.03885892629623412)
('****Preprocess time: ', 0.004471433162689209, 0.005848205089569092)
('****Data time: ', 0.0004459238052368164, 0.0005181193351745604)
('****Fetch time: ', 7.93231725692749e-05, 9.179115295410156e-05)
('****Sort time: ', 0.0005761845111846924, 0.0006521105766296385)
****Stage 0 average time 0.0251551520824
****Stage 1 average time 0.00382487440109
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.3364567757
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.023172477722167968, 0.027029180526733396)
('****Total time: ', 0.031332198977470395, 0.0366363763809204)
('****Preprocess time: ', 0.004383432149887085, 0.00469900369644165)
('****Data time: ', 0.0004447067975997925, 0.0005159378051757812)
('****Fetch time: ', 7.914781570434571e-05, 9.012222290039062e-05)
('****Sort time: ', 0.00058292555809021, 0.0006392359733581541)
****Stage 0 average time 0.0248001077175
****Stage 1 average time 0.00386258232594
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.2648880482
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.022775646686553956, 0.026076483726501464)
('****Total time: ', 0.03042941617965698, 0.03438732624053955)
('****Preprocess time: ', 0.004338615417480469, 0.0046389222145080565)
('****Data time: ', 0.00044538962841033936, 0.000514984130859375)
('****Fetch time: ', 7.723712921142579e-05, 8.821487426757812e-05)
('****Sort time: ', 0.0005774134397506714, 0.0006351470947265625)
****Stage 0 average time 0.0243818479776
****Stage 1 average time 0.00383245432377
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.3850929737
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.02282181167602539, 0.027070152759552)
('****Total time: ', 0.030308531284332276, 0.035073792934417716)
('****Preprocess time: ', 0.004383643388748169, 0.0047465324401855455)
('****Data time: ', 0.00044362258911132815, 0.0005080699920654297)
('****Fetch time: ', 7.876622676849366e-05, 9.012222290039062e-05)
('****Sort time: ', 0.000581581950187683, 0.0006251335144042969)
****Stage 0 average time 0.0244284933805
****Stage 1 average time 0.00388093245029
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.2764749527
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.02273232614994049, 0.026482880115509033)
('****Total time: ', 0.030318758487701415, 0.03479759693145751)
('****Preprocess time: ', 0.004387072205543518, 0.004930102825164793)
('****Data time: ', 0.0004502581357955933, 0.0005109429359436035)
('****Fetch time: ', 7.830202579498291e-05, 9.012222290039062e-05)
('****Sort time: ', 0.0005834043025970459, 0.0006210923194885253)
****Stage 0 average time 0.0242730442286
****Stage 1 average time 0.00395831859112
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  32.5956521034
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.02231868350505829, 0.02570143938064575)
('****Total time: ', 0.0299996497631073, 0.03372474908828734)
('****Preprocess time: ', 0.00430181348323822, 0.004646122455596924)
('****Data time: ', 0.00044282519817352294, 0.0005130767822265625)
('****Fetch time: ', 7.567083835601807e-05, 8.58306884765625e-05)
('****Sort time: ', 0.000591636061668396, 0.0006189346313476562)
****Stage 0 average time 0.0238371806145
****Stage 1 average time 0.00389344847202
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  3.58500814438
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.027772570490837097, 0.03873847723007202)
('****Total time: ', 0.11623270404338837, 0.2015882134437561)
('****Preprocess time: ', 0.005195229053497314, 0.007705330848693845)
('****Data time: ', 0.0005213651657104492, 0.0006249070167541503)
('****Fetch time: ', 6.862258911132813e-05, 8.20159912109375e-05)
('****Sort time: ', 0.0006398012638092041, 0.0008862376213073729)
****Stage 0 average time 0.0283626089096
****Stage 1 average time 0.00583497965336
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.20988416672
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.026965003967285156, 0.03747800588607785)
('****Total time: ', 0.03671723473072052, 0.04868266582489013)
('****Preprocess time: ', 0.004915960073471069, 0.0071988701820373535)
('****Data time: ', 0.0005207602977752685, 0.0006229996681213378)
('****Fetch time: ', 6.733286380767822e-05, 8.20159912109375e-05)
('****Sort time: ', 0.0006020513772964477, 0.000734138488769531)
****Stage 0 average time 0.0281941310167
****Stage 1 average time 0.0048769775629
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.33403420448
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.02559534668922424, 0.03258899450302122)
('****Total time: ', 0.03470808267593384, 0.045081543922424305)
('****Preprocess time: ', 0.004734294414520264, 0.006821203231811524)
('****Data time: ', 0.0004925572872161865, 0.0005948662757873535)
('****Fetch time: ', 6.306672096252442e-05, 7.510185241699219e-05)
('****Sort time: ', 0.00059902024269104, 0.0007212519645690916)
****Stage 0 average time 0.0268177524805
****Stage 1 average time 0.00466653287411
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  6.27844309807
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.025167797327041625, 0.03247505426406858)
('****Total time: ', 0.033308818697929385, 0.041723346710205035)
('****Preprocess time: ', 0.004684926629066467, 0.0067251682281494135)
('****Data time: ', 0.0004761446714401245, 0.0005481719970703122)
('****Fetch time: ', 5.973362922668457e-05, 7.131099700927721e-05)
('****Sort time: ', 0.000596574068069458, 0.0007100582122802732)
****Stage 0 average time 0.0263860323429
****Stage 1 average time 0.00459914398193
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.35151410103
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.02367387056350708, 0.027467966079711914)
('****Total time: ', 0.031522146940231324, 0.03583462238311766)
('****Preprocess time: ', 0.004505673408508301, 0.005783677101135245)
('****Data time: ', 0.0004658902883529663, 0.0005300045013427734)
('****Fetch time: ', 5.5017948150634766e-05, 6.580352783203125e-05)
('****Sort time: ', 0.0005830916166305542, 0.0006761550903320312)
****Stage 0 average time 0.0248727654219
****Stage 1 average time 0.00441077840328
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.3931360245
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.023207929611206053, 0.026162111759185785)
('****Total time: ', 0.030955231904983522, 0.03464299440383911)
('****Preprocess time: ', 0.00441908848285675, 0.004923665523529048)
('****Data time: ', 0.0004619717597961426, 0.0005249977111816406)
('****Fetch time: ', 5.3175568580627443e-05, 6.29425048828125e-05)
('****Sort time: ', 0.0005811098814010621, 0.0006482839584350585)
****Stage 0 average time 0.0244200766087
****Stage 1 average time 0.00430319869518
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.5646140575
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.02269354498386383, 0.025717258453369137)
('****Total time: ', 0.03061688184738159, 0.034396135807037355)
('****Preprocess time: ', 0.004365179300308227, 0.004773175716400147)
('****Data time: ', 0.00045645380020141604, 0.0005221366882324219)
('****Fetch time: ', 5.1802635192871096e-05, 6.008148193359375e-05)
('****Sort time: ', 0.0006050626039505005, 0.0006490230560302732)
****Stage 0 average time 0.02388517344
****Stage 1 average time 0.00428686988354
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.4449648857
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.02310713267326355, 0.025986206531524655)
('****Total time: ', 0.031066745042800905, 0.03439726829528809)
('****Preprocess time: ', 0.0044196248054504395, 0.005134463310241696)
('****Data time: ', 0.0004556643962860107, 0.0005178451538085938)
('****Fetch time: ', 5.3279995918273925e-05, 6.29425048828125e-05)
('****Sort time: ', 0.0005936204195022583, 0.0006473422050476072)
****Stage 0 average time 0.0241568295956
****Stage 1 average time 0.00447249269485
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.3995919228
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.022954835772514344, 0.025651073455810545)
('****Total time: ', 0.030659964561462402, 0.03383178710937499)
('****Preprocess time: ', 0.004383656620979309, 0.004981100559234618)
('****Data time: ', 0.00045109891891479493, 0.000511205196380615)
('****Fetch time: ', 5.4831624031066896e-05, 6.29425048828125e-05)
('****Sort time: ', 0.0005862886905670166, 0.0006440043449401854)
****Stage 0 average time 0.0239397470951
****Stage 1 average time 0.0044909645319
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.3921079636
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.022552026629447938, 0.024894297122955315)
('****Total time: ', 0.03012740135192871, 0.03287094831466674)
('****Preprocess time: ', 0.004365100026130676, 0.004801118373870849)
('****Data time: ', 0.0004494525194168091, 0.0005068898200988769)
('****Fetch time: ', 5.2678465843200684e-05, 6.198883056640625e-05)
('****Sort time: ', 0.0005927492380142212, 0.0006368160247802734)
****Stage 0 average time 0.0235246959925
****Stage 1 average time 0.00448731088638
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.4686088562
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.022347549080848694, 0.02501806020736694)
('****Total time: ', 0.030163119435310363, 0.03326941728591919)
('****Preprocess time: ', 0.004292827963829041, 0.004586255550384522)
('****Data time: ', 0.0004495835304260254, 0.0005099773406982422)
('****Fetch time: ', 5.253851413726807e-05, 6.103515625e-05)
('****Sort time: ', 0.0005888583660125733, 0.0006308555603027344)
****Stage 0 average time 0.0234037407637
****Stage 1 average time 0.00432761669159
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  32.3863420486
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.021816853880882264, 0.024175202846527098)
('****Total time: ', 0.029408091306686403, 0.03214141130447387)
('****Preprocess time: ', 0.0042797656059265134, 0.0046160221099853516)
('****Data time: ', 0.00045190632343292234, 0.0005192756652832031)
('****Fetch time: ', 5.016231536865234e-05, 6.008148193359375e-05)
('****Sort time: ', 0.0006082432270050049, 0.0007258534431457514)
****Stage 0 average time 0.023065251112
****Stage 1 average time 0.00414168024063
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  16.337624073
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007709434509277344, 0.008376562595367423)
('****Total time: ', 7.006031308889389, 13.161334693431854)
('****Preprocess time: ', 0.0037012779712677, 0.0038600087165832518)
('****Data time: ', 0.0002930037975311279, 0.0003130912780761716)
('****Fetch time: ', 0.00013121402263641357, 0.0001392364501953125)
('****Sort time: ', 0.0005238282680511474, 0.0005629062652587891)
****Stage 0 average time 0.00834412491322
****Stage 1 average time 0.00401463365555
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.0324850082
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.007541593074798584, 0.007919216156005859)
('****Total time: ', 6.259081230640412, 11.897851109504698)
('****Preprocess time: ', 0.0036236624717712403, 0.0037567734718322752)
('****Data time: ', 0.0002880924940109253, 0.0003037452697753906)
('****Fetch time: ', 0.0001330960988998413, 0.00014090538024902344)
('****Sort time: ', 0.0005396953821182251, 0.0006330490112304685)
****Stage 0 average time 0.00821665644646
****Stage 1 average time 0.00390948307514
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.630409956
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008167497038841247, 0.008549022674560546)
('****Total time: ', 6.497301754951477, 12.38549585342407)
('****Preprocess time: ', 0.0037906450033187867, 0.0038662433624267576)
('****Data time: ', 0.00031723296642303467, 0.0003390312194824219)
('****Fetch time: ', 0.00010376226902008057, 0.00012421607971191406)
('****Sort time: ', 0.0005422188043594361, 0.0005707859992980956)
****Stage 0 average time 0.00901290309429
****Stage 1 average time 0.00390845298767
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.3891780376
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.007553134202957153, 0.007897138595581055)
('****Total time: ', 5.357308730840683, 10.170241570472715)
('****Preprocess time: ', 0.003787901997566223, 0.0038571834564208986)
('****Data time: ', 0.000294836163520813, 0.00031495094299316406)
('****Fetch time: ', 0.00013408374786376954, 0.00014090538024902344)
('****Sort time: ', 0.0005487861633300781, 0.00057220458984375)
****Stage 0 average time 0.0083994601965
****Stage 1 average time 0.00391928207874
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.3195149899
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.00812807834148407, 0.008513343334197997)
('****Total time: ', 4.779654056191444, 9.124741303920745)
('****Preprocess time: ', 0.003697242021560669, 0.0038230895996093747)
('****Data time: ', 0.00030890285968780516, 0.00032806396484375)
('****Fetch time: ', 0.00010699713230133057, 0.00012993812561035156)
('****Sort time: ', 0.0005508354902267457, 0.0005807876586914062)
****Stage 0 average time 0.0088683501482
****Stage 1 average time 0.00392370569706
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.4834020138
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.00817996621131897, 0.008546161651611327)
('****Total time: ', 3.82537127327919, 7.302481245994567)
('****Preprocess time: ', 0.003697084903717041, 0.003832101821899414)
('****Data time: ', 0.00031079888343811036, 0.0003311634063720703)
('****Fetch time: ', 0.00010392522811889649, 0.00011610984802246094)
('****Sort time: ', 0.0005504062175750732, 0.0005772113800048828)
****Stage 0 average time 0.00894971394539
****Stage 1 average time 0.00389246749878
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.3111832142
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007576445937156677, 0.007989203929901122)
('****Total time: ', 2.3120487983226776, 4.314823198318481)
('****Preprocess time: ', 0.0037458167076110838, 0.003921067714691162)
('****Data time: ', 0.00029882586002349856, 0.0003170967102050781)
('****Fetch time: ', 0.0001312345266342163, 0.0001392364501953125)
('****Sort time: ', 0.0005542410612106323, 0.0005867719650268553)
****Stage 0 average time 0.00836240255833
****Stage 1 average time 0.00394416153431
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.6875858307
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.00822650170326233, 0.008611977100372314)
('****Total time: ', 1.843387971162796, 3.577697730064391)
('****Preprocess time: ', 0.0037848489284515383, 0.003854036331176758)
('****Data time: ', 0.00031618177890777586, 0.0003349781036376953)
('****Fetch time: ', 0.00010232484340667725, 0.00011491775512695312)
('****Sort time: ', 0.0005520550012588501, 0.0005911350250244135)
****Stage 0 average time 0.00904831457138
****Stage 1 average time 0.00393359768391
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.6699838638
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.00822440493106842, 0.008653247356414795)
('****Total time: ', 0.425894814491272, 0.7628674507141113)
('****Preprocess time: ', 0.003781814455986023, 0.00385667085647583)
('****Data time: ', 0.0003156341314315796, 0.0003330707550048828)
('****Fetch time: ', 0.00010301387310028077, 0.00011492967605590814)
('****Sort time: ', 0.0005457137823104859, 0.000579845905303955)
****Stage 0 average time 0.00903527665138
****Stage 1 average time 0.00393530452251
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.2252879143
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.007752894878387451, 0.008570969104766846)
('****Total time: ', 0.014685560941696168, 0.017654693126678465)
('****Preprocess time: ', 0.0037264649868011474, 0.0038640975952148435)
('****Data time: ', 0.00030344998836517336, 0.00033000707626342754)
('****Fetch time: ', 0.0001225532293319702, 0.00013899803161621094)
('****Sort time: ', 0.0005448411703109741, 0.0005738735198974609)
****Stage 0 average time 0.00845143949986
****Stage 1 average time 0.00399876475334
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.9067790508
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.007579275131225586, 0.008282244205474852)
('****Total time: ', 0.014248196959495545, 0.016028583049774163)
('****Preprocess time: ', 0.003767304062843323, 0.0039336919784545895)
('****Data time: ', 0.00030972027778625486, 0.0003388047218322753)
('****Fetch time: ', 0.0001223471164703369, 0.00013208389282226562)
('****Sort time: ', 0.000540543794631958, 0.0005888938903808594)
****Stage 0 average time 0.00833738434315
****Stage 1 average time 0.00398180603981
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  32.0678060055
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.007590034246444702, 0.008346009254455566)
('****Total time: ', 0.014090803980827332, 0.015405285358428947)
('****Preprocess time: ', 0.003752937197685242, 0.0039291143417358385)
('****Data time: ', 0.00031074631214141843, 0.0003321528434753416)
('****Fetch time: ', 0.0001224086284637451, 0.00013303756713867188)
('****Sort time: ', 0.0005376356840133667, 0.0005950927734375)
****Stage 0 average time 0.00831385266781
****Stage 1 average time 0.00399990940094
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.966936599674
****DCGs @ 32: 0.941856353519
****DCGs @ 64: 0.909016263604
****Error : 0.184375
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  8.7918741703
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.02728342854976654, 0.0376203179359436)
('****Total time: ', 2.859399824619293, 5.324477279186247)
('****Preprocess time: ', 0.005623431324958801, 0.007913076877593992)
('****Data time: ', 0.000520655632019043, 0.0006277799606323241)
('****Fetch time: ', 8.022511005401611e-05, 9.419918060302721e-05)
('****Sort time: ', 0.0007701599597930908, 0.0009558796882629391)
****Stage 0 average time 0.0298539801836
****Stage 1 average time 0.00442392039299
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.57566714287
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.02491891384124756, 0.03270560503005981)
('****Total time: ', 2.409041848063469, 4.348875391483307)
('****Preprocess time: ', 0.00510211980342865, 0.007085263729095457)
('****Data time: ', 0.0004665153026580811, 0.0005409717559814453)
('****Fetch time: ', 7.529985904693603e-05, 8.512735366821283e-05)
('****Sort time: ', 0.000774394154548645, 0.0009438991546630859)
****Stage 0 average time 0.0270101314783
****Stage 1 average time 0.00432711148262
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.6608479023
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.0247130264043808, 0.03130500316619872)
('****Total time: ', 1.8983783103227616, 3.387279105186462)
('****Preprocess time: ', 0.004986728668212891, 0.006682407855987548)
('****Data time: ', 0.00046002113819122313, 0.0005280971527099609)
('****Fetch time: ', 7.596921920776367e-05, 8.416175842285156e-05)
('****Sort time: ', 0.0007573987245559692, 0.0009009838104248047)
****Stage 0 average time 0.0266656637192
****Stage 1 average time 0.00432748043537
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.70061993599
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.024396049618721008, 0.031654369831085195)
('****Total time: ', 1.3880102216005326, 2.5057984471321104)
('****Preprocess time: ', 0.004966674685478211, 0.006675720214843747)
('****Data time: ', 0.0004560168981552124, 0.00051499605178833)
('****Fetch time: ', 7.558822631835938e-05, 8.392333984375e-05)
('****Sort time: ', 0.0007830102443695068, 0.0009542346000671382)
****Stage 0 average time 0.0262984858751
****Stage 1 average time 0.00437885379791
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.87446784973
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.024008399248123168, 0.03032644987106323)
('****Total time: ', 0.4513245531320572, 0.7058855772018433)
('****Preprocess time: ', 0.004964191675186158, 0.006499826908111569)
('****Data time: ', 0.0004582765102386475, 0.0005228638648986816)
('****Fetch time: ', 7.445025444030762e-05, 8.296966552734375e-05)
('****Sort time: ', 0.0007618961334228515, 0.0008819103240966797)
****Stage 0 average time 0.0258139131069
****Stage 1 average time 0.00445330071449
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.1608920097
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.02368558478355408, 0.028404295444488525)
('****Total time: ', 0.03500874972343445, 0.044114375114440905)
('****Preprocess time: ', 0.004799491643905639, 0.0053046703338623)
('****Data time: ', 0.0004460331201553345, 0.0005018711090087891)
('****Fetch time: ', 7.243108749389648e-05, 8.20159912109375e-05)
('****Sort time: ', 0.0007385545969009399, 0.0008096814155578613)
****Stage 0 average time 0.0254141055346
****Stage 1 average time 0.00432798969746
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.3518619537
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.023616639375686647, 0.02885949611663817)
('****Total time: ', 0.03346355652809143, 0.04135884046554565)
('****Preprocess time: ', 0.004825295925140381, 0.005346322059631347)
('****Data time: ', 0.0004470280408859253, 0.0005109310150146484)
('****Fetch time: ', 7.341039180755616e-05, 8.58306884765625e-05)
('****Sort time: ', 0.0007410273551940918, 0.0008008480072021484)
****Stage 0 average time 0.0252112647295
****Stage 1 average time 0.00449213635921
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.3498511314
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.023225499749183656, 0.027262389659881592)
('****Total time: ', 0.03181534242630005, 0.036967742443084664)
('****Preprocess time: ', 0.004763473987579345, 0.005180883407592774)
('****Data time: ', 0.00044594383239746093, 0.0005080699920654297)
('****Fetch time: ', 7.230448722839355e-05, 8.0108642578125e-05)
('****Sort time: ', 0.0007422013282775879, 0.0007999420166015622)
****Stage 0 average time 0.0249131656885
****Stage 1 average time 0.00433625769615
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.0808229446
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.022777085065841675, 0.02648081779479979)
('****Total time: ', 0.03083263623714447, 0.03503632545471191)
('****Preprocess time: ', 0.004715109705924988, 0.005173110961914062)
('****Data time: ', 0.0004401034116744995, 0.0005138039588928222)
('****Fetch time: ', 7.11292028427124e-05, 7.82012939453125e-05)
('****Sort time: ', 0.0007474219799041748, 0.0008087754249572751)
****Stage 0 average time 0.024403878212
****Stage 1 average time 0.00434697115421
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.3418931961
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.022291706323623657, 0.025002598762512204)
('****Total time: ', 0.03014869034290314, 0.03341929912567138)
('****Preprocess time: ', 0.004678826808929443, 0.005092227458953857)
('****Data time: ', 0.0004379324913024902, 0.0005078315734863281)
('****Fetch time: ', 7.079493999481201e-05, 7.677078247070312e-05)
('****Sort time: ', 0.0007364832162857056, 0.0007987022399902344)
****Stage 0 average time 0.0239108159542
****Stage 1 average time 0.00430492782593
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.9286160469
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.022275610327720644, 0.025434899330139146)
('****Total time: ', 0.03002246618270874, 0.03371554613113402)
('****Preprocess time: ', 0.004693191885948181, 0.005166089534759522)
('****Data time: ', 0.0004439054727554321, 0.0005168914794921875)
('****Fetch time: ', 7.091128826141357e-05, 7.678270339965814e-05)
('****Sort time: ', 0.0007298128604888916, 0.0007898807525634766)
****Stage 0 average time 0.023898471117
****Stage 1 average time 0.00431496071815
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  32.2400400639
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.02207796859741211, 0.025137042999267577)
('****Total time: ', 0.029853652000427246, 0.03352137804031371)
('****Preprocess time: ', 0.00469521427154541, 0.005244064331054688)
('****Data time: ', 0.0004408537149429321, 0.0005178570747375488)
('****Fetch time: ', 7.055509090423584e-05, 7.700920104980469e-05)
('****Sort time: ', 0.0007312818765640259, 0.0007908344268798828)
****Stage 0 average time 0.0237007722855
****Stage 1 average time 0.00431510126591
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  3.55553889275
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.0333813214302063, 0.04079768657684325)
('****Total time: ', 0.14611845242977142, 0.22568957805633544)
('****Preprocess time: ', 0.005674057006835938, 0.007888603210449206)
('****Data time: ', 0.0005986024141311645, 0.0007200598716735838)
('****Fetch time: ', 7.740962505340577e-05, 9.202957153320312e-05)
('****Sort time: ', 0.0008189877271652222, 0.001164019107818603)
****Stage 0 average time 0.0279139301777
****Stage 1 average time 0.0126364480257
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.15946602821
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.03161288404464722, 0.04218052625656124)
('****Total time: ', 0.04169029152393341, 0.05451647043228147)
('****Preprocess time: ', 0.005528682112693787, 0.007759177684783919)
('****Data time: ', 0.0005517423152923584, 0.0006432771682739257)
('****Fetch time: ', 7.262969017028808e-05, 8.41975212097166e-05)
('****Sort time: ', 0.0008556827306747437, 0.0011410713195800781)
****Stage 0 average time 0.0278896028996
****Stage 1 average time 0.0107320179939
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.2950360775
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03093090033531189, 0.039830982685089104)
('****Total time: ', 0.040590553283691405, 0.05139888525009154)
('****Preprocess time: ', 0.005470123052597046, 0.007713031768798827)
('****Data time: ', 0.0005432859659194946, 0.0006518483161926269)
('****Fetch time: ', 7.098162174224854e-05, 8.178949356079095e-05)
('****Sort time: ', 0.0008371959924697876, 0.0010700702667236326)
****Stage 0 average time 0.0275249731541
****Stage 1 average time 0.010327513814
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  6.42028999329
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.03002494716644287, 0.03796563148498534)
('****Total time: ', 0.03958376443386078, 0.04866908788681028)
('****Preprocess time: ', 0.00534502911567688, 0.007374596595764157)
('****Data time: ', 0.0005233467817306518, 0.0006137013435363769)
('****Fetch time: ', 6.614768505096435e-05, 7.915496826171875e-05)
('****Sort time: ', 0.0008109198808670043, 0.0009842276573181151)
****Stage 0 average time 0.0267538061142
****Stage 1 average time 0.0100165845156
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.38009119034
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.02954837429523468, 0.03583899736404419)
('****Total time: ', 0.03881949520111084, 0.04621930122375489)
('****Preprocess time: ', 0.005345380783081054, 0.007630515098571776)
('****Data time: ', 0.0005263911485671997, 0.0006060600280761719)
('****Fetch time: ', 6.409299373626708e-05, 7.678270339965814e-05)
('****Sort time: ', 0.0008223724365234375, 0.0009489178657531738)
****Stage 0 average time 0.0262028867006
****Stage 1 average time 0.0101037249565
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.4537489414
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.028254329085350038, 0.033662247657775875)
('****Total time: ', 0.03720514404773712, 0.043352270126342775)
('****Preprocess time: ', 0.005212327599525452, 0.007059848308563228)
('****Data time: ', 0.0005058841705322265, 0.0005901336669921872)
('****Fetch time: ', 6.175017356872559e-05, 7.200241088867188e-05)
('****Sort time: ', 0.000794816255569458, 0.0009160518646240232)
****Stage 0 average time 0.0252964434624
****Stage 1 average time 0.00953266382217
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.5034708977
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.027743102073669434, 0.03231812715530395)
('****Total time: ', 0.03663160443305969, 0.04196009635925293)
('****Preprocess time: ', 0.005082728028297424, 0.0063047289848327534)
('****Data time: ', 0.0005020241737365722, 0.0005810260772705078)
('****Fetch time: ', 6.092500686645508e-05, 7.010698318481439e-05)
('****Sort time: ', 0.0007838102579116822, 0.0008891105651855466)
****Stage 0 average time 0.0247033069134
****Stage 1 average time 0.00946928262711
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.5256419182
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.027502060055732726, 0.03226910829544067)
('****Total time: ', 0.03636170637607575, 0.04158649444580078)
('****Preprocess time: ', 0.005081277132034301, 0.006496596336364744)
('****Data time: ', 0.0004994409084320068, 0.0005767345428466797)
('****Fetch time: ', 5.937981605529785e-05, 6.794929504394531e-05)
('****Sort time: ', 0.0007950776815414429, 0.0008716702461242675)
****Stage 0 average time 0.024511634469
****Stage 1 average time 0.00942560112476
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.4790308475
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.02706763422489166, 0.030046582221984853)
('****Total time: ', 0.035840217590332034, 0.03969738483428954)
('****Preprocess time: ', 0.004986613988876343, 0.0053402543067932115)
('****Data time: ', 0.0005071219205856323, 0.0005832076072692869)
('****Fetch time: ', 5.9353113174438475e-05, 6.699562072753906e-05)
('****Sort time: ', 0.0007842322587966919, 0.0008509159088134766)
****Stage 0 average time 0.0239896649122
****Stage 1 average time 0.0094152905941
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.6462340355
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.026617029786109924, 0.029925823211669915)
('****Total time: ', 0.035380721926689146, 0.039137184619903564)
('****Preprocess time: ', 0.004999534010887146, 0.005401325225830077)
('****Data time: ', 0.0004988048076629639, 0.0005770206451416013)
('****Fetch time: ', 5.695772171020508e-05, 6.508827209472656e-05)
('****Sort time: ', 0.0007865630388259888, 0.0008378148078918456)
****Stage 0 average time 0.0237887706757
****Stage 1 average time 0.00917011868954
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.4606320858
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.026411720991134643, 0.0292050838470459)
('****Total time: ', 0.035165821433067325, 0.03855712413787842)
('****Preprocess time: ', 0.004917979001998901, 0.005251944065093993)
('****Data time: ', 0.0004994344711303711, 0.0005789279937744138)
('****Fetch time: ', 5.600845813751221e-05, 6.4849853515625e-05)
('****Sort time: ', 0.0007826544046401978, 0.0008340358734130857)
****Stage 0 average time 0.023624651432
****Stage 1 average time 0.009043145895
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  32.6948158741
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.026447130918502808, 0.02947312593460082)
('****Total time: ', 0.03517959368228912, 0.03879555463790893)
('****Preprocess time: ', 0.004942532420158386, 0.005359256267547607)
('****Data time: ', 0.0004989639520645142, 0.0005750656127929688)
('****Fetch time: ', 5.754244327545166e-05, 6.389617919921875e-05)
('****Sort time: ', 0.0007736337184906006, 0.0008249282836914062)
****Stage 0 average time 0.0235115523338
****Stage 1 average time 0.00920825111866
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  17.6339828968
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.012315846800804138, 0.014933693408966052)
('****Total time: ', 7.56807303750515, 14.309363770484923)
('****Preprocess time: ', 0.004334142208099365, 0.004787933826446533)
('****Data time: ', 0.0003640604019165039, 0.0004087090492248532)
('****Fetch time: ', 0.00010864555835723877, 0.00013184547424316406)
('****Sort time: ', 0.0007702546119689941, 0.0008208751678466797)
****Stage 0 average time 0.00908807468414
****Stage 1 average time 0.008804874897
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.8099520206
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.011911823391914367, 0.013598012924194335)
('****Total time: ', 6.816774538516999, 12.67340667247772)
('****Preprocess time: ', 0.00428249979019165, 0.004449856281280517)
('****Data time: ', 0.0003505117893218994, 0.0004210472106933594)
('****Fetch time: ', 0.00012283849716186523, 0.00014400482177734375)
('****Sort time: ', 0.0007672475576400757, 0.0008139610290527344)
****Stage 0 average time 0.00868398737907
****Stage 1 average time 0.00875093364716
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.9329781532
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011973529458045959, 0.012598919868469238)
('****Total time: ', 6.187852483630181, 11.727153003215788)
('****Preprocess time: ', 0.00438191556930542, 0.0044708251953125)
('****Data time: ', 0.00037919509410858153, 0.00040411949157714844)
('****Fetch time: ', 0.00012324154376983643, 0.00013589859008789062)
('****Sort time: ', 0.0007981984615325928, 0.000843048095703125)
****Stage 0 average time 0.00873349452019
****Stage 1 average time 0.00892258560658
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.2559671402
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.011769128918647766, 0.013406491279602039)
('****Total time: ', 5.330946566462517, 10.116277801990508)
('****Preprocess time: ', 0.004257948994636536, 0.004488956928253174)
('****Data time: ', 0.00032891178131103517, 0.00036288499832153314)
('****Fetch time: ', 0.00014128458499908448, 0.0001480579376220703)
('****Sort time: ', 0.0007810387611389161, 0.0008032679557800291)
****Stage 0 average time 0.00841477644444
****Stage 1 average time 0.0088635365963
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.6218361855
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.011996026039123536, 0.013002312183380126)
('****Total time: ', 4.535729661345482, 8.472011733055114)
('****Preprocess time: ', 0.004321657180786133, 0.0044460296630859375)
('****Data time: ', 0.0003563750982284546, 0.00039124488830566406)
('****Fetch time: ', 0.00013107907772064208, 0.0001430511474609375)
('****Sort time: ', 0.0007742671966552735, 0.0008289813995361328)
****Stage 0 average time 0.00859202241898
****Stage 1 average time 0.00898738217354
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.5787041187
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.012331597208976745, 0.014133489131927487)
('****Total time: ', 3.8460317641496657, 7.402172935009001)
('****Preprocess time: ', 0.004259368658065796, 0.004428029060363769)
('****Data time: ', 0.0003484210968017578, 0.000373852252960205)
('****Fetch time: ', 0.0001060718297958374, 0.00011709928512573223)
('****Sort time: ', 0.0007515314817428589, 0.0008030056953430175)
****Stage 0 average time 0.00907152712345
****Stage 1 average time 0.00872546315193
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.3611550331
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011788277626037598, 0.013037097454071039)
('****Total time: ', 2.3502639623880386, 4.417910110950469)
('****Preprocess time: ', 0.0042482086420059205, 0.004405069351196288)
('****Data time: ', 0.0003434755802154541, 0.0003779053688049316)
('****Fetch time: ', 0.00013529980182647706, 0.00014495849609375)
('****Sort time: ', 0.000755109429359436, 0.0008170962333679197)
****Stage 0 average time 0.00845887732506
****Stage 1 average time 0.00881149375439
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.1536648273
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.011678190350532532, 0.013112473487854001)
('****Total time: ', 1.15159228181839, 2.2446785688400257)
('****Preprocess time: ', 0.004186114430427552, 0.0043811798095703125)
('****Data time: ', 0.00032572150230407714, 0.0003681182861328125)
('****Fetch time: ', 0.00013677000999450683, 0.00014591217041015625)
('****Sort time: ', 0.0007471801042556763, 0.0008082747459411619)
****Stage 0 average time 0.00836070334911
****Stage 1 average time 0.0087132730484
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.9105448723
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.012036491632461548, 0.013372790813446035)
('****Total time: ', 0.058240152716636656, 0.11742024421691893)
('****Preprocess time: ', 0.004350335001945495, 0.004479026794433593)
('****Data time: ', 0.000359034538269043, 0.0003859996795654297)
('****Fetch time: ', 0.00013066017627716065, 0.000141143798828125)
('****Sort time: ', 0.0007736111879348755, 0.0008280277252197266)
****Stage 0 average time 0.0086060385704
****Stage 1 average time 0.00904409396648
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.426787138
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.012127849221229553, 0.013546192646026611)
('****Total time: ', 0.0205924916267395, 0.0241105318069458)
('****Preprocess time: ', 0.004417254209518433, 0.0047511219978332506)
('****Data time: ', 0.00037957394123077395, 0.00047025680541992135)
('****Fetch time: ', 0.00011468172073364258, 0.00013327598571777344)
('****Sort time: ', 0.0007706805467605591, 0.0008170604705810547)
****Stage 0 average time 0.008797129035
****Stage 1 average time 0.00901291060448
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.142649889
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.012209202170372009, 0.013696455955505367)
('****Total time: ', 0.020213246464729308, 0.02266411781311035)
('****Preprocess time: ', 0.004462205052375793, 0.0047811508178710925)
('****Data time: ', 0.000402410626411438, 0.00048313140869140573)
('****Fetch time: ', 0.0001048884391784668, 0.00012612342834472656)
('****Sort time: ', 0.0007383691072463989, 0.0008120536804199219)
****Stage 0 average time 0.00899760758877
****Stage 1 average time 0.00891946780682
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  32.1270968914
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.01200084102153778, 0.013574147224426267)
('****Total time: ', 0.019494054675102235, 0.021627855300903318)
('****Preprocess time: ', 0.004331846833229065, 0.004882121086120603)
('****Data time: ', 0.0003689502477645874, 0.0004933118820190428)
('****Fetch time: ', 0.00012119805812835693, 0.0001399517059326172)
('****Sort time: ', 0.0007559618949890137, 0.0008030056953430175)
****Stage 0 average time 0.00864444351196
****Stage 1 average time 0.00893435454369
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986214284266
****DCGs @ 16: 0.967258690998
****DCGs @ 32: 0.942058162213
****DCGs @ 64: 0.909218292578
****Error : 0.346375
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  11.2773370743
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.029726311922073364, 0.04168698787689209)
('****Total time: ', 4.115564330339431, 7.304789745807648)
('****Preprocess time: ', 0.006439865112304688, 0.008823168277740477)
('****Data time: ', 0.0005649751424789428, 0.0007141113281249997)
('****Fetch time: ', 9.015107154846191e-05, 0.00011396408081054688)
('****Sort time: ', 0.0010556935071945191, 0.00144205093383789)
****Stage 0 average time 0.0320937073231
****Stage 1 average time 0.00578328943253
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.9569070339
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.026764240741729735, 0.036922514438629137)
('****Total time: ', 3.578751727938652, 6.523220789432525)
('****Preprocess time: ', 0.005939542174339295, 0.008254194259643553)
('****Data time: ', 0.000530093789100647, 0.000640869140625)
('****Fetch time: ', 8.627462387084961e-05, 0.00010013580322265625)
('****Sort time: ', 0.0010523124933242798, 0.0013732552528381336)
****Stage 0 average time 0.0287406237125
****Stage 1 average time 0.00563184010983
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.962886095
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.024638646125793456, 0.029717051982879633)
('****Total time: ', 3.084460441470146, 5.65612963438034)
('****Preprocess time: ', 0.005537342548370361, 0.006900048255920409)
('****Data time: ', 0.0004986414909362793, 0.00058366060256958)
('****Fetch time: ', 7.939064502716064e-05, 8.920431137084941e-05)
('****Sort time: ', 0.001073217511177063, 0.0013209939002990713)
****Stage 0 average time 0.0261836974621
****Stage 1 average time 0.00564354085922
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.0300459862
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.024381608247756956, 0.028934049606323235)
('****Total time: ', 2.4905722304582594, 4.579727518558501)
('****Preprocess time: ', 0.005503968119621277, 0.00680049657821655)
('****Data time: ', 0.0004912652969360352, 0.0005712866783142088)
('****Fetch time: ', 7.775485515594482e-05, 8.893013000488281e-05)
('****Sort time: ', 0.0010501892566680908, 0.0012838959693908692)
****Stage 0 average time 0.0258340997696
****Stage 1 average time 0.00567068600655
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.9793038368
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.023845160961151125, 0.027589130401611327)
('****Total time: ', 1.500403459906578, 2.6823597908020016)
('****Preprocess time: ', 0.0054489121437072754, 0.0061471104621887195)
('****Data time: ', 0.0004950022697448731, 0.0005717396736145019)
('****Fetch time: ', 7.797300815582276e-05, 8.584260940551751e-05)
('****Sort time: ', 0.001118138313293457, 0.001331818103790283)
****Stage 0 average time 0.0252486535311
****Stage 1 average time 0.00573653316498
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.5000610352
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.02388113009929657, 0.02870535850524901)
('****Total time: ', 0.5019512031078338, 0.9202705144882202)
('****Preprocess time: ', 0.0055636844635009765, 0.006453454494476315)
('****Data time: ', 0.0004880974292755127, 0.0005581378936767578)
('****Fetch time: ', 7.858479022979736e-05, 9.107589721679688e-05)
('****Sort time: ', 0.0010409593582153321, 0.001224088668823242)
****Stage 0 average time 0.0251231058836
****Stage 1 average time 0.00592935025692
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.4086661339
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.023908743739128113, 0.028425729274749748)
('****Total time: ', 0.04057200145721435, 0.05596339702606197)
('****Preprocess time: ', 0.0055252845287323, 0.00634963512420654)
('****Data time: ', 0.0004966737031936645, 0.0005810379981994628)
('****Fetch time: ', 7.796192169189453e-05, 9.179115295410156e-05)
('****Sort time: ', 0.0010398581027984619, 0.0012331485748291013)
****Stage 0 average time 0.0251608350277
****Stage 1 average time 0.00588768696785
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.4288589954
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.023537659287452696, 0.027781236171722408)
('****Total time: ', 0.03452768671512604, 0.04260715246200561)
('****Preprocess time: ', 0.005484871625900269, 0.006270515918731688)
('****Data time: ', 0.0005000275373458862, 0.0005736470222473144)
('****Fetch time: ', 7.79956579208374e-05, 9.084939956665033e-05)
('****Sort time: ', 0.00102004873752594, 0.001183044910430908)
****Stage 0 average time 0.0247560751438
****Stage 1 average time 0.00586452770233
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.4735660553
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.023431170463562013, 0.027840924263000482)
('****Total time: ', 0.03366879093647003, 0.03970886468887329)
('****Preprocess time: ', 0.005555516958236694, 0.006546950340270996)
('****Data time: ', 0.0004933446645736695, 0.0005681514739990234)
('****Fetch time: ', 7.838881015777588e-05, 9.371042251586908e-05)
('****Sort time: ', 0.001022038459777832, 0.0010772109031677245)
****Stage 0 average time 0.0245671144724
****Stage 1 average time 0.00601334488392
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.6382379532
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.02308733892440796, 0.026307094097137447)
('****Total time: ', 0.032512218475341796, 0.03636916875839232)
('****Preprocess time: ', 0.005429082274436951, 0.006080377101898191)
('****Data time: ', 0.0005033093690872192, 0.0005750656127929688)
('****Fetch time: ', 7.779085636138916e-05, 8.702278137207031e-05)
('****Sort time: ', 0.0010022103786468505, 0.0011871218681335446)
****Stage 0 average time 0.0242408021688
****Stage 1 average time 0.00585892963409
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.4563560486
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.022924001574516295, 0.025796544551849352)
('****Total time: ', 0.03235086619853973, 0.03585463762283325)
('****Preprocess time: ', 0.005386086821556091, 0.005756962299346923)
('****Data time: ', 0.0005020829439163208, 0.0005719661712646484)
('****Fetch time: ', 7.746052742004394e-05, 8.702278137207031e-05)
('****Sort time: ', 0.0010268253087997437, 0.00109105110168457)
****Stage 0 average time 0.0240670138597
****Stage 1 average time 0.00584944331646
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  32.5888421535
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.0228431693315506, 0.02595952749252318)
('****Total time: ', 0.03215798020362854, 0.035718810558319075)
('****Preprocess time: ', 0.0053822119235992436, 0.005879890918731689)
('****Data time: ', 0.000495877981185913, 0.0005703210830688475)
('****Fetch time: ', 7.66148567199707e-05, 8.702278137207031e-05)
('****Sort time: ', 0.0010181772708892822, 0.001074075698852539)
****Stage 0 average time 0.0239572503567
****Stage 1 average time 0.00585880100727
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  3.86236596107
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.04665230262279511, 0.06141628026962279)
('****Total time: ', 0.5897703356742859, 1.0103269219398499)
('****Preprocess time: ', 0.007087489128112793, 0.010991680622100826)
('****Data time: ', 0.0006815004348754883, 0.0008309483528137204)
('****Fetch time: ', 9.971964359283447e-05, 0.00011587142944335938)
('****Sort time: ', 0.0012596995830535889, 0.0017669796943664546)
****Stage 0 average time 0.0306845839024
****Stage 1 average time 0.0250961275101
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.53262209892
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.04134045195579529, 0.05359658002853391)
('****Total time: ', 0.05405466973781586, 0.0694994568824768)
('****Preprocess time: ', 0.006592629432678222, 0.00947839021682739)
('****Data time: ', 0.0006668201684951782, 0.0008008480072021484)
('****Fetch time: ', 8.997619152069092e-05, 0.00010422468185424785)
('****Sort time: ', 0.001181557059288025, 0.0016341567039489745)
****Stage 0 average time 0.0297935461998
****Stage 1 average time 0.020077888608
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.38390398026
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03962711668014526, 0.049801611900329563)
('****Total time: ', 0.050859513163566586, 0.0627274751663208)
('****Preprocess time: ', 0.006357431888580322, 0.008954286575317383)
('****Data time: ', 0.000640718698501587, 0.0007470130920410154)
('****Fetch time: ', 9.18736457824707e-05, 0.00010112524032592754)
('****Sort time: ', 0.0011779401302337647, 0.0015541195869445794)
****Stage 0 average time 0.0287194032669
****Stage 1 average time 0.0191756777763
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  6.31461000443
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.038357323050498965, 0.04752402305603026)
('****Total time: ', 0.04894799304008484, 0.058989942073822015)
('****Preprocess time: ', 0.006154530763626099, 0.00855025053024292)
('****Data time: ', 0.0006116182804107666, 0.0007279038429260253)
('****Fetch time: ', 8.175289630889893e-05, 9.584426879882812e-05)
('****Sort time: ', 0.0011341971158981322, 0.001475930213928222)
****Stage 0 average time 0.0278273715973
****Stage 1 average time 0.0185120505095
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.4529800415
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.037031893491744995, 0.04530019760131836)
('****Total time: ', 0.047450096487998965, 0.0572746992111206)
('****Preprocess time: ', 0.006090032339096069, 0.008300471305847166)
('****Data time: ', 0.0006025276184082032, 0.0006971716880798338)
('****Fetch time: ', 8.097803592681885e-05, 9.298324584960938e-05)
('****Sort time: ', 0.0011081960201263427, 0.0013380050659179688)
****Stage 0 average time 0.0271205416918
****Stage 1 average time 0.0177930858135
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.4335160255
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.03586743712425232, 0.04379897117614745)
('****Total time: ', 0.04586787045001984, 0.05529457330703732)
('****Preprocess time: ', 0.0059074097871780395, 0.007880043983459468)
('****Data time: ', 0.000581117033958435, 0.0006649613380432128)
('****Fetch time: ', 7.502365112304688e-05, 8.606910705566406e-05)
('****Sort time: ', 0.0010963693857192994, 0.0013161063194274901)
****Stage 0 average time 0.0264150539637
****Stage 1 average time 0.0171123030186
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.4095079899
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.035989327907562256, 0.043257498741149904)
('****Total time: ', 0.04629484677314758, 0.05500062704086302)
('****Preprocess time: ', 0.005966368556022644, 0.008187246322631835)
('****Data time: ', 0.0005882934331893921, 0.0006749749183654785)
('****Fetch time: ', 7.494473457336426e-05, 9.083747863769531e-05)
('****Sort time: ', 0.0010947469472885132, 0.001304185390472412)
****Stage 0 average time 0.0264522826672
****Stage 1 average time 0.0172613989115
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.2029089928
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.03445523250102997, 0.03980423212051391)
('****Total time: ', 0.044236588358879086, 0.05056655406951904)
('****Preprocess time: ', 0.005741963505744934, 0.006900334358215329)
('****Data time: ', 0.000575359582901001, 0.0006528019905090331)
('****Fetch time: ', 7.18003511428833e-05, 8.320808410644531e-05)
('****Sort time: ', 0.0010884314775466918, 0.0012419342994689942)
****Stage 0 average time 0.0256557077169
****Stage 1 average time 0.0162770797014
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.3447990417
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03473901093006134, 0.04090458154678345)
('****Total time: ', 0.04468184816837311, 0.05230799913406372)
('****Preprocess time: ', 0.005812033176422119, 0.007402288913726804)
('****Data time: ', 0.0005783790349960327, 0.0006592512130737303)
('****Fetch time: ', 7.202088832855224e-05, 8.416175842285156e-05)
('****Sort time: ', 0.0010949701070785522, 0.001258909702301025)
****Stage 0 average time 0.0258705096245
****Stage 1 average time 0.0164259045124
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.4488129616
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.03400611734390259, 0.03943343162536621)
('****Total time: ', 0.043872147917747496, 0.05008985996246337)
('****Preprocess time: ', 0.005697535395622254, 0.006432080268859862)
('****Data time: ', 0.0005761284828186035, 0.0006489753723144531)
('****Fetch time: ', 7.074475288391114e-05, 8.296966552734375e-05)
('****Sort time: ', 0.0010882306098937988, 0.001171159744262695)
****Stage 0 average time 0.0253593740463
****Stage 1 average time 0.0160793825388
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.425673008
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.032742097616195676, 0.036786150932311995)
('****Total time: ', 0.042644193530082704, 0.04723421335220337)
('****Preprocess time: ', 0.00557428503036499, 0.006110453605651855)
('****Data time: ', 0.0005647131204605103, 0.000637054443359375)
('****Fetch time: ', 6.733262538909912e-05, 7.727146148681628e-05)
('****Sort time: ', 0.0010898487567901612, 0.0011783719062805158)
****Stage 0 average time 0.0245703675747
****Stage 1 average time 0.0154679095745
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  32.6163270473
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.03351054346561432, 0.0393754482269287)
('****Total time: ', 0.04346159934997559, 0.04998115301132201)
('****Preprocess time: ', 0.005698634624481201, 0.007212018966674804)
('****Data time: ', 0.0005650531053543091, 0.0006389975547790525)
('****Fetch time: ', 6.896674633026123e-05, 7.796287536621094e-05)
('****Sort time: ', 0.0010723294019699097, 0.0011451721191406247)
****Stage 0 average time 0.0249101980925
****Stage 1 average time 0.0160053292513
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  17.6298558712
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017818051934242247, 0.020662188529968258)
('****Total time: ', 7.578529325604439, 14.36200760602951)
('****Preprocess time: ', 0.005147630214691162, 0.00552948713302612)
('****Data time: ', 0.00046444225311279296, 0.0005052089691162109)
('****Fetch time: ', 0.0001063375473022461, 0.00012683868408203125)
('****Sort time: ', 0.0010783610343933106, 0.0011361241340637205)
****Stage 0 average time 0.00915409862995
****Stage 1 average time 0.0154607243538
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.5828769207
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.017757726550102233, 0.020740461349487302)
('****Total time: ', 7.046611656785012, 13.388303577899931)
('****Preprocess time: ', 0.005121676802635193, 0.005257165431976319)
('****Data time: ', 0.00045911335945129396, 0.0004990100860595703)
('****Fetch time: ', 0.00010642540454864502, 0.0001289844512939453)
('****Sort time: ', 0.0010933530330657958, 0.001286756992340088)
****Stage 0 average time 0.00913609480858
****Stage 1 average time 0.0154022003412
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.57644701
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017519556641578674, 0.020002269744873045)
('****Total time: ', 6.502957949995994, 12.33017416000366)
('****Preprocess time: ', 0.005088079333305359, 0.005224049091339111)
('****Data time: ', 0.00045586907863616943, 0.0004951953887939453)
('****Fetch time: ', 0.00010554707050323487, 0.00012612342834472656)
('****Sort time: ', 0.0010756431818008422, 0.0011239171028137205)
****Stage 0 average time 0.00912424862385
****Stage 1 average time 0.015120446682
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  18.928344965
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.01804839813709259, 0.02009588479995727)
('****Total time: ', 6.616143817543984, 12.600553095340727)
('****Preprocess time: ', 0.005111675620079041, 0.005263864994049071)
('****Data time: ', 0.00047027754783630373, 0.0005099773406982422)
('****Fetch time: ', 8.78450870513916e-05, 0.0001010894775390625)
('****Sort time: ', 0.0010750309228897096, 0.0011923432350158677)
****Stage 0 average time 0.00979937684536
****Stage 1 average time 0.0149938504696
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.588668108
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.017755199790000915, 0.020023190975189203)
('****Total time: ', 4.9327365491390225, 9.326065897941588)
('****Preprocess time: ', 0.0051486495733261105, 0.005436086654663086)
('****Data time: ', 0.00046703171730041505, 0.0005359649658203125)
('****Fetch time: ', 0.00010868322849273682, 0.00013926029205322253)
('****Sort time: ', 0.0010594446659088134, 0.001132965087890625)
****Stage 0 average time 0.00912031960487
****Stage 1 average time 0.0154186893702
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.4781849384
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.0176861435174942, 0.019765102863311765)
('****Total time: ', 3.7965134216547014, 7.271271872520447)
('****Preprocess time: ', 0.005096475958824158, 0.005237102508544922)
('****Data time: ', 0.00045410895347595216, 0.0004918694496154785)
('****Fetch time: ', 0.00010925054550170899, 0.00013589859008789062)
('****Sort time: ', 0.0010716410875320434, 0.0011339664459228513)
****Stage 0 average time 0.00907394874096
****Stage 1 average time 0.0153436713219
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.4599180222
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017701801419258117, 0.020150184631347656)
('****Total time: ', 2.831736381649971, 5.423512256145477)
('****Preprocess time: ', 0.005086020231246948, 0.005248117446899413)
('****Data time: ', 0.00046049022674560545, 0.0005018711090087891)
('****Fetch time: ', 0.00010942208766937256, 0.0001380443572998047)
('****Sort time: ', 0.001079158067703247, 0.0011581420898437492)
****Stage 0 average time 0.00905633485317
****Stage 1 average time 0.0153805571795
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.4141080379
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.017522064685821532, 0.01951441764831543)
('****Total time: ', 1.746516008257866, 3.3990508198738087)
('****Preprocess time: ', 0.00507727038860321, 0.005221176147460938)
('****Data time: ', 0.0004544813632965088, 0.0004901885986328125)
('****Fetch time: ', 0.00011053073406219482, 0.00013399124145507812)
('****Sort time: ', 0.0010686627626419068, 0.0011398911476135254)
****Stage 0 average time 0.00903760373592
****Stage 1 average time 0.0151954061985
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.4729321003
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017576996922492982, 0.019730234146118162)
('****Total time: ', 0.36335739970207215, 0.6005176305770873)
('****Preprocess time: ', 0.005102298617362976, 0.005276203155517577)
('****Data time: ', 0.00045331943035125733, 0.0004980564117431641)
('****Fetch time: ', 0.0001156618595123291, 0.00014117956161499004)
('****Sort time: ', 0.0010665922164916992, 0.0011380195617675779)
****Stage 0 average time 0.00903372180462
****Stage 1 average time 0.0152811472416
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.3102641106
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.01756706762313843, 0.020175874233245846)
('****Total time: ', 0.02677501952648163, 0.030721843242645253)
('****Preprocess time: ', 0.004968254566192627, 0.005321502685546873)
('****Data time: ', 0.0004270411729812622, 0.0004901885986328125)
('****Fetch time: ', 0.00013341164588928222, 0.00014901161193847656)
('****Sort time: ', 0.0010491493940353394, 0.0011091232299804688)
****Stage 0 average time 0.00863021457195
****Stage 1 average time 0.0155147098303
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.7527189255
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.01742735493183136, 0.020313799381256097)
('****Total time: ', 0.02594848597049713, 0.029249548912048336)
('****Preprocess time: ', 0.004934438705444336, 0.0053128123283386185)
('****Data time: ', 0.00041796648502349855, 0.0004818558692932128)
('****Fetch time: ', 0.00013257241249084472, 0.0001461505889892578)
('****Sort time: ', 0.0010462316274642944, 0.0010979175567626953)
****Stage 0 average time 0.00860391545296
****Stage 1 average time 0.0153546487093
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  32.301707983
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.018028651475906373, 0.021385610103607174)
('****Total time: ', 0.027041919231414795, 0.031288611888885494)
('****Preprocess time: ', 0.005243626117706299, 0.006902885437011713)
('****Data time: ', 0.00047096216678619386, 0.0005559921264648438)
('****Fetch time: ', 0.00010448217391967774, 0.00014090538024902344)
('****Sort time: ', 0.0010541115999221802, 0.0011251330375671384)
****Stage 0 average time 0.00928551447392
****Stage 1 average time 0.0156163190603
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99440341893
****DCGs @ 8: 0.986354563136
****DCGs @ 16: 0.967342025233
****DCGs @ 32: 0.941945163753
****DCGs @ 64: 0.909083077214
****Error : 0.341640625
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  7.35666799545
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03772190463542938, 0.0509045362472534)
('****Total time: ', 1.5170098785161972, 2.7813503265380857)
('****Preprocess time: ', 0.00742770767211914, 0.010689508914947502)
('****Data time: ', 0.0006005361080169678, 0.000778234004974365)
('****Fetch time: ', 8.603215217590333e-05, 0.0001010894775390625)
('****Sort time: ', 0.0006681126356124878, 0.00084308385848999)
****Stage 0 average time 0.0429019672871
****Stage 1 average time 0.00360232591629
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996911800729
****DCGs @ 8: 0.99285029507
****DCGs @ 16: 0.975345719294
****DCGs @ 32: 0.9479760291
****DCGs @ 64: 0.923929078226
****Error : 0.15454296875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.37241792679
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.03175333213806152, 0.043716347217559806)
('****Total time: ', 1.5125375872850417, 2.816406917572021)
('****Preprocess time: ', 0.006300725698471069, 0.009338903427124023)
('****Data time: ', 0.0005330630540847779, 0.0006389617919921875)
('****Fetch time: ', 7.87496566772461e-05, 9.107589721679688e-05)
('****Sort time: ', 0.0006723744869232178, 0.0008140087127685544)
****Stage 0 average time 0.0357232612371
****Stage 1 average time 0.00361498379707
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996827736961
****DCGs @ 8: 0.99276721793
****DCGs @ 16: 0.975121401485
****DCGs @ 32: 0.947834001511
****DCGs @ 64: 0.923896210064
****Error : 0.1546640625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.48902988434
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.030102997064590454, 0.04030852317810058)
('****Total time: ', 1.0822241444587708, 1.9635499835014343)
('****Preprocess time: ', 0.005903216004371643, 0.008497285842895505)
('****Data time: ', 0.000511993408203125, 0.0006108283996582031)
('****Fetch time: ', 7.948243618011474e-05, 8.988380432128906e-05)
('****Sort time: ', 0.0006825404167175293, 0.0008042216300964354)
****Stage 0 average time 0.0335920735598
****Stage 1 average time 0.0036881557703
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996730141949
****DCGs @ 8: 0.993040234559
****DCGs @ 16: 0.975320414787
****DCGs @ 32: 0.947959034278
****DCGs @ 64: 0.924002032822
****Error : 0.154609375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.44834804535
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.029660761952400208, 0.03655184507369993)
('****Total time: ', 0.4280462962388992, 0.7364726185798645)
('****Preprocess time: ', 0.005806644678115844, 0.007521009445190429)
('****Data time: ', 0.0005092051029205322, 0.0005991458892822266)
('****Fetch time: ', 7.748544216156006e-05, 8.703470230102533e-05)
('****Sort time: ', 0.0006718932390213012, 0.0007908463478088378)
****Stage 0 average time 0.0330662190914
****Stage 1 average time 0.0036597713232
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996841268205
****DCGs @ 8: 0.992647265024
****DCGs @ 16: 0.975300096201
****DCGs @ 32: 0.947979210456
****DCGs @ 64: 0.923997798369
****Error : 0.15454296875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.47528219223
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.029247528076171876, 0.03456966876983642)
('****Total time: ', 0.041875367164611814, 0.05396492481231682)
('****Preprocess time: ', 0.00567557692527771, 0.006641042232513412)
('****Data time: ', 0.0005022680759429932, 0.0005831718444824219)
('****Fetch time: ', 7.45922327041626e-05, 8.511543273925781e-05)
('****Sort time: ', 0.0006571052074432373, 0.0007488846778869628)
****Stage 0 average time 0.0325277377367
****Stage 1 average time 0.00362933278084
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996814205717
****DCGs @ 8: 0.992761343388
****DCGs @ 16: 0.97509531982
****DCGs @ 32: 0.947950706436
****DCGs @ 64: 0.92392095345
****Error : 0.154640625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.5361177921
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.02853649628162384, 0.034438836574554446)
('****Total time: ', 0.03850856029987335, 0.04618401527404784)
('****Preprocess time: ', 0.0055963735580444336, 0.0062508702278137205)
('****Data time: ', 0.0004955021142959595, 0.0005779266357421875)
('****Fetch time: ', 7.431840896606445e-05, 8.511543273925781e-05)
('****Sort time: ', 0.0006508092880249023, 0.0007102727890014647)
****Stage 0 average time 0.0317413797379
****Stage 1 average time 0.0036121199131
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996730141949
****DCGs @ 8: 0.993032821976
****DCGs @ 16: 0.97526398719
****DCGs @ 32: 0.947937242187
****DCGs @ 64: 0.923960440568
****Error : 0.1546171875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.99218297
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.028229583382606508, 0.0338145613670349)
('****Total time: ', 0.03797217071056366, 0.04511883258819579)
('****Preprocess time: ', 0.005567280650138855, 0.006132888793945313)
('****Data time: ', 0.0004940415620803833, 0.000576066970825195)
('****Fetch time: ', 7.349514961242676e-05, 8.41975212097166e-05)
('****Sort time: ', 0.0006422913074493409, 0.0006959438323974609)
****Stage 0 average time 0.0314217281342
****Stage 1 average time 0.00358496391773
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996911800729
****DCGs @ 8: 0.992691982935
****DCGs @ 16: 0.975263658849
****DCGs @ 32: 0.947969140651
****DCGs @ 64: 0.92399317646
****Error : 0.154546875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.0517408848
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.028656266927719116, 0.03633269071578979)
('****Total time: ', 0.0382130012512207, 0.04757984876632684)
('****Preprocess time: ', 0.005574721336364746, 0.006406199932098387)
('****Data time: ', 0.0004953902959823609, 0.0005748271942138672)
('****Fetch time: ', 7.316946983337402e-05, 8.58306884765625e-05)
('****Sort time: ', 0.0006519473791122436, 0.0007369518280029297)
****Stage 0 average time 0.0318664352894
****Stage 1 average time 0.00358506011963
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996659609425
****DCGs @ 8: 0.992803442885
****DCGs @ 16: 0.975092099038
****DCGs @ 32: 0.947890294471
****DCGs @ 64: 0.923899933434
****Error : 0.15467578125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  18.0437259674
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.027946139454841614, 0.03427079916000366)
('****Total time: ', 0.037273099780082704, 0.04508049488067625)
('****Preprocess time: ', 0.0055119385719299314, 0.006156444549560545)
('****Data time: ', 0.0004946075677871705, 0.0005750656127929688)
('****Fetch time: ', 7.289624214172364e-05, 8.27431678771972e-05)
('****Sort time: ', 0.0006599855422973632, 0.0007388710975646972)
****Stage 0 average time 0.0310937987566
****Stage 1 average time 0.0035917686224
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996898269485
****DCGs @ 8: 0.992958959601
****DCGs @ 16: 0.975267554756
****DCGs @ 32: 0.948015520251
****DCGs @ 64: 0.923987438437
****Error : 0.15455078125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.9399170876
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.02724825167655945, 0.031539165973663304)
('****Total time: ', 0.03620420110225678, 0.04109933376312254)
('****Preprocess time: ', 0.005423782110214234, 0.005971395969390868)
('****Data time: ', 0.0004923003911972046, 0.0005710124969482422)
('****Fetch time: ', 7.266831398010254e-05, 8.177757263183594e-05)
('****Sort time: ', 0.0006739120483398438, 0.0007238388061523438)
****Stage 0 average time 0.0303188254833
****Stage 1 average time 0.00359208905697
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996827736961
****DCGs @ 8: 0.992683547599
****DCGs @ 16: 0.975170524931
****DCGs @ 32: 0.947942921356
****DCGs @ 64: 0.923909728755
****Error : 0.154578125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.9019069672
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.027115355014801026, 0.030783355236053463)
('****Total time: ', 0.03608511412143707, 0.04020525217056274)
('****Preprocess time: ', 0.005414607524871826, 0.005909931659698487)
('****Data time: ', 0.000493984580039978, 0.0005750656127929688)
('****Fetch time: ', 7.256174087524414e-05, 8.012056350708001e-05)
('****Sort time: ', 0.0006531896591186523, 0.0007240772247314453)
****Stage 0 average time 0.0301649830341
****Stage 1 average time 0.00358471548557
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996659609425
****DCGs @ 8: 0.992972693529
****DCGs @ 16: 0.975260125149
****DCGs @ 32: 0.948037399125
****DCGs @ 64: 0.923960697976
****Error : 0.15466015625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  33.1800928116
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.0268893723487854, 0.030711722373962382)
('****Total time: ', 0.03584095275402069, 0.04020115137100219)
('****Preprocess time: ', 0.005392918586730957, 0.0059195041656494125)
('****Data time: ', 0.0004931627511978149, 0.0005741119384765625)
('****Fetch time: ', 7.246363162994385e-05, 7.987022399902344e-05)
('****Sort time: ', 0.0006449908018112182, 0.0007109642028808594)
****Stage 0 average time 0.0299189630747
****Stage 1 average time 0.00357394504547
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996982333253
****DCGs @ 8: 0.992889860246
****DCGs @ 16: 0.975395234838
****DCGs @ 32: 0.947976770081
****DCGs @ 64: 0.924011444018
****Error : 0.15455859375
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  4.18781995773
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03073856806755066, 0.0359636068344116)
('****Total time: ', 0.31832545626163483, 0.6058035135269165)
('****Preprocess time: ', 0.005837779521942138, 0.006764435768127429)
('****Data time: ', 0.0005752183198928833, 0.000698089599609375)
('****Fetch time: ', 7.048666477203369e-05, 7.727146148681628e-05)
('****Sort time: ', 0.0007309890985488891, 0.0009461522102355951)
****Stage 0 average time 0.0328509346247
****Stage 1 average time 0.00510210704803
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996911800729
****DCGs @ 8: 0.99285029507
****DCGs @ 16: 0.975345719294
****DCGs @ 32: 0.9479760291
****DCGs @ 64: 0.923929078226
****Error : 0.15454296875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.56593298912
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.03150589919090271, 0.039230704307556145)
('****Total time: ', 0.04690446674823761, 0.067476999759674)
('****Preprocess time: ', 0.0060122071504592894, 0.008687973022460938)
('****Data time: ', 0.0005722881555557251, 0.0006753444671630852)
('****Fetch time: ', 6.933391094207764e-05, 7.891654968261719e-05)
('****Sort time: ', 0.0007015566825866699, 0.0008441567420959464)
****Stage 0 average time 0.0336380217075
****Stage 1 average time 0.00522326338291
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996827736961
****DCGs @ 8: 0.99276721793
****DCGs @ 16: 0.975121401485
****DCGs @ 32: 0.947834001511
****DCGs @ 64: 0.923896210064
****Error : 0.1546640625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.78453993797
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.031084041357040404, 0.03712632656097409)
('****Total time: ', 0.04093458044528961, 0.048537051677703856)
('****Preprocess time: ', 0.006017174482345581, 0.008080685138702387)
('****Data time: ', 0.0005707800388336182, 0.0006718635559082031)
('****Fetch time: ', 6.480515003204346e-05, 7.605552673339844e-05)
('****Sort time: ', 0.0007077226638793945, 0.000840914249420166)
****Stage 0 average time 0.0333900741339
****Stage 1 average time 0.00505444955826
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996730141949
****DCGs @ 8: 0.993040234559
****DCGs @ 16: 0.975320414787
****DCGs @ 32: 0.947959034278
****DCGs @ 64: 0.924002032822
****Error : 0.154609375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  6.78667283058
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.0304976851940155, 0.03686648607254027)
('****Total time: ', 0.040285416007041934, 0.04807170629501343)
('****Preprocess time: ', 0.005966209173202515, 0.008042716979980465)
('****Data time: ', 0.0005596810579299926, 0.0006589889526367188)
('****Fetch time: ', 6.277000904083252e-05, 7.224082946777344e-05)
('****Sort time: ', 0.0006981006860733032, 0.0008192420005798338)
****Stage 0 average time 0.0328770164251
****Stage 1 average time 0.00490742969513
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996841268205
****DCGs @ 8: 0.992647265024
****DCGs @ 16: 0.975300096201
****DCGs @ 32: 0.947979210456
****DCGs @ 64: 0.923997798369
****Error : 0.15454296875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.68753480911
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.029637937664985656, 0.034364402294158936)
('****Total time: ', 0.039078365683555605, 0.044829034805297846)
('****Preprocess time: ', 0.005785123825073242, 0.00713008642196655)
('****Data time: ', 0.0005503159761428833, 0.0006442070007324219)
('****Fetch time: ', 5.952584743499756e-05, 7.013082504272441e-05)
('****Sort time: ', 0.0007165029048919678, 0.0008042335510253904)
****Stage 0 average time 0.0320713955164
****Stage 1 average time 0.00467801070213
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996814205717
****DCGs @ 8: 0.992761343388
****DCGs @ 16: 0.97509531982
****DCGs @ 32: 0.947950706436
****DCGs @ 64: 0.92392095345
****Error : 0.154640625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.8139631748
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.02936780047416687, 0.03451207876205444)
('****Total time: ', 0.03883347427845001, 0.04521747827529907)
('****Preprocess time: ', 0.005799205780029297, 0.007647430896759031)
('****Data time: ', 0.0005448827743530273, 0.0006361365318298338)
('****Fetch time: ', 5.725228786468506e-05, 6.796121597290033e-05)
('****Sort time: ', 0.0006952747106552124, 0.0007760524749755859)
****Stage 0 average time 0.0319169460535
****Stage 1 average time 0.00454746997356
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996730141949
****DCGs @ 8: 0.993032821976
****DCGs @ 16: 0.97526398719
****DCGs @ 32: 0.947937242187
****DCGs @ 64: 0.923960440568
****Error : 0.1546171875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.7660090923
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.02913563632965088, 0.03370548486709594)
('****Total time: ', 0.038416126370429994, 0.043748307228088375)
('****Preprocess time: ', 0.0057309213876724245, 0.006999647617340074)
('****Data time: ', 0.0005431797504425049, 0.0006301760673522947)
('****Fetch time: ', 5.6937575340271e-05, 6.67572021484375e-05)
('****Sort time: ', 0.0006866518259048462, 0.0007541656494140622)
****Stage 0 average time 0.0314660174847
****Stage 1 average time 0.00468730938435
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996911800729
****DCGs @ 8: 0.992691982935
****DCGs @ 16: 0.975263658849
****DCGs @ 32: 0.947969140651
****DCGs @ 64: 0.92399317646
****Error : 0.154546875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.9123101234
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.02855823814868927, 0.03244978189468384)
('****Total time: ', 0.03795640516281128, 0.0426974892616272)
('****Preprocess time: ', 0.0057035647630691525, 0.00673024654388427)
('****Data time: ', 0.0005400456190109253, 0.0006239414215087891)
('****Fetch time: ', 5.488419532775879e-05, 6.508827209472656e-05)
('****Sort time: ', 0.0006961894035339356, 0.0007479190826416016)
****Stage 0 average time 0.0310046387911
****Stage 1 average time 0.00454828333855
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996659609425
****DCGs @ 8: 0.992803442885
****DCGs @ 16: 0.975092099038
****DCGs @ 32: 0.947890294471
****DCGs @ 64: 0.923899933434
****Error : 0.15467578125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.9597530365
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.028433284044265747, 0.03255963325500487)
('****Total time: ', 0.03781535446643829, 0.04294955730438232)
('****Preprocess time: ', 0.005686243176460266, 0.006613302230834949)
('****Data time: ', 0.000540080189704895, 0.0006198883056640625)
('****Fetch time: ', 5.4844737052917484e-05, 6.413459777832031e-05)
('****Sort time: ', 0.000693355917930603, 0.0007441520690917966)
****Stage 0 average time 0.030968305707
****Stage 1 average time 0.00443950235844
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996898269485
****DCGs @ 8: 0.992958959601
****DCGs @ 16: 0.975267554756
****DCGs @ 32: 0.948015520251
****DCGs @ 64: 0.923987438437
****Error : 0.15455078125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.984153986
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.027667287707328795, 0.031117546558380123)
('****Total time: ', 0.036878535389900206, 0.04089833498001097)
('****Preprocess time: ', 0.005578649282455444, 0.0059088349342346184)
('****Data time: ', 0.0005329458713531494, 0.0006129741668701172)
('****Fetch time: ', 5.255270004272461e-05, 6.17623329162597e-05)
('****Sort time: ', 0.0006910874843597412, 0.0007410049438476562)
****Stage 0 average time 0.0302417269945
****Stage 1 average time 0.00428079605103
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996827736961
****DCGs @ 8: 0.992683547599
****DCGs @ 16: 0.975170524931
****DCGs @ 32: 0.947942921356
****DCGs @ 64: 0.923909728755
****Error : 0.154578125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.6283388138
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.027831183314323424, 0.031164228916168213)
('****Total time: ', 0.03687617027759552, 0.04078102111816406)
('****Preprocess time: ', 0.005571203112602234, 0.005922174453735351)
('****Data time: ', 0.000530950665473938, 0.0006101131439208984)
('****Fetch time: ', 5.330193042755127e-05, 6.29425048828125e-05)
('****Sort time: ', 0.0006883770227432251, 0.0007357716560363769)
****Stage 0 average time 0.0303006538153
****Stage 1 average time 0.0043743622303
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996659609425
****DCGs @ 8: 0.992972693529
****DCGs @ 16: 0.975260125149
****DCGs @ 32: 0.948037399125
****DCGs @ 64: 0.923960697976
****Error : 0.15466015625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  33.1275868416
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.02765459454059601, 0.030924797058105465)
('****Total time: ', 0.03692620432376861, 0.04100203514099121)
('****Preprocess time: ', 0.005562701463699341, 0.0059239864349365234)
('****Data time: ', 0.0005323572158813476, 0.0006170272827148438)
('****Fetch time: ', 5.55037260055542e-05, 6.29425048828125e-05)
('****Sort time: ', 0.0006976344585418701, 0.0007350921630859372)
****Stage 0 average time 0.0300717206001
****Stage 1 average time 0.0044310708046
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996982333253
****DCGs @ 8: 0.992889860246
****DCGs @ 16: 0.975395234838
****DCGs @ 32: 0.947976770081
****DCGs @ 64: 0.924011444018
****Error : 0.15455859375
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  20.6907351017
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008698772072792054, 0.009238958358764648)
('****Total time: ', 8.951431087851525, 16.87835941314697)
('****Preprocess time: ', 0.0047401471138000485, 0.0048531174659729)
('****Data time: ', 0.00034752392768859866, 0.0003681182861328125)
('****Fetch time: ', 0.00014359831809997558, 0.00014901161193847656)
('****Sort time: ', 0.0006292904615402222, 0.0006649613380432128)
****Stage 0 average time 0.0106170648336
****Stage 1 average time 0.00394226706028
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996911800729
****DCGs @ 8: 0.99285029507
****DCGs @ 16: 0.975345719294
****DCGs @ 32: 0.9479760291
****DCGs @ 64: 0.923929078226
****Error : 0.15454296875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.525179863
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.00861750602722168, 0.00908808708190918)
('****Total time: ', 8.300829707145692, 15.843090581893918)
('****Preprocess time: ', 0.004732926845550537, 0.004838037490844727)
('****Data time: ', 0.00034402215480804446, 0.0003650188446044922)
('****Fetch time: ', 0.00014719712734222412, 0.0001709461212158203)
('****Sort time: ', 0.0006255348920822144, 0.0006527900695800781)
****Stage 0 average time 0.0105067712069
****Stage 1 average time 0.00396041584015
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996827736961
****DCGs @ 8: 0.99276721793
****DCGs @ 16: 0.975121401485
****DCGs @ 32: 0.947834001511
****DCGs @ 64: 0.923896210064
****Error : 0.1546640625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.7322430611
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008819991707801818, 0.00934910774230957)
('****Total time: ', 7.970421917915345, 15.004073405265805)
('****Preprocess time: ', 0.004733680009841919, 0.0048296570777893065)
('****Data time: ', 0.00034590566158294677, 0.0003657460212707519)
('****Fetch time: ', 0.00014348649978637696, 0.00015091896057128906)
('****Sort time: ', 0.0006314762830734253, 0.0006649613380432128)
****Stage 0 average time 0.0106276512146
****Stage 1 average time 0.00404688894749
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996730141949
****DCGs @ 8: 0.993040234559
****DCGs @ 16: 0.975320414787
****DCGs @ 32: 0.947959034278
****DCGs @ 64: 0.924002032822
****Error : 0.154609375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  19.312319994
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.008111986875534058, 0.009231913089752197)
('****Total time: ', 6.63143812084198, 12.621758902072905)
('****Preprocess time: ', 0.004788267731666565, 0.006981849670410156)
('****Data time: ', 0.00031800532341003416, 0.0003371238708496094)
('****Fetch time: ', 0.00018409085273742677, 0.00019097328186035156)
('****Sort time: ', 0.0006302015781402588, 0.00065995454788208)
****Stage 0 average time 0.00993687319756
****Stage 1 average time 0.00409567916393
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996841268205
****DCGs @ 8: 0.992647265024
****DCGs @ 16: 0.975300096201
****DCGs @ 32: 0.947979210456
****DCGs @ 64: 0.923997798369
****Error : 0.15454296875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  19.3059380054
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.008099894285202027, 0.009233319759368896)
('****Total time: ', 5.614420477986336, 10.643534433841705)
('****Preprocess time: ', 0.004795173168182373, 0.006963062286376952)
('****Data time: ', 0.00032373595237731933, 0.00033593177795410156)
('****Fetch time: ', 0.00018437445163726806, 0.00019121170043945312)
('****Sort time: ', 0.0006277879476547241, 0.000653994083404541)
****Stage 0 average time 0.00993531560898
****Stage 1 average time 0.00409565019608
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996814205717
****DCGs @ 8: 0.992761343388
****DCGs @ 16: 0.97509531982
****DCGs @ 32: 0.947950706436
****DCGs @ 64: 0.92392095345
****Error : 0.154640625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.6152009964
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.008729304909706116, 0.009169864654541017)
('****Total time: ', 5.197498934388161, 9.897944295406338)
('****Preprocess time: ', 0.004732439994812012, 0.004821062088012695)
('****Data time: ', 0.0003455164432525635, 0.0003638267517089844)
('****Fetch time: ', 0.00014520478248596192, 0.00015306472778320312)
('****Sort time: ', 0.0006345198154449463, 0.0006620883941650391)
****Stage 0 average time 0.0105791970491
****Stage 1 average time 0.00400778889656
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996730141949
****DCGs @ 8: 0.993032821976
****DCGs @ 16: 0.97526398719
****DCGs @ 32: 0.947937242187
****DCGs @ 64: 0.923960440568
****Error : 0.1546171875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.2706518173
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008580800533294677, 0.009116220474243163)
('****Total time: ', 4.000482413291931, 7.7693405747413635)
('****Preprocess time: ', 0.004692195177078247, 0.0048001170158386225)
('****Data time: ', 0.0003402334451675415, 0.0003581047058105469)
('****Fetch time: ', 0.00015355420112609863, 0.00017905235290527344)
('****Sort time: ', 0.0006271613836288453, 0.0006537437438964844)
****Stage 0 average time 0.0104083565474
****Stage 1 average time 0.00398558819294
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996911800729
****DCGs @ 8: 0.992691982935
****DCGs @ 16: 0.975263658849
****DCGs @ 32: 0.947969140651
****DCGs @ 64: 0.92399317646
****Error : 0.154546875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.567150116
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.008711491584777832, 0.009181976318359375)
('****Total time: ', 3.1563962619304657, 6.086602103710173)
('****Preprocess time: ', 0.004713692307472229, 0.004823923110961914)
('****Data time: ', 0.0003467820882797241, 0.0003619194030761719)
('****Fetch time: ', 0.00014500975608825684, 0.00015306472778320312)
('****Sort time: ', 0.0006306004524230957, 0.0006580352783203125)
****Stage 0 average time 0.0105554703474
****Stage 1 average time 0.00399210584164
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996659609425
****DCGs @ 8: 0.992803442885
****DCGs @ 16: 0.975092099038
****DCGs @ 32: 0.947890294471
****DCGs @ 64: 0.923899933434
****Error : 0.15467578125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  18.950622797
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007969345688819886, 0.008440053462982178)
('****Total time: ', 0.9858024784326553, 1.8007922053337095)
('****Preprocess time: ', 0.004607938289642334, 0.0047380924224853516)
('****Data time: ', 0.0003202286958694458, 0.00033811330795288066)
('****Fetch time: ', 0.00017843103408813477, 0.00018596649169921875)
('****Sort time: ', 0.0006295404434204101, 0.0006611347198486328)
****Stage 0 average time 0.00975911450386
****Stage 1 average time 0.00394636964798
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996898269485
****DCGs @ 8: 0.992958959601
****DCGs @ 16: 0.975267554756
****DCGs @ 32: 0.948015520251
****DCGs @ 64: 0.923987438437
****Error : 0.15455078125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.6676430702
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.008077593803405761, 0.009121084213256836)
('****Total time: ', 0.017946922779083253, 0.024799203872680663)
('****Preprocess time: ', 0.004775053858757019, 0.005318295955657959)
('****Data time: ', 0.00034146559238433836, 0.0004649162292480469)
('****Fetch time: ', 0.0001652500629425049, 0.00018024444580078125)
('****Sort time: ', 0.0006161756515502929, 0.0006630420684814453)
****Stage 0 average time 0.0100159417391
****Stage 1 average time 0.00395959722996
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996827736961
****DCGs @ 8: 0.992683547599
****DCGs @ 16: 0.975170524931
****DCGs @ 32: 0.947942921356
****DCGs @ 64: 0.923909728755
****Error : 0.154578125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.4389588833
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.008012850999832153, 0.00911194086074829)
('****Total time: ', 0.016314921855926513, 0.019541597366333)
('****Preprocess time: ', 0.004761212587356568, 0.00533618927001953)
('****Data time: ', 0.00033988869190216067, 0.00045609474182128906)
('****Fetch time: ', 0.0001668468713760376, 0.0001807332038879394)
('****Sort time: ', 0.0006156196594238281, 0.0006718635559082031)
****Stage 0 average time 0.00992937576771
****Stage 1 average time 0.00396704304218
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996659609425
****DCGs @ 8: 0.992972693529
****DCGs @ 16: 0.975260125149
****DCGs @ 32: 0.948037399125
****DCGs @ 64: 0.923960697976
****Error : 0.15466015625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  32.5062339306
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.008067370653152465, 0.009200239181518553)
('****Total time: ', 0.015861362099647523, 0.017780792713165284)
('****Preprocess time: ', 0.004742330312728882, 0.005295121669769287)
('****Data time: ', 0.00033949005603790285, 0.00044871568679809564)
('****Fetch time: ', 0.0001642378568649292, 0.00018072128295898438)
('****Sort time: ', 0.0006063334941864014, 0.0006709098815917969)
****Stage 0 average time 0.00993082296848
****Stage 1 average time 0.00398893940449
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996982333253
****DCGs @ 8: 0.992889860246
****DCGs @ 16: 0.975395234838
****DCGs @ 32: 0.947976770081
****DCGs @ 64: 0.924011444018
****Error : 0.15455859375
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  9.57027983665
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.035141046643257144, 0.04910078048706054)
('****Total time: ', 3.133930508494377, 5.414646494388581)
('****Preprocess time: ', 0.007379564046859741, 0.01082977056503295)
('****Data time: ', 0.0006259410381317139, 0.0007658004760742188)
('****Fetch time: ', 8.924102783203124e-05, 0.00011396408081054688)
('****Sort time: ', 0.0009094330072402955, 0.0011764645576477033)
****Stage 0 average time 0.0393724108934
****Stage 1 average time 0.00477281486988
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996925331974
****DCGs @ 8: 0.992815289437
****DCGs @ 16: 0.975357740856
****DCGs @ 32: 0.948325805724
****DCGs @ 64: 0.924683011319
****Error : 0.323357421875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.02984189987
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.031310084462165835, 0.04368281364440918)
('****Total time: ', 2.484000153541565, 4.347287333011627)
('****Preprocess time: ', 0.00661133885383606, 0.009624552726745603)
('****Data time: ', 0.0005660610198974609, 0.0006783246994018553)
('****Fetch time: ', 8.20167064666748e-05, 9.584426879882812e-05)
('****Sort time: ', 0.0009099162817001342, 0.0011561274528503417)
****Stage 0 average time 0.0349298430681
****Stage 1 average time 0.00454957425594
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.99685479945
****DCGs @ 8: 0.992826909906
****DCGs @ 16: 0.975186480938
****DCGs @ 32: 0.948222044522
****DCGs @ 64: 0.924593020673
****Error : 0.32330078125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.5867369175
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03088436472415924, 0.041418170928955084)
('****Total time: ', 1.5868332479000091, 2.9409229874610894)
('****Preprocess time: ', 0.006449880123138428, 0.009049642086029049)
('****Data time: ', 0.0005548334121704101, 0.0006589889526367188)
('****Fetch time: ', 7.683300971984864e-05, 8.893013000488281e-05)
('****Sort time: ', 0.000888251781463623, 0.0010848522186279294)
****Stage 0 average time 0.0345334790945
****Stage 1 average time 0.00432068395615
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996868330694
****DCGs @ 8: 0.992999436242
****DCGs @ 16: 0.975407292964
****DCGs @ 32: 0.948236641891
****DCGs @ 64: 0.924630039653
****Error : 0.323311523438
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.71411800385
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.030026179432868956, 0.037590289115905756)
('****Total time: ', 1.1141746145486833, 2.068270969390869)
('****Preprocess time: ', 0.0062522017955780025, 0.00822006464004516)
('****Data time: ', 0.0005361273288726807, 0.00061802864074707)
('****Fetch time: ', 7.701671123504639e-05, 8.630752563476562e-05)
('****Sort time: ', 0.0009335628747940063, 0.0010920166969299312)
****Stage 0 average time 0.0334047816992
****Stage 1 average time 0.00442030644417
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996841268205
****DCGs @ 8: 0.992647265024
****DCGs @ 16: 0.97533140288
****DCGs @ 32: 0.948337587245
****DCGs @ 64: 0.924705691892
****Error : 0.323315429687
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.92494010925
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.029867466926574708, 0.038211584091186426)
('****Total time: ', 0.1216087120771408, 0.1855887651443481)
('****Preprocess time: ', 0.006235326886177063, 0.008310627937316892)
('****Data time: ', 0.0005403863191604614, 0.0006198883056640625)
('****Fetch time: ', 7.706403732299805e-05, 8.702278137207031e-05)
('****Sort time: ', 0.0008927271366119385, 0.0010520100593566888)
****Stage 0 average time 0.0331221618652
****Stage 1 average time 0.00449080944061
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.997009395742
****DCGs @ 8: 0.9927883472
****DCGs @ 16: 0.975180833137
****DCGs @ 32: 0.948270206479
****DCGs @ 64: 0.924609287176
****Error : 0.323305664062
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.907269001
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.028825756430625914, 0.034530234336853025)
('****Total time: ', 0.0414765408039093, 0.05070459842681885)
('****Preprocess time: ', 0.006052665710449219, 0.006665134429931634)
('****Data time: ', 0.0005288517475128174, 0.0006101131439208984)
('****Fetch time: ', 7.497441768646241e-05, 8.606910705566406e-05)
('****Sort time: ', 0.0008906869888305664, 0.0010328769683837888)
****Stage 0 average time 0.031831782937
****Stage 1 average time 0.00454115235806
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.99679779817
****DCGs @ 8: 0.99295535137
****DCGs @ 16: 0.975315580915
****DCGs @ 32: 0.948298818196
****DCGs @ 64: 0.924683374671
****Error : 0.323303710937
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.0461289883
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.028868767857551575, 0.034760713577270494)
('****Total time: ', 0.04013665127754212, 0.04814902544021606)
('****Preprocess time: ', 0.006037622332572937, 0.006711685657501218)
('****Data time: ', 0.000535556435585022, 0.0006229877471923828)
('****Fetch time: ', 7.734489440917969e-05, 8.916854858398438e-05)
('****Sort time: ', 0.0008425914049148559, 0.0009482264518737791)
****Stage 0 average time 0.0317478675842
****Stage 1 average time 0.00461401534081
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996814205717
****DCGs @ 8: 0.992717570326
****DCGs @ 16: 0.975307057159
****DCGs @ 32: 0.948312902057
****DCGs @ 64: 0.924649790222
****Error : 0.323294921875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.0723898411
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.028476840376853944, 0.034509015083312986)
('****Total time: ', 0.0392663152217865, 0.04753814935684203)
('****Preprocess time: ', 0.006032926201820374, 0.006788110733032226)
('****Data time: ', 0.0005279231071472168, 0.0006148934364318847)
('****Fetch time: ', 7.504606246948243e-05, 8.797645568847656e-05)
('****Sort time: ', 0.0008811545372009277, 0.0009908795356750487)
****Stage 0 average time 0.0313115965128
****Stage 1 average time 0.0046822937727
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996925331974
****DCGs @ 8: 0.992787324447
****DCGs @ 16: 0.975194978778
****DCGs @ 32: 0.94819745372
****DCGs @ 64: 0.924558875506
****Error : 0.323314453125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.7223649025
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.028546830892562866, 0.03455215692520141)
('****Total time: ', 0.038684173703193665, 0.047420680522918694)
('****Preprocess time: ', 0.006120986700057983, 0.007933199405670164)
('****Data time: ', 0.0005289980173110962, 0.0006160736083984375)
('****Fetch time: ', 7.637274265289306e-05, 9.084939956665033e-05)
('****Sort time: ', 0.0008307937383651734, 0.0009360432624816894)
****Stage 0 average time 0.0313225234747
****Stage 1 average time 0.00478145861626
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996868330694
****DCGs @ 8: 0.992944713807
****DCGs @ 16: 0.975312050989
****DCGs @ 32: 0.948362150844
****DCGs @ 64: 0.924707213488
****Error : 0.3233046875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  23.0918018818
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.027759108543395996, 0.03145886659622193)
('****Total time: ', 0.037527501583099365, 0.04189203977584838)
('****Preprocess time: ', 0.005923718929290772, 0.006345081329345702)
('****Data time: ', 0.0005243216753005981, 0.0006089210510253906)
('****Fetch time: ', 7.656168937683105e-05, 8.678436279296875e-05)
('****Sort time: ', 0.0008235549926757812, 0.0008878707885742188)
****Stage 0 average time 0.0304813107252
****Stage 1 average time 0.00462595510483
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996925331974
****DCGs @ 8: 0.992700117325
****DCGs @ 16: 0.975250384626
****DCGs @ 32: 0.948329892785
****DCGs @ 64: 0.924639535315
****Error : 0.323306640625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.5992770195
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.02767594575881958, 0.0317009687423706)
('****Total time: ', 0.037262834787368776, 0.04166313409805297)
('****Preprocess time: ', 0.0059593280553817745, 0.006478083133697509)
('****Data time: ', 0.0005333923101425171, 0.0006170272827148438)
('****Fetch time: ', 7.673537731170654e-05, 8.797645568847656e-05)
('****Sort time: ', 0.0008431508541107178, 0.0009000301361083984)
****Stage 0 average time 0.0303796910048
****Stage 1 average time 0.00470886135101
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.99685479945
****DCGs @ 8: 0.992959800071
****DCGs @ 16: 0.975364589275
****DCGs @ 32: 0.948313414858
****DCGs @ 64: 0.92464190336
****Error : 0.323330078125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  32.9859461784
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.02770301616191864, 0.032378911972045885)
('****Total time: ', 0.03740917193889618, 0.04274321794509887)
('****Preprocess time: ', 0.00594379985332489, 0.006462872028350825)
('****Data time: ', 0.0005299268960952759, 0.0006218552589416501)
('****Fetch time: ', 7.513713836669922e-05, 8.702278137207031e-05)
('****Sort time: ', 0.0008486286401748657, 0.0009169578552246094)
****Stage 0 average time 0.0304004299641
****Stage 1 average time 0.00470007872581
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996925331974
****DCGs @ 8: 0.992818182324
****DCGs @ 16: 0.975405900842
****DCGs @ 32: 0.948324490131
****DCGs @ 64: 0.924687974002
****Error : 0.323276367188
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  4.41709303856
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03792037582397461, 0.04973442554473877)
('****Total time: ', 0.4447504564523697, 0.680884563922882)
('****Preprocess time: ', 0.006884011268615722, 0.010789918899536134)
('****Data time: ', 0.0006456829309463501, 0.0007771015167236323)
('****Fetch time: ', 7.21588134765625e-05, 8.488893508911126e-05)
('****Sort time: ', 0.0009855977296829223, 0.001360726356506347)
****Stage 0 average time 0.0350490407944
****Stage 1 average time 0.0114587857723
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996925331974
****DCGs @ 8: 0.992815289437
****DCGs @ 16: 0.975357740856
****DCGs @ 32: 0.948325805724
****DCGs @ 64: 0.924683011319
****Error : 0.323357421875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.83933496475
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.03780770123004913, 0.048104357719421384)
('****Total time: ', 0.052664844751358034, 0.06662707328796386)
('****Preprocess time: ', 0.00678024423122406, 0.010127675533294673)
('****Data time: ', 0.0006537870168685913, 0.0008030056953430175)
('****Fetch time: ', 7.137036323547363e-05, 8.392333984375e-05)
('****Sort time: ', 0.0009342043399810791, 0.0011739850044250487)
****Stage 0 average time 0.034851754427
****Stage 1 average time 0.0113955527544
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.99685479945
****DCGs @ 8: 0.992826909906
****DCGs @ 16: 0.975186480938
****DCGs @ 32: 0.948222044522
****DCGs @ 64: 0.924593020673
****Error : 0.32330078125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.76907801628
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03770388031005859, 0.04887363910675048)
('****Total time: ', 0.049306310415267944, 0.06308467388153075)
('****Preprocess time: ', 0.006865316152572632, 0.01005711555480957)
('****Data time: ', 0.0006382602453231811, 0.0007660508155822753)
('****Fetch time: ', 6.97031021118164e-05, 7.987022399902344e-05)
('****Sort time: ', 0.0009658116102218627, 0.0011580467224121091)
****Stage 0 average time 0.0353769880533
****Stage 1 average time 0.010865983367
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996868330694
****DCGs @ 8: 0.992999436242
****DCGs @ 16: 0.975407292964
****DCGs @ 32: 0.948236641891
****DCGs @ 64: 0.924630039653
****Error : 0.323311523438
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  6.89027190208
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.03618224930763245, 0.044319283962249746)
('****Total time: ', 0.04684369957447052, 0.05658327341079712)
('****Preprocess time: ', 0.006692084550857544, 0.009308552742004384)
('****Data time: ', 0.0006281015872955322, 0.0007241129875183104)
('****Fetch time: ', 6.783390045166016e-05, 7.605552673339844e-05)
('****Sort time: ', 0.0009212323427200317, 0.0011130928993225088)
****Stage 0 average time 0.0341071546078
****Stage 1 average time 0.0103843470812
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996841268205
****DCGs @ 8: 0.992647265024
****DCGs @ 16: 0.97533140288
****DCGs @ 32: 0.948337587245
****DCGs @ 64: 0.924705691892
****Error : 0.323315429687
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.5891020298
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.03491981267929077, 0.042436873912811264)
('****Total time: ', 0.045109811186790465, 0.05392472743988037)
('****Preprocess time: ', 0.006450246214866638, 0.008684790134429918)
('****Data time: ', 0.0005927685499191284, 0.0006949901580810547)
('****Fetch time: ', 6.167483329772949e-05, 7.319450378417969e-05)
('****Sort time: ', 0.000911247968673706, 0.0010929226875305174)
****Stage 0 average time 0.0331377893686
****Stage 1 average time 0.00979796087742
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.997009395742
****DCGs @ 8: 0.9927883472
****DCGs @ 16: 0.975180833137
****DCGs @ 32: 0.948270206479
****DCGs @ 64: 0.924609287176
****Error : 0.323305664062
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.9446280003
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.03441708517074585, 0.04084014892578124)
('****Total time: ', 0.04458628857135773, 0.05198818445205688)
('****Preprocess time: ', 0.0063947092294693, 0.008589076995849609)
('****Data time: ', 0.0005893253087997436, 0.0006780743598937988)
('****Fetch time: ', 6.137001514434814e-05, 6.985664367675781e-05)
('****Sort time: ', 0.0008987405300140381, 0.0010181069374084468)
****Stage 0 average time 0.0324748936892
****Stage 1 average time 0.00988633656502
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.99679779817
****DCGs @ 8: 0.99295535137
****DCGs @ 16: 0.975315580915
****DCGs @ 32: 0.948298818196
****DCGs @ 64: 0.924683374671
****Error : 0.323303710937
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.5552837849
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.033418880701065065, 0.04029029607772827)
('****Total time: ', 0.04332234525680542, 0.050970530509948715)
('****Preprocess time: ', 0.00626404881477356, 0.008670771121978754)
('****Data time: ', 0.0005730860233306885, 0.0006640076637268066)
('****Fetch time: ', 5.750668048858643e-05, 6.794929504394531e-05)
('****Sort time: ', 0.000890853762626648, 0.0010188221931457515)
****Stage 0 average time 0.0316701221466
****Stage 1 average time 0.00953425383568
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996814205717
****DCGs @ 8: 0.992717570326
****DCGs @ 16: 0.975307057159
****DCGs @ 32: 0.948312902057
****DCGs @ 64: 0.924649790222
****Error : 0.323294921875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.5490608215
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.03313056743144989, 0.03766422271728516)
('****Total time: ', 0.043031951785087584, 0.048124527931213364)
('****Preprocess time: ', 0.006258840918540955, 0.0072501301765441895)
('****Data time: ', 0.0005906703472137451, 0.0006740093231201172)
('****Fetch time: ', 5.702602863311768e-05, 6.699562072753906e-05)
('****Sort time: ', 0.0008983613252639771, 0.0010027885437011719)
****Stage 0 average time 0.0315117077827
****Stage 1 average time 0.00942375826836
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996925331974
****DCGs @ 8: 0.992787324447
****DCGs @ 16: 0.975194978778
****DCGs @ 32: 0.94819745372
****DCGs @ 64: 0.924558875506
****Error : 0.323314453125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.8230149746
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.032623254299163816, 0.03711081743240357)
('****Total time: ', 0.04242505717277527, 0.047772562503814675)
('****Preprocess time: ', 0.006125385880470276, 0.007337081432342524)
('****Data time: ', 0.0005622560977935791, 0.0006508827209472656)
('****Fetch time: ', 5.4940700531005857e-05, 6.389617919921875e-05)
('****Sort time: ', 0.0008902121782302856, 0.0010003089904785148)
****Stage 0 average time 0.0308057433367
****Stage 1 average time 0.00945030581951
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996868330694
****DCGs @ 8: 0.992944713807
****DCGs @ 16: 0.975312050989
****DCGs @ 32: 0.948362150844
****DCGs @ 64: 0.924707213488
****Error : 0.3233046875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.8190588951
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.03222799289226532, 0.03651845455169678)
('****Total time: ', 0.04194662630558014, 0.04676570892333984)
('****Preprocess time: ', 0.006067629694938659, 0.006850612163543698)
('****Data time: ', 0.0005596126317977905, 0.0006418228149414062)
('****Fetch time: ', 5.489611625671387e-05, 6.295442581176751e-05)
('****Sort time: ', 0.0008810933828353882, 0.0009450912475585938)
****Stage 0 average time 0.0303521872759
****Stage 1 average time 0.00943903744221
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996925331974
****DCGs @ 8: 0.992700117325
****DCGs @ 16: 0.975250384626
****DCGs @ 32: 0.948329892785
****DCGs @ 64: 0.924639535315
****Error : 0.323306640625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  27.0023150444
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.031911563277244565, 0.03611652851104736)
('****Total time: ', 0.04190295827388763, 0.04641151428222656)
('****Preprocess time: ', 0.006025589942932129, 0.006738233566284175)
('****Data time: ', 0.000557194471359253, 0.0006399154663085938)
('****Fetch time: ', 5.409860610961914e-05, 6.222724914550781e-05)
('****Sort time: ', 0.0008790063858032227, 0.0009388923645019531)
****Stage 0 average time 0.030232596159
****Stage 1 average time 0.00919485652447
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.99685479945
****DCGs @ 8: 0.992959800071
****DCGs @ 16: 0.975364589275
****DCGs @ 32: 0.948313414858
****DCGs @ 64: 0.92464190336
****Error : 0.323330078125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  33.0900211334
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.03130075979232788, 0.03410590887069701)
('****Total time: ', 0.041241759657859804, 0.04448509216308594)
('****Preprocess time: ', 0.005923751592636108, 0.006316280364990233)
('****Data time: ', 0.0005580787658691406, 0.0006330013275146484)
('****Fetch time: ', 5.392515659332276e-05, 6.008148193359375e-05)
('****Sort time: ', 0.0008733276128768921, 0.0009351134300231932)
****Stage 0 average time 0.0296137797832
****Stage 1 average time 0.00909606313705
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996925331974
****DCGs @ 8: 0.992818182324
****DCGs @ 16: 0.975405900842
****DCGs @ 32: 0.948324490131
****DCGs @ 64: 0.924687974002
****Error : 0.323276367188
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  19.8407490253
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.012282704710960388, 0.01314411163330078)
('****Total time: ', 8.51547450041771, 16.078824615478513)
('****Preprocess time: ', 0.00528492283821106, 0.005440044403076172)
('****Data time: ', 0.00041611051559448244, 0.0004461169242858885)
('****Fetch time: ', 0.00016547095775604247, 0.00018405914306640625)
('****Sort time: ', 0.0008472034931182862, 0.0009059906005859375)
****Stage 0 average time 0.0102338247299
****Stage 1 average time 0.00876258778572
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996925331974
****DCGs @ 8: 0.992815289437
****DCGs @ 16: 0.975357740856
****DCGs @ 32: 0.948325805724
****DCGs @ 64: 0.924683011319
****Error : 0.323357421875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  19.6733198166
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.012260643243789672, 0.013202106952667237)
('****Total time: ', 7.947050807476043, 15.041807293891905)
('****Preprocess time: ', 0.005253843784332276, 0.005410909652709961)
('****Data time: ', 0.0004039344787597656, 0.00043702125549316406)
('****Fetch time: ', 0.00016972827911376954, 0.000186920166015625)
('****Sort time: ', 0.0008519871234893799, 0.0009021759033203125)
****Stage 0 average time 0.0101714090109
****Stage 1 average time 0.0087687278986
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.99685479945
****DCGs @ 8: 0.992826909906
****DCGs @ 16: 0.975186480938
****DCGs @ 32: 0.948222044522
****DCGs @ 64: 0.924593020673
****Error : 0.32330078125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  19.7343809605
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01229259204864502, 0.012977945804595947)
('****Total time: ', 7.415809106588363, 14.04211115837097)
('****Preprocess time: ', 0.005239445567131042, 0.005345141887664795)
('****Data time: ', 0.0004001630544662476, 0.000431060791015625)
('****Fetch time: ', 0.00016749751567840575, 0.00018405914306640625)
('****Sort time: ', 0.000857606291770935, 0.00090789794921875)
****Stage 0 average time 0.0102117403746
****Stage 1 average time 0.00874556410313
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996868330694
****DCGs @ 8: 0.992999436242
****DCGs @ 16: 0.975407292964
****DCGs @ 32: 0.948236641891
****DCGs @ 64: 0.924630039653
****Error : 0.323311523438
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  19.5522871017
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.012212976813316345, 0.01304495334625244)
('****Total time: ', 6.754009964585304, 12.859674310684204)
('****Preprocess time: ', 0.0052105156183242796, 0.0053298592567443855)
('****Data time: ', 0.0003988443613052368, 0.0004313230514526366)
('****Fetch time: ', 0.0001710050106048584, 0.00018787384033203125)
('****Sort time: ', 0.0008520903587341308, 0.0009072184562683104)
****Stage 0 average time 0.0101142338514
****Stage 1 average time 0.00873119831085
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996841268205
****DCGs @ 8: 0.992647265024
****DCGs @ 16: 0.97533140288
****DCGs @ 32: 0.948337587245
****DCGs @ 64: 0.924705691892
****Error : 0.323315429687
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  19.5183138847
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.012219023227691651, 0.013185465335845945)
('****Total time: ', 5.761284662127495, 10.860757946968079)
('****Preprocess time: ', 0.0052113295793533325, 0.0053591251373291005)
('****Data time: ', 0.0004021081924438477, 0.00042891502380371094)
('****Fetch time: ', 0.0001733478307723999, 0.0001881122589111328)
('****Sort time: ', 0.0008556168079376221, 0.0009260177612304688)
****Stage 0 average time 0.0100926537514
****Stage 1 average time 0.00876877188683
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.997009395742
****DCGs @ 8: 0.9927883472
****DCGs @ 16: 0.975180833137
****DCGs @ 32: 0.948270206479
****DCGs @ 64: 0.924609287176
****Error : 0.323305664062
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  19.5882430077
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.012250982880592346, 0.013120651245117186)
('****Total time: ', 4.646653979659081, 8.929131054878233)
('****Preprocess time: ', 0.005218183398246765, 0.005331456661224364)
('****Data time: ', 0.00039968085289001466, 0.00042891502380371094)
('****Fetch time: ', 0.00017114365100860595, 0.0001862049102783203)
('****Sort time: ', 0.0008497915267944336, 0.0009021759033203125)
****Stage 0 average time 0.0101383032799
****Stage 1 average time 0.00875147902966
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.99679779817
****DCGs @ 8: 0.99295535137
****DCGs @ 16: 0.975315580915
****DCGs @ 32: 0.948298818196
****DCGs @ 64: 0.924683374671
****Error : 0.323303710937
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  19.4533648491
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.012125345468521119, 0.01309609413146971)
('****Total time: ', 3.6583819442987444, 6.94943481683731)
('****Preprocess time: ', 0.005175946593284607, 0.005311274528503418)
('****Data time: ', 0.0004048378467559814, 0.00043392181396484375)
('****Fetch time: ', 0.00017203068733215332, 0.00018596649169921875)
('****Sort time: ', 0.0008519247770309448, 0.000905764102935791)
****Stage 0 average time 0.0100592091084
****Stage 1 average time 0.00867087626457
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996814205717
****DCGs @ 8: 0.992717570326
****DCGs @ 16: 0.975307057159
****DCGs @ 32: 0.948312902057
****DCGs @ 64: 0.924649790222
****Error : 0.323294921875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  19.6032760143
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.012199322104454041, 0.013283216953277586)
('****Total time: ', 2.6491993176937103, 5.087134778499602)
('****Preprocess time: ', 0.005209182620048523, 0.005341827869415282)
('****Data time: ', 0.0003994940519332886, 0.00043201446533203125)
('****Fetch time: ', 0.00016850483417510986, 0.0001862049102783203)
('****Sort time: ', 0.0008497992753982544, 0.0008997917175292969)
****Stage 0 average time 0.0101395999193
****Stage 1 average time 0.00868670296669
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996925331974
****DCGs @ 8: 0.992787324447
****DCGs @ 16: 0.975194978778
****DCGs @ 32: 0.94819745372
****DCGs @ 64: 0.924558875506
****Error : 0.323314453125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.67319417
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.012877150654792786, 0.014212143421173095)
('****Total time: ', 1.5943015443086623, 3.1440799832344055)
('****Preprocess time: ', 0.005218815684318543, 0.005407130718231201)
('****Data time: ', 0.00039147186279296875, 0.00044417381286621094)
('****Fetch time: ', 0.00014186358451843262, 0.0001537799835205078)
('****Sort time: ', 0.0008463385105133056, 0.0008730888366699219)
****Stage 0 average time 0.0106748331785
****Stage 1 average time 0.00880080711842
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996868330694
****DCGs @ 8: 0.992944713807
****DCGs @ 16: 0.975312050989
****DCGs @ 32: 0.948362150844
****DCGs @ 64: 0.924707213488
****Error : 0.3233046875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.7219519615
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.012354407906532288, 0.013957297801971427)
('****Total time: ', 0.023283035159111024, 0.031666409969329824)
('****Preprocess time: ', 0.005312244534492493, 0.005810177326202392)
('****Data time: ', 0.0003948822021484375, 0.0004847168922424316)
('****Fetch time: ', 0.00016286599636077881, 0.00018310546875)
('****Sort time: ', 0.0008289594650268554, 0.0008788108825683594)
****Stage 0 average time 0.0102598062754
****Stage 1 average time 0.00879355382919
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996925331974
****DCGs @ 8: 0.992700117325
****DCGs @ 16: 0.975250384626
****DCGs @ 32: 0.948329892785
****DCGs @ 64: 0.924639535315
****Error : 0.323306640625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.3291959763
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.012279312252998352, 0.014306032657623287)
('****Total time: ', 0.021328686952590943, 0.025348401069641095)
('****Preprocess time: ', 0.005250619769096375, 0.005966246128082274)
('****Data time: ', 0.0003873941898345947, 0.0004719376564025873)
('****Fetch time: ', 0.00016895461082458497, 0.0001862049102783203)
('****Sort time: ', 0.0008266706466674805, 0.0008721709251403807)
****Stage 0 average time 0.0100352817774
****Stage 1 average time 0.00887766969204
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.99685479945
****DCGs @ 8: 0.992959800071
****DCGs @ 16: 0.975364589275
****DCGs @ 32: 0.948313414858
****DCGs @ 64: 0.92464190336
****Error : 0.323330078125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  32.8224639893
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.012348150372505189, 0.013902246952056878)
('****Total time: ', 0.02125507426261902, 0.023594415187835692)
('****Preprocess time: ', 0.005291771411895752, 0.005917167663574218)
('****Data time: ', 0.0004171382188796997, 0.0005253791809082023)
('****Fetch time: ', 0.00016171300411224366, 0.00018405914306640625)
('****Sort time: ', 0.0008292508125305176, 0.0008749961853027344)
****Stage 0 average time 0.0102606784105
****Stage 1 average time 0.00878734540939
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996925331974
****DCGs @ 8: 0.992818182324
****DCGs @ 16: 0.975405900842
****DCGs @ 32: 0.948324490131
****DCGs @ 64: 0.924687974002
****Error : 0.323276367188
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  14.7318270206
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03970505070686341, 0.05351794958114624)
('****Total time: ', 5.226118263959885, 9.752428436279297)
('****Preprocess time: ', 0.009577381014823914, 0.012713432312011715)
('****Data time: ', 0.000678725004196167, 0.0008190155029296872)
('****Fetch time: ', 0.00012565875053405763, 0.0001418590545654297)
('****Sort time: ', 0.0017004355192184449, 0.0022509574890136716)
****Stage 0 average time 0.0440146926641
****Stage 1 average time 0.00777255833149
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996965925707
****DCGs @ 8: 0.992965159326
****DCGs @ 16: 0.975404093939
****DCGs @ 32: 0.948372033854
****DCGs @ 64: 0.924715679547
****Error : 0.292567871094
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.7978479862
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.03289572989940643, 0.04510180950164794)
('****Total time: ', 5.211049143195153, 9.640478277206421)
('****Preprocess time: ', 0.00842711579799652, 0.011771309375762939)
('****Data time: ', 0.0006180535554885865, 0.0007538914680480956)
('****Fetch time: ', 0.00011768794059753419, 0.00013518333435058594)
('****Sort time: ', 0.0016460684537887573, 0.002055406570434569)
****Stage 0 average time 0.0358553469181
****Stage 1 average time 0.00784930872917
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996757204437
****DCGs @ 8: 0.992768826966
****DCGs @ 16: 0.975153722813
****DCGs @ 32: 0.94821133626
****DCGs @ 64: 0.924620090272
****Error : 0.292567626953
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.1332831383
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03171988308429718, 0.041406881809234616)
('****Total time: ', 4.912380274891853, 9.01445811986923)
('****Preprocess time: ', 0.0081900577545166, 0.010638236999511712)
('****Data time: ', 0.0006161534786224365, 0.0007271766662597656)
('****Fetch time: ', 0.00010826277732849121, 0.00012922286987304688)
('****Sort time: ', 0.0016704601049423217, 0.002114152908325195)
****Stage 0 average time 0.0342698218822
****Stage 1 average time 0.00803499531746
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996700203158
****DCGs @ 8: 0.993147940421
****DCGs @ 16: 0.975409025775
****DCGs @ 32: 0.948266454501
****DCGs @ 64: 0.924663437425
****Error : 0.292568115234
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.0337920189
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.03148996520042419, 0.0408429980278015)
('****Total time: ', 4.413538845419883, 8.08063930273056)
('****Preprocess time: ', 0.008117587327957154, 0.010701322555541992)
('****Data time: ', 0.0006172034740447998, 0.0007190704345703125)
('****Fetch time: ', 0.00010836076736450195, 0.00013184547424316406)
('****Sort time: ', 0.0016106016635894776, 0.0019449472427368157)
****Stage 0 average time 0.0339870308638
****Stage 1 average time 0.00795668756962
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996841268205
****DCGs @ 8: 0.992806854101
****DCGs @ 16: 0.975362346672
****DCGs @ 32: 0.948363463079
****DCGs @ 64: 0.92472114696
****Error : 0.292583740234
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.5399830341
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.031436579585075376, 0.03952186107635496)
('****Total time: ', 3.7755107164382933, 6.553522038459776)
('****Preprocess time: ', 0.007994708061218261, 0.010317683219909664)
('****Data time: ', 0.0005950192213058471, 0.0006899833679199219)
('****Fetch time: ', 0.00010449326038360596, 0.00012993812561035156)
('****Sort time: ', 0.001608448624610901, 0.0018719792366027822)
****Stage 0 average time 0.0335422809124
****Stage 1 average time 0.00819696784019
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996770735682
****DCGs @ 8: 0.992820384552
****DCGs @ 16: 0.975137021307
****DCGs @ 32: 0.948275231433
****DCGs @ 64: 0.924624157537
****Error : 0.292575927734
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.8898761272
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.03104145884513855, 0.03866782188415524)
('****Total time: ', 2.12237810754776, 3.988566482067108)
('****Preprocess time: ', 0.007859031200408935, 0.009640133380889891)
('****Data time: ', 0.0005807245969772338, 0.000657808780670166)
('****Fetch time: ', 0.00010497188568115234, 0.00012493133544921875)
('****Sort time: ', 0.001623230218887329, 0.0019410729408264155)
****Stage 0 average time 0.0333384764194
****Stage 1 average time 0.00787094032764
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.99679779817
****DCGs @ 8: 0.993114940447
****DCGs @ 16: 0.975363404238
****DCGs @ 32: 0.94833345753
****DCGs @ 64: 0.924718905208
****Error : 0.292572998047
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.9016470909
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.030473928570747374, 0.03665469884872436)
('****Total time: ', 1.1432087882757187, 2.0984521508216853)
('****Preprocess time: ', 0.007740403890609741, 0.008451437950134276)
('****Data time: ', 0.0005768272876739502, 0.0006518483161926269)
('****Fetch time: ', 0.00010588502883911132, 0.00012111663818359375)
('****Sort time: ', 0.0016203207969665528, 0.0019419312477111817)
****Stage 0 average time 0.0326541111469
****Stage 1 average time 0.00786325442791
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996841268205
****DCGs @ 8: 0.992814899723
****DCGs @ 16: 0.975324282108
****DCGs @ 32: 0.948320776489
****DCGs @ 64: 0.92467775488
****Error : 0.292575927734
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.083878994
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.030387779831886293, 0.03641034364700316)
('****Total time: ', 0.10067900013923645, 0.18320583105087276)
('****Preprocess time: ', 0.007785825490951538, 0.009046518802642815)
('****Data time: ', 0.0005726699829101563, 0.0006530284881591797)
('****Fetch time: ', 0.00010483765602111816, 0.00012520551681518535)
('****Sort time: ', 0.0016110646724700928, 0.0017370820045471181)
****Stage 0 average time 0.0325133258104
****Stage 1 average time 0.00794885182381
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996602608145
****DCGs @ 8: 0.992893613888
****DCGs @ 16: 0.975173088593
****DCGs @ 32: 0.948213789513
****DCGs @ 64: 0.924585369962
****Error : 0.292567871094
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  18.1284120083
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.029755711793899537, 0.034955608844757055)
('****Total time: ', 0.04609507036209107, 0.056497490406036355)
('****Preprocess time: ', 0.007849164605140686, 0.008637106418609618)
('****Data time: ', 0.0005977432727813721, 0.0006968975067138672)
('****Fetch time: ', 9.244954586029053e-05, 0.00011777877807617188)
('****Sort time: ', 0.001589976191520691, 0.0016789913177490232)
****Stage 0 average time 0.0317000559568
****Stage 1 average time 0.00818498945236
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996881861939
****DCGs @ 8: 0.993037151568
****DCGs @ 16: 0.975343743135
****DCGs @ 32: 0.948420484111
****DCGs @ 64: 0.924739653871
****Error : 0.292578125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  23.1775400639
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.02970015573501587, 0.034415113925933834)
('****Total time: ', 0.04353665375709534, 0.04988145828247069)
('****Preprocess time: ', 0.008033247590065002, 0.009054720401763913)
('****Data time: ', 0.000634834885597229, 0.0007328987121582031)
('****Fetch time: ', 8.433496952056884e-05, 9.72747802734375e-05)
('****Sort time: ', 0.0015870484113693238, 0.0016863465309143052)
****Stage 0 average time 0.0313884614706
****Stage 1 average time 0.00865116012096
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996911800729
****DCGs @ 8: 0.992767268641
****DCGs @ 16: 0.975230036252
****DCGs @ 32: 0.948305058448
****DCGs @ 64: 0.92466536038
****Error : 0.292579589844
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.8993048668
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.028954387903213502, 0.03397901058197021)
('****Total time: ', 0.04186534237861633, 0.04780511856079101)
('****Preprocess time: ', 0.0077489333152771, 0.008738732337951647)
('****Data time: ', 0.0005977624654769898, 0.0007081389427185057)
('****Fetch time: ', 9.560871124267578e-05, 0.00011706352233886719)
('****Sort time: ', 0.0015769611597061157, 0.0016732573509216308)
****Stage 0 average time 0.0308006416559
****Stage 1 average time 0.00817301189899
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996532075622
****DCGs @ 8: 0.993105986782
****DCGs @ 16: 0.975384245569
****DCGs @ 32: 0.948352410829
****DCGs @ 64: 0.924653149849
****Error : 0.292564697266
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  33.3674008846
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.02882230305671692, 0.03319302797317505)
('****Total time: ', 0.04204869365692138, 0.0471199631690979)
('****Preprocess time: ', 0.007987416744232178, 0.008728456497192382)
('****Data time: ', 0.0006555696725845337, 0.0007460117340087891)
('****Fetch time: ', 8.474314212799072e-05, 9.703636169433594e-05)
('****Sort time: ', 0.0015810526609420777, 0.0016601085662841797)
****Stage 0 average time 0.030327304244
****Stage 1 average time 0.00880378103256
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996965925707
****DCGs @ 8: 0.992968052213
****DCGs @ 16: 0.975432323533
****DCGs @ 32: 0.94837084217
****DCGs @ 64: 0.924731270052
****Error : 0.292569824219
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  5.26046919823
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.06899478757381439, 0.09441559314727782)
('****Total time: ', 0.4894447238445282, 0.9563159465789792)
('****Preprocess time: ', 0.010331786155700684, 0.01569709777832031)
('****Data time: ', 0.0009427722692489624, 0.001202929019927978)
('****Fetch time: ', 9.345412254333497e-05, 0.00011205673217773438)
('****Sort time: ', 0.00212444806098938, 0.002933025360107422)
****Stage 0 average time 0.0419504073858
****Stage 1 average time 0.0405368407965
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996965925707
****DCGs @ 8: 0.992965159326
****DCGs @ 16: 0.975404093939
****DCGs @ 32: 0.948372033854
****DCGs @ 64: 0.924715654887
****Error : 0.292567871094
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.4072239399
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.06621016883850098, 0.08699325323104855)
('****Total time: ', 0.11355330312252045, 0.17676569223403915)
('****Preprocess time: ', 0.010112163424491883, 0.01537715196609497)
('****Data time: ', 0.0008812685012817383, 0.0010802984237670895)
('****Fetch time: ', 9.648013114929199e-05, 0.00010609626770019531)
('****Sort time: ', 0.002000898599624634, 0.002771866321563721)
****Stage 0 average time 0.0404926236868
****Stage 1 average time 0.0388083558083
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996757204437
****DCGs @ 8: 0.992768826966
****DCGs @ 16: 0.975153722813
****DCGs @ 32: 0.94821133626
****DCGs @ 64: 0.924620065612
****Error : 0.292567626953
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  6.58283519745
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.06218339276313782, 0.08018978834152221)
('****Total time: ', 0.07902095901966096, 0.09985709190368651)
('****Preprocess time: ', 0.00991298520565033, 0.014671838283538815)
('****Data time: ', 0.0008818777799606323, 0.0010822772979736323)
('****Fetch time: ', 8.719849586486817e-05, 9.608268737792969e-05)
('****Sort time: ', 0.001874366521835327, 0.002557992935180664)
****Stage 0 average time 0.0385560554266
****Stage 1 average time 0.0363837653399
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996700203158
****DCGs @ 8: 0.993147940421
****DCGs @ 16: 0.975409025775
****DCGs @ 32: 0.948266454501
****DCGs @ 64: 0.924663437425
****Error : 0.292568115234
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.20249295235
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.05961256408691406, 0.07550898790359496)
('****Total time: ', 0.07485028481483459, 0.09288536310195922)
('****Preprocess time: ', 0.00946152663230896, 0.013221871852874751)
('****Data time: ', 0.0008362454175949097, 0.0009890079498291013)
('****Fetch time: ', 8.536529541015625e-05, 8.916854858398438e-05)
('****Sort time: ', 0.0017966159582138061, 0.0024291157722473138)
****Stage 0 average time 0.0369279212952
****Stage 1 average time 0.0348643960953
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996841268205
****DCGs @ 8: 0.992806854101
****DCGs @ 16: 0.975362346672
****DCGs @ 32: 0.948363463079
****DCGs @ 64: 0.924721122301
****Error : 0.292583740234
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.18774414062
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.05616407513618469, 0.06987694501876829)
('****Total time: ', 0.07065653359889984, 0.08625137805938721)
('****Preprocess time: ', 0.009033194422721862, 0.012198209762573237)
('****Data time: ', 0.0007883261442184448, 0.0009200692176818847)
('****Fetch time: ', 7.505011558532715e-05, 8.606910705566406e-05)
('****Sort time: ', 0.0017437317371368408, 0.0021741867065429685)
****Stage 0 average time 0.0349902091026
****Stage 1 average time 0.0328141684532
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996770735682
****DCGs @ 8: 0.992820384552
****DCGs @ 16: 0.975137021307
****DCGs @ 32: 0.948275231433
****DCGs @ 64: 0.924624132877
****Error : 0.292575927734
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.8463709354
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.05371880745887756, 0.06631973981857299)
('****Total time: ', 0.06735589385032653, 0.08102278709411619)
('****Preprocess time: ', 0.008594363927841187, 0.010933077335357665)
('****Data time: ', 0.0007507215738296509, 0.0008640289306640625)
('****Fetch time: ', 6.886923313140869e-05, 8.20159912109375e-05)
('****Sort time: ', 0.0017012827396392823, 0.0020741939544677724)
****Stage 0 average time 0.0330617595911
****Stage 1 average time 0.0317722853422
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.99679779817
****DCGs @ 8: 0.993114940447
****DCGs @ 16: 0.975363404238
****DCGs @ 32: 0.94833345753
****DCGs @ 64: 0.924718905208
****Error : 0.292572998047
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.8268268108
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.054479445099830624, 0.06643755435943599)
('****Total time: ', 0.06856940627098083, 0.08205358982086178)
('****Preprocess time: ', 0.008950567245483399, 0.012153828144073472)
('****Data time: ', 0.0008011125326156616, 0.0009180188179016107)
('****Fetch time: ', 7.215309143066406e-05, 8.323192596435534e-05)
('****Sort time: ', 0.0017395519018173218, 0.0021962165832519523)
****Stage 0 average time 0.0343041591644
****Stage 1 average time 0.0317386707067
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996841268205
****DCGs @ 8: 0.992814899723
****DCGs @ 16: 0.975324282108
****DCGs @ 32: 0.948320776489
****DCGs @ 64: 0.924677730221
****Error : 0.292575927734
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.9065790176
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.05329251325130463, 0.06397368907928463)
('****Total time: ', 0.06706990933418273, 0.07951738834381103)
('****Preprocess time: ', 0.008741914033889771, 0.01139403581619262)
('****Data time: ', 0.0007769770622253418, 0.0008812904357910151)
('****Fetch time: ', 6.723058223724365e-05, 7.919073104858379e-05)
('****Sort time: ', 0.0016855677366256713, 0.0020042061805725093)
****Stage 0 average time 0.0335583748817
****Stage 1 average time 0.0310058277845
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996602608145
****DCGs @ 8: 0.992893613888
****DCGs @ 16: 0.975173088593
****DCGs @ 32: 0.948213789513
****DCGs @ 64: 0.924585345303
****Error : 0.292567871094
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.7669007778
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.05137417018413544, 0.059743833541870114)
('****Total time: ', 0.06467281615734101, 0.0738979458808899)
('****Preprocess time: ', 0.00838346266746521, 0.010205149650573717)
('****Data time: ', 0.0007436062097549438, 0.0008459091186523438)
('****Fetch time: ', 6.773567199707031e-05, 7.796287536621094e-05)
('****Sort time: ', 0.0016922663450241089, 0.0020050168037414546)
****Stage 0 average time 0.0321176000834
****Stage 1 average time 0.030143640995
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996881861939
****DCGs @ 8: 0.993037151568
****DCGs @ 16: 0.975343743135
****DCGs @ 32: 0.948420484111
****DCGs @ 64: 0.924739653871
****Error : 0.292578125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.951212883
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.049313355445861816, 0.05498015880584717)
('****Total time: ', 0.062395449280738834, 0.06861715316772458)
('****Preprocess time: ', 0.008068456768989563, 0.008673000335693359)
('****Data time: ', 0.0007215174436569214, 0.0008099675178527829)
('****Fetch time: ', 6.360864639282226e-05, 7.390975952148438e-05)
('****Sort time: ', 0.0016984363794326782, 0.001953279972076415)
****Stage 0 average time 0.0308923249245
****Stage 1 average time 0.0289730497599
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996911800729
****DCGs @ 8: 0.992767268641
****DCGs @ 16: 0.975230036252
****DCGs @ 32: 0.948305058448
****DCGs @ 64: 0.92466533572
****Error : 0.292579589844
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.5440409184
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.05037603163719177, 0.05755634307861323)
('****Total time: ', 0.06362619376182556, 0.07204948663711547)
('****Preprocess time: ', 0.008360413670539855, 0.009873425960540765)
('****Data time: ', 0.0007582472562789917, 0.0008502006530761719)
('****Fetch time: ', 6.579720973968506e-05, 7.62939453125e-05)
('****Sort time: ', 0.0016936614513397216, 0.0020223498344421383)
****Stage 0 average time 0.032159438014
****Stage 1 average time 0.0290947132111
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996532075622
****DCGs @ 8: 0.993105986782
****DCGs @ 16: 0.975384245569
****DCGs @ 32: 0.948352410829
****DCGs @ 64: 0.924653149849
****Error : 0.292564697266
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  32.9058351517
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.048925823807716366, 0.05589649677276611)
('****Total time: ', 0.061945735692977906, 0.06955609321594239)
('****Preprocess time: ', 0.008067070960998535, 0.008990144729614258)
('****Data time: ', 0.0007183058261871338, 0.0008080005645751953)
('****Fetch time: ', 6.437766551971435e-05, 7.390975952148438e-05)
('****Sort time: ', 0.0016713210344314576, 0.00189218521118164)
****Stage 0 average time 0.03104286623
****Stage 1 average time 0.0284040330648
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996965925707
****DCGs @ 8: 0.992968052213
****DCGs @ 16: 0.975432323533
****DCGs @ 32: 0.94837084217
****DCGs @ 64: 0.924731245392
****Error : 0.292569824219
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_1_4.pth
****Total experiment time (s):  20.1374809742
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.02992702567577362, 0.036762118339538574)
('****Total time: ', 8.743053858757019, 16.406250476837158)
('****Preprocess time: ', 0.007309579253196716, 0.007981300354003905)
('****Data time: ', 0.0005840171575546265, 0.0006980180740356436)
('****Fetch time: ', 0.0001660771369934082, 0.00019073486328125)
('****Sort time: ', 0.0016490488052368164, 0.001730203628540039)
****Stage 0 average time 0.0106886245012
****Stage 1 average time 0.0289471235275
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996965925707
****DCGs @ 8: 0.992965159326
****DCGs @ 16: 0.975404093939
****DCGs @ 32: 0.948372033854
****DCGs @ 64: 0.924715677714
****Error : 0.292567871094
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.6297512054
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.03115153443813324, 0.03695685863494872)
('****Total time: ', 8.915449025392533, 16.89776357412338)
('****Preprocess time: ', 0.007852379441261291, 0.00901459455490112)
('****Data time: ', 0.0006487083435058594, 0.0006988167762756347)
('****Fetch time: ', 0.00013093173503875733, 0.00015091896057128906)
('****Sort time: ', 0.0016941593885421752, 0.0017478585243225096)
****Stage 0 average time 0.0114176901579
****Stage 1 average time 0.0300600231886
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996757204437
****DCGs @ 8: 0.992768826966
****DCGs @ 16: 0.975153722813
****DCGs @ 32: 0.94821133626
****DCGs @ 64: 0.924620110707
****Error : 0.292567626953
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.3589179516
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.031124837279319764, 0.03834292888641355)
('****Total time: ', 8.648104759454727, 16.429190099239346)
('****Preprocess time: ', 0.008011423707008362, 0.010465669631958004)
('****Data time: ', 0.0006532506942749023, 0.0007360458374023435)
('****Fetch time: ', 0.00013177919387817382, 0.00015282630920410156)
('****Sort time: ', 0.001688406467437744, 0.0017519116401672362)
****Stage 0 average time 0.0117633379698
****Stage 1 average time 0.0298463593721
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996700203158
****DCGs @ 8: 0.993147940421
****DCGs @ 16: 0.975409025775
****DCGs @ 32: 0.948266454501
****DCGs @ 64: 0.924663459692
****Error : 0.292568115234
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.4184060097
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.030396623849868774, 0.035708248615264886)
('****Total time: ', 7.659353007555008, 14.562953507900236)
('****Preprocess time: ', 0.007701995730400086, 0.008662033081054682)
('****Data time: ', 0.0006287318468093873, 0.0006821155548095703)
('****Fetch time: ', 0.00013584351539611817, 0.00015497207641601562)
('****Sort time: ', 0.001694833755493164, 0.0020111083984374997)
****Stage 0 average time 0.0113321543932
****Stage 1 average time 0.0292258743048
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996841268205
****DCGs @ 8: 0.992806854101
****DCGs @ 16: 0.975362346672
****DCGs @ 32: 0.948363463079
****DCGs @ 64: 0.924721145128
****Error : 0.292583740234
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.4328110218
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.030069547414779664, 0.034166800975799556)
('****Total time: ', 6.570253356099129, 12.484649062156677)
('****Preprocess time: ', 0.007609324336051941, 0.007915174961090087)
('****Data time: ', 0.0006186882257461548, 0.0006759166717529297)
('****Fetch time: ', 0.0001322075128555298, 0.00015188455581665033)
('****Sort time: ', 0.0017784301042556763, 0.0021564006805419914)
****Stage 0 average time 0.0113731330633
****Stage 1 average time 0.0288350645304
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996770735682
****DCGs @ 8: 0.992820384552
****DCGs @ 16: 0.975137021307
****DCGs @ 32: 0.948275231433
****DCGs @ 64: 0.924624155145
****Error : 0.292575927734
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.4178459644
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.029885332345962523, 0.03370736837387085)
('****Total time: ', 5.465226049900055, 10.396524238586426)
('****Preprocess time: ', 0.0076595828533172605, 0.008652126789093016)
('****Data time: ', 0.0006195750236511231, 0.0006799697875976562)
('****Fetch time: ', 0.0001334890127182007, 0.00015619993209838848)
('****Sort time: ', 0.0016645917892456055, 0.0017399787902832031)
****Stage 0 average time 0.0112891167402
****Stage 1 average time 0.0286734542847
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.99679779817
****DCGs @ 8: 0.993114940447
****DCGs @ 16: 0.975363404238
****DCGs @ 32: 0.94833345753
****DCGs @ 64: 0.924718928035
****Error : 0.292572998047
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.3438909054
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.029826687216758727, 0.03473435640335083)
('****Total time: ', 4.4857024538517, 8.48936161994934)
('****Preprocess time: ', 0.007635098218917846, 0.00820246934890747)
('****Data time: ', 0.0006206196546554566, 0.0006771445274353025)
('****Fetch time: ', 0.00013355684280395508, 0.00015665292739868158)
('****Sort time: ', 0.001680643081665039, 0.0018623471260070783)
****Stage 0 average time 0.0112864345312
****Stage 1 average time 0.0286101704836
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996841268205
****DCGs @ 8: 0.992814899723
****DCGs @ 16: 0.975324282108
****DCGs @ 32: 0.948320776489
****DCGs @ 64: 0.924677775315
****Error : 0.292575927734
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.3488659859
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.02950555992126465, 0.032990562915802)
('****Total time: ', 3.4527062517404556, 6.626295793056488)
('****Preprocess time: ', 0.0076127625703811645, 0.008013010025024414)
('****Data time: ', 0.0006180281639099121, 0.0006802082061767578)
('****Fetch time: ', 0.0001338289976119995, 0.00015523433685302721)
('****Sort time: ', 0.0016804670095443726, 0.0020173072814941404)
****Stage 0 average time 0.0112885761261
****Stage 1 average time 0.0282620705366
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996602608145
****DCGs @ 8: 0.992893613888
****DCGs @ 16: 0.975173088593
****DCGs @ 32: 0.948213789513
****DCGs @ 64: 0.92458536757
****Error : 0.292567871094
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.3707079887
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.029219196319580077, 0.032573044300079346)
('****Total time: ', 1.9707271511554718, 3.711498570442199)
('****Preprocess time: ', 0.007604472994804382, 0.007945597171783444)
('****Data time: ', 0.0006205242872238159, 0.0006761908531188963)
('****Fetch time: ', 0.0001354520320892334, 0.00015616416931152344)
('****Sort time: ', 0.0016885465383529663, 0.002055203914642334)
****Stage 0 average time 0.0112740842104
****Stage 1 average time 0.0279941079617
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996881861939
****DCGs @ 8: 0.993037151568
****DCGs @ 16: 0.975343743135
****DCGs @ 32: 0.948420484111
****DCGs @ 64: 0.924739676698
****Error : 0.292578125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.7131397724
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.030047240972518922, 0.03440313339233398)
('****Total time: ', 0.05514392900466919, 0.09304828643798825)
('****Preprocess time: ', 0.007724103569984436, 0.008625566959381095)
('****Data time: ', 0.000608209252357483, 0.0007310032844543456)
('****Fetch time: ', 0.00014609861373901368, 0.0001919269561767578)
('****Sort time: ', 0.001732391357421875, 0.0020799636840820312)
****Stage 0 average time 0.011297500968
****Stage 1 average time 0.028960542798
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996911800729
****DCGs @ 8: 0.992767268641
****DCGs @ 16: 0.975230036252
****DCGs @ 32: 0.948305058448
****DCGs @ 64: 0.924665380815
****Error : 0.292579589844
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.793555975
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.0296481773853302, 0.03267754316329956)
('****Total time: ', 0.04291714882850647, 0.047870767116546614)
('****Preprocess time: ', 0.007652138590812683, 0.007886898517608643)
('****Data time: ', 0.0006344611644744873, 0.0007009506225585938)
('****Fetch time: ', 0.000132798433303833, 0.0001590251922607422)
('****Sort time: ', 0.0016493009328842163, 0.0017159104347229004)
****Stage 0 average time 0.0113447008133
****Stage 1 average time 0.0283721756935
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996532075622
****DCGs @ 8: 0.993105986782
****DCGs @ 16: 0.975384245569
****DCGs @ 32: 0.948352410829
****DCGs @ 64: 0.924653172116
****Error : 0.292564697266
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Sun Jul 25 22:21:05 UTC 2021
****Total experiment time (s):  32.834321022
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.029681731581687926, 0.033271050453186034)
('****Total time: ', 0.0421882803440094, 0.04683843851089476)
('****Preprocess time: ', 0.0076815105676651, 0.008334183692932122)
('****Data time: ', 0.0006415621042251587, 0.000698137283325195)
('****Fetch time: ', 0.00013242101669311523, 0.0001521229743957519)
('****Sort time: ', 0.001665980100631714, 0.0017199516296386719)
****Stage 0 average time 0.0114223819971
****Stage 1 average time 0.0283808233738
('****model config: ', u'configs/model_configs/dim_4_0.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996965925707
****DCGs @ 8: 0.992968052213
****DCGs @ 16: 0.975432323533
****DCGs @ 32: 0.94837084217
****DCGs @ 64: 0.924731268219
****Error : 0.292569824219
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  7.11005997658
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.00879239797592163, 0.011929714679718009)
('****Total time: ', 2.858676342010498, 5.301566326618194)
('****Preprocess time: ', 0.0010969291925430299, 0.0014740586280822744)
('****Data time: ', 0.0002291712760925293, 0.0002773165702819822)
('****Fetch time: ', 7.156991958618164e-05, 8.702278137207031e-05)
('****Sort time: ', 0.00031924402713775634, 0.000425136089324951)
****Stage 0 average time 0.0070172804594
****Stage 1 average time 0.00349203193188
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945836912961
****DCGs @ 8: 0.920280217254
****DCGs @ 16: 0.876310127465
****DCGs @ 32: 0.816494425326
****DCGs @ 64: 0.726403237217
****Error : 0.360734375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.10080695152
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.008421263098716736, 0.010680425167083736)
('****Total time: ', 2.3594061969518663, 4.403225040435791)
('****Preprocess time: ', 0.0010651952028274535, 0.001340281963348388)
('****Data time: ', 0.0002190161943435669, 0.00024918317794799785)
('****Fetch time: ', 6.689321994781494e-05, 7.796287536621094e-05)
('****Sort time: ', 0.00031270575523376467, 0.00036787986755371094)
****Stage 0 average time 0.00659195029736
****Stage 1 average time 0.00349312317371
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947363099667
****DCGs @ 8: 0.920549957639
****DCGs @ 16: 0.877205078373
****DCGs @ 32: 0.816943292178
****DCGs @ 64: 0.726548352383
****Error : 0.36051953125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.04805397987
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008643707394599914, 0.011039113998413086)
('****Total time: ', 1.8139731090068818, 3.3725033879280084)
('****Preprocess time: ', 0.0010665947198867799, 0.0013070106506347656)
('****Data time: ', 0.00021429908275604249, 0.0002410411834716797)
('****Fetch time: ', 6.6314697265625e-05, 7.605552673339844e-05)
('****Sort time: ', 0.0003389921188354492, 0.0003859996795654297)
****Stage 0 average time 0.00685979306698
****Stage 1 average time 0.00347011494637
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946404816289
****DCGs @ 8: 0.92038789573
****DCGs @ 16: 0.876779701391
****DCGs @ 32: 0.817364915649
****DCGs @ 64: 0.726700326884
****Error : 0.360546875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.04929900169
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.008706730365753174, 0.011283063888549803)
('****Total time: ', 1.2654069323539734, 2.3808798789978027)
('****Preprocess time: ', 0.0010619622468948365, 0.0013480663299560544)
('****Data time: ', 0.00021461248397827148, 0.00024081468582153314)
('****Fetch time: ', 6.525230407714843e-05, 7.414817810058594e-05)
('****Sort time: ', 0.0003138061761856079, 0.00036625862121582005)
****Stage 0 average time 0.00689161252975
****Stage 1 average time 0.00347075104713
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946553523666
****DCGs @ 8: 0.920732157678
****DCGs @ 16: 0.877201307908
****DCGs @ 32: 0.816780719075
****DCGs @ 64: 0.726713121099
****Error : 0.3604453125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.05825090408
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.008313246607780456, 0.010517573356628415)
('****Total time: ', 0.26328729796409606, 0.4465972661972046)
('****Preprocess time: ', 0.0010385788679122925, 0.0011773347854614257)
('****Data time: ', 0.00021159565448760986, 0.00023890733718872064)
('****Fetch time: ', 6.351017951965331e-05, 7.200241088867188e-05)
('****Sort time: ', 0.0003118313550949097, 0.00035691261291503906)
****Stage 0 average time 0.00647146463394
****Stage 1 average time 0.00346729803085
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945927496169
****DCGs @ 8: 0.920161401173
****DCGs @ 16: 0.876836131138
****DCGs @ 32: 0.816763800297
****DCGs @ 64: 0.726591129604
****Error : 0.3605703125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.68613004684
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.008253623843193053, 0.009753096103668207)
('****Total time: ', 0.015144672870635987, 0.030601310729980433)
('****Preprocess time: ', 0.0010602350234985352, 0.0012489914894103994)
('****Data time: ', 0.00021301960945129396, 0.00023508071899414062)
('****Fetch time: ', 6.248068809509277e-05, 7.200241088867188e-05)
('****Sort time: ', 0.00031312525272369384, 0.0003638386726379394)
****Stage 0 average time 0.00631115007401
****Stage 1 average time 0.00359133434296
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947377506695
****DCGs @ 8: 0.920619697233
****DCGs @ 16: 0.876869569774
****DCGs @ 32: 0.81697568624
****DCGs @ 64: 0.726328944139
****Error : 0.3608046875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.625234127
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008214127063751221, 0.010190415382385251)
('****Total time: ', 0.012113550305366516, 0.015649271011352533)
('****Preprocess time: ', 0.0010572232007980346, 0.0012820720672607417)
('****Data time: ', 0.00021217358112335204, 0.00023698806762695312)
('****Fetch time: ', 6.1820387840271e-05, 7.009506225585938e-05)
('****Sort time: ', 0.0003130019903182983, 0.00035119056701660156)
****Stage 0 average time 0.00631829464436
****Stage 1 average time 0.00354005157948
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946076203546
****DCGs @ 8: 0.920724364887
****DCGs @ 16: 0.876852501951
****DCGs @ 32: 0.817118512294
****DCGs @ 64: 0.726916227006
****Error : 0.360421875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.6824138165
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.008319166779518128, 0.010056793689727773)
('****Total time: ', 0.011986220479011536, 0.014812147617340087)
('****Preprocess time: ', 0.0010970602035522462, 0.0013609051704406737)
('****Data time: ', 0.00021773219108581543, 0.00025010108947753906)
('****Fetch time: ', 6.344866752624511e-05, 7.200241088867188e-05)
('****Sort time: ', 0.00031371033191680906, 0.00036625862121582005)
****Stage 0 average time 0.00614185285568
****Stage 1 average time 0.00386926531792
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947443903716
****DCGs @ 8: 0.920868984384
****DCGs @ 16: 0.877127716131
****DCGs @ 32: 0.817081864714
****DCGs @ 64: 0.726741947637
****Error : 0.36041796875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.6763920784
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008219570398330689, 0.009839999675750721)
('****Total time: ', 0.01162863063812256, 0.013814318180084221)
('****Preprocess time: ', 0.0010847418308258057, 0.0013439655303955078)
('****Data time: ', 0.00021704578399658203, 0.00024390220642089844)
('****Fetch time: ', 6.226062774658203e-05, 7.132291793823223e-05)
('****Sort time: ', 0.0003347139358520508, 0.0003702998161315916)
****Stage 0 average time 0.00619654500484
****Stage 1 average time 0.00372178757191
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945554782866
****DCGs @ 8: 0.919852959408
****DCGs @ 16: 0.876535268558
****DCGs @ 32: 0.816498286703
****DCGs @ 64: 0.726344486974
****Error : 0.360734375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.8133249283
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.008044484972953797, 0.009536123275756836)
('****Total time: ', 0.01115652883052826, 0.013054525852203366)
('****Preprocess time: ', 0.0010278990268707275, 0.0012670755386352533)
('****Data time: ', 0.00021204817295074463, 0.00023199319839477533)
('****Fetch time: ', 6.079530715942383e-05, 6.605386734008783e-05)
('****Sort time: ', 0.0003104093074798584, 0.00034120082855224596)
****Stage 0 average time 0.00625432360172
****Stage 1 average time 0.00340131318569
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946408076009
****DCGs @ 8: 0.920535600918
****DCGs @ 16: 0.877287752706
****DCGs @ 32: 0.817157680528
****DCGs @ 64: 0.726853514699
****Error : 0.3604609375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.5712659359
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.00810191035270691, 0.00946557521820068)
('****Total time: ', 0.011297249436378479, 0.012867474555969236)
('****Preprocess time: ', 0.001066472053527832, 0.001316070556640625)
('****Data time: ', 0.00021283888816833496, 0.0002357959747314453)
('****Fetch time: ', 6.08752965927124e-05, 6.723403930664062e-05)
('****Sort time: ', 0.00031802380084991456, 0.00037198066711425755)
****Stage 0 average time 0.00621262919903
****Stage 1 average time 0.00354749119282
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947535362706
****DCGs @ 8: 0.921079902105
****DCGs @ 16: 0.877079382838
****DCGs @ 32: 0.817184311485
****DCGs @ 64: 0.726541506917
****Error : 0.3606875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  30.731981039
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.007970971584320068, 0.009314310550689694)
('****Total time: ', 0.011107938408851624, 0.012657928466796874)
('****Preprocess time: ', 0.0010585536956787109, 0.0012848377227783203)
('****Data time: ', 0.00021137368679046632, 0.00024127960205078125)
('****Fetch time: ', 6.154203414916992e-05, 6.580352783203125e-05)
('****Sort time: ', 0.0003132448196411133, 0.0003368854522705078)
****Stage 0 average time 0.00621634602547
****Stage 1 average time 0.00339933979511
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945467706485
****DCGs @ 8: 0.920305917912
****DCGs @ 16: 0.876413665762
****DCGs @ 32: 0.81663955702
****DCGs @ 64: 0.726557398397
****Error : 0.36054296875
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  1.6462521553
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.010810755491256714, 0.0142840027809143)
('****Total time: ', 0.015258155107498169, 0.020297396183013915)
('****Preprocess time: ', 0.0012432866096496581, 0.0017047047615051268)
('****Data time: ', 0.00028477132320404053, 0.000335705280303955)
('****Fetch time: ', 6.046736240386963e-05, 7.009506225585938e-05)
('****Sort time: ', 0.0003635566234588623, 0.0005300045013427734)
****Stage 0 average time 0.00748685979843
****Stage 1 average time 0.00527597761154
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945836912961
****DCGs @ 8: 0.920280217254
****DCGs @ 16: 0.876310127465
****DCGs @ 32: 0.816494425326
****DCGs @ 64: 0.726403237217
****Error : 0.360734375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  2.55738520622
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.009878201246261596, 0.012827944755554195)
('****Total time: ', 0.013957528114318848, 0.017602264881134033)
('****Preprocess time: ', 0.0011731677055358887, 0.0015142917633056635)
('****Data time: ', 0.0002686641216278076, 0.0003108978271484375)
('****Fetch time: ', 5.440521240234375e-05, 6.413459777832031e-05)
('****Sort time: ', 0.00034504878520965574, 0.00045491456985473626)
****Stage 0 average time 0.00676848852634
****Stage 1 average time 0.00495099854469
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947363099667
****DCGs @ 8: 0.920549957639
****DCGs @ 16: 0.877205078373
****DCGs @ 32: 0.816943292178
****DCGs @ 64: 0.726548352383
****Error : 0.36051953125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  3.6134250164
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.009253817796707153, 0.011538171768188474)
('****Total time: ', 0.013509832382202148, 0.016506910324096673)
('****Preprocess time: ', 0.0011460362672805785, 0.001408874988555908)
('****Data time: ', 0.0002647271156311035, 0.0002999305725097656)
('****Fetch time: ', 4.831218719482422e-05, 5.793571472167969e-05)
('****Sort time: ', 0.0003625603914260864, 0.0004351496696472166)
****Stage 0 average time 0.00641062271595
****Stage 1 average time 0.00466483104229
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946404816289
****DCGs @ 8: 0.92038789573
****DCGs @ 16: 0.876779701391
****DCGs @ 32: 0.817364915649
****DCGs @ 64: 0.726700326884
****Error : 0.360546875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.6019589901
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.009340476632118224, 0.011929881572723384)
('****Total time: ', 0.0130012366771698, 0.01606805324554442)
('****Preprocess time: ', 0.00114922034740448, 0.0014711260795593258)
('****Data time: ', 0.0002672392129898071, 0.0002939820289611816)
('****Fetch time: ', 4.630851745605469e-05, 5.699396133422845e-05)
('****Sort time: ', 0.00034163260459899904, 0.0004329681396484375)
****Stage 0 average time 0.00663231945038
****Stage 1 average time 0.00451255786419
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946553523666
****DCGs @ 8: 0.920732157678
****DCGs @ 16: 0.877201307908
****DCGs @ 32: 0.816780719075
****DCGs @ 64: 0.726713121099
****Error : 0.3604453125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  6.66666316986
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.009236226201057435, 0.011784875392913815)
('****Total time: ', 0.012869497656822205, 0.0158456802368164)
('****Preprocess time: ', 0.0011686242818832397, 0.001447069644927978)
('****Data time: ', 0.0002609214782714844, 0.0002880096435546875)
('****Fetch time: ', 4.381144046783447e-05, 5.198717117309564e-05)
('****Sort time: ', 0.000339497447013855, 0.0004107952117919922)
****Stage 0 average time 0.00659990167618
****Stage 1 average time 0.00444917917252
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945927496169
****DCGs @ 8: 0.920161401173
****DCGs @ 16: 0.876836131138
****DCGs @ 32: 0.816763800297
****DCGs @ 64: 0.726591129604
****Error : 0.3605703125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.72320389748
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.008878114461898803, 0.010671496391296385)
('****Total time: ', 0.012454538702964783, 0.014720022678375244)
('****Preprocess time: ', 0.0011394411325454713, 0.0013110637664794922)
('****Data time: ', 0.000259175181388855, 0.00028896331787109375)
('****Fetch time: ', 4.298865795135498e-05, 5.0067901611328125e-05)
('****Sort time: ', 0.0003410969972610474, 0.0003969788551330566)
****Stage 0 average time 0.00631712722778
****Stage 1 average time 0.00434368920326
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947377506695
****DCGs @ 8: 0.920619697233
****DCGs @ 16: 0.876869569774
****DCGs @ 32: 0.81697568624
****DCGs @ 64: 0.726328944139
****Error : 0.3608046875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.6362500191
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008751184344291688, 0.010461163520812987)
('****Total time: ', 0.012269699573516845, 0.014227163791656488)
('****Preprocess time: ', 0.0011525824069976807, 0.0013377666473388672)
('****Data time: ', 0.00025759828090667726, 0.00028613805770874004)
('****Fetch time: ', 4.0341973304748536e-05, 4.696846008300781e-05)
('****Sort time: ', 0.0003337452411651611, 0.00038005113601684564)
****Stage 0 average time 0.00624497425556
****Stage 1 average time 0.0042904779911
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946076203546
****DCGs @ 8: 0.920724364887
****DCGs @ 16: 0.876852501951
****DCGs @ 32: 0.817118512294
****DCGs @ 64: 0.726916227006
****Error : 0.360421875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.6553800106
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.008714341759681702, 0.010502839088439927)
('****Total time: ', 0.012268424868583679, 0.01447540521621704)
('****Preprocess time: ', 0.0011663702726364136, 0.0013719081878662107)
('****Data time: ', 0.0002616957426071167, 0.0002918362617492675)
('****Fetch time: ', 4.2559146881103516e-05, 4.792213439941406e-05)
('****Sort time: ', 0.0003348085880279541, 0.0003750324249267578)
****Stage 0 average time 0.00617676067352
****Stage 1 average time 0.00434301483631
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947443903716
****DCGs @ 8: 0.920868984384
****DCGs @ 16: 0.877127716131
****DCGs @ 32: 0.817081864714
****DCGs @ 64: 0.726741947637
****Error : 0.36041796875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.6469769478
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008781739950180053, 0.010658228397369384)
('****Total time: ', 0.012283389568328857, 0.014353680610656734)
('****Preprocess time: ', 0.0011619529724121093, 0.0013940453529357908)
('****Data time: ', 0.00026072812080383303, 0.00029206275939941406)
('****Fetch time: ', 4.169118404388428e-05, 4.696846008300781e-05)
('****Sort time: ', 0.0003334534168243408, 0.00037288665771484375)
****Stage 0 average time 0.00621140575409
****Stage 1 average time 0.00436815989017
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945554782866
****DCGs @ 8: 0.919852959408
****DCGs @ 16: 0.876535268558
****DCGs @ 32: 0.816498286703
****DCGs @ 64: 0.726344486974
****Error : 0.360734375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.8033120632
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.008652733445167541, 0.010399878025054932)
('****Total time: ', 0.01216020119190216, 0.014273679256439204)
('****Preprocess time: ', 0.0011643706560134888, 0.0013799786567687987)
('****Data time: ', 0.00025783836841583254, 0.0002901911735534666)
('****Fetch time: ', 3.9668917655944824e-05, 4.601478576660156e-05)
('****Sort time: ', 0.00033793115615844726, 0.0003951072692871091)
****Stage 0 average time 0.00614732587337
****Stage 1 average time 0.00430521667004
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946408076009
****DCGs @ 8: 0.920535600918
****DCGs @ 16: 0.877287752706
****DCGs @ 32: 0.817157680528
****DCGs @ 64: 0.726853514699
****Error : 0.3604609375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.541916132
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.008698978424072266, 0.010292470455169674)
('****Total time: ', 0.012199307322502136, 0.014009845256805415)
('****Preprocess time: ', 0.0011713515520095825, 0.0014121532440185547)
('****Data time: ', 0.0002608829736709595, 0.00029397010803222656)
('****Fetch time: ', 4.196023941040039e-05, 4.53233718872069e-05)
('****Sort time: ', 0.0003329817056655884, 0.00036597251892089844)
****Stage 0 average time 0.00623266839981
****Stage 1 average time 0.00427348649502
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947535362706
****DCGs @ 8: 0.921079902105
****DCGs @ 16: 0.877079382838
****DCGs @ 32: 0.817184311485
****DCGs @ 64: 0.726541506917
****Error : 0.3606875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  30.7477238178
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.008543561458587647, 0.010006487369537347)
('****Total time: ', 0.012019354462623597, 0.013852465152740478)
('****Preprocess time: ', 0.0011725386381149293, 0.001434814929962158)
('****Data time: ', 0.000252627968788147, 0.0002779960632324219)
('****Fetch time: ', 3.9722442626953126e-05, 4.38690185546875e-05)
('****Sort time: ', 0.00035124266147613524, 0.00036787986755371094)
****Stage 0 average time 0.00616318595409
****Stage 1 average time 0.0041965072155
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945467706485
****DCGs @ 8: 0.920305917912
****DCGs @ 16: 0.876413665762
****DCGs @ 32: 0.81663955702
****DCGs @ 64: 0.726557398397
****Error : 0.36054296875
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
****Total experiment time (s):  8.0911488533
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.006518024802207947, 0.007011437416076657)
('****Total time: ', 3.3849332482814787, 6.427136385440826)
('****Preprocess time: ', 0.0009984476566314696, 0.0010538101196289062)
('****Data time: ', 0.00020290541648864747, 0.00021886825561523438)
('****Fetch time: ', 5.839824676513672e-05, 6.390810012817376e-05)
('****Sort time: ', 0.0003266935348510742, 0.00036787986755371094)
****Stage 0 average time 0.00404011702538
****Stage 1 average time 0.00406435263157
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945836912961
****DCGs @ 8: 0.920280217254
****DCGs @ 16: 0.876310127465
****DCGs @ 32: 0.816494425326
****DCGs @ 64: 0.726403237217
****Error : 0.360734375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.11941695213
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.006527151346206665, 0.006987190246582031)
('****Total time: ', 2.8975115274190903, 5.500924873352051)
('****Preprocess time: ', 0.0009976663589477538, 0.001121091842651367)
('****Data time: ', 0.00019585013389587403, 0.0002129077911376953)
('****Fetch time: ', 5.870199203491211e-05, 6.390810012817376e-05)
('****Sort time: ', 0.00031445729732513427, 0.00034499168395996094)
****Stage 0 average time 0.00404208159447
****Stage 1 average time 0.00405174553394
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947363099667
****DCGs @ 8: 0.920549957639
****DCGs @ 16: 0.877205078373
****DCGs @ 32: 0.816943292178
****DCGs @ 64: 0.726548352383
****Error : 0.36051953125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.09124112129
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.006470503687858582, 0.006987071037292479)
('****Total time: ', 2.3497678010463714, 4.458565950393676)
('****Preprocess time: ', 0.000982283353805542, 0.0011241793632507321)
('****Data time: ', 0.0001933002471923828, 0.00020599365234375)
('****Fetch time: ', 5.804955959320068e-05, 6.271600723266595e-05)
('****Sort time: ', 0.00031221818923950196, 0.0003440499305725097)
****Stage 0 average time 0.00401530516148
****Stage 1 average time 0.00400104987621
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946404816289
****DCGs @ 8: 0.92038789573
****DCGs @ 16: 0.876779701391
****DCGs @ 32: 0.817364915649
****DCGs @ 64: 0.726700326884
****Error : 0.360546875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.07850813866
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.006470884323120117, 0.006993329524993897)
('****Total time: ', 1.7778425107002258, 3.411725401878357)
('****Preprocess time: ', 0.0010082274675369263, 0.001163101196289062)
('****Data time: ', 0.00019274747371673584, 0.0002071857452392578)
('****Fetch time: ', 5.7645082473754884e-05, 6.198883056640625e-05)
('****Sort time: ', 0.0003067704439163208, 0.0003349781036376953)
****Stage 0 average time 0.0040199034214
****Stage 1 average time 0.00401637136936
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946553523666
****DCGs @ 8: 0.920732157678
****DCGs @ 16: 0.877201307908
****DCGs @ 32: 0.816780719075
****DCGs @ 64: 0.726713121099
****Error : 0.3604453125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.05422496796
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.006449649214744568, 0.006995022296905518)
('****Total time: ', 0.8031559535264969, 1.5024446725845337)
('****Preprocess time: ', 0.0010066863298416138, 0.001176249980926513)
('****Data time: ', 0.00019284641742706298, 0.00020694732666015625)
('****Fetch time: ', 5.770266056060791e-05, 6.32166862487791e-05)
('****Sort time: ', 0.0003095326423645019, 0.0003383398056030272)
****Stage 0 average time 0.00400164306164
****Stage 1 average time 0.0040147742033
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945927496169
****DCGs @ 8: 0.920161401173
****DCGs @ 16: 0.876836131138
****DCGs @ 32: 0.816763800297
****DCGs @ 64: 0.726591129604
****Error : 0.3605703125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.68664216995
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.006444829225540161, 0.006845998764038086)
('****Total time: ', 0.017040115356445312, 0.04280763864517202)
('****Preprocess time: ', 0.0009798617362976074, 0.0011038899421691893)
('****Data time: ', 0.00019334375858306885, 0.00020575523376464844)
('****Fetch time: ', 5.778539180755615e-05, 6.198883056640625e-05)
('****Sort time: ', 0.0003070695400238037, 0.00033475160598754876)
****Stage 0 average time 0.00400043153763
****Stage 1 average time 0.00398245811462
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947377506695
****DCGs @ 8: 0.920619697233
****DCGs @ 16: 0.876869569774
****DCGs @ 32: 0.81697568624
****DCGs @ 64: 0.726328944139
****Error : 0.3608046875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.5932159424
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.006501939177513122, 0.0070300579071044915)
('****Total time: ', 0.01064493703842163, 0.014875578880310051)
('****Preprocess time: ', 0.000956866979598999, 0.001113903522491455)
('****Data time: ', 0.0001950889825820923, 0.0002079010009765625)
('****Fetch time: ', 5.784428119659424e-05, 6.198883056640625e-05)
('****Sort time: ', 0.0003177032470703125, 0.00033402442932128906)
****Stage 0 average time 0.00399086844921
****Stage 1 average time 0.00403857421875
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946076203546
****DCGs @ 8: 0.920724364887
****DCGs @ 16: 0.876852501951
****DCGs @ 32: 0.817118512294
****DCGs @ 64: 0.726916227006
****Error : 0.360421875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.6904110909
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.0064681401252746585, 0.006956815719604492)
('****Total time: ', 0.009683447122573853, 0.011935341358184807)
('****Preprocess time: ', 0.000940358281135559, 0.001076948642730713)
('****Data time: ', 0.00019309890270233153, 0.00020505189895629876)
('****Fetch time: ', 5.771172046661377e-05, 6.198883056640625e-05)
('****Sort time: ', 0.0003076242208480835, 0.0003380775451660156)
****Stage 0 average time 0.00394718635082
****Stage 1 average time 0.0040197468996
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947443903716
****DCGs @ 8: 0.920868984384
****DCGs @ 16: 0.877127716131
****DCGs @ 32: 0.817081864714
****DCGs @ 64: 0.726741947637
****Error : 0.36041796875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.6597731113
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.006374525785446167, 0.006890058517456055)
('****Total time: ', 0.009293822646141052, 0.010310947895050049)
('****Preprocess time: ', 0.0009324024915695191, 0.0011251449584960935)
('****Data time: ', 0.00019322168827056886, 0.00020503997802734375)
('****Fetch time: ', 5.696225166320801e-05, 6.103515625e-05)
('****Sort time: ', 0.0003049941062927246, 0.0003266334533691406)
****Stage 0 average time 0.00389510428905
****Stage 1 average time 0.00396700203419
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945554782866
****DCGs @ 8: 0.919852959408
****DCGs @ 16: 0.876535268558
****DCGs @ 32: 0.816498286703
****DCGs @ 64: 0.726344486974
****Error : 0.360734375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.7784149647
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.006334365606307984, 0.0069167733192443855)
('****Total time: ', 0.009213504791259765, 0.009906208515167237)
('****Preprocess time: ', 0.0009417623281478882, 0.0011969685554504388)
('****Data time: ', 0.00019184172153472901, 0.00020384788513183594)
('****Fetch time: ', 5.6307554244995115e-05, 6.103515625e-05)
('****Sort time: ', 0.0003108837604522705, 0.00033593177795410156)
****Stage 0 average time 0.00387523436546
****Stage 1 average time 0.00395992660522
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.946408076009
****DCGs @ 8: 0.920535600918
****DCGs @ 16: 0.877287752706
****DCGs @ 32: 0.817157680528
****DCGs @ 64: 0.726853514699
****Error : 0.3604609375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.4802970886
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.006410251617431641, 0.006982004642486572)
('****Total time: ', 0.009311149954795837, 0.009962177276611327)
('****Preprocess time: ', 0.0009392871856689453, 0.0011921405792236326)
('****Data time: ', 0.00019442474842071533, 0.00020694732666015625)
('****Fetch time: ', 5.80371618270874e-05, 6.29425048828125e-05)
('****Sort time: ', 0.0003116673231124878, 0.00033166408538818346)
****Stage 0 average time 0.00393567693233
****Stage 1 average time 0.00397799110413
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.947535362706
****DCGs @ 8: 0.921079902105
****DCGs @ 16: 0.877079382838
****DCGs @ 32: 0.817184311485
****DCGs @ 64: 0.726541506917
****Error : 0.3606875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  30.7474138737
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.006333244919776916, 0.006910860538482666)
('****Total time: ', 0.009242719292640686, 0.00990828275680542)
('****Preprocess time: ', 0.000942099928855896, 0.0012052059173583984)
('****Data time: ', 0.00019325566291809082, 0.00020575523376464844)
('****Fetch time: ', 5.684888362884521e-05, 6.103515625e-05)
('****Sort time: ', 0.0003086118698120117, 0.00032806396484375)
****Stage 0 average time 0.00387749040127
****Stage 1 average time 0.00395657086372
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 128])
****DCGs @ 4: 0.945467706485
****DCGs @ 8: 0.920305917912
****DCGs @ 16: 0.876413665762
****DCGs @ 32: 0.81663955702
****DCGs @ 64: 0.726557398397
****Error : 0.36054296875
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  7.31218194962
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.009107597947120667, 0.012345063686370845)
('****Total time: ', 2.9022677747011185, 5.4703958272933955)
('****Preprocess time: ', 0.0012713299989700318, 0.0016799092292785643)
('****Data time: ', 0.00023598897457122802, 0.00028277635574340814)
('****Fetch time: ', 7.041311264038086e-05, 8.20159912109375e-05)
('****Sort time: ', 0.0003673223257064819, 0.0004448890686035156)
****Stage 0 average time 0.00741542947292
****Stage 1 average time 0.00363722288609
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945836912961
****DCGs @ 8: 0.920197169098
****DCGs @ 16: 0.8763693994
****DCGs @ 32: 0.816579024835
****DCGs @ 64: 0.726529550884
****Error : 0.29508203125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.32278203964
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.008509499669075013, 0.011261606216430662)
('****Total time: ', 2.467634730696678, 4.624425220489501)
('****Preprocess time: ', 0.0011929937601089478, 0.0015421867370605464)
('****Data time: ', 0.00022443556785583496, 0.0002608299255371094)
('****Fetch time: ', 6.824564933776855e-05, 7.772445678710938e-05)
('****Sort time: ', 0.00037253868579864504, 0.0004439353942871094)
****Stage 0 average time 0.00672568929195
****Stage 1 average time 0.00364202404022
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947363099667
****DCGs @ 8: 0.920418966592
****DCGs @ 16: 0.877213989468
****DCGs @ 32: 0.817043178345
****DCGs @ 64: 0.726659441052
****Error : 0.29490234375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.33370518684
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008325879335403442, 0.010849690437316891)
('****Total time: ', 1.9450307245254517, 3.632312512397766)
('****Preprocess time: ', 0.0011732017993927003, 0.001478016376495361)
('****Data time: ', 0.00022215139865875243, 0.0002548694610595703)
('****Fetch time: ', 6.507539749145508e-05, 7.319450378417969e-05)
('****Sort time: ', 0.0003708055019378662, 0.0004410743713378906)
****Stage 0 average time 0.00651211893559
****Stage 1 average time 0.0036449944973
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946404816289
****DCGs @ 8: 0.92033895907
****DCGs @ 16: 0.8767185906
****DCGs @ 32: 0.817448297602
****DCGs @ 64: 0.726859550854
****Error : 0.29487890625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.39144897461
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.008195332884788513, 0.010145950317382807)
('****Total time: ', 1.406503685951233, 2.6796898007392884)
('****Preprocess time: ', 0.0011808528900146484, 0.0014910697937011719)
('****Data time: ', 0.00022221624851226807, 0.00025227069854736315)
('****Fetch time: ', 6.430304050445557e-05, 7.176399230957031e-05)
('****Sort time: ', 0.00036510515213012697, 0.00042828321456909134)
****Stage 0 average time 0.00635225594044
****Stage 1 average time 0.00367555427551
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946553523666
****DCGs @ 8: 0.920689006791
****DCGs @ 16: 0.87727691126
****DCGs @ 32: 0.81686395777
****DCGs @ 64: 0.726859262881
****Error : 0.2950234375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.37104892731
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.007872491598129272, 0.008836770057678224)
('****Total time: ', 0.41792426311969755, 0.7361439228057862)
('****Preprocess time: ', 0.001153188943862915, 0.001244795322418213)
('****Data time: ', 0.00021944427490234376, 0.0002467751502990722)
('****Fetch time: ', 6.200957298278808e-05, 6.794929504394531e-05)
('****Sort time: ', 0.00036948788166046143, 0.00042510032653808594)
****Stage 0 average time 0.00601334393024
****Stage 1 average time 0.00366327834129
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945927496169
****DCGs @ 8: 0.919990512857
****DCGs @ 16: 0.876864087608
****DCGs @ 32: 0.816832904157
****DCGs @ 64: 0.726659052923
****Error : 0.2951484375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.71065187454
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.008088617086410522, 0.009855008125305174)
('****Total time: ', 0.033043781042099, 0.13674744367599476)
('****Preprocess time: ', 0.0011616759300231933, 0.0012999176979064937)
('****Data time: ', 0.00022704172134399415, 0.0002598762512207031)
('****Fetch time: ', 6.342196464538575e-05, 7.319450378417969e-05)
('****Sort time: ', 0.0003703174591064453, 0.00041985511779785156)
****Stage 0 average time 0.00606927752495
****Stage 1 average time 0.00384179663658
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947377506695
****DCGs @ 8: 0.920568500724
****DCGs @ 16: 0.876764802779
****DCGs @ 32: 0.817086531834
****DCGs @ 64: 0.72645828018
****Error : 0.294875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.6116781235
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007833667397499085, 0.009333014488220211)
('****Total time: ', 0.01199429202079773, 0.015687835216522207)
('****Preprocess time: ', 0.0011331671476364135, 0.0012402772903442382)
('****Data time: ', 0.00022730612754821776, 0.00025725364685058594)
('****Fetch time: ', 6.161582469940185e-05, 6.794929504394531e-05)
('****Sort time: ', 0.00036483657360076904, 0.00041011571884155254)
****Stage 0 average time 0.00598535752296
****Stage 1 average time 0.00363523554802
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946076203546
****DCGs @ 8: 0.920638423844
****DCGs @ 16: 0.876948733066
****DCGs @ 32: 0.817204136449
****DCGs @ 64: 0.727075127439
****Error : 0.294955078125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.669262886
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.007748956918716431, 0.008899021148681642)
('****Total time: ', 0.011252056241035462, 0.013240146636962892)
('****Preprocess time: ', 0.001121788501739502, 0.0012319087982177734)
('****Data time: ', 0.0002276219129562378, 0.0002551078796386719)
('****Fetch time: ', 6.0907244682312014e-05, 6.580352783203125e-05)
('****Sort time: ', 0.0003643842935562134, 0.0004072427749633788)
****Stage 0 average time 0.00592074334621
****Stage 1 average time 0.00360291552544
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947443903716
****DCGs @ 8: 0.920780150454
****DCGs @ 16: 0.877159739696
****DCGs @ 32: 0.817142467123
****DCGs @ 64: 0.726854924464
****Error : 0.294921875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.6947469711
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007821398735046387, 0.008864462375640867)
('****Total time: ', 0.011127785086631774, 0.01268019676208496)
('****Preprocess time: ', 0.0011351895332336426, 0.0013549327850341797)
('****Data time: ', 0.00022244787216186524, 0.00024796724319458)
('****Fetch time: ', 6.167292594909668e-05, 6.796121597290033e-05)
('****Sort time: ', 0.00036291635036468504, 0.0004131793975830078)
****Stage 0 average time 0.00586206746101
****Stage 1 average time 0.00374155795574
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945554782866
****DCGs @ 8: 0.919769911252
****DCGs @ 16: 0.876452721426
****DCGs @ 32: 0.816620211811
****DCGs @ 64: 0.726457542464
****Error : 0.295072265625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.8070979118
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.007740509986877441, 0.009288108348846424)
('****Total time: ', 0.010991236805915832, 0.012792682647705073)
('****Preprocess time: ', 0.0011207661628723144, 0.0012810707092285154)
('****Data time: ', 0.00022311437129974364, 0.00025200843811035156)
('****Fetch time: ', 6.152331829071045e-05, 6.413459777832031e-05)
('****Sort time: ', 0.00035688328742980956, 0.0003979206085205078)
****Stage 0 average time 0.00592958796024
****Stage 1 average time 0.00357320916653
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946408076009
****DCGs @ 8: 0.920404609871
****DCGs @ 16: 0.87736233135
****DCGs @ 32: 0.817231086353
****DCGs @ 64: 0.726983285825
****Error : 0.29500390625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.5531229973
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.007707956910133362, 0.009370183944702147)
('****Total time: ', 0.011010805010795594, 0.012906575202941892)
('****Preprocess time: ', 0.0011163113117218018, 0.001308929920196533)
('****Data time: ', 0.00021884989738464356, 0.00024580955505371094)
('****Fetch time: ', 5.9889674186706545e-05, 6.413459777832031e-05)
('****Sort time: ', 0.0003594313859939575, 0.0004010200500488281)
****Stage 0 average time 0.00590015912056
****Stage 1 average time 0.00356228005886
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947535362706
****DCGs @ 8: 0.921068602866
****DCGs @ 16: 0.87706989017
****DCGs @ 32: 0.817244602138
****DCGs @ 64: 0.726671648041
****Error : 0.294974609375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  30.7558541298
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.007858997702598573, 0.009112167358398437)
('****Total time: ', 0.011259715914726257, 0.012800431251525876)
('****Preprocess time: ', 0.0011790269613265992, 0.0014500975608825683)
('****Data time: ', 0.0002250579595565796, 0.0002498626708984375)
('****Fetch time: ', 6.226909160614014e-05, 6.771087646484375e-05)
('****Sort time: ', 0.0003668525218963623, 0.0004329681396484375)
****Stage 0 average time 0.00584801888466
****Stage 1 average time 0.00384418535233
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945467706485
****DCGs @ 8: 0.920225129604
****DCGs @ 16: 0.876391365891
****DCGs @ 32: 0.81674174617
****DCGs @ 64: 0.72666522572
****Error : 0.29487109375
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  1.70725893974
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.012799569129943848, 0.016654396057128897)
('****Total time: ', 0.020723641037940978, 0.03854523897171017)
('****Preprocess time: ', 0.001426585555076599, 0.001909065246582031)
('****Data time: ', 0.00031147301197052, 0.0003790855407714844)
('****Fetch time: ', 6.894385814666748e-05, 7.917881011962878e-05)
('****Sort time: ', 0.000497940182685852, 0.0006680488586425781)
****Stage 0 average time 0.0076110625267
****Stage 1 average time 0.00749344921112
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945836912961
****DCGs @ 8: 0.920197169098
****DCGs @ 16: 0.8763693994
****DCGs @ 32: 0.816579024835
****DCGs @ 64: 0.726529550884
****Error : 0.29508203125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  2.57497596741
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.011414943575859069, 0.01462506055831907)
('****Total time: ', 0.015764565587043762, 0.0197332501411438)
('****Preprocess time: ', 0.001336410641670227, 0.0016962051391601557)
('****Data time: ', 0.0002892882823944092, 0.00033593177795410156)
('****Fetch time: ', 5.83951473236084e-05, 7.033348083496094e-05)
('****Sort time: ', 0.00042450904846191406, 0.0005719661712646484)
****Stage 0 average time 0.00687529075146
****Stage 1 average time 0.00664825594425
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947363099667
****DCGs @ 8: 0.920418966592
****DCGs @ 16: 0.877213989468
****DCGs @ 32: 0.817043178345
****DCGs @ 64: 0.726659441052
****Error : 0.29490234375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  3.61841988564
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.010996613144874573, 0.014191114902496327)
('****Total time: ', 0.014969093322753906, 0.018850529193878165)
('****Preprocess time: ', 0.0013149330615997315, 0.0017161369323730469)
('****Data time: ', 0.00028425633907318114, 0.00032901763916015625)
('****Fetch time: ', 5.505049228668213e-05, 6.699562072753906e-05)
('****Sort time: ', 0.0004079909324645996, 0.0005238056182861328)
****Stage 0 average time 0.00667314231396
****Stage 1 average time 0.00638570165634
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946404816289
****DCGs @ 8: 0.92033895907
****DCGs @ 16: 0.8767185906
****DCGs @ 32: 0.817448297602
****DCGs @ 64: 0.726859550854
****Error : 0.29487890625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.64596796036
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.011140780448913574, 0.014190804958343501)
('****Total time: ', 0.015205234289169312, 0.018497192859649656)
('****Preprocess time: ', 0.001344933032989502, 0.0017492532730102512)
('****Data time: ', 0.00027916991710662844, 0.00032591819763183594)
('****Fetch time: ', 5.4135918617248535e-05, 6.604194641113281e-05)
('****Sort time: ', 0.00040561103820800783, 0.0005118846893310547)
****Stage 0 average time 0.00684197545052
****Stage 1 average time 0.00638265490532
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946553523666
****DCGs @ 8: 0.920689006791
****DCGs @ 16: 0.87727691126
****DCGs @ 32: 0.81686395777
****DCGs @ 64: 0.726859262881
****Error : 0.2950234375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  6.72804903984
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.010501749753952027, 0.012923049926757812)
('****Total time: ', 0.014472625613212586, 0.017426204681396478)
('****Preprocess time: ', 0.0012953735589981078, 0.0016029357910156247)
('****Data time: ', 0.00027557921409606935, 0.0003109097480773925)
('****Fetch time: ', 5.0720572471618655e-05, 5.91278076171875e-05)
('****Sort time: ', 0.00040441977977752683, 0.0004780292510986328)
****Stage 0 average time 0.00637693238258
****Stage 1 average time 0.00615091049671
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945927496169
****DCGs @ 8: 0.919990512857
****DCGs @ 16: 0.876864087608
****DCGs @ 32: 0.816832904157
****DCGs @ 64: 0.726659052923
****Error : 0.2951484375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.74601984024
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.010697183728218079, 0.013180398941040035)
('****Total time: ', 0.014501912951469421, 0.017380952835083008)
('****Preprocess time: ', 0.0013151464462280273, 0.0016020894050598135)
('****Data time: ', 0.0002744513750076294, 0.00031375885009765625)
('****Fetch time: ', 4.7859907150268556e-05, 5.6743621826171875e-05)
('****Sort time: ', 0.00040796613693237305, 0.0004699349403381347)
****Stage 0 average time 0.00643791019917
****Stage 1 average time 0.00630469739437
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947377506695
****DCGs @ 8: 0.920568500724
****DCGs @ 16: 0.876764802779
****DCGs @ 32: 0.817086531834
****DCGs @ 64: 0.72645828018
****Error : 0.294875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.608684063
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01029580283164978, 0.012299251556396483)
('****Total time: ', 0.01399463164806366, 0.016282331943511964)
('****Preprocess time: ', 0.0012934184074401855, 0.0015659451484680174)
('****Data time: ', 0.0002689656019210815, 0.0003001689910888672)
('****Fetch time: ', 4.599499702453613e-05, 5.412101745605469e-05)
('****Sort time: ', 0.00040921831130981445, 0.00046305656433105443)
****Stage 0 average time 0.00623518061638
****Stage 1 average time 0.00607821953297
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946076203546
****DCGs @ 8: 0.920638423844
****DCGs @ 16: 0.876948733066
****DCGs @ 32: 0.817204136449
****DCGs @ 64: 0.727075127439
****Error : 0.294955078125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.6681649685
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.010100253343582154, 0.011970090866088861)
('****Total time: ', 0.01377305507659912, 0.015902996063232422)
('****Preprocess time: ', 0.0012863589525222779, 0.001520884037017822)
('****Data time: ', 0.00026883864402770994, 0.0003037452697753906)
('****Fetch time: ', 4.3923497200012206e-05, 5.125999450683594e-05)
('****Sort time: ', 0.0003978637456893921, 0.0004401206970214844)
****Stage 0 average time 0.00610847079754
****Stage 1 average time 0.00598876738548
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947443903716
****DCGs @ 8: 0.920780150454
****DCGs @ 16: 0.877159739696
****DCGs @ 32: 0.817142467123
****DCGs @ 64: 0.726854924464
****Error : 0.294921875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.7505431175
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.010011111497879028, 0.011759853363037105)
('****Total time: ', 0.013672586441040038, 0.015624046325683587)
('****Preprocess time: ', 0.0012901029586791992, 0.001553833484649658)
('****Data time: ', 0.00026906967163085936, 0.00030112266540527344)
('****Fetch time: ', 4.273676872253418e-05, 4.9114227294921875e-05)
('****Sort time: ', 0.0003925071954727173, 0.0004458427429199219)
****Stage 0 average time 0.00613189387321
****Stage 1 average time 0.00587363421917
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945554782866
****DCGs @ 8: 0.919769911252
****DCGs @ 16: 0.876452721426
****DCGs @ 32: 0.816620211811
****DCGs @ 64: 0.726457542464
****Error : 0.295072265625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.8373458385
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.009824905276298522, 0.01138036251068115)
('****Total time: ', 0.013479606747627259, 0.015313196182250976)
('****Preprocess time: ', 0.0012917890548706055, 0.001528024673461914)
('****Data time: ', 0.0002659631967544556, 0.0002918243408203125)
('****Fetch time: ', 4.228270053863525e-05, 4.696846008300781e-05)
('****Sort time: ', 0.0004083210229873657, 0.000446343421936035)
****Stage 0 average time 0.00600532257557
****Stage 1 average time 0.00582793867588
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946408076009
****DCGs @ 8: 0.920404609871
****DCGs @ 16: 0.87736233135
****DCGs @ 32: 0.817231086353
****DCGs @ 64: 0.726983285825
****Error : 0.29500390625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.507319212
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.009865986347198487, 0.011456263065338134)
('****Total time: ', 0.013468307733535767, 0.015302956104278564)
('****Preprocess time: ', 0.001282041907310486, 0.0015079975128173828)
('****Data time: ', 0.000267777681350708, 0.0002949237823486328)
('****Fetch time: ', 4.2842745780944827e-05, 4.8160552978515625e-05)
('****Sort time: ', 0.0003968091011047363, 0.0004379749298095703)
****Stage 0 average time 0.00596200799942
****Stage 1 average time 0.00589344978333
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947535362706
****DCGs @ 8: 0.921068602866
****DCGs @ 16: 0.87706989017
****DCGs @ 32: 0.817244602138
****DCGs @ 64: 0.726671648041
****Error : 0.294974609375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  30.6752159595
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.00988373053073883, 0.01143239736557006)
('****Total time: ', 0.013468825578689576, 0.015347647666931143)
('****Preprocess time: ', 0.0012691606283187866, 0.0014619946479797362)
('****Data time: ', 0.00026685786247253416, 0.0003008842468261719)
('****Fetch time: ', 4.252445697784424e-05, 4.9114227294921875e-05)
('****Sort time: ', 0.00040523624420166015, 0.00043702125549316406)
****Stage 0 average time 0.00596534657478
****Stage 1 average time 0.00590216314793
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945467706485
****DCGs @ 8: 0.920225129604
****DCGs @ 16: 0.876391365891
****DCGs @ 32: 0.81674174617
****DCGs @ 64: 0.72666522572
****Error : 0.29487109375
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
****Total experiment time (s):  8.03393101692
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008196217060089111, 0.008940935134887695)
('****Total time: ', 3.3640993072986602, 6.390450930595398)
('****Preprocess time: ', 0.0011253052949905396, 0.0012768864631652822)
('****Data time: ', 0.00023322880268096923, 0.00025227069854736315)
('****Fetch time: ', 6.487524509429931e-05, 7.081031799316406e-05)
('****Sort time: ', 0.0003782545328140259, 0.00041103363037109375)
****Stage 0 average time 0.00401251637936
****Stage 1 average time 0.00598536455631
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945836912961
****DCGs @ 8: 0.920197169098
****DCGs @ 16: 0.8763693994
****DCGs @ 32: 0.816579024835
****DCGs @ 64: 0.726529550884
****Error : 0.29508203125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.06078505516
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.008159963130950928, 0.008959019184112548)
('****Total time: ', 2.8461774888038636, 5.421428847312926)
('****Preprocess time: ', 0.0011464735269546508, 0.001313924789428711)
('****Data time: ', 0.00022311162948608398, 0.0002460479736328125)
('****Fetch time: ', 6.373417377471923e-05, 6.914138793945312e-05)
('****Sort time: ', 0.00037803125381469726, 0.0004119873046875)
****Stage 0 average time 0.00402542948723
****Stage 1 average time 0.00594588422775
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947363099667
****DCGs @ 8: 0.920418966592
****DCGs @ 16: 0.877213989468
****DCGs @ 32: 0.817043178345
****DCGs @ 64: 0.726659441052
****Error : 0.29490234375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.01065993309
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008134902596473694, 0.009120559692382808)
('****Total time: ', 2.2772023550271987, 4.324297547340393)
('****Preprocess time: ', 0.0011631669998168946, 0.0013489723205566406)
('****Data time: ', 0.00022135818004608154, 0.00024700164794921875)
('****Fetch time: ', 6.22023344039917e-05, 6.794929504394531e-05)
('****Sort time: ', 0.0003770761489868164, 0.0004053354263305663)
****Stage 0 average time 0.00400560796261
****Stage 1 average time 0.00595309829712
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946404816289
****DCGs @ 8: 0.92033895907
****DCGs @ 16: 0.8767185906
****DCGs @ 32: 0.817448297602
****DCGs @ 64: 0.726859550854
****Error : 0.29487890625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.96510386467
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.008126490473747253, 0.009464204311370848)
('****Total time: ', 1.7228469153642654, 3.285203492641448)
('****Preprocess time: ', 0.0011477593183517455, 0.0013349533081054685)
('****Data time: ', 0.00021698856353759765, 0.0002448678016662597)
('****Fetch time: ', 6.287097930908203e-05, 6.890296936035156e-05)
('****Sort time: ', 0.0003773910999298096, 0.0003998279571533203)
****Stage 0 average time 0.00398486685753
****Stage 1 average time 0.00594663357735
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946553523666
****DCGs @ 8: 0.920689006791
****DCGs @ 16: 0.87727691126
****DCGs @ 32: 0.81686395777
****DCGs @ 64: 0.726859262881
****Error : 0.2950234375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.94928002357
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.008041558027267456, 0.008951091766357422)
('****Total time: ', 0.7347439126968384, 1.3371909022331236)
('****Preprocess time: ', 0.001149508833885193, 0.0013273119926452634)
('****Data time: ', 0.0002236560583114624, 0.00025417804718017565)
('****Fetch time: ', 6.097579002380371e-05, 6.67572021484375e-05)
('****Sort time: ', 0.0003801991939544678, 0.00040793418884277344)
****Stage 0 average time 0.00397672128677
****Stage 1 average time 0.00587917661667
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945927496169
****DCGs @ 8: 0.919990512857
****DCGs @ 16: 0.876864087608
****DCGs @ 32: 0.816832904157
****DCGs @ 64: 0.726659052923
****Error : 0.2951484375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.72391080856
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.008033194661140441, 0.00892782211303711)
('****Total time: ', 0.017571280360221864, 0.03998901844024649)
('****Preprocess time: ', 0.0011307079792022706, 0.0013203620910644518)
('****Data time: ', 0.00021965217590332032, 0.00024199485778808594)
('****Fetch time: ', 6.302440166473389e-05, 6.699562072753906e-05)
('****Sort time: ', 0.00037460601329803464, 0.0004069805145263672)
****Stage 0 average time 0.00398164355755
****Stage 1 average time 0.00583954167366
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947377506695
****DCGs @ 8: 0.920568500724
****DCGs @ 16: 0.876764802779
****DCGs @ 32: 0.817086531834
****DCGs @ 64: 0.72645828018
****Error : 0.294875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.580258131
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008211724996566772, 0.00957522392272949)
('****Total time: ', 0.01271942102909088, 0.016719019412994387)
('****Preprocess time: ', 0.0011347782611846923, 0.00131227970123291)
('****Data time: ', 0.00022043073177337646, 0.0002472400665283203)
('****Fetch time: ', 6.392335891723632e-05, 7.177591323852533e-05)
('****Sort time: ', 0.0003648355007171631, 0.00040293931961059564)
****Stage 0 average time 0.00408484137058
****Stage 1 average time 0.00591085147858
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946076203546
****DCGs @ 8: 0.920638423844
****DCGs @ 16: 0.876948733066
****DCGs @ 32: 0.817204136449
****DCGs @ 64: 0.727075127439
****Error : 0.294955078125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.6389830112
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.008085923433303834, 0.009147286415100096)
('****Total time: ', 0.01174997317790985, 0.014422178268432605)
('****Preprocess time: ', 0.001113904356956482, 0.001292264461517334)
('****Data time: ', 0.00021954679489135742, 0.0002482414245605466)
('****Fetch time: ', 6.317830085754394e-05, 7.200241088867188e-05)
('****Sort time: ', 0.00036955714225769045, 0.0004232287406921385)
****Stage 0 average time 0.00405689036846
****Stage 1 average time 0.00579521965981
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947443903716
****DCGs @ 8: 0.920780150454
****DCGs @ 16: 0.877159739696
****DCGs @ 32: 0.817142467123
****DCGs @ 64: 0.726854924464
****Error : 0.294921875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.6445419788
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008113625645637512, 0.009241819381713862)
('****Total time: ', 0.01159858512878418, 0.01354073286056517)
('****Preprocess time: ', 0.0011216450929641723, 0.0013282299041748047)
('****Data time: ', 0.0002247030735015869, 0.0002570152282714844)
('****Fetch time: ', 6.388986110687256e-05, 7.321834564208971e-05)
('****Sort time: ', 0.0003710529804229736, 0.0004401564598083494)
****Stage 0 average time 0.00408548843861
****Stage 1 average time 0.00580942821503
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945554782866
****DCGs @ 8: 0.919769911252
****DCGs @ 16: 0.876452721426
****DCGs @ 32: 0.816620211811
****DCGs @ 64: 0.726457542464
****Error : 0.295072265625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.8128750324
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.008059596300125121, 0.00915032625198364)
('****Total time: ', 0.011402735590934753, 0.012944722175598136)
('****Preprocess time: ', 0.0011042358875274659, 0.0012719750404357908)
('****Data time: ', 0.00021977555751800538, 0.00025200843811035156)
('****Fetch time: ', 6.333017349243163e-05, 7.104873657226562e-05)
('****Sort time: ', 0.000373343825340271, 0.0004461407661437985)
****Stage 0 average time 0.00404644358158
****Stage 1 average time 0.00577383816242
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.946408076009
****DCGs @ 8: 0.920404609871
****DCGs @ 16: 0.87736233135
****DCGs @ 32: 0.817231086353
****DCGs @ 64: 0.726983285825
****Error : 0.29500390625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.5178821087
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.00805623733997345, 0.00904088020324707)
('****Total time: ', 0.011390729188919067, 0.012604343891143796)
('****Preprocess time: ', 0.0010997462272644043, 0.0012777447700500484)
('****Data time: ', 0.00022040390968322755, 0.00024892091751098626)
('****Fetch time: ', 6.272757053375244e-05, 6.986856460571283e-05)
('****Sort time: ', 0.0003687189817428589, 0.00044490098953247064)
****Stage 0 average time 0.00402929186821
****Stage 1 average time 0.00577854216099
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.947535362706
****DCGs @ 8: 0.921068602866
****DCGs @ 16: 0.87706989017
****DCGs @ 32: 0.817244602138
****DCGs @ 64: 0.726671648041
****Error : 0.294974609375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  30.7291080952
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.008140288591384888, 0.009333348274230954)
('****Total time: ', 0.01148594880104065, 0.012904465198516844)
('****Preprocess time: ', 0.0011045613288879394, 0.0012810587882995605)
('****Data time: ', 0.00022196567058563232, 0.00025200843811035156)
('****Fetch time: ', 6.30112886428833e-05, 6.985664367675781e-05)
('****Sort time: ', 0.0003699311017990112, 0.00044016838073730443)
****Stage 0 average time 0.00405326211452
****Stage 1 average time 0.00584649586678
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [512, 256])
****DCGs @ 4: 0.945467706485
****DCGs @ 8: 0.920225129604
****DCGs @ 16: 0.876391365891
****DCGs @ 32: 0.81674174617
****DCGs @ 64: 0.72666522572
****Error : 0.29487109375
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  7.62929606438
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.013159491539001466, 0.018632864952087387)
('****Total time: ', 2.98908946287632, 5.42092924118042)
('****Preprocess time: ', 0.0019156038761138916, 0.002665996551513672)
('****Data time: ', 0.0002998238801956177, 0.00036671161651611315)
('****Fetch time: ', 7.955038547515869e-05, 9.393692016601562e-05)
('****Sort time: ', 0.0003622777462005615, 0.0004999637603759766)
****Stage 0 average time 0.0120849602222
****Stage 1 average time 0.00373178720474
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971405334172
****DCGs @ 8: 0.948470245556
****DCGs @ 16: 0.923238010731
****DCGs @ 32: 0.87915469362
****DCGs @ 64: 0.815903564962
****Error : 0.3231171875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.57873797417
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.012260799765586854, 0.016752982139587397)
('****Total time: ', 2.4879542977809908, 4.500076627731322)
('****Preprocess time: ', 0.0017904390096664428, 0.0024610519409179682)
('****Data time: ', 0.0002799021005630493, 0.0003349781036376953)
('****Fetch time: ', 7.338261604309082e-05, 8.584260940551751e-05)
('****Sort time: ', 0.00035629808902740476, 0.00048804283142089844)
****Stage 0 average time 0.0110423854589
****Stage 1 average time 0.00371843612194
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.970021090143
****DCGs @ 8: 0.949323758751
****DCGs @ 16: 0.923605009664
****DCGs @ 32: 0.879667233109
****DCGs @ 64: 0.81633756698
****Error : 0.32284375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.44489693642
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011939587593078614, 0.016300511360168454)
('****Total time: ', 1.8655771614313126, 3.417997682094573)
('****Preprocess time: ', 0.0017352550029754638, 0.002392888069152831)
('****Data time: ', 0.00027143359184265135, 0.0003170967102050781)
('****Fetch time: ', 7.128679752349853e-05, 8.106231689453125e-05)
('****Sort time: ', 0.00037494421005249026, 0.00047998428344726536)
****Stage 0 average time 0.010746029377
****Stage 1 average time 0.00364647781849
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.967881778509
****DCGs @ 8: 0.947995418784
****DCGs @ 16: 0.922817245871
****DCGs @ 32: 0.878525919462
****DCGs @ 64: 0.815917582452
****Error : 0.32287890625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.74421715736
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.012118295073509215, 0.014441704750061027)
('****Total time: ', 1.8223702887296676, 3.6207100629806512)
('****Preprocess time: ', 0.001741590142250061, 0.0022744059562683095)
('****Data time: ', 0.00027870082855224607, 0.0003187775611877441)
('****Fetch time: ', 7.32886791229248e-05, 8.296966552734375e-05)
('****Sort time: ', 0.00035132062435150145, 0.00044417381286621094)
****Stage 0 average time 0.0102706922293
****Stage 1 average time 0.00429250311852
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971702501818
****DCGs @ 8: 0.948721003805
****DCGs @ 16: 0.923597080681
****DCGs @ 32: 0.879472027746
****DCGs @ 64: 0.816184117288
****Error : 0.3228359375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.83869290352
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.011434459447860718, 0.013326227664947503)
('****Total time: ', 0.6505001832246781, 0.8669745445251464)
('****Preprocess time: ', 0.0016722596883773804, 0.001886212825775146)
('****Data time: ', 0.0002663520574569702, 0.0003032922744750975)
('****Fetch time: ', 6.845533847808838e-05, 7.915496826171875e-05)
('****Sort time: ', 0.00036531400680541994, 0.00045396089553833)
****Stage 0 average time 0.00996352398396
****Stage 1 average time 0.00384331655502
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.968790072412
****DCGs @ 8: 0.948798377696
****DCGs @ 16: 0.923117630094
****DCGs @ 32: 0.879277562764
****DCGs @ 64: 0.816148363113
****Error : 0.32290625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.08985495567
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.01159346580505371, 0.013759028911590565)
('****Total time: ', 0.02861702597141266, 0.07465670108795162)
('****Preprocess time: ', 0.0016740304231643677, 0.001862061023712158)
('****Data time: ', 0.0002659316062927246, 0.0002970695495605469)
('****Fetch time: ', 6.740736961364746e-05, 7.605552673339844e-05)
('****Sort time: ', 0.0003635156154632568, 0.00043419599533081035)
****Stage 0 average time 0.0100334312916
****Stage 1 average time 0.00393091952801
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.968666921218
****DCGs @ 8: 0.948149927131
****DCGs @ 16: 0.923131187468
****DCGs @ 32: 0.878877673737
****DCGs @ 64: 0.816092280026
****Error : 0.32277734375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.9817221165
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011273592948913573, 0.013006782531738276)
('****Total time: ', 0.016110748529434202, 0.020420444011688223)
('****Preprocess time: ', 0.001676385760307312, 0.001883292198181152)
('****Data time: ', 0.0002613393068313599, 0.0002968311309814453)
('****Fetch time: ', 6.560540199279785e-05, 7.581710815429688e-05)
('****Sort time: ', 0.0003745145797729492, 0.00043774843215942376)
****Stage 0 average time 0.00989079070091
****Stage 1 average time 0.00376064729691
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971824146705
****DCGs @ 8: 0.949129857239
****DCGs @ 16: 0.923432371193
****DCGs @ 32: 0.879264550042
****DCGs @ 64: 0.816166275158
****Error : 0.32296875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.0428819656
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.011275363445281983, 0.013366079330444336)
('****Total time: ', 0.01568329691886902, 0.018761467933654775)
('****Preprocess time: ', 0.001687638998031616, 0.002031087875366211)
('****Data time: ', 0.0002625633478164673, 0.00029469728469848626)
('****Fetch time: ', 6.694507598876953e-05, 7.70211219787597e-05)
('****Sort time: ', 0.00036951184272766114, 0.00042800903320312474)
****Stage 0 average time 0.00990207695961
****Stage 1 average time 0.00375994575024
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.968037881108
****DCGs @ 8: 0.948493872922
****DCGs @ 16: 0.92310293686
****DCGs @ 32: 0.879353055502
****DCGs @ 64: 0.816264583587
****Error : 0.322796875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.0407090187
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011132920384407044, 0.013392174243927)
('****Total time: ', 0.015350489854812622, 0.017924618721008298)
('****Preprocess time: ', 0.0016643478870391846, 0.0018971443176269529)
('****Data time: ', 0.00026394641399383545, 0.0003011584281921385)
('****Fetch time: ', 6.423354148864747e-05, 7.104873657226562e-05)
('****Sort time: ', 0.00036111617088317873, 0.00040293931961059564)
****Stage 0 average time 0.00983886027336
****Stage 1 average time 0.00364770412445
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.969684835071
****DCGs @ 8: 0.948049341344
****DCGs @ 16: 0.923189273877
****DCGs @ 32: 0.878705489227
****DCGs @ 64: 0.815892392719
****Error : 0.32283203125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.1749739647
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.011010280132293701, 0.012895560264587401)
('****Total time: ', 0.015071510314941406, 0.017238736152648922)
('****Preprocess time: ', 0.0016635429859161376, 0.0018849849700927732)
('****Data time: ', 0.00026620209217071534, 0.0002980232238769531)
('****Fetch time: ', 6.705796718597412e-05, 7.200241088867188e-05)
('****Sort time: ', 0.0003632615804672241, 0.0003988862037658691)
****Stage 0 average time 0.00958203518391
****Stage 1 average time 0.00378830957413
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971487891633
****DCGs @ 8: 0.949535912932
****DCGs @ 16: 0.92355797463
****DCGs @ 32: 0.879649661036
****DCGs @ 64: 0.816371768139
****Error : 0.32295703125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.9281151295
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.011063518524169922, 0.013484191894531244)
('****Total time: ', 0.015138289332389832, 0.01777106523513794)
('****Preprocess time: ', 0.0016738760471343994, 0.0019050836563110345)
('****Data time: ', 0.00026398181915283204, 0.0002970695495605469)
('****Fetch time: ', 6.435108184814453e-05, 7.104873657226562e-05)
('****Sort time: ', 0.00035900723934173583, 0.00039505958557128906)
****Stage 0 average time 0.00967303955555
****Stage 1 average time 0.0037516951561
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.967588993471
****DCGs @ 8: 0.948104956978
****DCGs @ 16: 0.923036749428
****DCGs @ 32: 0.878802697054
****DCGs @ 64: 0.816038963803
****Error : 0.32276171875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  31.1201770306
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.011058757185935974, 0.013435125350952148)
('****Total time: ', 0.01511819350719452, 0.017646169662475585)
('****Preprocess time: ', 0.0016684207916259765, 0.0019143462181091305)
('****Data time: ', 0.00026603519916534423, 0.0002982616424560547)
('****Fetch time: ', 6.311321258544922e-05, 7.009506225585938e-05)
('****Sort time: ', 0.00035471200942993164, 0.000392913818359375)
****Stage 0 average time 0.00967467498779
****Stage 1 average time 0.00373636341095
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.970903827865
****DCGs @ 8: 0.948456469086
****DCGs @ 16: 0.923274403264
****DCGs @ 32: 0.87924558374
****DCGs @ 64: 0.816126173967
****Error : 0.3228515625
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  2.04065704346
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.014208550095558166, 0.02037492990493774)
('****Total time: ', 0.020312353014945984, 0.02832512855529785)
('****Preprocess time: ', 0.0019260238409042358, 0.0026952385902404776)
('****Data time: ', 0.0003425674438476563, 0.0004260540008544922)
('****Fetch time: ', 6.0384035110473634e-05, 6.986856460571283e-05)
('****Sort time: ', 0.0003844914436340332, 0.0005071520805358885)
****Stage 0 average time 0.0120634486675
****Stage 1 average time 0.00485856819153
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971405334172
****DCGs @ 8: 0.948470245556
****DCGs @ 16: 0.923238010731
****DCGs @ 32: 0.87915469362
****DCGs @ 64: 0.815903564962
****Error : 0.3231171875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  2.94231009483
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.014121471166610718, 0.02011967897415161)
('****Total time: ', 0.019335362911224365, 0.025824809074401843)
('****Preprocess time: ', 0.0019246944189071655, 0.0026589035987854)
('****Data time: ', 0.00033994638919830324, 0.0003962874412536619)
('****Fetch time: ', 5.732274055480957e-05, 6.699562072753906e-05)
('****Sort time: ', 0.00037604081630706785, 0.0004942774772644041)
****Stage 0 average time 0.0119337729216
****Stage 1 average time 0.00488570261002
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.970021090143
****DCGs @ 8: 0.949323758751
****DCGs @ 16: 0.923605009664
****DCGs @ 32: 0.879667233109
****DCGs @ 64: 0.81633756698
****Error : 0.32284375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  3.93002009392
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.012590501427650452, 0.01563451290130615)
('****Total time: ', 0.017848978519439698, 0.02199097871780395)
('****Preprocess time: ', 0.0017915784120559693, 0.002235925197601317)
('****Data time: ', 0.0003092622756958008, 0.00035191774368286126)
('****Fetch time: ', 5.04007339477539e-05, 5.91278076171875e-05)
('****Sort time: ', 0.00041317260265350344, 0.0004737496376037597)
****Stage 0 average time 0.0105067495108
****Stage 1 average time 0.00464816594124
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.967881778509
****DCGs @ 8: 0.947995418784
****DCGs @ 16: 0.922817245871
****DCGs @ 32: 0.878525919462
****DCGs @ 64: 0.815917582452
****Error : 0.32287890625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.96009397507
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.012682540059089661, 0.015430676937103267)
('****Total time: ', 0.01739367389678955, 0.0206712007522583)
('****Preprocess time: ', 0.0018110835552215575, 0.0023311138153076167)
('****Data time: ', 0.00031255853176116944, 0.0003521442413330078)
('****Fetch time: ', 4.909241199493408e-05, 5.91278076171875e-05)
('****Sort time: ', 0.0003893389701843262, 0.0004680156707763672)
****Stage 0 average time 0.0106088550091
****Stage 1 average time 0.00463575851917
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971702501818
****DCGs @ 8: 0.948721003805
****DCGs @ 16: 0.923597080681
****DCGs @ 32: 0.879472027746
****DCGs @ 64: 0.816184117288
****Error : 0.3228359375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.00207304955
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.012210833191871643, 0.014486992359161371)
('****Total time: ', 0.016728176832199095, 0.01945084333419799)
('****Preprocess time: ', 0.0017630044221878052, 0.0019898533821105955)
('****Data time: ', 0.0003043433427810669, 0.0003399848937988281)
('****Fetch time: ', 4.611325263977051e-05, 5.5789947509765625e-05)
('****Sort time: ', 0.00038363826274871824, 0.0004360675811767578)
****Stage 0 average time 0.0103655706644
****Stage 1 average time 0.00434236180782
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.968790072412
****DCGs @ 8: 0.948798377696
****DCGs @ 16: 0.923117630094
****DCGs @ 32: 0.879277562764
****DCGs @ 64: 0.816148363113
****Error : 0.32290625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.08759999275
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.012409316420555115, 0.015207982063293456)
('****Total time: ', 0.016865958571434022, 0.020024597644805905)
('****Preprocess time: ', 0.0017895458936691285, 0.0022072792053222643)
('****Data time: ', 0.0003084244728088379, 0.00034117698669433594)
('****Fetch time: ', 4.52347993850708e-05, 5.389451980590814e-05)
('****Sort time: ', 0.00037968337535858153, 0.0004317879676818847)
****Stage 0 average time 0.010448482275
****Stage 1 average time 0.00448372268677
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.968666921218
****DCGs @ 8: 0.948149927131
****DCGs @ 16: 0.923131187468
****DCGs @ 32: 0.878877673737
****DCGs @ 64: 0.816092280026
****Error : 0.32277734375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.9889290333
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011818482995033264, 0.014052641391754148)
('****Total time: ', 0.01617131221294403, 0.01866614818572998)
('****Preprocess time: ', 0.0017534134387969971, 0.001954805850982666)
('****Data time: ', 0.00030096042156219484, 0.0003409385681152344)
('****Fetch time: ', 4.270851612091064e-05, 5.078315734863281e-05)
('****Sort time: ', 0.0003800370693206787, 0.00043010711669921875)
****Stage 0 average time 0.0100032268763
****Stage 1 average time 0.00429237556458
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971824146705
****DCGs @ 8: 0.949129857239
****DCGs @ 16: 0.923432371193
****DCGs @ 32: 0.879264550042
****DCGs @ 64: 0.816166275158
****Error : 0.32296875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.0635330677
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.011809380769729615, 0.01417994499206543)
('****Total time: ', 0.01622364628314972, 0.01889441013336181)
('****Preprocess time: ', 0.0017586573362350464, 0.0020000219345092766)
('****Data time: ', 0.000304223895072937, 0.00033402442932128906)
('****Fetch time: ', 4.391241073608398e-05, 4.9114227294921875e-05)
('****Sort time: ', 0.000375149130821228, 0.00042130947113037096)
****Stage 0 average time 0.00994386780262
****Stage 1 average time 0.00434745573997
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.968037881108
****DCGs @ 8: 0.948493872922
****DCGs @ 16: 0.92310293686
****DCGs @ 32: 0.879353055502
****DCGs @ 64: 0.816264583587
****Error : 0.322796875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.0437679291
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011819850087165833, 0.014251387119293212)
('****Total time: ', 0.016186511158943175, 0.018784320354461665)
('****Preprocess time: ', 0.0017721976041793824, 0.0019960761070251464)
('****Data time: ', 0.00030145680904388426, 0.0003349781036376953)
('****Fetch time: ', 4.1411757469177246e-05, 4.8160552978515625e-05)
('****Sort time: ', 0.00037406349182128904, 0.0004141688346862791)
****Stage 0 average time 0.00995193648338
****Stage 1 average time 0.0043570432663
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.969684835071
****DCGs @ 8: 0.948049341344
****DCGs @ 16: 0.923189273877
****DCGs @ 32: 0.878705489227
****DCGs @ 64: 0.815892392719
****Error : 0.32283203125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.1908750534
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.011437453031539917, 0.013502216339111327)
('****Total time: ', 0.01578844714164734, 0.0181195855140686)
('****Preprocess time: ', 0.0017501496076583862, 0.00197993516921997)
('****Data time: ', 0.00030200958251953126, 0.0003368973731994628)
('****Fetch time: ', 3.993105888366699e-05, 4.696846008300781e-05)
('****Sort time: ', 0.00037390637397766114, 0.00040985345840454095)
****Stage 0 average time 0.00966251981258
****Stage 1 average time 0.004240929842
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971487891633
****DCGs @ 8: 0.949535912932
****DCGs @ 16: 0.92355797463
****DCGs @ 32: 0.879649661036
****DCGs @ 64: 0.816371768139
****Error : 0.32295703125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.9542810917
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.011505981922149659, 0.013389217853546142)
('****Total time: ', 0.015880847454071045, 0.017976236343383786)
('****Preprocess time: ', 0.0017615983486175537, 0.001973652839660644)
('****Data time: ', 0.00030114567279815676, 0.00032902956008911126)
('****Fetch time: ', 4.004836082458496e-05, 4.506111145019531e-05)
('****Sort time: ', 0.0003819141387939453, 0.00041604042053222656)
****Stage 0 average time 0.00963900709152
****Stage 1 average time 0.00435168135166
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.967588993471
****DCGs @ 8: 0.948104956978
****DCGs @ 16: 0.923036749428
****DCGs @ 32: 0.878802697054
****DCGs @ 64: 0.816038963803
****Error : 0.32276171875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.1601231098
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.011422770619392396, 0.013505494594573971)
('****Total time: ', 0.015826523303985596, 0.01820751428604125)
('****Preprocess time: ', 0.0017559802532196044, 0.0020079612731933594)
('****Data time: ', 0.0003012709617614746, 0.0003371596336364744)
('****Fetch time: ', 4.0632009506225586e-05, 4.8160552978515625e-05)
('****Sort time: ', 0.0003915175199508667, 0.00041413307189941406)
****Stage 0 average time 0.00959977710247
****Stage 1 average time 0.00431239426136
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.970903827865
****DCGs @ 8: 0.948456469086
****DCGs @ 16: 0.923274403264
****DCGs @ 32: 0.87924558374
****DCGs @ 64: 0.816126173967
****Error : 0.3228515625
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
****Total experiment time (s):  9.79101610184
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.0069086747169494625, 0.008259868621826167)
('****Total time: ', 4.109803134441376, 7.814760076999663)
('****Preprocess time: ', 0.001554369568824768, 0.0018168091773986812)
('****Data time: ', 0.00021712231636047364, 0.0002319812774658203)
('****Fetch time: ', 5.9592366218566894e-05, 6.508827209472656e-05)
('****Sort time: ', 0.00035863173007965086, 0.0003998279571533203)
****Stage 0 average time 0.00491582024097
****Stage 1 average time 0.00418257045746
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971405334172
****DCGs @ 8: 0.948470245556
****DCGs @ 16: 0.923238010731
****DCGs @ 32: 0.87915469362
****DCGs @ 64: 0.815903564962
****Error : 0.3231171875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.78150010109
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.0067545738220214846, 0.007268238067626952)
('****Total time: ', 3.6221241546869276, 6.862743294239043)
('****Preprocess time: ', 0.0015349905490875243, 0.0017231106758117671)
('****Data time: ', 0.00021971142292022706, 0.00023293495178222656)
('****Fetch time: ', 5.8511257171630856e-05, 6.29425048828125e-05)
('****Sort time: ', 0.00035667037963867186, 0.0003948211669921875)
****Stage 0 average time 0.00491073012352
****Stage 1 average time 0.00401372730732
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.970021090143
****DCGs @ 8: 0.949323758751
****DCGs @ 16: 0.923605009664
****DCGs @ 32: 0.879667233109
****DCGs @ 64: 0.816337537788
****Error : 0.32284375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.73440599442
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.006759647607803345, 0.007294213771820069)
('****Total time: ', 3.0514367498159407, 5.796956121921538)
('****Preprocess time: ', 0.0015394465923309327, 0.0017717003822326658)
('****Data time: ', 0.00021368110179901124, 0.00022912025451660156)
('****Fetch time: ', 5.869340896606445e-05, 6.318092346191406e-05)
('****Sort time: ', 0.0003573623895645142, 0.0003821849822998047)
****Stage 0 average time 0.00489032936096
****Stage 1 average time 0.0040385017395
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.967881778509
****DCGs @ 8: 0.947995418784
****DCGs @ 16: 0.922817245871
****DCGs @ 32: 0.878525919462
****DCGs @ 64: 0.815917582452
****Error : 0.32287890625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.70339798927
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.006783147692680359, 0.007281208038330078)
('****Total time: ', 2.477344274520874, 4.740205442905425)
('****Preprocess time: ', 0.0015319868326187133, 0.0016877770423889158)
('****Data time: ', 0.0002135847806930542, 0.00022912025451660156)
('****Fetch time: ', 5.8692216873168946e-05, 6.29425048828125e-05)
('****Sort time: ', 0.00035822081565856936, 0.0003881812095642088)
****Stage 0 average time 0.00487308287621
****Stage 1 average time 0.00407254946232
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971702501818
****DCGs @ 8: 0.948721003805
****DCGs @ 16: 0.923597080681
****DCGs @ 32: 0.879472027746
****DCGs @ 64: 0.816184088096
****Error : 0.3228359375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.60709500313
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.006636898398399353, 0.0069179534912109375)
('****Total time: ', 1.4611425895690917, 2.7844461917877195)
('****Preprocess time: ', 0.0015010498762130736, 0.0016117215156555174)
('****Data time: ', 0.00021888303756713867, 0.00023889541625976562)
('****Fetch time: ', 5.715787410736084e-05, 6.508827209472656e-05)
('****Sort time: ', 0.00035512912273406985, 0.00038695335388183594)
****Stage 0 average time 0.00479587841034
****Stage 1 average time 0.00397323989868
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.968790072412
****DCGs @ 8: 0.948798377696
****DCGs @ 16: 0.923117630094
****DCGs @ 32: 0.879277562764
****DCGs @ 64: 0.816148333921
****Error : 0.32290625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.55092310905
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.006606625437736512, 0.006901121139526367)
('****Total time: ', 0.367655289888382, 0.7604083299636836)
('****Preprocess time: ', 0.0014993680715560914, 0.0015759468078613281)
('****Data time: ', 0.00021887969970703125, 0.0002410411834716797)
('****Fetch time: ', 5.653393268585205e-05, 6.079673767089844e-05)
('****Sort time: ', 0.00036321330070495603, 0.00039076805114746094)
****Stage 0 average time 0.00479478085041
****Stage 1 average time 0.00394983959198
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.968666921218
****DCGs @ 8: 0.948149927131
****DCGs @ 16: 0.923131187468
****DCGs @ 32: 0.878877673737
****DCGs @ 64: 0.816092280026
****Error : 0.32277734375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.8847119808
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.006639339804649353, 0.00693831443786621)
('****Total time: ', 0.013388054728507995, 0.020708227157592775)
('****Preprocess time: ', 0.00149785578250885, 0.0015668869018554688)
('****Data time: ', 0.00021706926822662355, 0.00023629665374755846)
('****Fetch time: ', 5.690467357635498e-05, 6.103515625e-05)
('****Sort time: ', 0.0003786449432373047, 0.0003879189491271972)
****Stage 0 average time 0.00483496320248
****Stage 1 average time 0.00395485126972
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971824146705
****DCGs @ 8: 0.949129857239
****DCGs @ 16: 0.923432371193
****DCGs @ 32: 0.879264550042
****DCGs @ 64: 0.816166245966
****Error : 0.32296875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.9947109222
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.007182029008865357, 0.007925307750701905)
('****Total time: ', 0.01215247893333435, 0.01737508773803711)
('****Preprocess time: ', 0.0015318727493286134, 0.0016398549079895018)
('****Data time: ', 0.00022254443168640136, 0.0002410411834716797)
('****Fetch time: ', 6.201684474945069e-05, 6.794929504394531e-05)
('****Sort time: ', 0.0003311425447463989, 0.00035907030105590814)
****Stage 0 average time 0.00528220582008
****Stage 1 average time 0.00404739975929
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.968037881108
****DCGs @ 8: 0.948493872922
****DCGs @ 16: 0.92310293686
****DCGs @ 32: 0.879353055502
****DCGs @ 64: 0.816264554395
****Error : 0.322796875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.965389967
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.006612958669662475, 0.007051610946655271)
('****Total time: ', 0.010479899406433105, 0.011838412284851073)
('****Preprocess time: ', 0.0014664254188537598, 0.0015461444854736328)
('****Data time: ', 0.00021593034267425537, 0.0002319812774658203)
('****Fetch time: ', 5.7310223579406737e-05, 6.103515625e-05)
('****Sort time: ', 0.0003574479818344116, 0.0003829002380371094)
****Stage 0 average time 0.00477230203152
****Stage 1 average time 0.00393777060509
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.969684835071
****DCGs @ 8: 0.948049341344
****DCGs @ 16: 0.923189273877
****DCGs @ 32: 0.878705489227
****DCGs @ 64: 0.815892392719
****Error : 0.32283203125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.0322699547
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.006769901156425476, 0.007332050800323485)
('****Total time: ', 0.010329200148582459, 0.011439335346221923)
('****Preprocess time: ', 0.0014897162914276124, 0.0017841339111328122)
('****Data time: ', 0.0002118098735809326, 0.0002281665802001953)
('****Fetch time: ', 5.8828115463256835e-05, 6.29425048828125e-05)
('****Sort time: ', 0.0003490978479385376, 0.0003731250762939453)
****Stage 0 average time 0.00483690917492
****Stage 1 average time 0.00404244410992
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.971487891633
****DCGs @ 8: 0.949535912932
****DCGs @ 16: 0.92355797463
****DCGs @ 32: 0.879649661036
****DCGs @ 64: 0.816371738947
****Error : 0.32295703125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.831387043
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.006748482584953308, 0.007299959659576416)
('****Total time: ', 0.0103711918592453, 0.011055004596710206)
('****Preprocess time: ', 0.0014666390419006347, 0.0016589164733886719)
('****Data time: ', 0.00021745967864990234, 0.0002319812774658203)
('****Fetch time: ', 5.937576293945312e-05, 6.389617919921875e-05)
('****Sort time: ', 0.00035051643848419187, 0.00037407875061035156)
****Stage 0 average time 0.00481510674953
****Stage 1 average time 0.00402736675739
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.967588993471
****DCGs @ 8: 0.948104956978
****DCGs @ 16: 0.923036749428
****DCGs @ 32: 0.878802697054
****DCGs @ 64: 0.816038934611
****Error : 0.32276171875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.0322210789
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.006743703961372375, 0.007277226448059081)
('****Total time: ', 0.01032148802280426, 0.010970890522003174)
('****Preprocess time: ', 0.0014586858749389647, 0.0016232967376708977)
('****Data time: ', 0.00021813130378723144, 0.00023317337036132812)
('****Fetch time: ', 5.949783325195312e-05, 6.389617919921875e-05)
('****Sort time: ', 0.0003522437810897827, 0.0003867387771606444)
****Stage 0 average time 0.00481684207916
****Stage 1 average time 0.00401542067528
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 128])
****DCGs @ 4: 0.970903827865
****DCGs @ 8: 0.948456469086
****DCGs @ 16: 0.923274403264
****DCGs @ 32: 0.87924558374
****DCGs @ 64: 0.816126173967
****Error : 0.3228515625
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  8.77916312218
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.013305697798728942, 0.018935120105743407)
('****Total time: ', 3.5447850979566575, 6.549742794036864)
('****Preprocess time: ', 0.0023451501131057737, 0.003113985061645508)
('****Data time: ', 0.000309171199798584, 0.0003838539123535156)
('****Fetch time: ', 7.795631885528565e-05, 9.275674819946283e-05)
('****Sort time: ', 0.0005380039215087891, 0.000690078735351562)
****Stage 0 average time 0.0121603043079
****Stage 1 average time 0.00441567504406
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971405334172
****DCGs @ 8: 0.948390451018
****DCGs @ 16: 0.923298503225
****DCGs @ 32: 0.879226562512
****DCGs @ 64: 0.816237578868
****Error : 0.295013671875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.97708010674
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.011995176792144775, 0.014370417594909665)
('****Total time: ', 3.267029679775238, 5.847977340221404)
('****Preprocess time: ', 0.0021277958154678344, 0.002627003192901611)
('****Data time: ', 0.0002876112461090088, 0.0003409385681152344)
('****Fetch time: ', 7.329165935516358e-05, 8.606910705566406e-05)
('****Sort time: ', 0.0005383467674255371, 0.0006912231445312497)
****Stage 0 average time 0.0105145977736
****Stage 1 average time 0.00450762450695
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.970021090143
****DCGs @ 8: 0.949271929203
****DCGs @ 16: 0.923661842631
****DCGs @ 32: 0.879670544888
****DCGs @ 64: 0.816580854388
****Error : 0.295033203125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.76419591904
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011659696698188782, 0.013757729530334462)
('****Total time: ', 2.532224713087082, 4.652848029136657)
('****Preprocess time: ', 0.002116146922111511, 0.002564287185668945)
('****Data time: ', 0.00028397798538208006, 0.00032401084899902344)
('****Fetch time: ', 7.054054737091064e-05, 8.106231689453125e-05)
('****Sort time: ', 0.0005479866266250611, 0.00069812536239624)
****Stage 0 average time 0.0102583781481
****Stage 1 average time 0.0044199706316
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.967881778509
****DCGs @ 8: 0.947948108932
****DCGs @ 16: 0.922872970155
****DCGs @ 32: 0.87856311271
****DCGs @ 64: 0.816190761458
****Error : 0.2950703125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.04844498634
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.011783227324485779, 0.014963948726654049)
('****Total time: ', 2.202137140393257, 3.9854266524314874)
('****Preprocess time: ', 0.002142050266265869, 0.0026848793029785154)
('****Data time: ', 0.000281514048576355, 0.00032401084899902344)
('****Fetch time: ', 7.117199897766113e-05, 8.296966552734375e-05)
('****Sort time: ', 0.0005447463989257812, 0.0006659030914306641)
****Stage 0 average time 0.0102679519653
****Stage 1 average time 0.0045547580719
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971702501818
****DCGs @ 8: 0.94867658684
****DCGs @ 16: 0.923658290268
****DCGs @ 32: 0.879535317785
****DCGs @ 64: 0.816486068103
****Error : 0.294961914062
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.75527596474
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.011247896790504456, 0.012194097042083738)
('****Total time: ', 0.9443403486013412, 1.7329349517822266)
('****Preprocess time: ', 0.00207122540473938, 0.0022500157356262207)
('****Data time: ', 0.0002753866910934448, 0.00030494928359985345)
('****Fetch time: ', 6.776869297027588e-05, 7.582902908325189e-05)
('****Sort time: ', 0.0005431913137435913, 0.0006490230560302732)
****Stage 0 average time 0.00978903102875
****Stage 1 average time 0.0044164378643
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.968790072412
****DCGs @ 8: 0.948704391031
****DCGs @ 16: 0.923173961299
****DCGs @ 32: 0.879279271897
****DCGs @ 64: 0.816406707278
****Error : 0.29509765625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.1604809761
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.011484581112861634, 0.01434497833251953)
('****Total time: ', 0.158514301776886, 0.26882565021514887)
('****Preprocess time: ', 0.002122649669647217, 0.002631282806396484)
('****Data time: ', 0.0002767033576965332, 0.00031495094299316406)
('****Fetch time: ', 6.796479225158691e-05, 7.915496826171875e-05)
('****Sort time: ', 0.0005299323797225953, 0.0006041884422302244)
****Stage 0 average time 0.0099212397337
****Stage 1 average time 0.00456059157848
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.968666921218
****DCGs @ 8: 0.948147034244
****DCGs @ 16: 0.923209294912
****DCGs @ 32: 0.878926585746
****DCGs @ 64: 0.816372164656
****Error : 0.295
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.9180731773
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.012166491150856018, 0.014665639400482173)
('****Total time: ', 0.02248655915260315, 0.03320262432098388)
('****Preprocess time: ', 0.0021378661394119264, 0.0022960066795349116)
('****Data time: ', 0.00029587173461914065, 0.00033284425735473626)
('****Fetch time: ', 7.236480712890625e-05, 8.082389831542969e-05)
('****Sort time: ', 0.0005573612451553344, 0.0005970001220703125)
****Stage 0 average time 0.0101450852156
****Stage 1 average time 0.0050848698616
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971824146705
****DCGs @ 8: 0.949043283157
****DCGs @ 16: 0.923489551586
****DCGs @ 32: 0.879295327594
****DCGs @ 64: 0.816456091284
****Error : 0.295034179688
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.030534029
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.011631497740745544, 0.013528966903686518)
('****Total time: ', 0.01707116436958313, 0.021090197563171372)
('****Preprocess time: ', 0.0020989807844161985, 0.0023059844970703125)
('****Data time: ', 0.00028054332733154296, 0.0003140091896057128)
('****Fetch time: ', 6.803739070892334e-05, 7.677078247070312e-05)
('****Sort time: ', 0.0005340443849563599, 0.0006302356719970698)
****Stage 0 average time 0.00994926416874
****Stage 1 average time 0.00466383945942
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.968037881108
****DCGs @ 8: 0.948439783526
****DCGs @ 16: 0.923179145476
****DCGs @ 32: 0.87935451308
****DCGs @ 64: 0.816528337993
****Error : 0.29502734375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.0556149483
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011630946516990662, 0.014109659194946285)
('****Total time: ', 0.01657339525222778, 0.019764685630798327)
('****Preprocess time: ', 0.0021080586910247803, 0.0024128079414367674)
('****Data time: ', 0.00028637337684631346, 0.00032619237899780254)
('****Fetch time: ', 6.727385520935058e-05, 7.700920104980469e-05)
('****Sort time: ', 0.0005377988815307617, 0.0006468415260314941)
****Stage 0 average time 0.0101241234541
****Stage 1 average time 0.00450632786751
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.969684835071
****DCGs @ 8: 0.948006551188
****DCGs @ 16: 0.923248412359
****DCGs @ 32: 0.878765095507
****DCGs @ 64: 0.816172080525
****Error : 0.295120117187
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.173623085
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.011399801850318908, 0.013637995719909667)
('****Total time: ', 0.01605278789997101, 0.01861201524734497)
('****Preprocess time: ', 0.0020777294635772707, 0.0022962927818298336)
('****Data time: ', 0.00027863967418670653, 0.00031185150146484375)
('****Fetch time: ', 6.742846965789795e-05, 7.200241088867188e-05)
('****Sort time: ', 0.0005297117233276367, 0.000579833984375)
****Stage 0 average time 0.0099188773632
****Stage 1 average time 0.00443443381786
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971487891633
****DCGs @ 8: 0.949447079002
****DCGs @ 16: 0.923594273473
****DCGs @ 32: 0.879681658754
****DCGs @ 64: 0.816684270146
****Error : 0.29491796875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.9025270939
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.01156852638721466, 0.014117002487182617)
('****Total time: ', 0.016246765851974487, 0.018996357917785645)
('****Preprocess time: ', 0.002094586491584778, 0.0023530483245849604)
('****Data time: ', 0.00028715264797210695, 0.0003261566162109375)
('****Fetch time: ', 6.589078903198242e-05, 7.486343383789062e-05)
('****Sort time: ', 0.0005251374244689941, 0.00057222843170166)
****Stage 0 average time 0.0100331561565
****Stage 1 average time 0.00450813758373
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.967588993471
****DCGs @ 8: 0.94805312743
****DCGs @ 16: 0.923151472946
****DCGs @ 32: 0.878811860015
****DCGs @ 64: 0.816269358687
****Error : 0.295130859375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  31.1176249981
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.01131296694278717, 0.013688135147094726)
('****Total time: ', 0.01597515380382538, 0.018627941608428955)
('****Preprocess time: ', 0.002084007382392883, 0.0023410797119140622)
('****Data time: ', 0.0002782377004623413, 0.0003168702125549316)
('****Fetch time: ', 6.579422950744629e-05, 7.414817810058594e-05)
('****Sort time: ', 0.0005248571634292602, 0.0005691051483154297)
****Stage 0 average time 0.00978512811661
****Stage 1 average time 0.00448073530197
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.970903827865
****DCGs @ 8: 0.948376041508
****DCGs @ 16: 0.923314830246
****DCGs @ 32: 0.879306087432
****DCGs @ 64: 0.816422027894
****Error : 0.294924804687
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  2.16640806198
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.021703558444976807, 0.028889930248260483)
('****Total time: ', 0.03212521624565125, 0.045665478706359855)
('****Preprocess time: ', 0.0027211376428604127, 0.0038236618041992167)
('****Data time: ', 0.0004081240892410278, 0.000528144836425781)
('****Fetch time: ', 7.480788230895996e-05, 8.511543273925781e-05)
('****Sort time: ', 0.0006738816499710083, 0.0009331703186035156)
****Stage 0 average time 0.0131940473318
****Stage 1 average time 0.0123874623775
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971405334172
****DCGs @ 8: 0.948390451018
****DCGs @ 16: 0.923298503225
****DCGs @ 32: 0.879226562512
****DCGs @ 64: 0.816237578868
****Error : 0.295013671875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  3.03418111801
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.019128211617469786, 0.024604666233062733)
('****Total time: ', 0.025522324919700624, 0.03215148448944092)
('****Preprocess time: ', 0.0024382253885269164, 0.0032101154327392576)
('****Data time: ', 0.0003647618293762207, 0.00042419433593749974)
('****Fetch time: ', 6.311964988708496e-05, 7.414817810058594e-05)
('****Sort time: ', 0.0006117995977401733, 0.0008070826530456541)
****Stage 0 average time 0.0115346630812
****Stage 1 average time 0.0110714550018
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.970021090143
****DCGs @ 8: 0.949271929203
****DCGs @ 16: 0.923661842631
****DCGs @ 32: 0.879670544888
****DCGs @ 64: 0.816580854388
****Error : 0.295033203125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  3.97078895569
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017688610076904296, 0.022541522979736325)
('****Total time: ', 0.02344432508945465, 0.028908562660217282)
('****Preprocess time: ', 0.002307990550994873, 0.0029219746589660635)
('****Data time: ', 0.00034786689281463625, 0.0003939151763916013)
('****Fetch time: ', 6.442844867706299e-05, 7.009506225585938e-05)
('****Sort time: ', 0.000605754017829895, 0.0007848739624023438)
****Stage 0 average time 0.0107182745934
****Stage 1 average time 0.0102963753939
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.967881778509
****DCGs @ 8: 0.947948108932
****DCGs @ 16: 0.922872970155
****DCGs @ 32: 0.87856311271
****DCGs @ 64: 0.816190761458
****Error : 0.2950703125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.08836984634
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.018124723434448244, 0.023171234130859353)
('****Total time: ', 0.02371240997314453, 0.029358959197998042)
('****Preprocess time: ', 0.002387989640235901, 0.003187084197998046)
('****Data time: ', 0.0003533288240432739, 0.0004051089286804197)
('****Fetch time: ', 5.945694446563721e-05, 7.104873657226562e-05)
('****Sort time: ', 0.0006031849384307861, 0.000753200054168701)
****Stage 0 average time 0.0108662912846
****Stage 1 average time 0.0106623924971
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971702501818
****DCGs @ 8: 0.94867658684
****DCGs @ 16: 0.923658290268
****DCGs @ 32: 0.879535317785
****DCGs @ 64: 0.816486068103
****Error : 0.294961914062
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.10174012184
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.01717168402671814, 0.02152525186538696)
('****Total time: ', 0.022642199397087098, 0.02753940820693969)
('****Preprocess time: ', 0.0022987523078918455, 0.002945923805236816)
('****Data time: ', 0.00034238231182098387, 0.0003859996795654297)
('****Fetch time: ', 5.568385124206543e-05, 6.604194641113281e-05)
('****Sort time: ', 0.0006235785484313965, 0.0007362008094787587)
****Stage 0 average time 0.0103611767292
****Stage 1 average time 0.0101309043169
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.968790072412
****DCGs @ 8: 0.948704391031
****DCGs @ 16: 0.923173961299
****DCGs @ 32: 0.879279271897
****DCGs @ 64: 0.816406707278
****Error : 0.29509765625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.13605117798
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.01690406143665314, 0.0211901307106018)
('****Total time: ', 0.022151832342147827, 0.02688199281692505)
('****Preprocess time: ', 0.002280933976173401, 0.0028907299041748)
('****Data time: ', 0.00033758282661437987, 0.00038123130798339844)
('****Fetch time: ', 5.3792238235473635e-05, 6.389617919921875e-05)
('****Sort time: ', 0.0005943422317504882, 0.0006919503211975094)
****Stage 0 average time 0.010197714448
****Stage 1 average time 0.00997299826145
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.968666921218
****DCGs @ 8: 0.948147034244
****DCGs @ 16: 0.923209294912
****DCGs @ 32: 0.878926585746
****DCGs @ 64: 0.816372164656
****Error : 0.295
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.0631651878
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.016742292404174804, 0.02057517766952514)
('****Total time: ', 0.02192159128189087, 0.026105475425720212)
('****Preprocess time: ', 0.002290721893310547, 0.0029183149337768536)
('****Data time: ', 0.0003346189260482788, 0.00037789344787597656)
('****Fetch time: ', 5.253720283508301e-05, 6.129741668701159e-05)
('****Sort time: ', 0.0005872279405593872, 0.0006549835205078122)
****Stage 0 average time 0.0101747359037
****Stage 1 average time 0.00983266246319
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971824146705
****DCGs @ 8: 0.949043283157
****DCGs @ 16: 0.923489551586
****DCGs @ 32: 0.879295327594
****DCGs @ 64: 0.816456091284
****Error : 0.295034179688
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.1344609261
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.016386237502098083, 0.02005331516265869)
('****Total time: ', 0.021554540038108826, 0.02551063299179076)
('****Preprocess time: ', 0.0022693887948989867, 0.0028341412544250484)
('****Data time: ', 0.0003346629142761231, 0.0003707408905029297)
('****Fetch time: ', 5.158066749572754e-05, 6.008148193359375e-05)
('****Sort time: ', 0.0005895823240280151, 0.0006652832031249995)
****Stage 0 average time 0.0101159961224
****Stage 1 average time 0.00951545608044
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.968037881108
****DCGs @ 8: 0.948439783526
****DCGs @ 16: 0.923179145476
****DCGs @ 32: 0.87935451308
****DCGs @ 64: 0.816528337993
****Error : 0.29502734375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.105340004
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.016092581391334532, 0.01949050426483154)
('****Total time: ', 0.021151111721992494, 0.024866116046905508)
('****Preprocess time: ', 0.002215978741645813, 0.002657210826873779)
('****Data time: ', 0.00032940316200256347, 0.0003631114959716797)
('****Fetch time: ', 5.125033855438232e-05, 5.698204040527344e-05)
('****Sort time: ', 0.0005974361896514893, 0.000675249099731445)
****Stage 0 average time 0.00991678130627
****Stage 1 average time 0.00936986851692
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.969684835071
****DCGs @ 8: 0.948006551188
****DCGs @ 16: 0.923248412359
****DCGs @ 32: 0.878765095507
****DCGs @ 64: 0.816172080525
****Error : 0.295120117187
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.3189809322
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.015565449357032775, 0.0181502103805542)
('****Total time: ', 0.020700405836105346, 0.023659837245941156)
('****Preprocess time: ', 0.002197328448295593, 0.0024329304695129388)
('****Data time: ', 0.0003285410404205322, 0.00036288499832153314)
('****Fetch time: ', 4.858911037445069e-05, 5.507469177246094e-05)
('****Sort time: ', 0.0005942727327346802, 0.0006383419036865229)
****Stage 0 average time 0.00950582790375
****Stage 1 average time 0.00922835278511
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971487891633
****DCGs @ 8: 0.949447079002
****DCGs @ 16: 0.923594273473
****DCGs @ 32: 0.879681658754
****DCGs @ 64: 0.816684270146
****Error : 0.29491796875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.0114569664
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.01590839207172394, 0.018305504322051993)
('****Total time: ', 0.021002012372016907, 0.023592698574066158)
('****Preprocess time: ', 0.002202876329421997, 0.00242624282836914)
('****Data time: ', 0.00033260822296142577, 0.0003590583801269531)
('****Fetch time: ', 4.901039600372315e-05, 5.507469177246094e-05)
('****Sort time: ', 0.0005981777906417847, 0.0006389617919921875)
****Stage 0 average time 0.00991103374958
****Stage 1 average time 0.00918003106117
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.967588993471
****DCGs @ 8: 0.94805312743
****DCGs @ 16: 0.923151472946
****DCGs @ 32: 0.878811860015
****DCGs @ 64: 0.816269358687
****Error : 0.295130859375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.2484378815
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.01566400730609894, 0.017875921726226807)
('****Total time: ', 0.020688751697540284, 0.02313004732131958)
('****Preprocess time: ', 0.002180363416671753, 0.002393007278442383)
('****Data time: ', 0.00032377016544342044, 0.0003512263298034666)
('****Fetch time: ', 4.739236831665039e-05, 5.1021575927734375e-05)
('****Sort time: ', 0.000597331166267395, 0.0006501674652099609)
****Stage 0 average time 0.00968810498714
****Stage 1 average time 0.00912475943565
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.970903827865
****DCGs @ 8: 0.948376041508
****DCGs @ 16: 0.923314830246
****DCGs @ 32: 0.879306087432
****DCGs @ 64: 0.816422027894
****Error : 0.294924804687
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
****Total experiment time (s):  9.85616612434
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011169702053070068, 0.012568044662475585)
('****Total time: ', 4.157254058480262, 7.889804327487943)
('****Preprocess time: ', 0.0020520042181015013, 0.0021520137786865236)
('****Data time: ', 0.0002558755874633789, 0.00028706789016723626)
('****Fetch time: ', 6.650876998901368e-05, 7.323026657104473e-05)
('****Sort time: ', 0.000573512077331543, 0.0006110668182373047)
****Stage 0 average time 0.00503740000725
****Stage 1 average time 0.00908020269871
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971405334172
****DCGs @ 8: 0.948390451018
****DCGs @ 16: 0.923298503225
****DCGs @ 32: 0.879226562512
****DCGs @ 64: 0.816237578868
****Error : 0.295013671875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.82128500938
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.011069053173065186, 0.012500476837158195)
('****Total time: ', 3.601613896608353, 6.872840201854705)
('****Preprocess time: ', 0.002046260952949524, 0.0021488785743713377)
('****Data time: ', 0.00025615692138671877, 0.00028204917907714844)
('****Fetch time: ', 6.599247455596924e-05, 7.200241088867188e-05)
('****Sort time: ', 0.0005739589929580688, 0.00061420202255249)
****Stage 0 average time 0.00502343297005
****Stage 1 average time 0.00898798954487
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.970021090143
****DCGs @ 8: 0.949271929203
****DCGs @ 16: 0.923661842631
****DCGs @ 32: 0.879670544888
****DCGs @ 64: 0.816580854388
****Error : 0.295033203125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.78523898125
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011160417318344116, 0.012751615047454829)
('****Total time: ', 3.0734546751976013, 5.852864313125609)
('****Preprocess time: ', 0.0020483028888702392, 0.002199888229370117)
('****Data time: ', 0.00025570690631866456, 0.00028277635574340814)
('****Fetch time: ', 6.577026844024658e-05, 7.368326187133783e-05)
('****Sort time: ', 0.0005649737119674682, 0.0006058335304260253)
****Stage 0 average time 0.00500414466858
****Stage 1 average time 0.00909102642536
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.967881778509
****DCGs @ 8: 0.947948108932
****DCGs @ 16: 0.922872970155
****DCGs @ 32: 0.87856311271
****DCGs @ 64: 0.816190761458
****Error : 0.2950703125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.79204678535
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.011130882263183593, 0.01293193101882934)
('****Total time: ', 2.5558897577524187, 4.8774120688438405)
('****Preprocess time: ', 0.0020232791900634765, 0.002135074138641357)
('****Data time: ', 0.0002544817924499512, 0.0002808570861816406)
('****Fetch time: ', 6.570303440093995e-05, 7.390975952148438e-05)
('****Sort time: ', 0.0005641878843307495, 0.0006020069122314453)
****Stage 0 average time 0.00499571621418
****Stage 1 average time 0.00904281795025
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971702501818
****DCGs @ 8: 0.94867658684
****DCGs @ 16: 0.923658290268
****DCGs @ 32: 0.879535317785
****DCGs @ 64: 0.816486068103
****Error : 0.294961914062
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.76939702034
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.011097757935523986, 0.012632083892822254)
('****Total time: ', 1.5460816951990128, 2.9275116682052613)
('****Preprocess time: ', 0.0020453410148620604, 0.0021360516548156734)
('****Data time: ', 0.0002545706033706665, 0.0002849102020263672)
('****Fetch time: ', 6.5604567527771e-05, 7.319450378417969e-05)
('****Sort time: ', 0.0005653450489044189, 0.0006120204925537109)
****Stage 0 average time 0.00499707472324
****Stage 1 average time 0.00903154444695
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.968790072412
****DCGs @ 8: 0.948704391031
****DCGs @ 16: 0.923173961299
****DCGs @ 32: 0.879279271897
****DCGs @ 64: 0.816406707278
****Error : 0.29509765625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.62585306168
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.011080211758613586, 0.012473094463348383)
('****Total time: ', 0.41844181525707247, 0.8229942083358754)
('****Preprocess time: ', 0.0020280174016952513, 0.0024180889129638665)
('****Data time: ', 0.0002553151845932007, 0.00028778314590454095)
('****Fetch time: ', 6.47904872894287e-05, 7.390975952148438e-05)
('****Sort time: ', 0.000544844388961792, 0.0005800724029541016)
****Stage 0 average time 0.00491150152683
****Stage 1 average time 0.00906167769432
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.968666921218
****DCGs @ 8: 0.948147034244
****DCGs @ 16: 0.923209294912
****DCGs @ 32: 0.878926585746
****DCGs @ 64: 0.816372164656
****Error : 0.295
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.9336719513
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011220813035964965, 0.012504470348358152)
('****Total time: ', 0.020138786792755128, 0.03124278783798214)
('****Preprocess time: ', 0.002042588233947754, 0.0021638870239257812)
('****Data time: ', 0.0002640693187713623, 0.0002901792526245116)
('****Fetch time: ', 6.75874948501587e-05, 7.390975952148438e-05)
('****Sort time: ', 0.0005607727766036987, 0.0006170272827148438)
****Stage 0 average time 0.00511462533474
****Stage 1 average time 0.0090412055254
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971824146705
****DCGs @ 8: 0.949043283157
****DCGs @ 16: 0.923489551586
****DCGs @ 32: 0.879295327594
****DCGs @ 64: 0.816456091284
****Error : 0.295034179688
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.993751049
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.011076321482658386, 0.01342616081237793)
('****Total time: ', 0.01624353003501892, 0.02001270055770873)
('****Preprocess time: ', 0.001971228837966919, 0.0020909428596496585)
('****Data time: ', 0.00025283420085906984, 0.0002810955047607422)
('****Fetch time: ', 6.403100490570068e-05, 6.986856460571283e-05)
('****Sort time: ', 0.0005481828451156616, 0.0006070613861083982)
****Stage 0 average time 0.00489321136475
****Stage 1 average time 0.00901938700676
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.968037881108
****DCGs @ 8: 0.948439783526
****DCGs @ 16: 0.923179145476
****DCGs @ 32: 0.87935451308
****DCGs @ 64: 0.816528337993
****Error : 0.29502734375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.9327800274
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.010998992919921876, 0.013237142562866205)
('****Total time: ', 0.015676923990249635, 0.018306267261505128)
('****Preprocess time: ', 0.0019478062391281128, 0.0021409988403320312)
('****Data time: ', 0.00025327706336975096, 0.0002789497375488281)
('****Fetch time: ', 6.455135345458984e-05, 7.009506225585938e-05)
('****Sort time: ', 0.0005538731813430787, 0.0006021022796630854)
****Stage 0 average time 0.00489745259285
****Stage 1 average time 0.00892104816437
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.969684835071
****DCGs @ 8: 0.948006551188
****DCGs @ 16: 0.923248412359
****DCGs @ 32: 0.878765095507
****DCGs @ 64: 0.816172080525
****Error : 0.295120117187
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.1157050133
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.011153426885604858, 0.012903940677642823)
('****Total time: ', 0.015684219479560852, 0.017776262760162354)
('****Preprocess time: ', 0.001982408881187439, 0.0021882414817810058)
('****Data time: ', 0.00026519763469696046, 0.0002939820289611816)
('****Fetch time: ', 6.538712978363036e-05, 7.106065750122064e-05)
('****Sort time: ', 0.0005488407611846924, 0.0006029725074768066)
****Stage 0 average time 0.00500333464146
****Stage 1 average time 0.009011926651
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.971487891633
****DCGs @ 8: 0.949447079002
****DCGs @ 16: 0.923594273473
****DCGs @ 32: 0.879681658754
****DCGs @ 64: 0.816684270146
****Error : 0.29491796875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  24.8595609665
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.01108072829246521, 0.012577962875366194)
('****Total time: ', 0.015616690635681153, 0.017407846450805658)
('****Preprocess time: ', 0.0019641153812408447, 0.0021560668945312497)
('****Data time: ', 0.00026659488677978517, 0.00029778480529785156)
('****Fetch time: ', 6.510686874389648e-05, 7.009506225585938e-05)
('****Sort time: ', 0.0005526264905929565, 0.0006029605865478516)
****Stage 0 average time 0.00498546254635
****Stage 1 average time 0.00894370937347
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.967588993471
****DCGs @ 8: 0.94805312743
****DCGs @ 16: 0.923151472946
****DCGs @ 32: 0.878811860015
****DCGs @ 64: 0.816269358687
****Error : 0.295130859375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.1285359859
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.011169028997421265, 0.01238176822662353)
('****Total time: ', 0.01577896726131439, 0.017189621925353993)
('****Preprocess time: ', 0.0019899582862854003, 0.0021560430526733386)
('****Data time: ', 0.00027587294578552247, 0.0002999305725097656)
('****Fetch time: ', 6.529724597930909e-05, 6.985664367675781e-05)
('****Sort time: ', 0.0005499688386917114, 0.0006070137023925781)
****Stage 0 average time 0.00499816930294
****Stage 1 average time 0.00905195701122
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1024, 512])
****DCGs @ 4: 0.970903827865
****DCGs @ 8: 0.948376041508
****DCGs @ 16: 0.923314830246
****DCGs @ 32: 0.879306087432
****DCGs @ 64: 0.816422027894
****Error : 0.294924804687
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  7.51361894608
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017566423654556275, 0.025849246978759767)
('****Total time: ', 2.7995953481197358, 5.018727231025694)
('****Preprocess time: ', 0.00283132004737854, 0.003993225097656249)
('****Data time: ', 0.0003933291435241699, 0.0004639625549316406)
('****Fetch time: ', 7.604968547821045e-05, 8.825063705444316e-05)
('****Sort time: ', 0.00040381503105163573, 0.0005162000656127915)
****Stage 0 average time 0.0176117353439
****Stage 1 average time 0.00365920221806
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.58544397354
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.015949623107910156, 0.020973324775695776)
('****Total time: ', 2.272184211611748, 4.167766213417052)
('****Preprocess time: ', 0.0025736751556396484, 0.0035722613334655757)
('****Data time: ', 0.0003456166982650757, 0.0004019856452941894)
('****Fetch time: ', 7.202625274658204e-05, 8.0108642578125e-05)
('****Sort time: ', 0.0004183584451675415, 0.0005341529846191401)
****Stage 0 average time 0.0156446828842
****Stage 1 average time 0.00371461677551
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.4896068573
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.0160276038646698, 0.020986115932464588)
('****Total time: ', 1.6867613589763641, 3.1058711171150204)
('****Preprocess time: ', 0.002538434982299805, 0.0034700393676757807)
('****Data time: ', 0.0003416848182678223, 0.00039197206497192376)
('****Fetch time: ', 6.935548782348633e-05, 7.797479629516595e-05)
('****Sort time: ', 0.00042197048664093016, 0.0005390644073486328)
****Stage 0 average time 0.0157200278044
****Stage 1 average time 0.00367902183533
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.51784801483
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.015385363698005677, 0.018857872486114476)
('****Total time: ', 1.2034993500709534, 2.2008687376976015)
('****Preprocess time: ', 0.0024542604684829714, 0.0032185196876525863)
('****Data time: ', 0.0003314117193222046, 0.00037384033203125)
('****Fetch time: ', 6.903886795043945e-05, 7.605552673339844e-05)
('****Sort time: ', 0.00042499518394470214, 0.0005171656608581541)
****Stage 0 average time 0.0149705734253
****Stage 1 average time 0.00369449651241
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.45397806168
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.015097898364067077, 0.018337380886077878)
('****Total time: ', 0.10241114854812622, 0.16299959421157836)
('****Preprocess time: ', 0.0024348241090774536, 0.003012371063232421)
('****Data time: ', 0.00032771742343902586, 0.00036598443984985345)
('****Fetch time: ', 6.685113906860352e-05, 7.295608520507812e-05)
('****Sort time: ', 0.00044875180721282957, 0.0004978299140930175)
****Stage 0 average time 0.0146997693777
****Stage 1 average time 0.00367627346516
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.47694301605
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.015042689919471742, 0.017882204055786128)
('****Total time: ', 0.02708344542980194, 0.06488786935806264)
('****Preprocess time: ', 0.00244278621673584, 0.002669155597686767)
('****Data time: ', 0.0003288301229476929, 0.0003731369972229003)
('****Fetch time: ', 6.706619262695312e-05, 7.700920104980469e-05)
('****Sort time: ', 0.0004420193433761597, 0.0005142688751220703)
****Stage 0 average time 0.0143483378887
****Stage 1 average time 0.00397505390644
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.2651910782
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01502726447582245, 0.018598580360412596)
('****Total time: ', 0.02096948277950287, 0.026271355152130128)
('****Preprocess time: ', 0.0024325764179229737, 0.003098011016845703)
('****Data time: ', 0.0003304898738861084, 0.00037097930908203125)
('****Fetch time: ', 6.608903408050537e-05, 7.869005203247064e-05)
('****Sort time: ', 0.00040678679943084717, 0.00047497749328613255)
****Stage 0 average time 0.0144809465408
****Stage 1 average time 0.00378226006031
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.4103250504
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.014954720258712768, 0.01850606203079223)
('****Total time: ', 0.02054572308063507, 0.024844384193420405)
('****Preprocess time: ', 0.0024170159101486208, 0.002737021446228026)
('****Data time: ', 0.0003298392295837402, 0.0003790855407714844)
('****Fetch time: ', 6.571328639984131e-05, 7.605552673339844e-05)
('****Sort time: ', 0.00041750776767730715, 0.00047707557678222656)
****Stage 0 average time 0.0144251226187
****Stage 1 average time 0.00375967383385
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.4284827709
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.014940484523773194, 0.018381226062774658)
('****Total time: ', 0.020316773295402525, 0.024351763725280758)
('****Preprocess time: ', 0.002394317865371704, 0.0026221275329589844)
('****Data time: ', 0.00033173930644989015, 0.00037479400634765625)
('****Fetch time: ', 6.606686115264892e-05, 7.414817810058594e-05)
('****Sort time: ', 0.00043517625331878664, 0.0004909038543701172)
****Stage 0 average time 0.0144027804136
****Stage 1 average time 0.00376500439644
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.5933070183
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.014873693466186524, 0.018529319763183595)
('****Total time: ', 0.0199265398979187, 0.023788130283355715)
('****Preprocess time: ', 0.002376295566558838, 0.002585172653198242)
('****Data time: ', 0.0003328744173049927, 0.0003781318664550781)
('****Fetch time: ', 6.461429595947266e-05, 7.390975952148438e-05)
('****Sort time: ', 0.00041385293006896974, 0.0004820823669433594)
****Stage 0 average time 0.0143156360388
****Stage 1 average time 0.0037456946373
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.3171601295
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.014608581066131592, 0.01781493425369262)
('****Total time: ', 0.01962423574924469, 0.023182117938995363)
('****Preprocess time: ', 0.002365745306015015, 0.0025180816650390617)
('****Data time: ', 0.0003284047842025757, 0.0003621935844421385)
('****Fetch time: ', 6.42913579940796e-05, 7.081031799316406e-05)
('****Sort time: ', 0.00042152535915374755, 0.00046924352645874004)
****Stage 0 average time 0.01404670012
****Stage 1 average time 0.00374184775352
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  31.4102730751
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.014460939526557923, 0.01738891601562499)
('****Total time: ', 0.01941110336780548, 0.02278687953948974)
('****Preprocess time: ', 0.0023529075384140013, 0.002552080154418945)
('****Data time: ', 0.0003279591798782349, 0.00036716461181640625)
('****Fetch time: ', 6.533384323120117e-05, 7.081031799316406e-05)
('****Sort time: ', 0.0004306371212005615, 0.0004690170288085935)
****Stage 0 average time 0.0139103010893
****Stage 1 average time 0.00372747612
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  2.29913306236
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01767912769317627, 0.02441207170486448)
('****Total time: ', 0.025894830703735352, 0.03511430025100708)
('****Preprocess time: ', 0.002728228569030762, 0.004023098945617675)
('****Data time: ', 0.0004022555351257324, 0.0004950046539306638)
('****Fetch time: ', 5.719685554504395e-05, 6.890296936035156e-05)
('****Sort time: ', 0.0004487605094909668, 0.0005953669548034666)
****Stage 0 average time 0.0160502860546
****Stage 1 average time 0.00526528310776
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  3.20553588867
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.016616954803466796, 0.02145771980285644)
('****Total time: ', 0.022575291752815245, 0.028464877605438227)
('****Preprocess time: ', 0.002604142189025879, 0.003635227680206297)
('****Data time: ', 0.0003803801536560059, 0.00044398307800292943)
('****Fetch time: ', 5.350351333618164e-05, 6.4849853515625e-05)
('****Sort time: ', 0.00043617773056030273, 0.0005421638488769531)
****Stage 0 average time 0.0153722678423
****Stage 1 average time 0.00471889054775
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.2742369175
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.016280156373977662, 0.02060701847076414)
('****Total time: ', 0.022069849252700807, 0.027575504779815664)
('****Preprocess time: ', 0.002526310324668884, 0.0032514810562133765)
('****Data time: ', 0.0003689429759979248, 0.0004229545593261719)
('****Fetch time: ', 5.2448391914367675e-05, 6.103515625e-05)
('****Sort time: ', 0.0004625471830368042, 0.0005360603332519526)
****Stage 0 average time 0.0150483270884
****Stage 1 average time 0.00464207816124
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.40874505043
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.01600482988357544, 0.020141088962554912)
('****Total time: ', 0.021578329563140868, 0.02633218765258789)
('****Preprocess time: ', 0.0025098559856414795, 0.003187906742095947)
('****Data time: ', 0.0003648461103439331, 0.0004119873046875)
('****Fetch time: ', 4.906952381134033e-05, 5.793571472167969e-05)
('****Sort time: ', 0.000443088173866272, 0.0005240917205810544)
****Stage 0 average time 0.0149348796606
****Stage 1 average time 0.00443681001663
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.36654400826
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.015285871982574462, 0.018318045139312743)
('****Total time: ', 0.020690738797187806, 0.024134373664855956)
('****Preprocess time: ', 0.0024741488695144654, 0.0028334259986877424)
('****Data time: ', 0.0003616180419921875, 0.0004038810729980469)
('****Fetch time: ', 4.628264904022217e-05, 5.507469177246094e-05)
('****Sort time: ', 0.0004378595352172852, 0.0004978179931640625)
****Stage 0 average time 0.0143215852976
****Stage 1 average time 0.00428419578075
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.43703389168
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.015890066504478453, 0.020227897167205803)
('****Total time: ', 0.021399474382400512, 0.026159060001373278)
('****Preprocess time: ', 0.00254522168636322, 0.003431427478790281)
('****Data time: ', 0.0003651409149169922, 0.0004169940948486328)
('****Fetch time: ', 4.798817634582519e-05, 5.793571472167969e-05)
('****Sort time: ', 0.00043784403800964356, 0.0004868507385253906)
****Stage 0 average time 0.014735016346
****Stage 1 average time 0.00455124497414
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.4405992031
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01517573344707489, 0.018924605846405027)
('****Total time: ', 0.02049559259414673, 0.024654150009155273)
('****Preprocess time: ', 0.0024491597414016725, 0.0026632428169250486)
('****Data time: ', 0.00035865747928619387, 0.0003991127014160156)
('****Fetch time: ', 4.463613033294678e-05, 5.316734313964844e-05)
('****Sort time: ', 0.0004363136291503906, 0.0004887580871582031)
****Stage 0 average time 0.0142143585682
****Stage 1 average time 0.00425014185905
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.3420040607
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.014984766721725464, 0.01819374561309814)
('****Total time: ', 0.020227209091186523, 0.02374415397644043)
('****Preprocess time: ', 0.002429834008216858, 0.0026417374610900875)
('****Data time: ', 0.0003547542095184326, 0.0003991127014160156)
('****Fetch time: ', 4.351019859313965e-05, 5.1975250244140625e-05)
('****Sort time: ', 0.00043226802349090576, 0.0004820942878723144)
****Stage 0 average time 0.0141003655195
****Stage 1 average time 0.00414476764202
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.4630889893
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.014749828696250916, 0.01762425899505615)
('****Total time: ', 0.02003100287914276, 0.023128890991210915)
('****Preprocess time: ', 0.0024156614542007447, 0.0025732159614562976)
('****Data time: ', 0.0003570624589920044, 0.0003948211669921875)
('****Fetch time: ', 4.351449012756348e-05, 5.1975250244140625e-05)
('****Sort time: ', 0.0004260287284851074, 0.00047135353088378906)
****Stage 0 average time 0.0139275392294
****Stage 1 average time 0.00406455659866
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.5391738415
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.014442450046539306, 0.017063045501708982)
('****Total time: ', 0.01962112247943878, 0.022487604618072508)
('****Preprocess time: ', 0.002419006824493408, 0.002589046955108642)
('****Data time: ', 0.0003510998487472534, 0.00039292573928833)
('****Fetch time: ', 4.166626930236816e-05, 4.8160552978515625e-05)
('****Sort time: ', 0.0004314818382263184, 0.00047588348388671875)
****Stage 0 average time 0.0136646863222
****Stage 1 average time 0.0040210185051
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.299932003
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.01435894787311554, 0.017135000228881828)
('****Total time: ', 0.01959833800792694, 0.02274450063705444)
('****Preprocess time: ', 0.0024273242950439452, 0.002583348751068115)
('****Data time: ', 0.0003508009910583496, 0.00039505958557128906)
('****Fetch time: ', 4.104351997375488e-05, 4.76837158203125e-05)
('****Sort time: ', 0.00043221640586853027, 0.00047516822814941406)
****Stage 0 average time 0.0135724540949
****Stage 1 average time 0.00403787899017
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.5355129242
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.014159162044525147, 0.016594874858856197)
('****Total time: ', 0.019426424741744996, 0.02243256568908691)
('****Preprocess time: ', 0.002420450687408447, 0.002660930156707763)
('****Data time: ', 0.00035658693313598633, 0.0004019737243652344)
('****Fetch time: ', 4.135203361511231e-05, 4.864931106567376e-05)
('****Sort time: ', 0.0004472557306289673, 0.0004921555519104001)
****Stage 0 average time 0.013341293931
****Stage 1 average time 0.00408351349831
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  11.5854980946
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.0070307586193084715, 0.0075354814529418924)
('****Total time: ', 4.90602069568634, 9.294819092750547)
('****Preprocess time: ', 0.002140441417694092, 0.002241849899291992)
('****Data time: ', 0.0002425137758255005, 0.00026106834411621094)
('****Fetch time: ', 5.9856891632080076e-05, 6.794929504394531e-05)
('****Sort time: ', 0.00040915894508361815, 0.000431060791015625)
****Stage 0 average time 0.00584892368317
****Stage 1 average time 0.00403380596638
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.6340949535
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.0070587538480758666, 0.007623302936553953)
('****Total time: ', 4.430781369924545, 8.378782081604003)
('****Preprocess time: ', 0.0021569061279296873, 0.002324926853179931)
('****Data time: ', 0.0002492203712463379, 0.0002651214599609375)
('****Fetch time: ', 5.985629558563232e-05, 6.413459777832031e-05)
('****Sort time: ', 0.0004071096181869507, 0.00042891502380371094)
****Stage 0 average time 0.00588802587986
****Stage 1 average time 0.00404382038116
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.5619590282
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.006989886164665222, 0.0074721813201904285)
('****Total time: ', 3.8623065124750138, 7.313826155662536)
('****Preprocess time: ', 0.0021450390815734863, 0.002229022979736328)
('****Data time: ', 0.0002398451566696167, 0.0002570152282714844)
('****Fetch time: ', 6.056690216064453e-05, 6.867647171020501e-05)
('****Sort time: ', 0.00040213370323181154, 0.00042773485183715814)
****Stage 0 average time 0.00584411859512
****Stage 1 average time 0.00399335241318
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.6530311108
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.007120198726654052, 0.00757908821105957)
('****Total time: ', 3.3115906020402908, 6.335616731643675)
('****Preprocess time: ', 0.0021333123445510865, 0.0021930217742919915)
('****Data time: ', 0.00024552309513092043, 0.0002591967582702635)
('****Fetch time: ', 6.097137928009033e-05, 6.699562072753906e-05)
('****Sort time: ', 0.0004055957794189453, 0.00042819976806640625)
****Stage 0 average time 0.00589201414585
****Stage 1 average time 0.00407358717918
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.6881549358
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.007148535132408142, 0.007570028305053711)
('****Total time: ', 2.3752403440475462, 4.495913565158843)
('****Preprocess time: ', 0.002113400101661682, 0.0021851420402526855)
('****Data time: ', 0.0002453153133392334, 0.0002639293670654297)
('****Fetch time: ', 6.158590316772461e-05, 7.009506225585938e-05)
('****Sort time: ', 0.0004048006534576416, 0.0004282236099243163)
****Stage 0 average time 0.00588470196724
****Stage 1 average time 0.0040889351368
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.539465189
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.007039935827255249, 0.007475864887237549)
('****Total time: ', 1.2260570924282075, 2.397555863857269)
('****Preprocess time: ', 0.002135133624076843, 0.0021939754486083986)
('****Data time: ', 0.00024086034297943115, 0.0002570152282714844)
('****Fetch time: ', 6.029379367828369e-05, 6.794929504394531e-05)
('****Sort time: ', 0.00040297091007232663, 0.00042819976806640625)
****Stage 0 average time 0.00583371019363
****Stage 1 average time 0.00404548430443
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.545238018
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007017119526863098, 0.007428812980651855)
('****Total time: ', 0.2980411075353622, 0.5612370014190673)
('****Preprocess time: ', 0.0021358810663223266, 0.0021910667419433594)
('****Data time: ', 0.000241338849067688, 0.00025582313537597656)
('****Fetch time: ', 6.0162782669067385e-05, 6.822347640991191e-05)
('****Sort time: ', 0.0004014768600463867, 0.0004267692565917969)
****Stage 0 average time 0.00582240819931
****Stage 1 average time 0.00403357088566
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.3458938599
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.007125113844871521, 0.007533133029937743)
('****Total time: ', 0.013631883621215821, 0.019549322128295882)
('****Preprocess time: ', 0.0021130586862564086, 0.0021822810173034667)
('****Data time: ', 0.0002434217929840088, 0.0002620339393615722)
('****Fetch time: ', 6.064879894256592e-05, 6.508827209472656e-05)
('****Sort time: ', 0.00040358507633209226, 0.0004329681396484375)
****Stage 0 average time 0.00585973000526
****Stage 1 average time 0.00408609819412
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.2938270569
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.006989584803581238, 0.007443058490753173)
('****Total time: ', 0.011797340750694276, 0.014344179630279539)
('****Preprocess time: ', 0.002089005470275879, 0.0022668838500976562)
('****Data time: ', 0.00024292898178100586, 0.0002582073211669922)
('****Fetch time: ', 5.9942960739135745e-05, 6.414651870727533e-05)
('****Sort time: ', 0.0003983283042907715, 0.0004222393035888672)
****Stage 0 average time 0.00577718734741
****Stage 1 average time 0.00400260317326
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.4249880314
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.0069833225011825565, 0.007500946521759032)
('****Total time: ', 0.011506301045417786, 0.012456905841827392)
('****Preprocess time: ', 0.002049477696418762, 0.0022237896919250484)
('****Data time: ', 0.00024392473697662354, 0.00026679039001464844)
('****Fetch time: ', 5.920791625976563e-05, 6.413459777832031e-05)
('****Sort time: ', 0.00039984822273254395, 0.0004630088806152344)
****Stage 0 average time 0.00571994817257
****Stage 1 average time 0.004015832901
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.0262188911
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.00701377272605896, 0.007575047016143798)
('****Total time: ', 0.011329758286476135, 0.012195658683776853)
('****Preprocess time: ', 0.002052743077278137, 0.002136027812957763)
('****Data time: ', 0.00024409425258636476, 0.00026297569274902344)
('****Fetch time: ', 5.91810941696167e-05, 6.413459777832031e-05)
('****Sort time: ', 0.0003983466625213623, 0.00043010711669921875)
****Stage 0 average time 0.00576360416412
****Stage 1 average time 0.00400453364849
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.2564809322
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.00713089370727539, 0.007598876953125)
('****Total time: ', 0.011325104713439942, 0.011972904205322266)
('****Preprocess time: ', 0.002047197341918945, 0.0021278858184814453)
('****Data time: ', 0.0002494606971740723, 0.00026702880859375)
('****Fetch time: ', 6.119132041931152e-05, 6.508827209472656e-05)
('****Sort time: ', 0.0004235279560089111, 0.0005190372467041016)
****Stage 0 average time 0.00578489375114
****Stage 1 average time 0.00412737727165
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 128])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965619616348
****DCGs @ 16: 0.941265410054
****DCGs @ 32: 0.911003618065
****DCGs @ 64: 0.858850007335
****Error : 0.259625
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  8.6376721859
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017274184465408324, 0.025004386901855465)
('****Total time: ', 3.2971993411779406, 6.01288878917694)
('****Preprocess time: ', 0.0031543704271316526, 0.004389452934265134)
('****Data time: ', 0.00039381897449493406, 0.00047497749328613255)
('****Fetch time: ', 7.896959781646729e-05, 9.371042251586908e-05)
('****Sort time: ', 0.0006077896356582642, 0.0007618069648742673)
****Stage 0 average time 0.0171685246229
****Stage 1 average time 0.00434060847759
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.45210790634
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.01626597487926483, 0.021959412097930862)
('****Total time: ', 2.729342278838158, 5.002579915523529)
('****Preprocess time: ', 0.002928597927093506, 0.0039250850677490234)
('****Data time: ', 0.00034510648250579836, 0.0003917336463928222)
('****Fetch time: ', 7.202696800231934e-05, 8.0108642578125e-05)
('****Sort time: ', 0.0005883022546768189, 0.000711238384246826)
****Stage 0 average time 0.0159351104498
****Stage 1 average time 0.00426489806175
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.41672110558
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.015743663787841797, 0.02012085914611815)
('****Total time: ', 2.1856923183202746, 4.010450744628906)
('****Preprocess time: ', 0.0028727768659591673, 0.003782093524932861)
('****Data time: ', 0.0003376178741455078, 0.0003859996795654297)
('****Fetch time: ', 7.073867321014404e-05, 7.891654968261719e-05)
('****Sort time: ', 0.000603476881980896, 0.0007291316986083982)
****Stage 0 average time 0.0153724216223
****Stage 1 average time 0.00425585246086
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.43532299995
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.015975937843322754, 0.021270108222961413)
('****Total time: ', 1.576527388572693, 2.9722895264625544)
('****Preprocess time: ', 0.0028541922569274903, 0.0036883234977722144)
('****Data time: ', 0.00033453786373138425, 0.0003719329833984375)
('****Fetch time: ', 6.960678100585937e-05, 7.822513580322253e-05)
('****Sort time: ', 0.0005970872640609741, 0.0007021427154541016)
****Stage 0 average time 0.0155829895735
****Stage 1 average time 0.00424837243557
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.62871813774
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.01631848680973053, 0.022005140781402577)
('****Total time: ', 0.7296712028980256, 1.2805017471313476)
('****Preprocess time: ', 0.002867705583572388, 0.0037831783294677724)
('****Data time: ', 0.0003332202434539795, 0.000370025634765625)
('****Fetch time: ', 6.986784934997559e-05, 7.891654968261719e-05)
('****Sort time: ', 0.0005989933013916016, 0.0006740570068359372)
****Stage 0 average time 0.0158470702171
****Stage 1 average time 0.00434120357037
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.50846099854
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.01565442085266113, 0.020246005058288562)
('****Total time: ', 0.026223477482795715, 0.037468659877777075)
('****Preprocess time: ', 0.002754838466644287, 0.002973067760467527)
('****Data time: ', 0.0003317705392837524, 0.00036979913711547845)
('****Fetch time: ', 6.801319122314452e-05, 7.796287536621094e-05)
('****Sort time: ', 0.0005947303771972656, 0.0006611347198486328)
****Stage 0 average time 0.0151368598938
****Stage 1 average time 0.00426691353321
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.4053590298
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.015493086814880371, 0.01988462209701538)
('****Total time: ', 0.02389374041557312, 0.030080080032348605)
('****Preprocess time: ', 0.002758295297622681, 0.003110897541046132)
('****Data time: ', 0.000329306960105896, 0.0003688335418701172)
('****Fetch time: ', 6.747376918792724e-05, 7.605552673339844e-05)
('****Sort time: ', 0.0005898112058639526, 0.0006539821624755859)
****Stage 0 average time 0.0150007778406
****Stage 1 average time 0.00423719620705
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.4208090305
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.015347099184989929, 0.019428265094757077)
('****Total time: ', 0.02207923889160156, 0.027340030670166014)
('****Preprocess time: ', 0.0028142610788345337, 0.003168928623199462)
('****Data time: ', 0.00033271324634552004, 0.0003867268562316894)
('****Fetch time: ', 7.048285007476807e-05, 8.20159912109375e-05)
('****Sort time: ', 0.0005914007425308228, 0.0006530404090881347)
****Stage 0 average time 0.0145669378042
****Stage 1 average time 0.00458901929855
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.514179945
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.014786293625831604, 0.01822320222854614)
('****Total time: ', 0.020615737438201904, 0.02441674470901489)
('****Preprocess time: ', 0.0026965967416763305, 0.0028561115264892573)
('****Data time: ', 0.0003253185749053955, 0.0003609657287597656)
('****Fetch time: ', 6.697475910186768e-05, 7.295608520507812e-05)
('****Sort time: ', 0.0005815174579620362, 0.000640869140625)
****Stage 0 average time 0.0142601619959
****Stage 1 average time 0.00419653916359
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.5888478756
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.014460347890853882, 0.01769009828567505)
('****Total time: ', 0.019972772240638734, 0.023481643199920646)
('****Preprocess time: ', 0.0026671231985092164, 0.002831757068634033)
('****Data time: ', 0.0003323558568954468, 0.00037480592727661126)
('****Fetch time: ', 6.655728816986084e-05, 7.009506225585938e-05)
('****Sort time: ', 0.0005735807418823242, 0.0006270408630371094)
****Stage 0 average time 0.0139474705458
****Stage 1 average time 0.00415249443054
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.3609509468
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.014284820318222046, 0.017738521099090573)
('****Total time: ', 0.0197476726770401, 0.023529171943664544)
('****Preprocess time: ', 0.0026502494812011717, 0.0028150081634521484)
('****Data time: ', 0.0003306455612182617, 0.00037384033203125)
('****Fetch time: ', 6.571531295776367e-05, 6.818771362304688e-05)
('****Sort time: ', 0.0005659205913543701, 0.0006210803985595703)
****Stage 0 average time 0.0137594373226
****Stage 1 average time 0.00413791394234
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  31.5472130775
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.014077759623527527, 0.01746029853820801)
('****Total time: ', 0.019480824947357176, 0.023334014415740956)
('****Preprocess time: ', 0.0026351239681243897, 0.002814829349517822)
('****Data time: ', 0.0003275055885314941, 0.0003769397735595703)
('****Fetch time: ', 6.395232677459717e-05, 6.818771362304688e-05)
('****Sort time: ', 0.0005782337188720703, 0.0006198883056640625)
****Stage 0 average time 0.0135170520544
****Stage 1 average time 0.00416552317142
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  2.4195291996
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.026551636934280396, 0.03602143526077269)
('****Total time: ', 0.05212100434303284, 0.07753387689590453)
('****Preprocess time: ', 0.0036471837759017942, 0.005249345302581787)
('****Data time: ', 0.00047844719886779783, 0.0006067752838134766)
('****Fetch time: ', 7.816624641418457e-05, 9.083747863769531e-05)
('****Sort time: ', 0.0007203774452209473, 0.0010030269622802734)
****Stage 0 average time 0.0177029439211
****Stage 1 average time 0.0137728676796
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  3.32700395584
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.023135014533996582, 0.029596173763275137)
('****Total time: ', 0.03044521415233612, 0.038533020019531246)
('****Preprocess time: ', 0.0033767236471176146, 0.004667210578918455)
('****Data time: ', 0.0004425933361053467, 0.0005159378051757812)
('****Fetch time: ', 6.838834285736084e-05, 7.678270339965814e-05)
('****Sort time: ', 0.000675422191619873, 0.0009000778198242185)
****Stage 0 average time 0.0163442355394
****Stage 1 average time 0.0113539065123
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.23419380188
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.02133942985534668, 0.026284182071685792)
('****Total time: ', 0.028005599737167357, 0.033937478065490724)
('****Preprocess time: ', 0.0031190260648727417, 0.003937411308288572)
('****Data time: ', 0.0004178386926651001, 0.0004699349403381347)
('****Fetch time: ', 6.12725019454956e-05, 7.132291793823223e-05)
('****Sort time: ', 0.0006623227596282959, 0.0008271098136901854)
****Stage 0 average time 0.0152529312372
****Stage 1 average time 0.0103469586372
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.34864497185
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.021253015875816347, 0.02664914131164551)
('****Total time: ', 0.027979791045188905, 0.03413881063461303)
('****Preprocess time: ', 0.00312386155128479, 0.00400680303573608)
('****Data time: ', 0.00040563082695007323, 0.000467097759246826)
('****Fetch time: ', 5.9925436973571774e-05, 6.986856460571283e-05)
('****Sort time: ', 0.0006565614938735962, 0.0008030891418457026)
****Stage 0 average time 0.0150915956497
****Stage 1 average time 0.0104073995352
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.4693031311
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.020523277878761292, 0.025286900997161854)
('****Total time: ', 0.026981825232505797, 0.03227005004882812)
('****Preprocess time: ', 0.003086707353591919, 0.003943920135498047)
('****Data time: ', 0.00040630960464477537, 0.00046181678771972656)
('****Fetch time: ', 5.670619010925293e-05, 6.699562072753906e-05)
('****Sort time: ', 0.0006800575256347656, 0.0007852077484130854)
****Stage 0 average time 0.0148503702879
****Stage 1 average time 0.00990268826485
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.39832782745
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.01987777304649353, 0.023889541625976562)
('****Total time: ', 0.02608764910697937, 0.03041945695877075)
('****Preprocess time: ', 0.0030071375370025635, 0.003431081771850586)
('****Data time: ', 0.00039794421195983885, 0.00044989585876464844)
('****Fetch time: ', 5.7808399200439455e-05, 6.29425048828125e-05)
('****Sort time: ', 0.000663330078125, 0.0007205009460449206)
****Stage 0 average time 0.0144306362867
****Stage 1 average time 0.00957335698605
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.4330868721
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01978493893146515, 0.02362312078475952)
('****Total time: ', 0.02605833077430725, 0.030234897136688227)
('****Preprocess time: ', 0.003005487561225891, 0.0033810377120971668)
('****Data time: ', 0.00039750075340270997, 0.0004461288452148435)
('****Fetch time: ', 5.543339252471924e-05, 6.413459777832031e-05)
('****Sort time: ', 0.000658469557762146, 0.0007339119911193844)
****Stage 0 average time 0.0143542689085
****Stage 1 average time 0.00954756128788
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.558024168
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.01981552040576935, 0.023679864406585684)
('****Total time: ', 0.026107295989990235, 0.03044269084930419)
('****Preprocess time: ', 0.003004754900932312, 0.003474318981170654)
('****Data time: ', 0.0003977776765823364, 0.0004458546638488769)
('****Fetch time: ', 5.3998708724975585e-05, 6.318092346191406e-05)
('****Sort time: ', 0.0006546143293380737, 0.0007660508155822753)
****Stage 0 average time 0.0144497270584
****Stage 1 average time 0.00947693896294
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.4851741791
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.019307371497154235, 0.02304984331130981)
('****Total time: ', 0.025541665911674498, 0.02966500520706176)
('****Preprocess time: ', 0.002995375394821167, 0.0033730626106262197)
('****Data time: ', 0.00039367043972015383, 0.0004410743713378906)
('****Fetch time: ', 5.3353071212768554e-05, 5.91278076171875e-05)
('****Sort time: ', 0.0006716222763061523, 0.0007512927055358885)
****Stage 0 average time 0.0141152478456
****Stage 1 average time 0.00930614483356
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.5994329453
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.019110186219215394, 0.0226542592048645)
('****Total time: ', 0.025280827403068543, 0.029157543182373045)
('****Preprocess time: ', 0.002950260758399963, 0.0032329678535461424)
('****Data time: ', 0.0003921753168106079, 0.0004408478736877441)
('****Fetch time: ', 5.051589012145996e-05, 5.91278076171875e-05)
('****Sort time: ', 0.0006686277389526367, 0.0007710933685302732)
****Stage 0 average time 0.0139372645617
****Stage 1 average time 0.00923450136185
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.3740339279
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.019316549062728883, 0.02295715808868408)
('****Total time: ', 0.025482231020927427, 0.029516530036926267)
('****Preprocess time: ', 0.002973965883255005, 0.0033300876617431635)
('****Data time: ', 0.0003975313901901245, 0.0004379868507385253)
('****Fetch time: ', 5.0660014152526854e-05, 5.793571472167969e-05)
('****Sort time: ', 0.0006567116975784302, 0.0007078647613525391)
****Stage 0 average time 0.0141476249695
****Stage 1 average time 0.00924779307842
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.6514298916
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.019455384016036987, 0.02338043451309204)
('****Total time: ', 0.025696145892143248, 0.0298877477645874)
('****Preprocess time: ', 0.0029928392171859742, 0.0034659504890441895)
('****Data time: ', 0.0003955522775650024, 0.00043201446533203125)
('****Fetch time: ', 5.081498622894287e-05, 5.7220458984375e-05)
('****Sort time: ', 0.0006584674119949341, 0.000724804401397705)
****Stage 0 average time 0.0142576009035
****Stage 1 average time 0.0092954570055
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  11.4987900257
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011598279476165771, 0.013902354240417478)
('****Total time: ', 4.889413518667221, 9.217316699028014)
('****Preprocess time: ', 0.0026385780572891235, 0.002916824817657471)
('****Data time: ', 0.00028832697868347166, 0.0003218770027160644)
('****Fetch time: ', 6.977343559265137e-05, 7.700920104980469e-05)
('****Sort time: ', 0.0006137583255767823, 0.0006580352783203125)
****Stage 0 average time 0.00588765883446
****Stage 1 average time 0.00932105743885
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.6612370014
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.01151531720161438, 0.013344037532806392)
('****Total time: ', 4.409920709967613, 8.405522787570952)
('****Preprocess time: ', 0.0026330887079238892, 0.002744960784912109)
('****Data time: ', 0.0002866871356964111, 0.000308990478515625)
('****Fetch time: ', 6.73062801361084e-05, 7.200241088867188e-05)
('****Sort time: ', 0.0006297988891601563, 0.0007322311401367185)
****Stage 0 average time 0.00598273515701
****Stage 1 average time 0.00914946305752
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.7517859936
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011545377492904662, 0.013369858264923096)
('****Total time: ', 3.9922152894735334, 7.5873340368270865)
('****Preprocess time: ', 0.0026376787424087526, 0.0027430534362792966)
('****Data time: ', 0.0002868574857711792, 0.00031113624572753906)
('****Fetch time: ', 6.742191314697266e-05, 7.128715515136719e-05)
('****Sort time: ', 0.0006316949129104614, 0.0007469654083251953)
****Stage 0 average time 0.00602176606655
****Stage 1 average time 0.00914726448059
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.6134409904
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.011380423665046692, 0.01265451908111572)
('****Total time: ', 3.3459759471416475, 6.379367291927336)
('****Preprocess time: ', 0.0026071703433990477, 0.002722024917602539)
('****Data time: ', 0.00028618967533111574, 0.0003109097480773925)
('****Fetch time: ', 6.65128231048584e-05, 7.272958755493158e-05)
('****Sort time: ', 0.0006285762786865235, 0.0007351040840148923)
****Stage 0 average time 0.00594263899326
****Stage 1 average time 0.0090262337923
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.6016328335
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.011373270511627197, 0.012275314331054686)
('****Total time: ', 2.2868195054531095, 4.408795201778412)
('****Preprocess time: ', 0.0026297227144241333, 0.0028150558471679685)
('****Data time: ', 0.00029073286056518555, 0.0003151893615722656)
('****Fetch time: ', 6.7268967628479e-05, 7.224082946777344e-05)
('****Sort time: ', 0.0006156263351440429, 0.000720977783203125)
****Stage 0 average time 0.00594483304024
****Stage 1 average time 0.00903178834915
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.4286370277
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.011140329718589782, 0.012127256393432616)
('****Total time: ', 1.1898183964490892, 2.3090918183326714)
('****Preprocess time: ', 0.0026254328489303588, 0.0027167916297912596)
('****Data time: ', 0.0002762877941131592, 0.00030493736267089844)
('****Fetch time: ', 6.49470090866089e-05, 6.914138793945312e-05)
('****Sort time: ', 0.000599772572517395, 0.0006480216979980469)
****Stage 0 average time 0.00586772096157
****Stage 1 average time 0.00883904898167
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.5425610542
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01131219208240509, 0.012576079368591304)
('****Total time: ', 0.3233494026660919, 0.5551235795021057)
('****Preprocess time: ', 0.0026129686832427976, 0.0027248978614807127)
('****Data time: ', 0.00028305697441101076, 0.00030995607376098626)
('****Fetch time: ', 6.627070903778076e-05, 7.128715515136719e-05)
('****Sort time: ', 0.0006034483909606933, 0.0006669044494628904)
****Stage 0 average time 0.00590149271488
****Stage 1 average time 0.00897644412518
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.2073049545
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.011247191548347473, 0.01270179748535156)
('****Total time: ', 0.018641541481018067, 0.025006818771362294)
('****Preprocess time: ', 0.002594514608383179, 0.0027129650115966797)
('****Data time: ', 0.0002817903757095337, 0.00030803680419921875)
('****Fetch time: ', 6.636035442352296e-05, 7.009506225585938e-05)
('****Sort time: ', 0.0006044769287109375, 0.0006559014320373535)
****Stage 0 average time 0.0059421043396
****Stage 1 average time 0.00885222947598
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.2523419857
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011109774708747864, 0.012472021579742431)
('****Total time: ', 0.01680911886692047, 0.019725227355957033)
('****Preprocess time: ', 0.002575144648551941, 0.002714884281158447)
('****Data time: ', 0.0002797921895980835, 0.000303065776824951)
('****Fetch time: ', 6.592416763305663e-05, 7.009506225585938e-05)
('****Sort time: ', 0.00060683274269104, 0.0006999969482421875)
****Stage 0 average time 0.00589057433605
****Stage 1 average time 0.00874689412117
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.4824140072
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.011026201128959657, 0.012319159507751462)
('****Total time: ', 0.016309659600257872, 0.018050205707550046)
('****Preprocess time: ', 0.0025570318698883055, 0.0026998639106750487)
('****Data time: ', 0.00028183794021606446, 0.00030493736267089844)
('****Fetch time: ', 6.610333919525146e-05, 7.177591323852533e-05)
('****Sort time: ', 0.0005940884351730346, 0.0006380558013916013)
****Stage 0 average time 0.00590560805798
****Stage 1 average time 0.00861965465546
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.0795590878
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.011461628079414367, 0.012961256504058835)
('****Total time: ', 0.016746222496032716, 0.018575501441955564)
('****Preprocess time: ', 0.002612225413322449, 0.0027981281280517576)
('****Data time: ', 0.0002949188947677612, 0.0003228187561035156)
('****Fetch time: ', 6.822359561920167e-05, 7.319450378417969e-05)
('****Sort time: ', 0.0005866636037826538, 0.0006421208381652829)
****Stage 0 average time 0.00598805344105
****Stage 1 average time 0.00903560614586
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.2716240883
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.011073853015899658, 0.01232227087020874)
('****Total time: ', 0.01622169828414917, 0.017700278759002683)
('****Preprocess time: ', 0.0025326052904129028, 0.0026807904243469237)
('****Data time: ', 0.00028073954582214357, 0.00030493736267089844)
('****Fetch time: ', 6.659889221191407e-05, 7.009506225585938e-05)
('****Sort time: ', 0.000588420033454895, 0.000637102127075195)
****Stage 0 average time 0.00584235870838
****Stage 1 average time 0.00869985806942
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [1600, 512])
****DCGs @ 4: 0.976673600639
****DCGs @ 8: 0.965583458782
****DCGs @ 16: 0.941242796371
****DCGs @ 32: 0.91096682018
****DCGs @ 64: 0.858825423073
****Error : 0.344
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  7.76027393341
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.020569348335266115, 0.029817211627960197)
('****Total time: ', 2.6769916372299196, 4.811816596984863)
('****Preprocess time: ', 0.003483320355415344, 0.004983365535736082)
('****Data time: ', 0.00042161738872528075, 0.0004971504211425779)
('****Fetch time: ', 8.073759078979492e-05, 9.512901306152344e-05)
('****Sort time: ', 0.00046858024597167967, 0.0005853295326232896)
****Stage 0 average time 0.0212380508184
****Stage 1 average time 0.00378555309772
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983681191933
****DCGs @ 8: 0.971644951388
****DCGs @ 16: 0.949350720037
****DCGs @ 32: 0.924524714484
****DCGs @ 64: 0.880007800001
****Error : 0.2268046875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.56793284416
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.018525163531303405, 0.023340082168579104)
('****Total time: ', 2.149647954583168, 3.950105190277099)
('****Preprocess time: ', 0.0031495747566223143, 0.004304039478302002)
('****Data time: ', 0.0003801906108856201, 0.00043392181396484375)
('****Fetch time: ', 7.075297832489014e-05, 8.082389831542969e-05)
('****Sort time: ', 0.0004738154411315918, 0.0006011009216308591)
****Stage 0 average time 0.0188860734701
****Stage 1 average time 0.00371342384815
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.982975483277
****DCGs @ 8: 0.971577169458
****DCGs @ 16: 0.949544654689
****DCGs @ 32: 0.924395795001
****DCGs @ 64: 0.879808991322
****Error : 0.22672265625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.15673899651
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.019111537098884582, 0.025126922130584706)
('****Total time: ', 1.6782491513490676, 3.4110096931457514)
('****Preprocess time: ', 0.0031536760330200197, 0.004394161701202392)
('****Data time: ', 0.00038129007816314697, 0.00043702125549316406)
('****Fetch time: ', 7.195746898651124e-05, 8.20159912109375e-05)
('****Sort time: ', 0.0004736812114715576, 0.0005932331085205076)
****Stage 0 average time 0.0191764758825
****Stage 1 average time 0.004015666008
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983100251573
****DCGs @ 8: 0.971398907495
****DCGs @ 16: 0.949353116319
****DCGs @ 32: 0.924304518548
****DCGs @ 64: 0.879752259539
****Error : 0.226609375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.7841629982
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.01862251162528992, 0.023734688758850094)
('****Total time: ', 1.2767193081378936, 2.1784567356109616)
('****Preprocess time: ', 0.0030752276182174684, 0.004172086715698242)
('****Data time: ', 0.00036526286602020264, 0.0004220008850097656)
('****Fetch time: ', 7.168352603912354e-05, 8.392333984375e-05)
('****Sort time: ', 0.00048657679557800296, 0.0006001114845275878)
****Stage 0 average time 0.0187972223759
****Stage 1 average time 0.00382404005527
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983344936861
****DCGs @ 8: 0.971531698678
****DCGs @ 16: 0.949415114551
****DCGs @ 32: 0.924612830307
****DCGs @ 64: 0.879973608447
****Error : 0.22671484375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.28641605377
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.018709702849388124, 0.0253814935684204)
('****Total time: ', 0.572097333908081, 0.8211376070976257)
('****Preprocess time: ', 0.003097446322441101, 0.0042274475097656234)
('****Data time: ', 0.0003668036460876465, 0.000415802001953125)
('****Fetch time: ', 7.164645195007324e-05, 8.702278137207031e-05)
('****Sort time: ', 0.0004750560522079468, 0.0005559921264648438)
****Stage 0 average time 0.0186580514908
****Stage 1 average time 0.00406260383129
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983181191933
****DCGs @ 8: 0.971605835972
****DCGs @ 16: 0.949472826653
****DCGs @ 32: 0.924444255878
****DCGs @ 64: 0.879843051623
****Error : 0.2266875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.72624707222
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.018078932762145995, 0.02220072746276855)
('****Total time: ', 0.02624628257751465, 0.03420675992965697)
('****Preprocess time: ', 0.0030344749689102174, 0.003969120979309081)
('****Data time: ', 0.00036246657371521, 0.0004069805145263672)
('****Fetch time: ', 7.065296173095703e-05, 8.20159912109375e-05)
('****Sort time: ', 0.0004702486991882324, 0.000541281700134277)
****Stage 0 average time 0.0181792088747
****Stage 1 average time 0.00383756709099
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983244329234
****DCGs @ 8: 0.971578485336
****DCGs @ 16: 0.949563928094
****DCGs @ 32: 0.924472567529
****DCGs @ 64: 0.879828193555
****Error : 0.22669140625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.7106950283
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017850897550582886, 0.02189326286315918)
('****Total time: ', 0.024728298783302308, 0.030172753334045406)
('****Preprocess time: ', 0.002995064854621887, 0.0033639073371887207)
('****Data time: ', 0.00036464035511016844, 0.00041294097900390625)
('****Fetch time: ', 6.969726085662842e-05, 7.987022399902344e-05)
('****Sort time: ', 0.0004848957061767578, 0.0005529046058654785)
****Stage 0 average time 0.0178980826139
****Stage 1 average time 0.0038671131134
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.982858468105
****DCGs @ 8: 0.971286417003
****DCGs @ 16: 0.949308286873
****DCGs @ 32: 0.924373148186
****DCGs @ 64: 0.879784307993
****Error : 0.22668359375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.5101780891
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.018177119731903075, 0.022808516025543207)
('****Total time: ', 0.0244754718542099, 0.029863262176513666)
('****Preprocess time: ', 0.0030031503438949585, 0.003853917121887206)
('****Data time: ', 0.0003656145334243774, 0.00041985511779785156)
('****Fetch time: ', 6.964802742004395e-05, 8.177757263183594e-05)
('****Sort time: ', 0.00046508991718292235, 0.0005290508270263672)
****Stage 0 average time 0.0182380781174
****Stage 1 average time 0.00384254443645
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983607646796
****DCGs @ 8: 0.971763012434
****DCGs @ 16: 0.9494837499
****DCGs @ 32: 0.924548923893
****DCGs @ 64: 0.879981699515
****Error : 0.2266484375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.5921890736
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01798238682746887, 0.02273849248886108)
('****Total time: ', 0.024230552792549133, 0.029687225818634026)
('****Preprocess time: ', 0.002984212517738342, 0.0034662961959838795)
('****Data time: ', 0.0003684713840484619, 0.000415802001953125)
('****Fetch time: ', 7.04936981201172e-05, 8.08358192443847e-05)
('****Sort time: ', 0.00047769880294799805, 0.00053788423538208)
****Stage 0 average time 0.0180095367432
****Stage 1 average time 0.00387372648716
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983304343127
****DCGs @ 8: 0.971614771864
****DCGs @ 16: 0.94964085
****DCGs @ 32: 0.92451911514
****DCGs @ 64: 0.879839020195
****Error : 0.2267890625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.6375980377
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.017995555877685546, 0.021263194084167478)
('****Total time: ', 0.023689568638801575, 0.02740788459777832)
('****Preprocess time: ', 0.003025887966156006, 0.003573656082153319)
('****Data time: ', 0.00038327550888061525, 0.0004279613494873047)
('****Fetch time: ', 6.897330284118653e-05, 7.891654968261719e-05)
('****Sort time: ', 0.0004736669063568115, 0.0005040168762207031)
****Stage 0 average time 0.0182362012863
****Stage 1 average time 0.0037111582756
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.982856961798
****DCGs @ 8: 0.971457290502
****DCGs @ 16: 0.94943221054
****DCGs @ 32: 0.924465223751
****DCGs @ 64: 0.879835051812
****Error : 0.2266484375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.6837449074
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.017588507533073425, 0.020425438880920396)
('****Total time: ', 0.023524033665657043, 0.027121067047119123)
('****Preprocess time: ', 0.0029384875297546386, 0.0031529426574707026)
('****Data time: ', 0.00037068545818328856, 0.0004172563552856444)
('****Fetch time: ', 6.784236431121826e-05, 7.700920104980469e-05)
('****Sort time: ', 0.00047179031372070315, 0.0005099773406982422)
****Stage 0 average time 0.0176531575918
****Stage 1 average time 0.00378415560722
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983296947905
****DCGs @ 8: 0.971405985028
****DCGs @ 16: 0.949362716586
****DCGs @ 32: 0.924335384372
****DCGs @ 64: 0.87977394318
****Error : 0.22661328125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  31.7807350159
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.01740943241119385, 0.020673120021820066)
('****Total time: ', 0.02324606788158417, 0.02704961299896238)
('****Preprocess time: ', 0.0029361640214920046, 0.003192949295043945)
('****Data time: ', 0.0003715019226074219, 0.0004200935363769531)
('****Fetch time: ', 6.761527061462402e-05, 7.605552673339844e-05)
('****Sort time: ', 0.0004688866138458252, 0.0005080699920654297)
****Stage 0 average time 0.0174275410175
****Stage 1 average time 0.00382605922222
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983518953313
****DCGs @ 8: 0.971626382913
****DCGs @ 16: 0.949495079177
****DCGs @ 32: 0.924492521091
****DCGs @ 64: 0.880066330034
****Error : 0.2267890625
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  2.54027605057
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.020389049410820006, 0.025862073898315425)
('****Total time: ', 0.04297421979904175, 0.07056971788406366)
('****Preprocess time: ', 0.0032186696529388427, 0.0045796751976013165)
('****Data time: ', 0.00043260800838470457, 0.000528132915496826)
('****Fetch time: ', 6.106913089752197e-05, 6.914138793945312e-05)
('****Sort time: ', 0.0004996058940887451, 0.000676929950714111)
****Stage 0 average time 0.0192524561882
****Stage 1 average time 0.00534854590893
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983681191933
****DCGs @ 8: 0.971644951388
****DCGs @ 16: 0.949350720037
****DCGs @ 32: 0.924524714484
****DCGs @ 64: 0.880007800001
****Error : 0.2268046875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  3.51333808899
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.020435906529426576, 0.026608622074127182)
('****Total time: ', 0.027217723488807678, 0.035021507740020726)
('****Preprocess time: ', 0.003261461019515991, 0.004624152183532714)
('****Data time: ', 0.0004378132820129394, 0.0005140304565429688)
('****Fetch time: ', 5.759370326995849e-05, 6.794929504394531e-05)
('****Sort time: ', 0.00047864317893981935, 0.0005958199501037597)
****Stage 0 average time 0.0196488517523
****Stage 1 average time 0.00502256596088
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.982975483277
****DCGs @ 8: 0.971577169458
****DCGs @ 16: 0.949544654689
****DCGs @ 32: 0.924395795001
****DCGs @ 64: 0.879808991322
****Error : 0.22672265625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.58261108398
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.02008256447315216, 0.024592185020446758)
('****Total time: ', 0.02710241234302521, 0.033545255661010735)
('****Preprocess time: ', 0.003214134693145752, 0.004397487640380855)
('****Data time: ', 0.00043356812000274657, 0.0004999637603759766)
('****Fetch time: ', 5.810689926147461e-05, 6.604194641113281e-05)
('****Sort time: ', 0.0005077478885650634, 0.000579845905303955)
****Stage 0 average time 0.0193976656199
****Stage 1 average time 0.00489845645428
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983100251573
****DCGs @ 8: 0.971398907495
****DCGs @ 16: 0.949353116319
****DCGs @ 32: 0.924304518548
****DCGs @ 64: 0.879752259539
****Error : 0.226609375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.60370397568
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.020173423886299134, 0.024543404579162594)
('****Total time: ', 0.026735501289367677, 0.03173112869262694)
('****Preprocess time: ', 0.0032379753589630127, 0.004457139968872069)
('****Data time: ', 0.0004388449192047119, 0.0005009174346923828)
('****Fetch time: ', 5.7190656661987305e-05, 6.604194641113281e-05)
('****Sort time: ', 0.0004888011217117309, 0.0005631923675537107)
****Stage 0 average time 0.0194800013304
****Stage 1 average time 0.00491623461246
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983344936861
****DCGs @ 8: 0.971531698678
****DCGs @ 16: 0.949415114551
****DCGs @ 32: 0.924612830307
****DCGs @ 64: 0.879973608447
****Error : 0.22671484375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.63776016235
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.0192005318403244, 0.023122227191925034)
('****Total time: ', 0.0254703871011734, 0.029825377464294416)
('****Preprocess time: ', 0.003134282350540161, 0.004181408882141105)
('****Data time: ', 0.0004161386489868164, 0.0004749417304992675)
('****Fetch time: ', 5.0784468650817874e-05, 5.98549842834472e-05)
('****Sort time: ', 0.0004908024072647095, 0.0005619525909423828)
****Stage 0 average time 0.0187045698166
****Stage 1 average time 0.00458796989918
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983181191933
****DCGs @ 8: 0.971605835972
****DCGs @ 16: 0.949472826653
****DCGs @ 32: 0.924444255878
****DCGs @ 64: 0.879843051623
****Error : 0.2266875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.64465498924
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.018617564678192138, 0.021692633628845215)
('****Total time: ', 0.024725231647491457, 0.028298151493072507)
('****Preprocess time: ', 0.0030688169002532958, 0.003442049026489258)
('****Data time: ', 0.00041086089611053466, 0.00046707391738891595)
('****Fetch time: ', 5.0340652465820314e-05, 5.888938903808594e-05)
('****Sort time: ', 0.0004950332641601563, 0.0005609989166259766)
****Stage 0 average time 0.0182398066521
****Stage 1 average time 0.00440280973911
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983244329234
****DCGs @ 8: 0.971578485336
****DCGs @ 16: 0.949563928094
****DCGs @ 32: 0.924472567529
****DCGs @ 64: 0.879828193555
****Error : 0.22669140625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.5195171833
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01902279031276703, 0.022508203983306878)
('****Total time: ', 0.02512731456756592, 0.029142916202545166)
('****Preprocess time: ', 0.003109323024749756, 0.0037370800971984796)
('****Data time: ', 0.00041603052616119384, 0.00047278404235839844)
('****Fetch time: ', 4.914653301239014e-05, 5.793571472167969e-05)
('****Sort time: ', 0.0004970424175262451, 0.0005450248718261719)
****Stage 0 average time 0.0186598323584
****Stage 1 average time 0.00443450045586
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.982858468105
****DCGs @ 8: 0.971286417003
****DCGs @ 16: 0.949308286873
****DCGs @ 32: 0.924373148186
****DCGs @ 64: 0.879784307993
****Error : 0.22668359375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.5598828793
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.01909608268737793, 0.022515392303466792)
('****Total time: ', 0.025231631875038147, 0.028999483585357665)
('****Preprocess time: ', 0.003147383213043213, 0.004051387310028075)
('****Data time: ', 0.00041444861888885497, 0.00046706199645996094)
('****Fetch time: ', 4.882156848907471e-05, 5.698204040527344e-05)
('****Sort time: ', 0.0004879786968231201, 0.0005309581756591797)
****Stage 0 average time 0.0187078943253
****Stage 1 average time 0.00448682045937
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983607646796
****DCGs @ 8: 0.971763012434
****DCGs @ 16: 0.9494837499
****DCGs @ 32: 0.924548923893
****DCGs @ 64: 0.879981699515
****Error : 0.2266484375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.6291258335
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.018719347953796386, 0.022036361694335923)
('****Total time: ', 0.024794559597969053, 0.028428316116333)
('****Preprocess time: ', 0.0030696030855178833, 0.003509318828582763)
('****Data time: ', 0.0004083751440048218, 0.0004589557647705078)
('****Fetch time: ', 5.054640769958496e-05, 5.602836608886719e-05)
('****Sort time: ', 0.0004957568645477295, 0.0005650997161865232)
****Stage 0 average time 0.0183861600161
****Stage 1 average time 0.00435746943951
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983304343127
****DCGs @ 8: 0.971614771864
****DCGs @ 16: 0.94964085
****DCGs @ 32: 0.92451911514
****DCGs @ 64: 0.879839020195
****Error : 0.2267890625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.9878129959
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.01823235285282135, 0.021538197994232174)
('****Total time: ', 0.02438881504535675, 0.02810702323913574)
('****Preprocess time: ', 0.003045683979988098, 0.003539013862609862)
('****Data time: ', 0.0004004513025283813, 0.0004420280456542969)
('****Fetch time: ', 4.799962043762207e-05, 5.1975250244140625e-05)
('****Sort time: ', 0.0004976820945739746, 0.0005681872367858885)
****Stage 0 average time 0.0179652808905
****Stage 1 average time 0.00425888895988
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.982856961798
****DCGs @ 8: 0.971457290502
****DCGs @ 16: 0.94943221054
****DCGs @ 32: 0.924465223751
****DCGs @ 64: 0.879835051812
****Error : 0.2266484375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.6372458935
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.0174671847820282, 0.020604121685028072)
('****Total time: ', 0.023585497736930847, 0.02688238620758056)
('****Preprocess time: ', 0.002981395483016968, 0.0033497929573059085)
('****Data time: ', 0.0003992786407470703, 0.0004451274871826172)
('****Fetch time: ', 4.5633673667907715e-05, 5.1975250244140625e-05)
('****Sort time: ', 0.0004987393617630005, 0.0005271434783935547)
****Stage 0 average time 0.0171514576674
****Stage 1 average time 0.00424077427387
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983296947905
****DCGs @ 8: 0.971405985028
****DCGs @ 16: 0.949362716586
****DCGs @ 32: 0.924335384372
****DCGs @ 64: 0.87977394318
****Error : 0.22661328125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.7872200012
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.017064932346343993, 0.019910788536071776)
('****Total time: ', 0.023125924587249755, 0.026274311542510982)
('****Preprocess time: ', 0.0029647911787033083, 0.003203225135803221)
('****Data time: ', 0.00039153134822845457, 0.0004427552223205566)
('****Fetch time: ', 4.380333423614502e-05, 5.1021575927734375e-05)
('****Sort time: ', 0.0005158398151397705, 0.0005328655242919922)
****Stage 0 average time 0.0167730289698
****Stage 1 average time 0.00420786905289
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983518953313
****DCGs @ 8: 0.971626382913
****DCGs @ 16: 0.949495079177
****DCGs @ 32: 0.924492521091
****DCGs @ 64: 0.880066330034
****Error : 0.2267890625
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  12.8771288395
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007234138965606689, 0.007812285423278806)
('****Total time: ', 5.484384912848473, 10.350751376152038)
('****Preprocess time: ', 0.002612043499946594, 0.0027690291404724116)
('****Data time: ', 0.00027174615859985353, 0.00029087066650390625)
('****Fetch time: ', 6.162786483764648e-05, 6.985664367675781e-05)
('****Sort time: ', 0.0004675610065460205, 0.0005419254302978516)
****Stage 0 average time 0.00657533597946
****Stage 1 average time 0.00407178151608
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983681191933
****DCGs @ 8: 0.971644951388
****DCGs @ 16: 0.949350720037
****DCGs @ 32: 0.924524714484
****DCGs @ 64: 0.880007800001
****Error : 0.2268046875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.8670270443
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.007228197693824768, 0.007611763477325439)
('****Total time: ', 4.934191461086273, 9.358730781078338)
('****Preprocess time: ', 0.002614253044128418, 0.0027229785919189453)
('****Data time: ', 0.0002637622356414795, 0.0002810955047607422)
('****Fetch time: ', 6.160593032836914e-05, 7.010698318481439e-05)
('****Sort time: ', 0.00043602120876312254, 0.0004623174667358397)
****Stage 0 average time 0.00653002488613
****Stage 1 average time 0.00407381522655
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.982975483277
****DCGs @ 8: 0.971577169458
****DCGs @ 16: 0.949544654689
****DCGs @ 32: 0.924395795001
****DCGs @ 64: 0.879808991322
****Error : 0.22672265625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.4070830345
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007634515285491943, 0.00923309326171875)
('****Total time: ', 4.646129847049713, 8.8075027346611)
('****Preprocess time: ', 0.0027903302907943727, 0.0036437630653381346)
('****Data time: ', 0.00027241718769073487, 0.0003111481666564941)
('****Fetch time: ', 6.460189819335937e-05, 7.200241088867188e-05)
('****Sort time: ', 0.0004345921277999878, 0.0004668354988098144)
****Stage 0 average time 0.00680748403072
****Stage 1 average time 0.00438897275925
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983100251573
****DCGs @ 8: 0.971398907495
****DCGs @ 16: 0.949353116319
****DCGs @ 32: 0.924304518548
****DCGs @ 64: 0.879752259539
****Error : 0.226609375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.0410671234
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.007365885138511658, 0.008492004871368409)
('****Total time: ', 3.911894105553627, 7.411597001552581)
('****Preprocess time: ', 0.002675077438354492, 0.0035632133483886716)
('****Data time: ', 0.0002662030458450317, 0.0002918362617492675)
('****Fetch time: ', 6.124365329742432e-05, 7.081031799316406e-05)
('****Sort time: ', 0.0004359971284866333, 0.0004630088806152344)
****Stage 0 average time 0.0066211001873
****Stage 1 average time 0.00418330621719
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983344936861
****DCGs @ 8: 0.971531698678
****DCGs @ 16: 0.949415114551
****DCGs @ 32: 0.924612830307
****DCGs @ 64: 0.879973608447
****Error : 0.22671484375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.5995059013
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.007060928463935852, 0.007508134841918945)
('****Total time: ', 2.7139053828716277, 5.121643209457397)
('****Preprocess time: ', 0.0025498855113983156, 0.0026440978050231933)
('****Data time: ', 0.0002548458576202393, 0.00027489662170410156)
('****Fetch time: ', 6.24988079071045e-05, 6.985664367675781e-05)
('****Sort time: ', 0.00044314873218536375, 0.00047397613525390625)
****Stage 0 average time 0.00641463005543
****Stage 1 average time 0.00395667731762
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983181191933
****DCGs @ 8: 0.971605835972
****DCGs @ 16: 0.949472826653
****DCGs @ 32: 0.924444255878
****DCGs @ 64: 0.879843051623
****Error : 0.2266875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.8417100906
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.007233822226524353, 0.0077278733253479)
('****Total time: ', 1.7676093682050704, 3.3468939781188958)
('****Preprocess time: ', 0.0026163774728775024, 0.0026819705963134766)
('****Data time: ', 0.00026427066326141355, 0.00028204917907714844)
('****Fetch time: ', 6.126797199249267e-05, 6.985664367675781e-05)
('****Sort time: ', 0.0004386954307556152, 0.00046898126602172845)
****Stage 0 average time 0.00651958203316
****Stage 1 average time 0.00409485173225
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983244329234
****DCGs @ 8: 0.971578485336
****DCGs @ 16: 0.949563928094
****DCGs @ 32: 0.924472567529
****DCGs @ 64: 0.879828193555
****Error : 0.22669140625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.8264241219
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007225028038024902, 0.007752943038940429)
('****Total time: ', 0.80232725918293, 1.496324336528778)
('****Preprocess time: ', 0.0026105966567993165, 0.002716064453125)
('****Data time: ', 0.0002682691812515259, 0.0002892017364501953)
('****Fetch time: ', 6.185328960418702e-05, 7.081031799316406e-05)
('****Sort time: ', 0.0004375571012496948, 0.0004711151123046875)
****Stage 0 average time 0.00651486575603
****Stage 1 average time 0.00408843851089
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.982858468105
****DCGs @ 8: 0.971286417003
****DCGs @ 16: 0.949308286873
****DCGs @ 32: 0.924373148186
****DCGs @ 64: 0.879784307993
****Error : 0.22668359375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.3152031898
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.007324068546295166, 0.007840502262115478)
('****Total time: ', 0.026001917481422426, 0.0488840103149414)
('****Preprocess time: ', 0.0026231427192687988, 0.002733004093170166)
('****Data time: ', 0.00026507174968719483, 0.00028395652770996094)
('****Fetch time: ', 6.262183189392089e-05, 6.890296936035156e-05)
('****Sort time: ', 0.0004400482177734375, 0.0004818439483642578)
****Stage 0 average time 0.00660282349586
****Stage 1 average time 0.00411212956905
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983607646796
****DCGs @ 8: 0.971763012434
****DCGs @ 16: 0.9494837499
****DCGs @ 32: 0.924548923893
****DCGs @ 64: 0.879981699515
****Error : 0.2266484375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.3991332054
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007354501366615296, 0.008002209663391113)
('****Total time: ', 0.013510096549987792, 0.01792702674865722)
('****Preprocess time: ', 0.002616295695304871, 0.002953052520751953)
('****Data time: ', 0.0002777367830276489, 0.000370025634765625)
('****Fetch time: ', 6.254208087921142e-05, 6.890296936035156e-05)
('****Sort time: ', 0.00043338286876678465, 0.0004830837249755857)
****Stage 0 average time 0.00665267384052
****Stage 1 average time 0.00409178495407
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983304343127
****DCGs @ 8: 0.971614771864
****DCGs @ 16: 0.94964085
****DCGs @ 32: 0.92451911514
****DCGs @ 64: 0.879839020195
****Error : 0.2267890625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.468957901
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.00734275758266449, 0.007974493503570554)
('****Total time: ', 0.012411730408668518, 0.014149653911590572)
('****Preprocess time: ', 0.00256407105922699, 0.002885103225708008)
('****Data time: ', 0.00027931320667266845, 0.00036388635635375944)
('****Fetch time: ', 6.139600276947022e-05, 6.890296936035156e-05)
('****Sort time: ', 0.0004269111156463623, 0.00048189163208007786)
****Stage 0 average time 0.00660007727146
****Stage 1 average time 0.00407437169552
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.982856961798
****DCGs @ 8: 0.971457290502
****DCGs @ 16: 0.94943221054
****DCGs @ 32: 0.924465223751
****DCGs @ 64: 0.879835051812
****Error : 0.2266484375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.3236880302
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.007441274285316467, 0.008163332939147947)
('****Total time: ', 0.012566824197769165, 0.01398401260375976)
('****Preprocess time: ', 0.002573457360267639, 0.0028708577156066895)
('****Data time: ', 0.000280153751373291, 0.0003309726715087888)
('****Fetch time: ', 6.264781951904297e-05, 6.985664367675781e-05)
('****Sort time: ', 0.00042852377891540526, 0.0004940032958984375)
****Stage 0 average time 0.00669282591343
****Stage 1 average time 0.00409323108196
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983296947905
****DCGs @ 8: 0.971405985028
****DCGs @ 16: 0.949362716586
****DCGs @ 32: 0.924335384372
****DCGs @ 64: 0.87977394318
****Error : 0.22661328125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.6249141693
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.007451475739479065, 0.00823221206665039)
('****Total time: ', 0.01267529010772705, 0.013773822784423824)
('****Preprocess time: ', 0.0025572638511657713, 0.002844142913818359)
('****Data time: ', 0.00027810537815093993, 0.00035228729248046797)
('****Fetch time: ', 6.306803226470947e-05, 7.081031799316406e-05)
('****Sort time: ', 0.0004534720182418823, 0.0005312204360961913)
****Stage 0 average time 0.00665200948715
****Stage 1 average time 0.00415137553215
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 128])
****DCGs @ 4: 0.983518953313
****DCGs @ 8: 0.971626382913
****DCGs @ 16: 0.949495079177
****DCGs @ 32: 0.924492521091
****DCGs @ 64: 0.880066330034
****Error : 0.2267890625
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  9.15454101562
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.02111900293827057, 0.030818891525268552)
('****Total time: ', 3.522680187821388, 6.230844020843506)
('****Preprocess time: ', 0.003982391238212585, 0.005680203437805174)
('****Data time: ', 0.0004444788694381714, 0.0005428791046142578)
('****Fetch time: ', 8.192586898803711e-05, 0.00010204315185546875)
('****Sort time: ', 0.000651427149772644, 0.0008590698242187497)
****Stage 0 average time 0.0216864646673
****Stage 1 average time 0.00459276139736
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983681191933
****DCGs @ 8: 0.971607313967
****DCGs @ 16: 0.949397428583
****DCGs @ 32: 0.924498199082
****DCGs @ 64: 0.879937190059
****Error : 0.360560546875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.77749490738
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.01987557029724121, 0.026118838787078852)
('****Total time: ', 2.80367580640316, 5.1364611744880655)
('****Preprocess time: ', 0.0036692477464675905, 0.005063331127166746)
('****Data time: ', 0.00041279518604278565, 0.000469207763671875)
('****Fetch time: ', 7.658278942108154e-05, 8.320808410644531e-05)
('****Sort time: ', 0.0006556239128112793, 0.0008344054222106924)
****Stage 0 average time 0.0202710556984
****Stage 1 average time 0.00441876423359
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.982975483277
****DCGs @ 8: 0.971583305099
****DCGs @ 16: 0.949606855204
****DCGs @ 32: 0.924418443173
****DCGs @ 64: 0.879797719665
****Error : 0.360555664063
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.02465796471
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01924354088306427, 0.0250356912612915)
('****Total time: ', 2.3498133289813996, 4.322543132305144)
('****Preprocess time: ', 0.0035425788164138794, 0.00471764802932739)
('****Data time: ', 0.00039263927936553956, 0.00045682191848754876)
('****Fetch time: ', 7.547545433044434e-05, 8.511543273925781e-05)
('****Sort time: ', 0.0006616848707199096, 0.0008347153663635253)
****Stage 0 average time 0.0193768099546
****Stage 1 average time 0.00453910934925
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983100251573
****DCGs @ 8: 0.971367405714
****DCGs @ 16: 0.949378746116
****DCGs @ 32: 0.924247632479
****DCGs @ 64: 0.879710684461
****Error : 0.36062890625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.93396902084
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.018569740056991576, 0.021767687797546377)
('****Total time: ', 1.785414209485054, 3.250508761405945)
('****Preprocess time: ', 0.00348374342918396, 0.004399299621582031)
('****Data time: ', 0.0003868463039398193, 0.0004379868507385253)
('****Fetch time: ', 7.450771331787109e-05, 7.964372634887689e-05)
('****Sort time: ', 0.0006487168073654175, 0.0007942676544189448)
****Stage 0 average time 0.0186667876244
****Stage 1 average time 0.00449676668644
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983344936861
****DCGs @ 8: 0.971494061257
****DCGs @ 16: 0.949459751436
****DCGs @ 32: 0.924583757675
****DCGs @ 64: 0.87992206671
****Error : 0.360552734375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.91115903854
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.018157114267349242, 0.021816205978393552)
('****Total time: ', 0.7665933300256729, 1.3480911135673523)
('****Preprocess time: ', 0.003427058219909668, 0.004336202144622802)
('****Data time: ', 0.0003783695697784424, 0.0004263162612915038)
('****Fetch time: ', 7.200658321380615e-05, 7.724761962890625e-05)
('****Sort time: ', 0.0006563138961791993, 0.0007932424545288085)
****Stage 0 average time 0.0182052112818
****Stage 1 average time 0.00448565125465
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983181191933
****DCGs @ 8: 0.971611971613
****DCGs @ 16: 0.949558228281
****DCGs @ 32: 0.924449348252
****DCGs @ 64: 0.879768924305
****Error : 0.360518554687
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.66786813736
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.018157592177391053, 0.021887481212615963)
('****Total time: ', 0.07063839387893676, 0.17455453872680637)
('****Preprocess time: ', 0.0034493811130523683, 0.00436711311340332)
('****Data time: ', 0.0003828830718994141, 0.00043109655380249004)
('****Fetch time: ', 7.143259048461914e-05, 7.891654968261719e-05)
('****Sort time: ', 0.0006628055572509765, 0.0007830262184143063)
****Stage 0 average time 0.0180499820709
****Stage 1 average time 0.00467411243916
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983244329234
****DCGs @ 8: 0.971546983555
****DCGs @ 16: 0.949550280931
****DCGs @ 32: 0.9244059084
****DCGs @ 64: 0.879782004326
****Error : 0.36064453125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.7278261185
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017748778462409975, 0.02087665796279907)
('****Total time: ', 0.02605629301071167, 0.03186277151107788)
('****Preprocess time: ', 0.003398107647895813, 0.0037111282348632805)
('****Data time: ', 0.00037955820560455324, 0.00043201446533203125)
('****Fetch time: ', 7.026278972625733e-05, 7.891654968261719e-05)
('****Sort time: ', 0.0006703599691390991, 0.0007538914680480956)
****Stage 0 average time 0.0176973938942
****Stage 1 average time 0.00456967318058
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.982858468105
****DCGs @ 8: 0.971248779581
****DCGs @ 16: 0.949349173422
****DCGs @ 32: 0.924362267204
****DCGs @ 64: 0.879753712526
****Error : 0.360572265625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.7688701153
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.017913357496261596, 0.021747434139251707)
('****Total time: ', 0.025475651144981383, 0.030597925186157223)
('****Preprocess time: ', 0.00342873740196228, 0.0038402915000915524)
('****Data time: ', 0.00038444685935974123, 0.00045108795166015625)
('****Fetch time: ', 7.070839405059814e-05, 8.296966552734375e-05)
('****Sort time: ', 0.0006449991464614869, 0.0007589459419250485)
****Stage 0 average time 0.0177939959764
****Stage 1 average time 0.00464825332165
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983607646796
****DCGs @ 8: 0.971769148075
****DCGs @ 16: 0.949569334886
****DCGs @ 32: 0.924543500588
****DCGs @ 64: 0.879916367394
****Error : 0.360559570313
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.824794054
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017812687277793886, 0.021864140033721922)
('****Total time: ', 0.024826789379119873, 0.029563152790069578)
('****Preprocess time: ', 0.003425134062767029, 0.0039112091064453115)
('****Data time: ', 0.00038004612922668457, 0.00043129920959472656)
('****Fetch time: ', 7.35321044921875e-05, 8.392333984375e-05)
('****Sort time: ', 0.0006558719873428345, 0.0007651329040527341)
****Stage 0 average time 0.0175995489359
****Stage 1 average time 0.00474772262573
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983304343127
****DCGs @ 8: 0.971583270084
****DCGs @ 16: 0.949650725958
****DCGs @ 32: 0.924464645656
****DCGs @ 64: 0.87979440396
****Error : 0.360603515625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.9042072296
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.0174401079416275, 0.021031987667083734)
('****Total time: ', 0.024077189803123473, 0.028157293796539303)
('****Preprocess time: ', 0.003369468092918396, 0.003621923923492431)
('****Data time: ', 0.00038291990756988525, 0.0004401564598083494)
('****Fetch time: ', 6.839644908905029e-05, 7.919073104858379e-05)
('****Sort time: ', 0.0006481343507766723, 0.000753200054168701)
****Stage 0 average time 0.0173307048082
****Stage 1 average time 0.00457832193375
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.982856961798
****DCGs @ 8: 0.971419653081
****DCGs @ 16: 0.949472188573
****DCGs @ 32: 0.924463982209
****DCGs @ 64: 0.879788555744
****Error : 0.360571289063
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.6509058475
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.017427112936973573, 0.021226668357849105)
('****Total time: ', 0.023944905042648314, 0.028126227855682372)
('****Preprocess time: ', 0.0033506587743759157, 0.0036173701286315914)
('****Data time: ', 0.0003862389326095581, 0.00044800043106079095)
('****Fetch time: ', 6.989073753356933e-05, 7.987022399902344e-05)
('****Sort time: ', 0.0006292012929916381, 0.0007272243499755857)
****Stage 0 average time 0.0173294849396
****Stage 1 average time 0.00453361773491
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983296947905
****DCGs @ 8: 0.971412120669
****DCGs @ 16: 0.949426655023
****DCGs @ 32: 0.924319435756
****DCGs @ 64: 0.879736813929
****Error : 0.360561523437
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  31.7649040222
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.01726033318042755, 0.020783555507659906)
('****Total time: ', 0.023570204973220824, 0.02749511003494263)
('****Preprocess time: ', 0.0033431715965270997, 0.0035739064216613768)
('****Data time: ', 0.00038381278514862063, 0.0004439353942871094)
('****Fetch time: ', 6.854581832885742e-05, 7.631778717041003e-05)
('****Sort time: ', 0.0006228916645050049, 0.0006778359413146972)
****Stage 0 average time 0.0171113400459
****Stage 1 average time 0.00456741499901
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983518953313
****DCGs @ 8: 0.971588745492
****DCGs @ 16: 0.949522849929
****DCGs @ 32: 0.92446752874
****DCGs @ 64: 0.87996987104
****Error : 0.360591796875
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  2.79983186722
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.02915292000770569, 0.0388411521911621)
('****Total time: ', 0.09094095253944397, 0.1542161703109741)
('****Preprocess time: ', 0.00426084840297699, 0.006437838077545166)
('****Data time: ', 0.0005304615497589111, 0.0006778359413146972)
('****Fetch time: ', 8.801412582397461e-05, 9.393692016601562e-05)
('****Sort time: ', 0.0007721471786499023, 0.001092338562011718)
****Stage 0 average time 0.0214024765491
****Stage 1 average time 0.0134019147158
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983681191933
****DCGs @ 8: 0.971607313967
****DCGs @ 16: 0.949397428583
****DCGs @ 32: 0.924498199082
****DCGs @ 64: 0.879937190059
****Error : 0.360560546875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  3.6523578167
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.025562914967536925, 0.03265882730484007)
('****Total time: ', 0.0338178300857544, 0.04182033538818359)
('****Preprocess time: ', 0.003907365083694458, 0.005312490463256834)
('****Data time: ', 0.00047915887832641603, 0.0005670070648193357)
('****Fetch time: ', 6.96568489074707e-05, 7.964372634887689e-05)
('****Sort time: ', 0.0007224284410476684, 0.0009405851364135715)
****Stage 0 average time 0.0198708164692
****Stage 1 average time 0.0108707077503
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.982975483277
****DCGs @ 8: 0.971583305099
****DCGs @ 16: 0.949606855204
****DCGs @ 32: 0.924418443173
****DCGs @ 64: 0.879797719665
****Error : 0.360555664063
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.61224293709
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.02515798544883728, 0.031870138645172116)
('****Total time: ', 0.03278408980369568, 0.040106010437011695)
('****Preprocess time: ', 0.003878437280654907, 0.005277323722839353)
('****Data time: ', 0.00047583997249603274, 0.0005450367927551269)
('****Fetch time: ', 6.895947456359864e-05, 7.700920104980469e-05)
('****Sort time: ', 0.000703741192817688, 0.0008900165557861328)
****Stage 0 average time 0.0195623040199
****Stage 1 average time 0.0107226593494
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983100251573
****DCGs @ 8: 0.971367405714
****DCGs @ 16: 0.949378746116
****DCGs @ 32: 0.924247632479
****DCGs @ 64: 0.879710684461
****Error : 0.36062890625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.73038005829
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.02461956524848938, 0.030689728260040277)
('****Total time: ', 0.032114505410194394, 0.03856527805328369)
('****Preprocess time: ', 0.0037947736978530882, 0.004985582828521726)
('****Data time: ', 0.000470548152923584, 0.0005360126495361326)
('****Fetch time: ', 6.47035837173462e-05, 7.536411285400378e-05)
('****Sort time: ', 0.0007051279544830323, 0.0008692860603332506)
****Stage 0 average time 0.0191913337708
****Stage 1 average time 0.0104633848667
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983344936861
****DCGs @ 8: 0.971494061257
****DCGs @ 16: 0.949459751436
****DCGs @ 32: 0.924583757675
****DCGs @ 64: 0.87992206671
****Error : 0.360552734375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.72876787186
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.023751988053321838, 0.029369378089904776)
('****Total time: ', 0.030960420846939087, 0.03710192441940306)
('****Preprocess time: ', 0.0037181961536407473, 0.00511016845703125)
('****Data time: ', 0.00044837605953216555, 0.0005147576332092285)
('****Fetch time: ', 6.0647249221801756e-05, 7.106065750122064e-05)
('****Sort time: ', 0.0007057868242263794, 0.0008459091186523438)
****Stage 0 average time 0.0186496158838
****Stage 1 average time 0.0100353784561
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983181191933
****DCGs @ 8: 0.971611971613
****DCGs @ 16: 0.949558228281
****DCGs @ 32: 0.924449348252
****DCGs @ 64: 0.879768924305
****Error : 0.360518554687
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.77125000954
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.02290505766868591, 0.02727484703063965)
('****Total time: ', 0.03011286735534668, 0.03509993553161621)
('****Preprocess time: ', 0.003614290952682495, 0.004049468040466306)
('****Data time: ', 0.0004449620246887207, 0.0004961609840393066)
('****Fetch time: ', 5.929851531982422e-05, 6.822347640991191e-05)
('****Sort time: ', 0.0007173614501953125, 0.0008042693138122554)
****Stage 0 average time 0.0179095944166
****Stage 1 average time 0.00983137619495
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983244329234
****DCGs @ 8: 0.971546983555
****DCGs @ 16: 0.949550280931
****DCGs @ 32: 0.9244059084
****DCGs @ 64: 0.879782004326
****Error : 0.36064453125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.7164461613
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.022325139999389648, 0.02555940151214599)
('****Total time: ', 0.029285168170928955, 0.03307918310165405)
('****Preprocess time: ', 0.0035603368282318116, 0.003920185565948486)
('****Data time: ', 0.00044108152389526367, 0.0004942774772644041)
('****Fetch time: ', 5.637824535369873e-05, 6.508827209472656e-05)
('****Sort time: ', 0.0006956380605697632, 0.000779879093170166)
****Stage 0 average time 0.0176451790333
****Stage 1 average time 0.00943339562416
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.982858468105
****DCGs @ 8: 0.971248779581
****DCGs @ 16: 0.949349173422
****DCGs @ 32: 0.924362267204
****DCGs @ 64: 0.879753712526
****Error : 0.360572265625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.8539209366
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.02235624623298645, 0.02599034309387206)
('****Total time: ', 0.029382033705711366, 0.033466935157775865)
('****Preprocess time: ', 0.0035454429388046263, 0.0038922429084777815)
('****Data time: ', 0.00044199669361114503, 0.0004940032958984375)
('****Fetch time: ', 5.550837516784668e-05, 6.413459777832031e-05)
('****Sort time: ', 0.0007091026306152344, 0.0007921099662780757)
****Stage 0 average time 0.017667249918
****Stage 1 average time 0.0094410469532
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983607646796
****DCGs @ 8: 0.971769148075
****DCGs @ 16: 0.949569334886
****DCGs @ 32: 0.924543500588
****DCGs @ 64: 0.879916367394
****Error : 0.360559570313
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.6158821583
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.022639460563659668, 0.026137030124664305)
('****Total time: ', 0.02960570251941681, 0.033684670925140374)
('****Preprocess time: ', 0.0035968810319900514, 0.003984081745147704)
('****Data time: ', 0.0004534852504730225, 0.0005059242248535156)
('****Fetch time: ', 5.704128742218018e-05, 6.699562072753906e-05)
('****Sort time: ', 0.0007068012952804565, 0.0007912635803222646)
****Stage 0 average time 0.0179775846004
****Stage 1 average time 0.00947608482838
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983304343127
****DCGs @ 8: 0.971583270084
****DCGs @ 16: 0.949650725958
****DCGs @ 32: 0.924464645656
****DCGs @ 64: 0.87979440396
****Error : 0.360603515625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.8451719284
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.022673524022102355, 0.027344167232513424)
('****Total time: ', 0.029586816787719728, 0.03480482101440429)
('****Preprocess time: ', 0.0036238267421722413, 0.004582273960113518)
('****Data time: ', 0.00043747985363006594, 0.0004839897155761719)
('****Fetch time: ', 5.676150321960449e-05, 6.508827209472656e-05)
('****Sort time: ', 0.0007083934545516968, 0.0007381439208984375)
****Stage 0 average time 0.0181546493769
****Stage 1 average time 0.00934533619881
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.982856961798
****DCGs @ 8: 0.971419653081
****DCGs @ 16: 0.949472188573
****DCGs @ 32: 0.924463982209
****DCGs @ 64: 0.879788555744
****Error : 0.360571289063
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.704228878
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.02236404299736023, 0.02648756504058837)
('****Total time: ', 0.02935909640789032, 0.033796918392181394)
('****Preprocess time: ', 0.003553207278251648, 0.003854990005493164)
('****Data time: ', 0.00043757784366607664, 0.0004820823669433594)
('****Fetch time: ', 6.021797657012939e-05, 6.295442581176751e-05)
('****Sort time: ', 0.0006981745958328247, 0.0007520198822021482)
****Stage 0 average time 0.0177858666182
****Stage 1 average time 0.00932735407352
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983296947905
****DCGs @ 8: 0.971412120669
****DCGs @ 16: 0.949426655023
****DCGs @ 32: 0.924319435756
****DCGs @ 64: 0.879736813929
****Error : 0.360561523437
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.7984719276
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.02175714135169983, 0.02542533874511719)
('****Total time: ', 0.028624109029769897, 0.03266284465789795)
('****Preprocess time: ', 0.003523726224899292, 0.0038309097290039062)
('****Data time: ', 0.0004357304573059082, 0.0004811286926269531)
('****Fetch time: ', 5.36506175994873e-05, 6.031990051269531e-05)
('****Sort time: ', 0.000695767879486084, 0.0007460951805114742)
****Stage 0 average time 0.0172834917307
****Stage 1 average time 0.0091825248003
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983518953313
****DCGs @ 8: 0.971588745492
****DCGs @ 16: 0.949522849929
****DCGs @ 32: 0.92446752874
****DCGs @ 64: 0.87996987104
****Error : 0.360591796875
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  13.1186950207
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011574891448020935, 0.012339222431182859)
('****Total time: ', 5.620111267328262, 10.587729322910308)
('****Preprocess time: ', 0.003110411882400513, 0.003213310241699218)
('****Data time: ', 0.00029912924766540525, 0.00032591819763183594)
('****Fetch time: ', 6.723701953887939e-05, 7.510185241699219e-05)
('****Sort time: ', 0.0006637932062149048, 0.000770187377929687)
****Stage 0 average time 0.00673909807205
****Stage 1 average time 0.00897636473179
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983681191933
****DCGs @ 8: 0.971607313967
****DCGs @ 16: 0.949397428583
****DCGs @ 32: 0.924498199082
****DCGs @ 64: 0.879937190059
****Error : 0.360560546875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.8411018848
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.011389915943145751, 0.011987924575805664)
('****Total time: ', 4.927024247288704, 9.31111989021301)
('****Preprocess time: ', 0.003055741310119629, 0.0031490683555603026)
('****Data time: ', 0.00029233598709106444, 0.00032019615173339844)
('****Fetch time: ', 6.726086139678955e-05, 7.605552673339844e-05)
('****Sort time: ', 0.0006514719724655152, 0.0006819367408752438)
****Stage 0 average time 0.00660412895679
****Stage 1 average time 0.00885259711742
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.982975483277
****DCGs @ 8: 0.971583305099
****DCGs @ 16: 0.949606855204
****DCGs @ 32: 0.924418637108
****DCGs @ 64: 0.879797807881
****Error : 0.360555664063
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.7795469761
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01143421447277069, 0.012086117267608642)
('****Total time: ', 4.393387427687645, 8.293978130817413)
('****Preprocess time: ', 0.003057996869087219, 0.0031690597534179688)
('****Data time: ', 0.00029233002662658694, 0.00032210350036621094)
('****Fetch time: ', 6.724441051483154e-05, 7.605552673339844e-05)
('****Sort time: ', 0.0006485432386398315, 0.0007009506225585938)
****Stage 0 average time 0.00657409727573
****Stage 1 average time 0.00892623174191
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983100251573
****DCGs @ 8: 0.971367405714
****DCGs @ 16: 0.949378746116
****DCGs @ 32: 0.924247826414
****DCGs @ 64: 0.879710772677
****Error : 0.36062890625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.4185390472
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.011650391817092896, 0.012697350978851316)
('****Total time: ', 4.133334752678871, 7.858649349212646)
('****Preprocess time: ', 0.0031330738067626954, 0.0032251238822937007)
('****Data time: ', 0.00032714223861694336, 0.00035691261291503906)
('****Fetch time: ', 7.001090049743652e-05, 7.414817810058594e-05)
('****Sort time: ', 0.0006516516208648681, 0.0007011890411376953)
****Stage 0 average time 0.00688537490368
****Stage 1 average time 0.00894689548016
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983344936861
****DCGs @ 8: 0.971494061257
****DCGs @ 16: 0.949459751436
****DCGs @ 32: 0.924583757675
****DCGs @ 64: 0.87992206671
****Error : 0.360552734375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.3581299782
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.011527082443237305, 0.012628495693206785)
('****Total time: ', 3.0817515938282014, 5.8236121892929065)
('****Preprocess time: ', 0.0031277263164520264, 0.003253984451293945)
('****Data time: ', 0.0003301496505737305, 0.0003559589385986328)
('****Fetch time: ', 6.835365295410157e-05, 7.392168045043939e-05)
('****Sort time: ', 0.0006630034446716309, 0.0006861686706542969)
****Stage 0 average time 0.00685226082802
****Stage 1 average time 0.00886405467987
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983181191933
****DCGs @ 8: 0.971611971613
****DCGs @ 16: 0.949558228281
****DCGs @ 32: 0.924449542187
****DCGs @ 64: 0.87976901252
****Error : 0.360518554687
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.268707037
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.011444391250610352, 0.012325298786163329)
('****Total time: ', 1.9584511947631835, 3.7915453672409054)
('****Preprocess time: ', 0.0031196924448013306, 0.003298306465148926)
('****Data time: ', 0.0003197199106216431, 0.00035027265548706035)
('****Fetch time: ', 6.7236065864563e-05, 7.224082946777344e-05)
('****Sort time: ', 0.0006419378519058228, 0.0006840348243713378)
****Stage 0 average time 0.00681309866905
****Stage 1 average time 0.00877987885475
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983244329234
****DCGs @ 8: 0.971546983555
****DCGs @ 16: 0.949550280931
****DCGs @ 32: 0.9244059084
****DCGs @ 64: 0.879782004326
****Error : 0.36064453125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.0874679089
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011394625067710877, 0.012334203720092772)
('****Total time: ', 0.9592628878355026, 1.7987204194068909)
('****Preprocess time: ', 0.0031120402812957765, 0.0032549381256103513)
('****Data time: ', 0.00031265902519226073, 0.00034809112548828125)
('****Fetch time: ', 6.690728664398194e-05, 7.486343383789062e-05)
('****Sort time: ', 0.0006412544250488281, 0.0006869316101074216)
****Stage 0 average time 0.00672540163994
****Stage 1 average time 0.00880208444595
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.982858468105
****DCGs @ 8: 0.971248779581
****DCGs @ 16: 0.949349173422
****DCGs @ 32: 0.924362461139
****DCGs @ 64: 0.879753800741
****Error : 0.360572265625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.7257781029
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.011545358419418335, 0.012293016910552979)
('****Total time: ', 0.02426193130016327, 0.0392488956451416)
('****Preprocess time: ', 0.0030916041135787965, 0.0032501220703125)
('****Data time: ', 0.00031550931930541995, 0.0003459453582763672)
('****Fetch time: ', 6.70546293258667e-05, 7.295608520507812e-05)
('****Sort time: ', 0.0006412204504013062, 0.0006850242614746091)
****Stage 0 average time 0.00676467120647
****Stage 1 average time 0.00889607572556
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983607646796
****DCGs @ 8: 0.971769148075
****DCGs @ 16: 0.949569334886
****DCGs @ 32: 0.924543694523
****DCGs @ 64: 0.879916455609
****Error : 0.360559570313
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.4679558277
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011471876740455628, 0.01284443140029907)
('****Total time: ', 0.01800022482872009, 0.022171318531036377)
('****Preprocess time: ', 0.0030272551774978636, 0.003138113021850586)
('****Data time: ', 0.00029325819015502927, 0.0003199577331542969)
('****Fetch time: ', 6.53369426727295e-05, 7.295608520507812e-05)
('****Sort time: ', 0.0006389628648757935, 0.0006880760192871094)
****Stage 0 average time 0.00659509682655
****Stage 1 average time 0.0089015930891
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983304343127
****DCGs @ 8: 0.971583270084
****DCGs @ 16: 0.949650725958
****DCGs @ 32: 0.924464645656
****DCGs @ 64: 0.87979440396
****Error : 0.360603515625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.8407280445
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.011628373861312866, 0.012892091274261473)
('****Total time: ', 0.017740833044052124, 0.019736123085021973)
('****Preprocess time: ', 0.0031036583185195922, 0.0033352017402648914)
('****Data time: ', 0.0003243082761764526, 0.0003550171852111816)
('****Fetch time: ', 6.932318210601806e-05, 7.390975952148438e-05)
('****Sort time: ', 0.0006492201089859009, 0.0006799697875976562)
****Stage 0 average time 0.00683362460136
****Stage 1 average time 0.00894125914574
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.982856961798
****DCGs @ 8: 0.971419653081
****DCGs @ 16: 0.949472188573
****DCGs @ 32: 0.924464176144
****DCGs @ 64: 0.879788643959
****Error : 0.360571289063
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.4815220833
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.0115453919172287, 0.012761485576629638)
('****Total time: ', 0.017414402723312378, 0.01902673244476318)
('****Preprocess time: ', 0.003055922627449036, 0.0032308220863342283)
('****Data time: ', 0.0003179336786270142, 0.0003552436828613281)
('****Fetch time: ', 6.754612922668458e-05, 7.224082946777344e-05)
('****Sort time: ', 0.0006367466449737548, 0.0006821155548095703)
****Stage 0 average time 0.00675109231472
****Stage 1 average time 0.00887244868279
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983296947905
****DCGs @ 8: 0.971412120669
****DCGs @ 16: 0.949426655023
****DCGs @ 32: 0.924319629691
****DCGs @ 64: 0.879736902144
****Error : 0.360561523437
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.7143750191
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.01163809096813202, 0.013125193119049066)
('****Total time: ', 0.017540918350219727, 0.019334268569946286)
('****Preprocess time: ', 0.0030773242712020875, 0.0032721161842346187)
('****Data time: ', 0.0003248186111450195, 0.0003559589385986328)
('****Fetch time: ', 6.805098056793212e-05, 7.295608520507812e-05)
('****Sort time: ', 0.0006378391981124877, 0.000698137283325195)
****Stage 0 average time 0.00680020081997
****Stage 1 average time 0.00894592320919
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 512])
****DCGs @ 4: 0.983518953313
****DCGs @ 8: 0.971588745492
****DCGs @ 16: 0.949522849929
****DCGs @ 32: 0.92446752874
****DCGs @ 64: 0.87996987104
****Error : 0.360591796875
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  10.8523068428
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.022195836067199708, 0.031160509586334224)
('****Total time: ', 4.20984818148613, 7.825978147983549)
('****Preprocess time: ', 0.004635517120361328, 0.0062699437141418455)
('****Data time: ', 0.0004541003704071045, 0.0005617260932922363)
('****Fetch time: ', 9.04378890991211e-05, 0.0001010894775390625)
('****Sort time: ', 0.0008946242332458496, 0.0011540055274963375)
****Stage 0 average time 0.0226814707518
****Stage 1 average time 0.00558904492855
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983597128165
****DCGs @ 8: 0.971633917201
****DCGs @ 16: 0.949387936657
****DCGs @ 32: 0.924480430623
****DCGs @ 64: 0.879928537583
****Error : 0.295215820312
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.9283280373
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.020356001377105713, 0.028357017040252674)
('****Total time: ', 3.865205402255058, 7.0995680451393115)
('****Preprocess time: ', 0.004311295747756958, 0.005760276317596435)
('****Data time: ', 0.0004487936496734619, 0.0005087971687316894)
('****Fetch time: ', 8.086347579956055e-05, 9.202957153320312e-05)
('****Sort time: ', 0.0009181298017501831, 0.0012041091918945307)
****Stage 0 average time 0.0204764903784
****Stage 1 average time 0.00563859367371
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.982975483277
****DCGs @ 8: 0.971615450782
****DCGs @ 16: 0.949568615338
****DCGs @ 32: 0.924386806959
****DCGs @ 64: 0.879812920401
****Error : 0.295211425781
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.0658321381
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01951507043838501, 0.024450731277465818)
('****Total time: ', 3.352070437669754, 6.150690197944639)
('****Preprocess time: ', 0.004168023467063904, 0.005339241027832031)
('****Data time: ', 0.00041532063484191894, 0.00048613548278808594)
('****Fetch time: ', 8.062899112701416e-05, 9.012222290039062e-05)
('****Sort time: ', 0.000963758111000061, 0.0012199878692626953)
****Stage 0 average time 0.0194165011644
****Stage 1 average time 0.00572630047798
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983016187805
****DCGs @ 8: 0.971354111679
****DCGs @ 16: 0.94937193184
****DCGs @ 32: 0.924284111027
****DCGs @ 64: 0.879707900001
****Error : 0.295217285156
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.0778470039
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.018717153191566468, 0.02200562953948974)
('****Total time: ', 2.869747856736183, 5.268813717365265)
('****Preprocess time: ', 0.004119914293289184, 0.004779577255249019)
('****Data time: ', 0.00040498602390289304, 0.0004639625549316406)
('****Fetch time: ', 7.662606239318847e-05, 8.511543273925781e-05)
('****Sort time: ', 0.0009590272903442383, 0.0012282967567443836)
****Stage 0 average time 0.018527805686
****Stage 1 average time 0.0057499011755
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983260873092
****DCGs @ 8: 0.971520664491
****DCGs @ 16: 0.949472874116
****DCGs @ 32: 0.92454761613
****DCGs @ 64: 0.879930815368
****Error : 0.295217285156
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.0439529419
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.01838173234462738, 0.021430754661560053)
('****Total time: ', 1.9050216248035432, 3.44430114030838)
('****Preprocess time: ', 0.004017637848854065, 0.00445113182067871)
('****Data time: ', 0.00039843785762786865, 0.00045013427734375)
('****Fetch time: ', 7.675623893737793e-05, 8.46505165100097e-05)
('****Sort time: ', 0.0009505072832107544, 0.0011668205261230469)
****Stage 0 average time 0.0181002060175
****Stage 1 average time 0.00572486555576
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983181191933
****DCGs @ 8: 0.971644117296
****DCGs @ 16: 0.949497092907
****DCGs @ 32: 0.924425742676
****DCGs @ 64: 0.87977180287
****Error : 0.295222167969
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.9984691143
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.018064527869224547, 0.02109609842300415)
('****Total time: ', 0.6700086363554001, 1.2839561581611623)
('****Preprocess time: ', 0.003990327596664429, 0.004374706745147703)
('****Data time: ', 0.0003965506553649902, 0.0004467964172363281)
('****Fetch time: ', 7.487618923187256e-05, 8.22901725769041e-05)
('****Sort time: ', 0.0009373130798339844, 0.001131784915924072)
****Stage 0 average time 0.0177871649265
****Stage 1 average time 0.00567643046379
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983160265466
****DCGs @ 8: 0.97153368952
****DCGs @ 16: 0.94956059575
****DCGs @ 32: 0.924459591449
****DCGs @ 64: 0.879799644188
****Error : 0.295197265625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.5863800049
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.018233558177947997, 0.0212184190750122)
('****Total time: ', 0.033903746843338016, 0.046961593627929676)
('****Preprocess time: ', 0.00400068199634552, 0.004644489288330076)
('****Data time: ', 0.00040539777278900146, 0.0004437088966369628)
('****Fetch time: ', 7.451212406158447e-05, 8.487701416015625e-05)
('****Sort time: ', 0.0009144798517227173, 0.0010751724243164055)
****Stage 0 average time 0.017936344862
****Stage 1 average time 0.00569228506088
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.982774404337
****DCGs @ 8: 0.971275382816
****DCGs @ 16: 0.949346069315
****DCGs @ 32: 0.924297474222
****DCGs @ 64: 0.879752089415
****Error : 0.295229003906
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.7092120647
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.018335466623306273, 0.02129094600677488)
('****Total time: ', 0.02792548096179962, 0.03536521196365356)
('****Preprocess time: ', 0.004057429075241089, 0.004806482791900632)
('****Data time: ', 0.00040408694744110106, 0.0004508495330810547)
('****Fetch time: ', 7.630765438079834e-05, 8.726119995117188e-05)
('****Sort time: ', 0.0009339262247085572, 0.0011057853698730469)
****Stage 0 average time 0.0179510899782
****Stage 1 average time 0.00585612654686
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983607646796
****DCGs @ 8: 0.971801293759
****DCGs @ 16: 0.949509270699
****DCGs @ 32: 0.92452189709
****DCGs @ 64: 0.879932030662
****Error : 0.295245117188
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.7669041157
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.019048473119735718, 0.023099136352539053)
('****Total time: ', 0.028384082555770875, 0.03618355989456177)
('****Preprocess time: ', 0.00414362645149231, 0.005073344707489013)
('****Data time: ', 0.0004177408218383789, 0.0004701972007751463)
('****Fetch time: ', 8.092248439788818e-05, 9.708404541015599e-05)
('****Sort time: ', 0.0009168740510940551, 0.001005029678344726)
****Stage 0 average time 0.0179953911304
****Stage 1 average time 0.00661224579811
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983220279359
****DCGs @ 8: 0.971569976049
****DCGs @ 16: 0.949658916341
****DCGs @ 32: 0.924496134145
****DCGs @ 64: 0.879799973851
****Error : 0.295224121094
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.8454530239
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.018213530898094177, 0.021337175369262697)
('****Total time: ', 0.025845632910728455, 0.029641413688659666)
('****Preprocess time: ', 0.004036296367645264, 0.004813957214355468)
('****Data time: ', 0.00041307926177978514, 0.0004608631134033203)
('****Fetch time: ', 7.778143882751464e-05, 9.108781814575189e-05)
('****Sort time: ', 0.0009226129055023193, 0.000983273983001709)
****Stage 0 average time 0.0175372258425
****Stage 1 average time 0.00612607502937
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.98277289803
****DCGs @ 8: 0.971446256315
****DCGs @ 16: 0.94944831954
****DCGs @ 32: 0.924429496925
****DCGs @ 64: 0.879802707321
****Error : 0.295211914063
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.5203418732
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.017978348016738893, 0.020954859256744385)
('****Total time: ', 0.025344297766685484, 0.028847134113311766)
('****Preprocess time: ', 0.004031680464744568, 0.004736530780792235)
('****Data time: ', 0.00041412770748138427, 0.00045491456985473626)
('****Fetch time: ', 7.68892765045166e-05, 8.825063705444316e-05)
('****Sort time: ', 0.0009321019649505615, 0.0011260509490966797)
****Stage 0 average time 0.0174895201921
****Stage 1 average time 0.00594362723827
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983296947905
****DCGs @ 8: 0.971448142145
****DCGs @ 16: 0.949408996482
****DCGs @ 32: 0.924288823728
****DCGs @ 64: 0.879758885856
****Error : 0.295225097656
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  31.7070639133
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.01760528242588043, 0.020355033874511718)
('****Total time: ', 0.024852840781211853, 0.027939236164093016)
('****Preprocess time: ', 0.00396643340587616, 0.004449534416198727)
('****Data time: ', 0.0004051380157470703, 0.0004477620124816894)
('****Fetch time: ', 7.705533504486083e-05, 8.225440979003906e-05)
('****Sort time: ', 0.000915359616279602, 0.000963020324707031)
****Stage 0 average time 0.0171592037678
****Stage 1 average time 0.00581006503105
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983434889544
****DCGs @ 8: 0.971575451457
****DCGs @ 16: 0.949510367344
****DCGs @ 32: 0.924477782559
****DCGs @ 64: 0.879959333044
****Error : 0.295213378906
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  3.01796078682
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03908119976520538, 0.05329190492630004)
('****Total time: ', 0.19802098572254181, 0.27705928087234494)
('****Preprocess time: ', 0.005270060658454895, 0.007780575752258298)
('****Data time: ', 0.0006048082113265991, 0.0008200764656066886)
('****Fetch time: ', 9.669327735900878e-05, 0.00011779069900512689)
('****Sort time: ', 0.001145931601524353, 0.0016723513603210446)
****Stage 0 average time 0.0235956045389
****Stage 1 average time 0.022603088975
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983597128165
****DCGs @ 8: 0.971633917201
****DCGs @ 16: 0.949387936657
****DCGs @ 32: 0.924480430623
****DCGs @ 64: 0.879928537583
****Error : 0.295215820312
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  3.84779191017
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.036484924077987674, 0.04774543046951294)
('****Total time: ', 0.04690604317188263, 0.060207080841064436)
('****Preprocess time: ', 0.005067211985588074, 0.007072901725769039)
('****Data time: ', 0.0005734052658081055, 0.0006840229034423828)
('****Fetch time: ', 8.382117748260498e-05, 9.083747863769531e-05)
('****Sort time: ', 0.0010450307130813598, 0.001466071605682373)
****Stage 0 average time 0.0227152159214
****Stage 1 average time 0.0205391772985
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.982975483277
****DCGs @ 8: 0.971615450782
****DCGs @ 16: 0.949568615338
****DCGs @ 32: 0.924386806959
****DCGs @ 64: 0.879812920401
****Error : 0.295211425781
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.79536890984
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03340608072280884, 0.042908298969268795)
('****Total time: ', 0.04302501142024994, 0.05464422702789306)
('****Preprocess time: ', 0.004728446245193482, 0.006528162956237792)
('****Data time: ', 0.0005384931564331054, 0.0006248950958251953)
('****Fetch time: ', 7.247984409332275e-05, 8.177757263183594e-05)
('****Sort time: ', 0.0010240715742111206, 0.001388907432556152)
****Stage 0 average time 0.0209712700844
****Stage 1 average time 0.0187983014584
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983016187805
****DCGs @ 8: 0.971354111679
****DCGs @ 16: 0.94937193184
****DCGs @ 32: 0.924284111027
****DCGs @ 64: 0.879707900001
****Error : 0.295217285156
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.75989294052
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.03176120674610138, 0.040117669105529774)
('****Total time: ', 0.040552961349487306, 0.05008995532989501)
('****Preprocess time: ', 0.00451773202419281, 0.0059739351272583)
('****Data time: ', 0.0005227856636047364, 0.0006039142608642578)
('****Fetch time: ', 6.923234462738038e-05, 7.822513580322253e-05)
('****Sort time: ', 0.000993543267250061, 0.0013351798057556151)
****Stage 0 average time 0.0198455774784
****Stage 1 average time 0.0180189225674
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983260873092
****DCGs @ 8: 0.971520664491
****DCGs @ 16: 0.949472874116
****DCGs @ 32: 0.92454761613
****DCGs @ 64: 0.879930815368
****Error : 0.295217285156
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.85310506821
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.03139560687541962, 0.03931165933609008)
('****Total time: ', 0.03995114541053772, 0.04884872436523435)
('****Preprocess time: ', 0.004544596433639527, 0.006277513504028319)
('****Data time: ', 0.0005207786560058594, 0.0006000995635986328)
('****Fetch time: ', 6.826567649841309e-05, 7.891654968261719e-05)
('****Sort time: ', 0.0009748766422271729, 0.0012342453002929677)
****Stage 0 average time 0.0198241910934
****Stage 1 average time 0.0176799331903
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983181191933
****DCGs @ 8: 0.971644117296
****DCGs @ 16: 0.949497092907
****DCGs @ 32: 0.924425742676
****DCGs @ 64: 0.87977180287
****Error : 0.295222167969
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.83210086823
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.029563735961914063, 0.035964024066925046)
('****Total time: ', 0.037848727226257324, 0.04487814903259276)
('****Preprocess time: ', 0.004335935115814209, 0.005547297000885009)
('****Data time: ', 0.0004886401891708375, 0.0005578994750976562)
('****Fetch time: ', 6.477689743041993e-05, 7.295608520507812e-05)
('****Sort time: ', 0.0009716744422912598, 0.001176154613494873)
****Stage 0 average time 0.0187198719978
****Stage 1 average time 0.0167048906088
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983160265466
****DCGs @ 8: 0.97153368952
****DCGs @ 16: 0.94956059575
****DCGs @ 32: 0.924459591449
****DCGs @ 64: 0.879799644188
****Error : 0.295197265625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.8028590679
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.02853148674964905, 0.0337445020675659)
('****Total time: ', 0.03668564093112946, 0.042687892913818345)
('****Preprocess time: ', 0.004220437645912171, 0.005097532272338864)
('****Data time: ', 0.0004826455116271973, 0.0005469322204589844)
('****Fetch time: ', 5.9772610664367675e-05, 7.009506225585938e-05)
('****Sort time: ', 0.0009713788032531738, 0.0011560916900634766)
****Stage 0 average time 0.0181380423307
****Stage 1 average time 0.0161276789904
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.982774404337
****DCGs @ 8: 0.971275382816
****DCGs @ 16: 0.949346069315
****DCGs @ 32: 0.924297474222
****DCGs @ 64: 0.879752089415
****Error : 0.295229003906
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.772395134
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.02822813045978546, 0.033469855785369866)
('****Total time: ', 0.03634224212169647, 0.042038214206695554)
('****Preprocess time: ', 0.004197595000267029, 0.004973185062408446)
('****Data time: ', 0.0004836972951889038, 0.0005438327789306641)
('****Fetch time: ', 6.085383892059326e-05, 6.985664367675781e-05)
('****Sort time: ', 0.0009765123128890991, 0.0010782241821289057)
****Stage 0 average time 0.017990324378
****Stage 1 average time 0.015956464529
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983607646796
****DCGs @ 8: 0.971801293759
****DCGs @ 16: 0.949509270699
****DCGs @ 32: 0.92452189709
****DCGs @ 64: 0.879932030662
****Error : 0.295245117188
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.7621090412
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.027581677198410034, 0.03111321926116943)
('****Total time: ', 0.0355080349445343, 0.03940044641494749)
('****Preprocess time: ', 0.0041368954181671145, 0.004457151889801024)
('****Data time: ', 0.00048329925537109376, 0.000535738468170166)
('****Fetch time: ', 5.906820297241211e-05, 6.794929504394531e-05)
('****Sort time: ', 0.0009596016407012939, 0.0010390758514404294)
****Stage 0 average time 0.0176109461784
****Stage 1 average time 0.0156095955372
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983220279359
****DCGs @ 8: 0.971569976049
****DCGs @ 16: 0.949658916341
****DCGs @ 32: 0.924496134145
****DCGs @ 64: 0.879799973851
****Error : 0.295224121094
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.9831690788
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.027437167644500732, 0.03170832395553588)
('****Total time: ', 0.03541591656208038, 0.04033068418502807)
('****Preprocess time: ', 0.004140299916267395, 0.004552114009857173)
('****Data time: ', 0.0004789654016494751, 0.0005350232124328613)
('****Fetch time: ', 5.949795246124268e-05, 6.67572021484375e-05)
('****Sort time: ', 0.0009533610343933106, 0.001099836826324463)
****Stage 0 average time 0.0174246579409
****Stage 1 average time 0.0156446340084
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.98277289803
****DCGs @ 8: 0.971446256315
****DCGs @ 16: 0.94944831954
****DCGs @ 32: 0.924429496925
****DCGs @ 64: 0.879802707321
****Error : 0.295211914063
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.7407879829
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.027032153964042665, 0.03157856464385986)
('****Total time: ', 0.035025775671005246, 0.0401192307472229)
('****Preprocess time: ', 0.004133892178535462, 0.0045291900634765615)
('****Data time: ', 0.00047220873832702636, 0.0005297780036926269)
('****Fetch time: ', 5.8068156242370604e-05, 6.607770919799785e-05)
('****Sort time: ', 0.0009642900228500367, 0.0010680317878723135)
****Stage 0 average time 0.0172588921785
****Stage 1 average time 0.0154017208815
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983296947905
****DCGs @ 8: 0.971448142145
****DCGs @ 16: 0.949408996482
****DCGs @ 32: 0.924288823728
****DCGs @ 64: 0.879758885856
****Error : 0.295225097656
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.8372480869
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.0265476199388504, 0.030519056320190422)
('****Total time: ', 0.03438368928432465, 0.03854144811630249)
('****Preprocess time: ', 0.004104825496673584, 0.004516375064849852)
('****Data time: ', 0.00047522687911987307, 0.0005269169807434081)
('****Fetch time: ', 5.7075023651123044e-05, 6.413459777832031e-05)
('****Sort time: ', 0.0009605735540390015, 0.0010779380798339841)
****Stage 0 average time 0.0169939488173
****Stage 1 average time 0.0151513720751
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983434889544
****DCGs @ 8: 0.971575451457
****DCGs @ 16: 0.949510367344
****DCGs @ 32: 0.924477782559
****DCGs @ 64: 0.879959333044
****Error : 0.295213378906
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  14.0397019386
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017454487085342408, 0.021169805526733396)
('****Total time: ', 6.039704301714897, 11.402544546127318)
('****Preprocess time: ', 0.004011292457580567, 0.004598009586334228)
('****Data time: ', 0.0004039226770401001, 0.0004439353942871094)
('****Fetch time: ', 7.862377166748047e-05, 8.702278137207031e-05)
('****Sort time: ', 0.0009405349493026734, 0.0010307550430297845)
****Stage 0 average time 0.00727024054527
****Stage 1 average time 0.0156186203957
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983597128165
****DCGs @ 8: 0.971633917201
****DCGs @ 16: 0.949387936657
****DCGs @ 32: 0.924480430623
****DCGs @ 64: 0.879928540596
****Error : 0.295215820312
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.8781628609
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.017867419838905333, 0.021804738044738765)
('****Total time: ', 5.402449678659439, 10.275304555892943)
('****Preprocess time: ', 0.003937215566635132, 0.004188835620880127)
('****Data time: ', 0.0003952744007110596, 0.0004360675811767578)
('****Fetch time: ', 7.747781276702881e-05, 8.58306884765625e-05)
('****Sort time: ', 0.0009366896152496338, 0.0009851455688476562)
****Stage 0 average time 0.00720700466633
****Stage 1 average time 0.0160070725679
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.982975483277
****DCGs @ 8: 0.971615450782
****DCGs @ 16: 0.949568615338
****DCGs @ 32: 0.924386806959
****DCGs @ 64: 0.879812895741
****Error : 0.295211425781
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.7816700935
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017575728058815004, 0.020864999294281004)
('****Total time: ', 4.818262956023216, 9.150706338882445)
('****Preprocess time: ', 0.003943155288696289, 0.004286396503448485)
('****Data time: ', 0.00039736437797546385, 0.00044398307800292943)
('****Fetch time: ', 7.695317268371582e-05, 8.630752563476562e-05)
('****Sort time: ', 0.0009278221130371094, 0.000978720188140869)
****Stage 0 average time 0.00716479301453
****Stage 1 average time 0.0157562299967
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983016187805
****DCGs @ 8: 0.971354111679
****DCGs @ 16: 0.94937193184
****DCGs @ 32: 0.924284111027
****DCGs @ 64: 0.879707903014
****Error : 0.295217285156
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.7833960056
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.01747372603416443, 0.02029063701629638)
('****Total time: ', 4.231937347650528, 8.078298497200011)
('****Preprocess time: ', 0.003912547469139099, 0.004126262664794921)
('****Data time: ', 0.0003960223197937012, 0.00043487548828125)
('****Fetch time: ', 7.63622522354126e-05, 8.416175842285156e-05)
('****Sort time: ', 0.0009297598600387573, 0.0009920954704284667)
****Stage 0 average time 0.00715795087814
****Stage 1 average time 0.0156304670572
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983260873092
****DCGs @ 8: 0.971520664491
****DCGs @ 16: 0.949472874116
****DCGs @ 32: 0.92454761613
****DCGs @ 64: 0.879930790708
****Error : 0.295217285156
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.6943621635
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.01726166784763336, 0.019516098499298095)
('****Total time: ', 3.188498904466629, 6.036178994178772)
('****Preprocess time: ', 0.00390843141078949, 0.004163074493408202)
('****Data time: ', 0.0003888760805130005, 0.0004329800605773925)
('****Fetch time: ', 7.612717151641846e-05, 8.511543273925781e-05)
('****Sort time: ', 0.0009498568773269653, 0.0011389851570129392)
****Stage 0 average time 0.0071221344471
****Stage 1 average time 0.0154628249407
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983181191933
****DCGs @ 8: 0.971644117296
****DCGs @ 16: 0.949497092907
****DCGs @ 32: 0.924425742676
****DCGs @ 64: 0.879771781223
****Error : 0.295222167969
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.5996129513
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.017114223480224608, 0.019520437717437743)
('****Total time: ', 2.0839229828119277, 4.023468577861785)
('****Preprocess time: ', 0.0038952107429504395, 0.004169952869415283)
('****Data time: ', 0.000383757472038269, 0.00042819976806640625)
('****Fetch time: ', 7.450270652770997e-05, 8.20159912109375e-05)
('****Sort time: ', 0.0009616228342056274, 0.001202929019927978)
****Stage 0 average time 0.00709221935272
****Stage 1 average time 0.0153370978832
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983160265466
****DCGs @ 8: 0.97153368952
****DCGs @ 16: 0.94956059575
****DCGs @ 32: 0.924459591449
****DCGs @ 64: 0.879799647201
****Error : 0.295197265625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.667361021
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017122162938117982, 0.019483137130737304)
('****Total time: ', 1.1429881323575974, 2.206769621372223)
('****Preprocess time: ', 0.0038935343027114867, 0.0041368484497070306)
('****Data time: ', 0.0003872225284576416, 0.00043107271194458)
('****Fetch time: ', 7.504963874816895e-05, 8.392333984375e-05)
('****Sort time: ', 0.0009565873146057129, 0.0012121200561523438)
****Stage 0 average time 0.00711808037758
****Stage 1 average time 0.0153164763451
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.982774404337
****DCGs @ 8: 0.971275382816
****DCGs @ 16: 0.949346069315
****DCGs @ 32: 0.924297474222
****DCGs @ 64: 0.879752064756
****Error : 0.295229003906
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.7967860699
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.017061383485794068, 0.019040822982788086)
('****Total time: ', 0.1285459965467453, 0.30664232969284055)
('****Preprocess time: ', 0.003879341959953308, 0.004091989994049072)
('****Data time: ', 0.00038705062866210935, 0.00042891502380371094)
('****Fetch time: ', 7.521426677703857e-05, 8.296966552734375e-05)
('****Sort time: ', 0.0009326280355453491, 0.001087284088134765)
****Stage 0 average time 0.00710968542099
****Stage 1 average time 0.0152259329557
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983607646796
****DCGs @ 8: 0.971801293759
****DCGs @ 16: 0.949509270699
****DCGs @ 32: 0.92452189709
****DCGs @ 64: 0.879932009015
****Error : 0.295245117188
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.6625878811
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01729416573047638, 0.01934657096862793)
('****Total time: ', 0.025822638750076295, 0.031138741970062243)
('****Preprocess time: ', 0.003871546745300293, 0.004069828987121582)
('****Data time: ', 0.00039066994190216066, 0.00043393373489379876)
('****Fetch time: ', 7.626879215240478e-05, 8.296966552734375e-05)
('****Sort time: ', 0.0009410516023635865, 0.0011659145355224607)
****Stage 0 average time 0.00717918860912
****Stage 1 average time 0.0153945142031
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983220279359
****DCGs @ 8: 0.971569976049
****DCGs @ 16: 0.949658916341
****DCGs @ 32: 0.924496134145
****DCGs @ 64: 0.879799976864
****Error : 0.295224121094
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.7252559662
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.01738940966129303, 0.019931221008300783)
('****Total time: ', 0.024747380018234254, 0.02795429229736328)
('****Preprocess time: ', 0.0039027661085128786, 0.004323101043701166)
('****Data time: ', 0.00039664041996002197, 0.0004451274871826172)
('****Fetch time: ', 7.772529125213622e-05, 8.511543273925781e-05)
('****Sort time: ', 0.0009487907886505127, 0.0011650323867797845)
****Stage 0 average time 0.00727366089821
****Stage 1 average time 0.0154416713715
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.98277289803
****DCGs @ 8: 0.971446256315
****DCGs @ 16: 0.94944831954
****DCGs @ 32: 0.924429496925
****DCGs @ 64: 0.879802682661
****Error : 0.295211914063
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.4880461693
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.01714739227294922, 0.019429123401641844)
('****Total time: ', 0.02427451193332672, 0.02710515260696411)
('****Preprocess time: ', 0.003800653338432312, 0.004049098491668701)
('****Data time: ', 0.00038538992404937747, 0.00044083595275878906)
('****Fetch time: ', 7.651686668395996e-05, 8.296966552734375e-05)
('****Sort time: ', 0.0009198511838912964, 0.0010031223297119135)
****Stage 0 average time 0.00705758237839
****Stage 1 average time 0.0152722212076
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983296947905
****DCGs @ 8: 0.971448142145
****DCGs @ 16: 0.949408996482
****DCGs @ 32: 0.924288823728
****DCGs @ 64: 0.879758864209
****Error : 0.295225097656
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  31.8620429039
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.017053038120269776, 0.0191832423210144)
('****Total time: ', 0.024378459215164183, 0.02681924104690552)
('****Preprocess time: ', 0.003846747040748596, 0.004091346263885498)
('****Data time: ', 0.00039667916297912595, 0.0004489541053771972)
('****Fetch time: ', 7.59897232055664e-05, 8.227825164794909e-05)
('****Sort time: ', 0.0009228218793869018, 0.0009751319885253906)
****Stage 0 average time 0.00716091561317
****Stage 1 average time 0.0151343603134
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [2048, 1024])
****DCGs @ 4: 0.983434889544
****DCGs @ 8: 0.971575451457
****DCGs @ 16: 0.949510367344
****DCGs @ 32: 0.924477782559
****DCGs @ 64: 0.879959336057
****Error : 0.295213378906
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  8.18058300018
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.032594142198562624, 0.047133648395538325)
('****Total time: ', 2.6291990467309954, 4.385624885559081)
('****Preprocess time: ', 0.0060215617418289185, 0.008936381340026854)
('****Data time: ', 0.0005336843729019165, 0.0006709218025207519)
('****Fetch time: ', 9.296882152557373e-05, 0.00011897087097167969)
('****Sort time: ', 0.0005877835750579834, 0.0007762551307678212)
****Stage 0 average time 0.0358716078997
****Stage 1 average time 0.00395853281021
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.79251694679
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.028712064623832703, 0.04142150878906249)
('****Total time: ', 1.8857279987335205, 3.308898913860321)
('****Preprocess time: ', 0.005413393378257751, 0.008409130573272704)
('****Data time: ', 0.0004964778423309326, 0.0006000995635986328)
('****Fetch time: ', 8.121061325073243e-05, 9.703636169433594e-05)
('****Sort time: ', 0.000599047064781189, 0.000757074356079101)
****Stage 0 average time 0.0315020717382
****Stage 1 average time 0.00380012178421
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.56462907791
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.025873220920562743, 0.034219622611999505)
('****Total time: ', 1.338592658162117, 2.3858761310577394)
('****Preprocess time: ', 0.0048503285646438596, 0.00708012580871582)
('****Data time: ', 0.00046893680095672606, 0.0005409717559814453)
('****Fetch time: ', 7.965075969696045e-05, 8.797645568847656e-05)
('****Sort time: ', 0.0005976667404174804, 0.0007231593132019041)
****Stage 0 average time 0.0281594370604
****Stage 1 average time 0.00371036672592
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.5295279026
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.02544019341468811, 0.031217145919799693)
('****Total time: ', 0.7614250798225403, 1.4504311203956604)
('****Preprocess time: ', 0.004731222748756409, 0.006349241733551024)
('****Data time: ', 0.00045584690570831297, 0.0005319118499755859)
('****Fetch time: ', 7.745075225830078e-05, 8.702278137207031e-05)
('****Sort time: ', 0.0006225306987762451, 0.0007488727569580078)
****Stage 0 average time 0.0276078776121
****Stage 1 average time 0.00371936690807
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.36238098145
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.02521740794181824, 0.02930935621261594)
('****Total time: ', 0.03978722655773163, 0.05472165346145627)
('****Preprocess time: ', 0.004591051578521728, 0.005920100212097155)
('****Data time: ', 0.0004483044147491455, 0.0005099892616271972)
('****Fetch time: ', 7.616174221038818e-05, 8.821487426757812e-05)
('****Sort time: ', 0.000584705114364624, 0.000673067569732666)
****Stage 0 average time 0.027176199913
****Stage 1 average time 0.00374143087864
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.2121400833
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.025288524985313414, 0.03147110939025878)
('****Total time: ', 0.034710412621498106, 0.04306499958038327)
('****Preprocess time: ', 0.004597583293914795, 0.00622493028640747)
('****Data time: ', 0.0004454343318939209, 0.0005140304565429688)
('****Fetch time: ', 7.652902603149414e-05, 8.702278137207031e-05)
('****Sort time: ', 0.0005671323537826538, 0.0006389975547790525)
****Stage 0 average time 0.027237024188
****Stage 1 average time 0.00373817980289
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.3692519665
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.025341288924217224, 0.03127568960189816)
('****Total time: ', 0.03440158319473267, 0.0425199508666992)
('****Preprocess time: ', 0.004584274768829346, 0.006028211116790772)
('****Data time: ', 0.00045309793949127196, 0.000512862205505371)
('****Fetch time: ', 7.610321044921875e-05, 9.107589721679688e-05)
('****Sort time: ', 0.0006149476766586304, 0.0006690025329589844)
****Stage 0 average time 0.0271958042383
****Stage 1 average time 0.00387390828133
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.403044939
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.025426554083824156, 0.03136359453201293)
('****Total time: ', 0.034102686524391176, 0.04153270721435546)
('****Preprocess time: ', 0.004626330614089966, 0.006258678436279287)
('****Data time: ', 0.00044631779193878175, 0.0005092978477478025)
('****Fetch time: ', 7.604289054870606e-05, 9.202957153320312e-05)
('****Sort time: ', 0.0005888311862945557, 0.0006609439849853513)
****Stage 0 average time 0.0271933633089
****Stage 1 average time 0.00397071325779
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.1221320629
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.02460695481300354, 0.029502463340759275)
('****Total time: ', 0.0324553611278534, 0.03793579339981077)
('****Preprocess time: ', 0.004473980545997619, 0.0047719478607177734)
('****Data time: ', 0.0004478914737701416, 0.0005178451538085938)
('****Fetch time: ', 7.5783371925354e-05, 8.797645568847656e-05)
('****Sort time: ', 0.0005925735235214234, 0.0006699681282043456)
****Stage 0 average time 0.0262506843805
****Stage 1 average time 0.00394649934769
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.2515711784
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.025169406294822692, 0.03028336763381958)
('****Total time: ', 0.03300101602077484, 0.03869050741195679)
('****Preprocess time: ', 0.004566946268081665, 0.005131006240844716)
('****Data time: ', 0.00045911920070648194, 0.0005300402641296385)
('****Fetch time: ', 7.728660106658936e-05, 9.180307388305658e-05)
('****Sort time: ', 0.0005919785499572754, 0.0006537675857543944)
****Stage 0 average time 0.0267735266685
****Stage 1 average time 0.00409121024609
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.3013370037
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.024963465452194213, 0.029125058650970457)
('****Total time: ', 0.03283726179599762, 0.037582194805145255)
('****Preprocess time: ', 0.0045044264793396, 0.005203473567962644)
('****Data time: ', 0.00045116066932678224, 0.0005040287971496581)
('****Fetch time: ', 7.590699195861817e-05, 8.797645568847656e-05)
('****Sort time: ', 0.000590880036354065, 0.0006270408630371094)
****Stage 0 average time 0.026728020668
****Stage 1 average time 0.00385781896114
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  32.4049789906
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.02452751314640045, 0.02939878702163696)
('****Total time: ', 0.032082811951637265, 0.037258362770080565)
('****Preprocess time: ', 0.004429874658584595, 0.004913055896759032)
('****Data time: ', 0.000449495792388916, 0.0005138039588928222)
('****Fetch time: ', 7.519626617431641e-05, 8.702278137207031e-05)
('****Sort time: ', 0.00059640371799469, 0.0006427884101867675)
****Stage 0 average time 0.0262108598948
****Stage 1 average time 0.00386762368679
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  3.58962011337
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.0269567586183548, 0.03198049068450926)
('****Total time: ', 0.2927832499742508, 0.5844732642173767)
('****Preprocess time: ', 0.004607200741767883, 0.005404901504516597)
('****Data time: ', 0.0005146702527999878, 0.0006180405616760251)
('****Fetch time: ', 6.276893615722656e-05, 7.224082946777344e-05)
('****Sort time: ', 0.0006200907230377198, 0.0008270025253295889)
****Stage 0 average time 0.0277870270014
****Stage 1 average time 0.00497446227074
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.43427991867
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.027932407259941103, 0.03716748952865596)
('****Total time: ', 0.0374729608297348, 0.04873213768005369)
('****Preprocess time: ', 0.004844951629638672, 0.007263290882110593)
('****Data time: ', 0.0005168541669845581, 0.0006201267242431641)
('****Fetch time: ', 6.355190277099609e-05, 7.295608520507812e-05)
('****Sort time: ', 0.0005990012884140015, 0.0007501602172851557)
****Stage 0 average time 0.029020812273
****Stage 1 average time 0.00493595397472
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.2110710144
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.026372384428977966, 0.03259588479995727)
('****Total time: ', 0.0346021488904953, 0.042018318176269505)
('****Preprocess time: ', 0.004584493041038513, 0.006257081031799315)
('****Data time: ', 0.0004919980764389038, 0.0005650520324707031)
('****Fetch time: ', 5.935931205749512e-05, 6.699562072753906e-05)
('****Sort time: ', 0.0006103814840316773, 0.00074009895324707)
****Stage 0 average time 0.0275666151047
****Stage 1 average time 0.00455200123787
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  6.28600597382
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.027167656183242798, 0.033953380584716794)
('****Total time: ', 0.035683504343032836, 0.043777883052825914)
('****Preprocess time: ', 0.004745838522911072, 0.006666457653045651)
('****Data time: ', 0.000513004183769226, 0.0006060957908630369)
('****Fetch time: ', 5.804669857025146e-05, 6.890296936035156e-05)
('****Sort time: ', 0.0005956829786300659, 0.0006928443908691406)
****Stage 0 average time 0.0282520428896
****Stage 1 average time 0.00482818567753
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.4591460228
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.025220017313957215, 0.02976133823394775)
('****Total time: ', 0.03331060516834259, 0.03874504566192626)
('****Preprocess time: ', 0.004437762022018433, 0.005792307853698728)
('****Data time: ', 0.0004724956750869751, 0.0005419254302978516)
('****Fetch time: ', 5.072987079620361e-05, 6.103515625e-05)
('****Sort time: ', 0.000593582034111023, 0.0006938576698303219)
****Stage 0 average time 0.0265155311823
****Stage 1 average time 0.00425905573368
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.4844031334
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.025195122957229615, 0.029973280429840085)
('****Total time: ', 0.033502665162086484, 0.039598488807678224)
('****Preprocess time: ', 0.004503037691116333, 0.006189966201782222)
('****Data time: ', 0.0004735722541809082, 0.0005481243133544922)
('****Fetch time: ', 5.168890953063965e-05, 6.103515625e-05)
('****Sort time: ', 0.0005849263668060303, 0.0006581306457519526)
****Stage 0 average time 0.0262147049904
****Stage 1 average time 0.00459364318848
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.2129459381
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.024108463048934936, 0.02791643142700194)
('****Total time: ', 0.03191580021381378, 0.03673309087753294)
('****Preprocess time: ', 0.004375722885131836, 0.004930317401885985)
('****Data time: ', 0.0004631024599075317, 0.0005350112915039062)
('****Fetch time: ', 5.1500678062438965e-05, 5.698204040527344e-05)
('****Sort time: ', 0.0005746294260025025, 0.0006412506103515617)
****Stage 0 average time 0.0254446895123
****Stage 1 average time 0.00412872898579
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.5413711071
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.023361706495285035, 0.026124668121337888)
('****Total time: ', 0.031176862001419066, 0.03434509038925169)
('****Preprocess time: ', 0.004284008145332336, 0.004559135437011718)
('****Data time: ', 0.00045847976207733155, 0.0005331158638000488)
('****Fetch time: ', 4.6985983848571776e-05, 5.41329383850097e-05)
('****Sort time: ', 0.0005657734870910644, 0.0006239414215087891)
****Stage 0 average time 0.0246603428125
****Stage 1 average time 0.0040566110611
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.5225229263
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.02333193838596344, 0.027135229110717776)
('****Total time: ', 0.031160172939300537, 0.03534332513809204)
('****Preprocess time: ', 0.00433042848110199, 0.00471225976943969)
('****Data time: ', 0.00046143960952758787, 0.000528144836425781)
('****Fetch time: ', 4.721665382385254e-05, 5.484819412231439e-05)
('****Sort time: ', 0.0005695661306381226, 0.0006258606910705566)
****Stage 0 average time 0.0246836023331
****Stage 1 average time 0.00405698692799
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.7168879509
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.022932727575302125, 0.026141142845153807)
('****Total time: ', 0.030772112607955933, 0.03441530466079711)
('****Preprocess time: ', 0.0042853676080703736, 0.0045791625976562495)
('****Data time: ', 0.0004564659595489502, 0.0005309581756591797)
('****Fetch time: ', 4.674553871154785e-05, 5.316734313964844e-05)
('****Sort time: ', 0.0005890491008758545, 0.0006358742713928222)
****Stage 0 average time 0.0242102698088
****Stage 1 average time 0.00410008597374
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.5098659992
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.022916252851486206, 0.026544606685638412)
('****Total time: ', 0.030759031057357788, 0.034877109527587886)
('****Preprocess time: ', 0.004292562961578369, 0.004599416255950927)
('****Data time: ', 0.0004602322578430176, 0.0005316853523254394)
('****Fetch time: ', 4.8365116119384767e-05, 5.507469177246094e-05)
('****Sort time: ', 0.0005771604776382447, 0.0006291866302490234)
****Stage 0 average time 0.024225992918
****Stage 1 average time 0.00406858074665
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  32.6626548767
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.02251087307929993, 0.025889968872070308)
('****Total time: ', 0.030282018899917603, 0.03414512872695922)
('****Preprocess time: ', 0.0042671414613723755, 0.004582881927490234)
('****Data time: ', 0.000457749605178833, 0.0005261898040771484)
('****Fetch time: ', 4.707157611846924e-05, 5.316734313964844e-05)
('****Sort time: ', 0.0005713654756546021, 0.0006170392036437988)
****Stage 0 average time 0.0238806189299
****Stage 1 average time 0.00397358226776
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  18.0259680748
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008471170902252197, 0.00922983884811401)
('****Total time: ', 7.807020524978638, 14.764603841304778)
('****Preprocess time: ', 0.0038033437728881834, 0.0039160728454589845)
('****Data time: ', 0.0003165379762649536, 0.0003330707550048828)
('****Fetch time: ', 9.870946407318115e-05, 0.00010514259338378906)
('****Sort time: ', 0.0005491678714752197, 0.0005772471427917479)
****Stage 0 average time 0.00920678067207
****Stage 1 average time 0.00403214931488
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.9458940029
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.00840604317188263, 0.00886707305908203)
('****Total time: ', 7.213675184488297, 13.695681595802306)
('****Preprocess time: ', 0.0037833743095397948, 0.0038890838623046875)
('****Data time: ', 0.0003146347999572754, 0.00032806396484375)
('****Fetch time: ', 9.887909889221191e-05, 0.00010514259338378906)
('****Sort time: ', 0.0005462908744812012, 0.0005729198455810547)
****Stage 0 average time 0.00916836798191
****Stage 1 average time 0.00398085427284
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.473512888
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.007752013206481933, 0.008201897144317627)
('****Total time: ', 5.950117891550064, 11.280306518077849)
('****Preprocess time: ', 0.0037333706617355346, 0.0038211822509765622)
('****Data time: ', 0.00029120206832885745, 0.00030803680419921875)
('****Fetch time: ', 0.00013205254077911378, 0.000141143798828125)
('****Sort time: ', 0.0005457395315170288, 0.0005702972412109375)
****Stage 0 average time 0.00844136202335
****Stage 1 average time 0.00401301598549
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.8560731411
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.008399163007736205, 0.00882798433303833)
('****Total time: ', 6.099004918336869, 11.649984633922575)
('****Preprocess time: ', 0.0037683807611465455, 0.0038399696350097656)
('****Data time: ', 0.00031677258014678954, 0.00033092498779296875)
('****Fetch time: ', 0.00010096979141235351, 0.00011183023452758783)
('****Sort time: ', 0.000545889139175415, 0.0005688667297363281)
****Stage 0 average time 0.0091239490509
****Stage 1 average time 0.00400722622871
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.8744559288
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.008410104274749756, 0.008838939666748046)
('****Total time: ', 5.077085326910019, 9.645032358169555)
('****Preprocess time: ', 0.0037814775705337523, 0.00386815071105957)
('****Data time: ', 0.00031135284900665283, 0.00032711029052734375)
('****Fetch time: ', 0.00010042250156402588, 0.00010800361633300781)
('****Sort time: ', 0.0005473847389221192, 0.0005719661712646484)
****Stage 0 average time 0.00913465583324
****Stage 1 average time 0.00401608610153
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.633398056
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.007880302906036377, 0.008716452121734617)
('****Total time: ', 3.372837156534195, 6.457500219345091)
('****Preprocess time: ', 0.003799307823181152, 0.0039251804351806635)
('****Data time: ', 0.0002976609468460083, 0.00031901597976684564)
('****Fetch time: ', 0.00013195884227752686, 0.00013899803161621094)
('****Sort time: ', 0.0005630331039428711, 0.0005679249763488769)
****Stage 0 average time 0.00849578285217
****Stage 1 average time 0.00417648077011
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.8677699566
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.00841037392616272, 0.008848011493682861)
('****Total time: ', 3.0272646132707597, 5.763439297676086)
('****Preprocess time: ', 0.003764056324958801, 0.003841876983642578)
('****Data time: ', 0.0003108428716659546, 0.0003268718719482422)
('****Fetch time: ', 0.00010007500648498535, 0.00010540485382080065)
('****Sort time: ', 0.0005430563688278198, 0.0005667209625244141)
****Stage 0 average time 0.00913144075871
****Stage 1 average time 0.0039969637394
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.8655788898
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.008383349776268005, 0.008868718147277832)
('****Total time: ', 1.9401099255084993, 3.792668640613555)
('****Preprocess time: ', 0.0037818036079406737, 0.003892219066619873)
('****Data time: ', 0.0003122709989547729, 0.00032782554626464844)
('****Fetch time: ', 0.0001014864444732666, 0.00010800361633300781)
('****Sort time: ', 0.0005449291467666626, 0.0005669593811035156)
****Stage 0 average time 0.00913217759132
****Stage 1 average time 0.00399166238308
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.9112288952
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.00841198456287384, 0.008911871910095214)
('****Total time: ', 0.5601061795949935, 1.0047938585281373)
('****Preprocess time: ', 0.0037786388397216797, 0.003882038593292236)
('****Data time: ', 0.00031141626834869387, 0.0003261566162109375)
('****Fetch time: ', 9.986639022827149e-05, 0.00010610818862915033)
('****Sort time: ', 0.0005412638187408447, 0.0005650520324707031)
****Stage 0 average time 0.00914095246792
****Stage 1 average time 0.00400221741199
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.0834200382
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.007920527458190918, 0.008639073371887206)
('****Total time: ', 0.014898939847946166, 0.018061351776123044)
('****Preprocess time: ', 0.003787805795669556, 0.004026997089385986)
('****Data time: ', 0.0003097264766693115, 0.00034027099609374974)
('****Fetch time: ', 0.0001231776475906372, 0.0001342296600341797)
('****Sort time: ', 0.0005398188829421997, 0.0005751132965087888)
****Stage 0 average time 0.0085528345108
****Stage 1 average time 0.00412822175026
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.7080910206
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.007876797437667846, 0.008752417564392082)
('****Total time: ', 0.014482755661010743, 0.01684913635253906)
('****Preprocess time: ', 0.00380107045173645, 0.004187870025634765)
('****Data time: ', 0.0003132096529006958, 0.00040022134780883704)
('****Fetch time: ', 0.00011822772026062011, 0.00012803077697753906)
('****Sort time: ', 0.0005500274896621704, 0.0005979537963867188)
****Stage 0 average time 0.00853682529926
****Stage 1 average time 0.00412250745296
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  32.1298019886
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.007762455224990845, 0.008807146549224853)
('****Total time: ', 0.014330960869789123, 0.01602731943130492)
('****Preprocess time: ', 0.003730355978012085, 0.004085075855255126)
('****Data time: ', 0.00030910539627075195, 0.00039724111557006816)
('****Fetch time: ', 0.00011926054954528808, 0.00013208389282226562)
('****Sort time: ', 0.0005341490507125854, 0.0005920290946960447)
****Stage 0 average time 0.00845808541775
****Stage 1 average time 0.00399724078178
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 128])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967297813646
****DCGs @ 32: 0.942086222291
****DCGs @ 64: 0.909352794269
****Error : 0.171625
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  9.24179911613
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.031593822479248045, 0.04585733413696288)
('****Total time: ', 3.122237667441368, 5.390366327762604)
('****Preprocess time: ', 0.006011102437973022, 0.00869513750076294)
('****Data time: ', 0.000545762300491333, 0.0006819248199462888)
('****Fetch time: ', 8.59055519104004e-05, 0.00011086463928222656)
('****Sort time: ', 0.000764851450920105, 0.0009858727455139158)
****Stage 0 average time 0.0343986260891
****Stage 1 average time 0.00460281813145
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.16551995277
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.029026988983154298, 0.04240716695785522)
('****Total time: ', 2.6715425357818603, 4.714652490615845)
('****Preprocess time: ', 0.005558685183525086, 0.008053660392761227)
('****Data time: ', 0.0005184354782104492, 0.0006208896636962888)
('****Fetch time: ', 8.368825912475586e-05, 9.894371032714844e-05)
('****Sort time: ', 0.0007827787399291992, 0.0010100126266479488)
****Stage 0 average time 0.0313631926775
****Stage 1 average time 0.00460738396645
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.89576911926
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.026918501138687132, 0.03650501966476437)
('****Total time: ', 2.0531350829601287, 3.64733612537384)
('****Preprocess time: ', 0.005199859499931335, 0.007495439052581784)
('****Data time: ', 0.0004992601871490478, 0.0005858063697814941)
('****Fetch time: ', 8.02760124206543e-05, 9.393692016601562e-05)
('****Sort time: ', 0.0007889631986618042, 0.0009961128234863281)
****Stage 0 average time 0.0290079541206
****Stage 1 average time 0.00447890591621
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.61338090897
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.02639269006252289, 0.032225847244262695)
('****Total time: ', 1.2776739050149917, 2.360010266304016)
('****Preprocess time: ', 0.005047388195991516, 0.006929373741149899)
('****Data time: ', 0.00048405802249908446, 0.0005559921264648438)
('****Fetch time: ', 8.024394512176514e-05, 8.897781372070286e-05)
('****Sort time: ', 0.0007769482135772705, 0.0009370326995849607)
****Stage 0 average time 0.0284520343542
****Stage 1 average time 0.0043292940855
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.80198311806
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.02587078893184662, 0.029731345176696775)
('****Total time: ', 0.27661151826381686, 0.52485533952713)
('****Preprocess time: ', 0.004932713627815247, 0.006422448158264158)
('****Data time: ', 0.00048035335540771486, 0.000537872314453125)
('****Fetch time: ', 7.676827907562256e-05, 8.488893508911126e-05)
('****Sort time: ', 0.000775682806968689, 0.0009279370307922363)
****Stage 0 average time 0.0277134720087
****Stage 1 average time 0.00442283499241
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.3676509857
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.02580405557155609, 0.03053060770034789)
('****Total time: ', 0.03984380221366882, 0.0523972988128662)
('****Preprocess time: ', 0.004915089845657349, 0.005824887752532954)
('****Data time: ', 0.00048034262657165527, 0.0005543470382690428)
('****Fetch time: ', 7.875573635101318e-05, 9.204149246215814e-05)
('****Sort time: ', 0.0007913267612457276, 0.0009288907051086425)
****Stage 0 average time 0.0273954797983
****Stage 1 average time 0.00467409074306
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.6611988544
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.02559402561187744, 0.030836045742034905)
('****Total time: ', 0.03622792434692383, 0.04400527477264402)
('****Preprocess time: ', 0.00491660737991333, 0.005652332305908203)
('****Data time: ', 0.00047347772121429443, 0.0005412459373474119)
('****Fetch time: ', 7.930755615234375e-05, 9.490251541137689e-05)
('****Sort time: ', 0.0007865338325500488, 0.0008990764617919922)
****Stage 0 average time 0.0270244417191
****Stage 1 average time 0.00482551038265
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.2682590485
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.02555569243431091, 0.03157569169998169)
('****Total time: ', 0.0349788236618042, 0.04247550964355469)
('****Preprocess time: ', 0.004903775334358216, 0.006291425228118894)
('****Data time: ', 0.00047308003902435305, 0.0005431175231933594)
('****Fetch time: ', 7.686030864715576e-05, 9.083747863769531e-05)
('****Sort time: ', 0.0007820101976394653, 0.0008969426155090331)
****Stage 0 average time 0.0271369860172
****Stage 1 average time 0.00465443229675
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.4348530769
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.025278565168380736, 0.030813217163085924)
('****Total time: ', 0.034393126964569094, 0.0413120150566101)
('****Preprocess time: ', 0.004828858613967896, 0.00531407594680785)
('****Data time: ', 0.00047682690620422366, 0.0005491137504577635)
('****Fetch time: ', 7.769548892974853e-05, 9.206533432006816e-05)
('****Sort time: ', 0.0007696806192398071, 0.0008612513542175288)
****Stage 0 average time 0.0267271016836
****Stage 1 average time 0.00470452511311
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.4663729668
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.025014971852302552, 0.030526721477508543)
('****Total time: ', 0.033441354990005494, 0.03956239223480225)
('****Preprocess time: ', 0.004822545766830445, 0.005412173271179198)
('****Data time: ', 0.00047663605213165284, 0.0005450367927551269)
('****Fetch time: ', 7.836782932281495e-05, 9.012222290039062e-05)
('****Sort time: ', 0.0007588456869125366, 0.0008752465248107896)
****Stage 0 average time 0.0265058580637
****Stage 1 average time 0.0046455091238
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.3497109413
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.02482320523262024, 0.030128252506256104)
('****Total time: ', 0.033358532547950744, 0.03917511701583862)
('****Preprocess time: ', 0.004791332125663758, 0.005201363563537595)
('****Data time: ', 0.0004760303497314453, 0.0005550384521484375)
('****Fetch time: ', 7.801342010498047e-05, 9.084939956665033e-05)
('****Sort time: ', 0.0007817469835281372, 0.0008399486541748047)
****Stage 0 average time 0.0262135677338
****Stage 1 average time 0.00473676037788
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  32.2586679459
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.024740155339241027, 0.030039095878601072)
('****Total time: ', 0.03282599246501922, 0.03859121799468994)
('****Preprocess time: ', 0.004756060600280762, 0.0050611853599548335)
('****Data time: ', 0.00047872376441955567, 0.0005359649658203125)
('****Fetch time: ', 7.792043685913086e-05, 8.821487426757812e-05)
('****Sort time: ', 0.0007848100662231445, 0.0008490562438964841)
****Stage 0 average time 0.0261586495638
****Stage 1 average time 0.00467902064323
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  3.65270209312
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.033952194690704346, 0.04206821918487549)
('****Total time: ', 0.23733994913101197, 0.5011166930198669)
('****Preprocess time: ', 0.005456631302833557, 0.007653176784515364)
('****Data time: ', 0.0005733898878097534, 0.000692164897918701)
('****Fetch time: ', 7.964217662811279e-05, 8.584260940551751e-05)
('****Sort time: ', 0.0008893079757690429, 0.0012451052665710446)
****Stage 0 average time 0.028762517333
****Stage 1 average time 0.0121886487007
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.16212797165
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.032580814838409425, 0.040314614772796624)
('****Total time: ', 0.042574941039085386, 0.052166080474853486)
('****Preprocess time: ', 0.005377977013587952, 0.0072262167930603)
('****Data time: ', 0.0005639683008193969, 0.0006480336189270019)
('****Fetch time: ', 6.945276260375976e-05, 7.796287536621094e-05)
('****Sort time: ', 0.0008550004959106445, 0.0011260986328124997)
****Stage 0 average time 0.0283762158155
****Stage 1 average time 0.0110709975958
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.7273349762
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.0325508120059967, 0.04090465307235716)
('****Total time: ', 0.04247202062606811, 0.052348995208740215)
('****Preprocess time: ', 0.005437786102294922, 0.007774364948272704)
('****Data time: ', 0.0005628546476364136, 0.0006652235984802244)
('****Fetch time: ', 6.819963455200196e-05, 7.988214492797845e-05)
('****Sort time: ', 0.0008314249515533447, 0.001048123836517334)
****Stage 0 average time 0.0287719423771
****Stage 1 average time 0.0106791349649
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  6.38519310951
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.03173778903484344, 0.03918088674545287)
('****Total time: ', 0.04115707051753998, 0.04983682632446289)
('****Preprocess time: ', 0.005321303963661194, 0.007615292072296142)
('****Data time: ', 0.000534390926361084, 0.0006220340728759766)
('****Fetch time: ', 6.386590003967285e-05, 7.513761520385723e-05)
('****Sort time: ', 0.0008405425548553467, 0.0010152816772460932)
****Stage 0 average time 0.0279527776241
****Stage 1 average time 0.0105451147556
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.41888284683
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.030291993260383607, 0.036930596828460685)
('****Total time: ', 0.0395020432472229, 0.04697178602218628)
('****Preprocess time: ', 0.005199571013450623, 0.007295131683349609)
('****Data time: ', 0.0005181814432144165, 0.0006017804145812988)
('****Fetch time: ', 5.9061646461486816e-05, 7.013082504272441e-05)
('****Sort time: ', 0.0008150948286056519, 0.0009701728820800779)
****Stage 0 average time 0.026998370409
****Stage 1 average time 0.0098855317831
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.4756498337
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.029307247281074523, 0.035249352455139146)
('****Total time: ', 0.03827237045764923, 0.04532203674316407)
('****Preprocess time: ', 0.00506222927570343, 0.006557261943817138)
('****Data time: ', 0.0005088591575622558, 0.0005832076072692869)
('****Fetch time: ', 6.103336811065674e-05, 6.725788116455065e-05)
('****Sort time: ', 0.0008041172027587891, 0.0009520053863525391)
****Stage 0 average time 0.0262577027082
****Stage 1 average time 0.00948578357697
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.4383938313
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.028524500250816345, 0.03284916877746582)
('****Total time: ', 0.03737079906463623, 0.04231269359588623)
('****Preprocess time: ', 0.004941413521766662, 0.0054111480712890625)
('****Data time: ', 0.0005078705549240113, 0.0005769848823547363)
('****Fetch time: ', 5.548381805419922e-05, 6.532669067382812e-05)
('****Sort time: ', 0.0008102161884307862, 0.0009408593177795407)
****Stage 0 average time 0.025581212759
****Stage 1 average time 0.00925827157497
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.6594450474
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.029233026146888733, 0.0340791344642639)
('****Total time: ', 0.03824007558822632, 0.04387053251266479)
('****Preprocess time: ', 0.005089516401290893, 0.006776928901672358)
('****Data time: ', 0.0005127776861190796, 0.0005888938903808594)
('****Fetch time: ', 5.931985378265381e-05, 6.63042068481444e-05)
('****Sort time: ', 0.0008028897047042847, 0.0008991241455078122)
****Stage 0 average time 0.0258081136942
****Stage 1 average time 0.00988941609859
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.5489530563
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.028076906204223633, 0.03267199993133542)
('****Total time: ', 0.03693141198158264, 0.042289566993713376)
('****Preprocess time: ', 0.004964725375175476, 0.005617725849151608)
('****Data time: ', 0.000503237247467041, 0.0005719780921936035)
('****Fetch time: ', 5.597090721130371e-05, 6.413459777832031e-05)
('****Sort time: ', 0.0008174692392349243, 0.0009141325950622557)
****Stage 0 average time 0.0253246680498
****Stage 1 average time 0.0090936409235
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.6755850315
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.027568153023719788, 0.03205189704895018)
('****Total time: ', 0.036306466341018674, 0.04168053865432739)
('****Preprocess time: ', 0.004885413885116577, 0.005403339862823485)
('****Data time: ', 0.0005006941556930542, 0.0005769729614257812)
('****Fetch time: ', 5.446243286132812e-05, 6.198883056640625e-05)
('****Sort time: ', 0.0008147033452987671, 0.0008590221405029297)
****Stage 0 average time 0.0249036238194
****Stage 1 average time 0.00891980302334
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.4560689926
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.02741162669658661, 0.03188700675964354)
('****Total time: ', 0.03614627540111542, 0.04114344120025634)
('****Preprocess time: ', 0.004837826490402221, 0.00515831708908081)
('****Data time: ', 0.0004959719181060791, 0.00057220458984375)
('****Fetch time: ', 5.504322052001953e-05, 6.198883056640625e-05)
('****Sort time: ', 0.0008151757717132568, 0.0008571147918701172)
****Stage 0 average time 0.0247367345095
****Stage 1 average time 0.00887890958786
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  32.6076459885
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.02722271263599396, 0.0321535587310791)
('****Total time: ', 0.036109788656234744, 0.04153583049774169)
('****Preprocess time: ', 0.004832879185676575, 0.00515822172164917)
('****Data time: ', 0.0005007990598678588, 0.0005710124969482422)
('****Fetch time: ', 5.320549011230469e-05, 6.103515625e-05)
('****Sort time: ', 0.0008102219104766846, 0.0008478164672851562)
****Stage 0 average time 0.0245964021683
****Stage 1 average time 0.00882341611385
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  18.500510931
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.012583821535110474, 0.013459169864654539)
('****Total time: ', 7.994622203826904, 15.222815406322479)
('****Preprocess time: ', 0.004368982553482056, 0.004484903812408448)
('****Data time: ', 0.00039393472671508787, 0.0004248738288879394)
('****Fetch time: ', 9.016144275665283e-05, 0.00012087821960449219)
('****Sort time: ', 0.0007798765897750854, 0.0008370876312255859)
****Stage 0 average time 0.00949933803082
****Stage 1 average time 0.00871743881702
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.1162548065
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.011877958059310913, 0.012615489959716796)
('****Total time: ', 6.831390607595444, 12.947709882259367)
('****Preprocess time: ', 0.004316003322601319, 0.004429149627685547)
('****Data time: ', 0.0003732798099517822, 0.0004000663757324219)
('****Fetch time: ', 0.00012116611003875732, 0.00013208389282226562)
('****Sort time: ', 0.0007790616750717164, 0.0008723855018615709)
****Stage 0 average time 0.00881643795967
****Stage 1 average time 0.0086510310173
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.1367468834
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011898539185523986, 0.012636911869049073)
('****Total time: ', 6.276504209160804, 11.910519027709958)
('****Preprocess time: ', 0.004311078786849975, 0.00441434383392334)
('****Data time: ', 0.0003743993043899536, 0.0004029273986816406)
('****Fetch time: ', 0.00012211954593658447, 0.00013494491577148438)
('****Sort time: ', 0.0007751699686050415, 0.0008111000061035156)
****Stage 0 average time 0.00881988811493
****Stage 1 average time 0.00866141867638
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.1006529331
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.011882096409797668, 0.012625026702880859)
('****Total time: ', 5.689200746655464, 10.80264183282852)
('****Preprocess time: ', 0.004317270517349243, 0.0044382095336914056)
('****Data time: ', 0.00037237608432769777, 0.0004000663757324219)
('****Fetch time: ', 0.00012304556369781495, 0.00013399124145507812)
('****Sort time: ', 0.0007763479948043824, 0.0008130073547363281)
****Stage 0 average time 0.00881355082989
****Stage 1 average time 0.00865758574009
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  18.3290009499
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.01248155379295349, 0.013436222076416014)
('****Total time: ', 5.303894644379616, 10.044670808315274)
('****Preprocess time: ', 0.004340742230415345, 0.004461050033569336)
('****Data time: ', 0.0003841341733932495, 0.0004139065742492675)
('****Fetch time: ', 9.386038780212402e-05, 0.00010706186294555658)
('****Sort time: ', 0.0007780555486679077, 0.0008800506591796872)
****Stage 0 average time 0.00942926585674
****Stage 1 average time 0.00864908027649
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.9407629967
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.011803242325782776, 0.012723612785339353)
('****Total time: ', 3.5553039660453796, 6.794047367572783)
('****Preprocess time: ', 0.004295940995216369, 0.004420101642608643)
('****Data time: ', 0.00036585962772369383, 0.00039696693420410156)
('****Fetch time: ', 0.00012747883796691893, 0.00013709068298339844)
('****Sort time: ', 0.0007722809314727783, 0.0008080005645751953)
****Stage 0 average time 0.00873732721806
****Stage 1 average time 0.00862747550011
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.9842760563
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.011880170583724975, 0.012764370441436766)
('****Total time: ', 2.5836767015457154, 4.948827016353607)
('****Preprocess time: ', 0.004308530688285827, 0.004464876651763916)
('****Data time: ', 0.0003658628463745117, 0.0003981709480285644)
('****Fetch time: ', 0.00012689447402954102, 0.00013899803161621094)
('****Sort time: ', 0.0007711435556411743, 0.0008161067962646484)
****Stage 0 average time 0.00875442767143
****Stage 1 average time 0.00869817447662
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.0271978378
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.011880463242530823, 0.01259089708328247)
('****Total time: ', 1.5241525926589965, 3.0226676106452937)
('****Preprocess time: ', 0.004302678465843201, 0.004411721229553222)
('****Data time: ', 0.0003669435977935791, 0.0004007935523986816)
('****Fetch time: ', 0.00012641096115112305, 0.00013709068298339844)
('****Sort time: ', 0.0007710245847702027, 0.0008051395416259766)
****Stage 0 average time 0.00876239776611
****Stage 1 average time 0.00868512308598
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  18.1654250622
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.012341789960861205, 0.013198184967041017)
('****Total time: ', 0.682449705004692, 1.2425483942031859)
('****Preprocess time: ', 0.004300347447395324, 0.004436075687408446)
('****Data time: ', 0.00037793612480163576, 0.00041103363037109375)
('****Fetch time: ', 9.725797176361084e-05, 0.00011014938354492188)
('****Sort time: ', 0.0007911447286605835, 0.0009169578552246094)
****Stage 0 average time 0.00934039354324
****Stage 1 average time 0.00856808269024
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.1795129776
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.011910350322723388, 0.013512182235717773)
('****Total time: ', 0.019796523809432982, 0.023238229751586906)
('****Preprocess time: ', 0.0042771191596984864, 0.004735159873962402)
('****Data time: ', 0.0003539031744003296, 0.0004580140113830566)
('****Fetch time: ', 0.0001263408660888672, 0.00014066696166992188)
('****Sort time: ', 0.0007629494667053222, 0.0008018136024475097)
****Stage 0 average time 0.00862301707268
****Stage 1 average time 0.00880764591694
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.2185549736
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.012079699039459229, 0.013083136081695555)
('****Total time: ', 0.019824625492095946, 0.022070324420928954)
('****Preprocess time: ', 0.004304215788841248, 0.004508209228515624)
('****Data time: ', 0.00037436985969543457, 0.0004200935363769531)
('****Fetch time: ', 0.00012031733989715576, 0.0001327991485595703)
('****Sort time: ', 0.0007604968547821045, 0.0007960796356201172)
****Stage 0 average time 0.00888246655464
****Stage 1 average time 0.00875663232803
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  32.253387928
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.01184777069091797, 0.01344335079193115)
('****Total time: ', 0.019441174387931824, 0.021801638603210445)
('****Preprocess time: ', 0.004298732161521912, 0.0048534393310546865)
('****Data time: ', 0.0003758606910705566, 0.0005040168762207031)
('****Fetch time: ', 0.00012043952941894532, 0.0001399517059326172)
('****Sort time: ', 0.0007446430921554566, 0.0007910728454589844)
****Stage 0 average time 0.00877010154724
****Stage 1 average time 0.00861734461784
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 512])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.986250441831
****DCGs @ 16: 0.967313490256
****DCGs @ 32: 0.94209513135
****DCGs @ 64: 0.909340042267
****Error : 0.3503125
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  10.6207590103
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03475641059875488, 0.04917887449264526)
('****Total time: ', 3.5492129702568054, 6.594745504856108)
('****Preprocess time: ', 0.0070497413873672485, 0.009772169589996337)
('****Data time: ', 0.0005652474164962769, 0.0007002592086791991)
('****Fetch time: ', 8.86986255645752e-05, 0.0001051783561706541)
('****Sort time: ', 0.0009742850065231324, 0.0010591030120849607)
****Stage 0 average time 0.0379464700222
****Stage 1 average time 0.0054879130125
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.7660918236
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.02747572112083435, 0.037276935577392555)
('****Total time: ', 3.4617056056261064, 6.392337012290954)
('****Preprocess time: ', 0.006009997367858887, 0.008557868003845216)
('****Data time: ', 0.0005163828134536743, 0.0006117939949035644)
('****Fetch time: ', 8.393001556396485e-05, 9.703636169433594e-05)
('****Sort time: ', 0.001010156750679016, 0.0012401103973388667)
****Stage 0 average time 0.0295240243673
****Stage 1 average time 0.00557216370106
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.7624561787
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.026847334623336792, 0.03526109457015991)
('****Total time: ', 2.9689486256837845, 5.351258361339569)
('****Preprocess time: ', 0.005780443668365478, 0.007975137233734131)
('****Data time: ', 0.0005000565052032471, 0.0005891323089599609)
('****Fetch time: ', 8.57466459274292e-05, 9.799003601074219e-05)
('****Sort time: ', 0.0010101181268692017, 0.0012231230735778808)
****Stage 0 average time 0.0286663204432
****Stage 1 average time 0.00555737912655
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.7778818607
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.027087032198905944, 0.03671054840087888)
('****Total time: ', 2.4852431584596633, 4.5031960725784295)
('****Preprocess time: ', 0.005723493933677673, 0.007814896106719971)
('****Data time: ', 0.0005012282133102417, 0.0005860328674316406)
('****Fetch time: ', 8.288776874542236e-05, 9.775161743164062e-05)
('****Sort time: ', 0.0010175622701644898, 0.001232242584228515)
****Stage 0 average time 0.0288471333981
****Stage 1 average time 0.00556507098675
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.7100498676
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.02621113383769989, 0.03202211856842038)
('****Total time: ', 1.3454635006189346, 2.4862919330596926)
('****Preprocess time: ', 0.0055645047426223756, 0.007000982761383057)
('****Data time: ', 0.000485216498374939, 0.0005481243133544922)
('****Fetch time: ', 7.97863006591797e-05, 8.989572525024408e-05)
('****Sort time: ', 0.000995473623275757, 0.0011010646820068357)
****Stage 0 average time 0.0278097826242
****Stage 1 average time 0.00552633237839
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.7291488647
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.02681033933162689, 0.03492536544799805)
('****Total time: ', 0.27270960760116575, 0.5566084504127502)
('****Preprocess time: ', 0.005623534202575684, 0.007505953311920166)
('****Data time: ', 0.0004797149896621704, 0.0005419373512268066)
('****Fetch time: ', 8.08626413345337e-05, 9.107589721679688e-05)
('****Sort time: ', 0.0009968104362487794, 0.0010781645774841308)
****Stage 0 average time 0.02845637393
****Stage 1 average time 0.00553488767147
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.9761719704
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.026116268634796144, 0.0336373925209045)
('****Total time: ', 0.052972429513931274, 0.08355981111526489)
('****Preprocess time: ', 0.0056447662115097046, 0.007285857200622554)
('****Data time: ', 0.00048486697673797607, 0.0005550384521484375)
('****Fetch time: ', 8.083176612854004e-05, 9.421110153198223e-05)
('****Sort time: ', 0.0009846575260162355, 0.0010509490966796875)
****Stage 0 average time 0.0275205130577
****Stage 1 average time 0.00579087805748
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.0835959911
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.025643954634666444, 0.03165508508682251)
('****Total time: ', 0.03660420620441437, 0.04446240663528442)
('****Preprocess time: ', 0.0054049197435379025, 0.005860877037048339)
('****Data time: ', 0.00047441792488098146, 0.0005447983741760253)
('****Fetch time: ', 7.770192623138428e-05, 8.797645568847656e-05)
('****Sort time: ', 0.0009736083745956421, 0.001040983200073242)
****Stage 0 average time 0.0270421155691
****Stage 1 average time 0.0055324870348
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.9749059677
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.025451635599136352, 0.031875240802764895)
('****Total time: ', 0.03539909279346466, 0.04321914911270141)
('****Preprocess time: ', 0.005484502553939819, 0.006270384788513181)
('****Data time: ', 0.00048540198802948, 0.0005619525909423828)
('****Fetch time: ', 8.235430717468261e-05, 9.202957153320312e-05)
('****Sort time: ', 0.000979707956314087, 0.0010431170463562009)
****Stage 0 average time 0.026808693409
****Stage 1 average time 0.00567490899563
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.3435590267
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.025303584694862366, 0.030928432941436768)
('****Total time: ', 0.03465309631824493, 0.04128829240798949)
('****Preprocess time: ', 0.005451712369918823, 0.006274712085723874)
('****Data time: ', 0.0004856572151184082, 0.0005650520324707031)
('****Fetch time: ', 7.875800132751464e-05, 9.012222290039062e-05)
('****Sort time: ', 0.0009740110635757446, 0.0010399818420410156)
****Stage 0 average time 0.0267281179428
****Stage 1 average time 0.00556560540199
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  25.9783079624
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.025007401823997497, 0.030832374095916736)
('****Total time: ', 0.03395429158210755, 0.04037684202194213)
('****Preprocess time: ', 0.005401655554771423, 0.0059158086776733365)
('****Data time: ', 0.00048228859901428223, 0.0005688667297363281)
('****Fetch time: ', 7.809686660766602e-05, 8.988380432128906e-05)
('****Sort time: ', 0.0009760609865188598, 0.0010412096977233884)
****Stage 0 average time 0.0263909525871
****Stage 1 average time 0.00555455124378
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  32.2436859608
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.024625128746032714, 0.030213856697082507)
('****Total time: ', 0.033484203219413755, 0.03975050449371337)
('****Preprocess time: ', 0.005367953062057495, 0.0058021306991577135)
('****Data time: ', 0.0004868464469909668, 0.000572240352630615)
('****Fetch time: ', 7.903027534484863e-05, 8.916854858398438e-05)
('****Sort time: ', 0.000984256625175476, 0.0010399937629699705)
****Stage 0 average time 0.0259412051439
****Stage 1 average time 0.00560201001167
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  4.01209306717
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.04654350912570954, 0.06031383275985716)
('****Total time: ', 0.37197563338279727, 0.7358172416687011)
('****Preprocess time: ', 0.00704732596874237, 0.01107481718063354)
('****Data time: ', 0.0006916784048080444, 0.0008437752723693847)
('****Fetch time: ', 0.0001026918888092041, 0.00011777877807617188)
('****Sort time: ', 0.0012014620304107665, 0.0017053484916687003)
****Stage 0 average time 0.0312293189764
****Stage 1 average time 0.0243573484421
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.63539719582
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.04264495575428009, 0.055560970306396444)
('****Total time: ', 0.05725216388702393, 0.08031988143920898)
('****Preprocess time: ', 0.006600622057914734, 0.009501624107360836)
('****Data time: ', 0.0006731915473937989, 0.0008099198341369628)
('****Fetch time: ', 9.203791618347169e-05, 0.00010704994201660156)
('****Sort time: ', 0.001185874342918396, 0.001655149459838867)
****Stage 0 average time 0.030760756731
****Stage 1 average time 0.0204359248877
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.40126299858
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03930238711833954, 0.04903447628021239)
('****Total time: ', 0.050243173003196716, 0.061282813549041706)
('****Preprocess time: ', 0.006185427308082581, 0.008568155765533447)
('****Data time: ', 0.0006225916147232055, 0.0007241249084472654)
('****Fetch time: ', 8.397030830383301e-05, 9.584426879882812e-05)
('****Sort time: ', 0.001138647437095642, 0.0015192270278930663)
****Stage 0 average time 0.0286977543831
****Stage 1 average time 0.0186352694035
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  6.30636715889
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.0377480663061142, 0.04702837467193601)
('****Total time: ', 0.048063553810119626, 0.058531284332275356)
('****Preprocess time: ', 0.005952407360076904, 0.008120155334472657)
('****Data time: ', 0.0005988490581512451, 0.0006949901580810547)
('****Fetch time: ', 8.048582077026367e-05, 9.202957153320312e-05)
('****Sort time: ', 0.0011095932722091674, 0.0013972520828247049)
****Stage 0 average time 0.0276897586584
****Stage 1 average time 0.0177996431589
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.45234417915
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.03599481701850891, 0.043209588527679435)
('****Total time: ', 0.04626530718803406, 0.054495799541473385)
('****Preprocess time: ', 0.0058472751379013066, 0.00779874324798583)
('****Data time: ', 0.0005807503461837768, 0.000659942626953125)
('****Fetch time: ', 7.401061058044434e-05, 8.72850418090819e-05)
('****Sort time: ', 0.001091264009475708, 0.0013430356979370103)
****Stage 0 average time 0.0267015491724
****Stage 1 average time 0.0168865679502
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.4170529842
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.03562344634532928, 0.043204009532928446)
('****Total time: ', 0.04583481478691101, 0.05466835498809814)
('****Preprocess time: ', 0.00578884208202362, 0.007582950592041015)
('****Data time: ', 0.000574466347694397, 0.0006609916687011714)
('****Fetch time: ', 7.429349422454835e-05, 8.606910705566406e-05)
('****Sort time: ', 0.0011025192737579347, 0.0012860774993896482)
****Stage 0 average time 0.0263211282492
****Stage 1 average time 0.0168424392939
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.3470451832
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03549724745750427, 0.04369620084762573)
('****Total time: ', 0.04557687497138977, 0.05457266569137572)
('****Preprocess time: ', 0.0057911057472229, 0.007737195491790772)
('****Data time: ', 0.0005698682069778442, 0.0006511211395263672)
('****Fetch time: ', 7.268571853637695e-05, 8.296966552734375e-05)
('****Sort time: ', 0.0010758521556854248, 0.0012579083442687987)
****Stage 0 average time 0.0267878922224
****Stage 1 average time 0.0162188670635
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.376333952
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.034370872139930723, 0.04074261188507078)
('****Total time: ', 0.044221866011619565, 0.051575767993927)
('****Preprocess time: ', 0.00564058768749237, 0.006647634506225582)
('****Data time: ', 0.000560150146484375, 0.0006399273872375488)
('****Fetch time: ', 7.062125205993652e-05, 8.20159912109375e-05)
('****Sort time: ', 0.0010773942470550537, 0.0012090682983398435)
****Stage 0 average time 0.0257817004919
****Stage 1 average time 0.0159379249811
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.4113731384
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03369811713695526, 0.039282476902008055)
('****Total time: ', 0.04346664929389953, 0.049771463871002196)
('****Preprocess time: ', 0.005603253483772278, 0.006567549705505368)
('****Data time: ', 0.0005578496456146241, 0.0006401538848876953)
('****Fetch time: ', 6.921732425689697e-05, 8.0108642578125e-05)
('****Sort time: ', 0.001082902193069458, 0.0012362480163574216)
****Stage 0 average time 0.0253811368942
****Stage 1 average time 0.0156302028894
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.708714962
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.033101908683776854, 0.038154280185699455)
('****Total time: ', 0.043042481064796446, 0.048827385902404784)
('****Preprocess time: ', 0.00553395426273346, 0.006080973148345947)
('****Data time: ', 0.0005579077005386353, 0.0006368279457092285)
('****Fetch time: ', 6.816256046295166e-05, 7.891654968261719e-05)
('****Sort time: ', 0.0010764797925949096, 0.0011840343475341794)
****Stage 0 average time 0.0250142327547
****Stage 1 average time 0.0153241802454
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.3581161499
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.03286801862716675, 0.03777353763580321)
('****Total time: ', 0.04255286419391632, 0.04804661273956298)
('****Preprocess time: ', 0.005466478705406189, 0.00592808723449707)
('****Data time: ', 0.000550951600074768, 0.0006318211555480956)
('****Fetch time: ', 6.77276849746704e-05, 7.700920104980469e-05)
('****Sort time: ', 0.0010865035057067872, 0.0011540532112121575)
****Stage 0 average time 0.0247992917299
****Stage 1 average time 0.0152403883934
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  32.6673269272
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.032604441404342654, 0.03722045421600342)
('****Total time: ', 0.04241065514087677, 0.04777824878692626)
('****Preprocess time: ', 0.005465598106384278, 0.005882179737091063)
('****Data time: ', 0.0005571352243423462, 0.0006296753883361816)
('****Fetch time: ', 6.680917739868164e-05, 7.605552673339844e-05)
('****Sort time: ', 0.0010884321928024293, 0.0011589527130126953)
****Stage 0 average time 0.0246756180525
****Stage 1 average time 0.0151067980528
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  17.7931959629
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017975291848182678, 0.021473336219787597)
('****Total time: ', 7.619229136347771, 14.466332614421843)
('****Preprocess time: ', 0.0051262760162353515, 0.005476963520050049)
('****Data time: ', 0.00044980621337890626, 0.0004909038543701172)
('****Fetch time: ', 9.88072156906128e-05, 0.00012493133544921875)
('****Sort time: ', 0.0010475937128067016, 0.0011048436164855955)
****Stage 0 average time 0.00923297095299
****Stage 1 average time 0.0154648040533
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.775108099
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.01793413782119751, 0.02133858203887939)
('****Total time: ', 7.0943329619169235, 13.48972177505493)
('****Preprocess time: ', 0.005108546257019043, 0.005305540561676023)
('****Data time: ', 0.00044725966453552246, 0.0004851818084716797)
('****Fetch time: ', 9.761202335357665e-05, 0.00011992454528808594)
('****Sort time: ', 0.0010497325658798218, 0.001102936267852783)
****Stage 0 average time 0.00922997200489
****Stage 1 average time 0.0154073163271
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.628041029
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017518823981285094, 0.01971727609634399)
('****Total time: ', 6.5050778048038485, 12.339662253856657)
('****Preprocess time: ', 0.0050819491147994994, 0.005388033390045166)
('****Data time: ', 0.0004372161626815796, 0.0004849433898925781)
('****Fetch time: ', 0.000102874755859375, 0.00013017654418945312)
('****Sort time: ', 0.0010566885471343995, 0.0011699795722961421)
****Stage 0 average time 0.00916976392269
****Stage 1 average time 0.0150277886391
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.8711249828
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.017748894929885864, 0.020338165760040276)
('****Total time: ', 6.104042340755463, 11.52846326828003)
('****Preprocess time: ', 0.005142410516738891, 0.005682146549224853)
('****Data time: ', 0.00044033217430114745, 0.00048495531082153314)
('****Fetch time: ', 0.00010226607322692871, 0.0001239776611328125)
('****Sort time: ', 0.0010519100427627563, 0.001109158992767334)
****Stage 0 average time 0.00929149544239
****Stage 1 average time 0.0151943182945
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.6168079376
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.017549526810646057, 0.019922208786010743)
('****Total time: ', 4.902955376505852, 9.305150210857391)
('****Preprocess time: ', 0.005090699672698974, 0.005387115478515625)
('****Data time: ', 0.0004372473955154419, 0.0004828095436096191)
('****Fetch time: ', 0.00010538876056671143, 0.0001289844512939453)
('****Sort time: ', 0.0010432581901550293, 0.0011101126670837401)
****Stage 0 average time 0.00914350950718
****Stage 1 average time 0.0150826113224
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.5822291374
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.017855400562286378, 0.020558702945709224)
('****Total time: ', 3.8326535865068436, 7.333918237686154)
('****Preprocess time: ', 0.005070541977882385, 0.005367279052734373)
('****Data time: ', 0.0004339427947998047, 0.00047707557678222656)
('****Fetch time: ', 0.00010432314872741699, 0.00012711286544799785)
('****Sort time: ', 0.0010431467294692994, 0.0010962843894958495)
****Stage 0 average time 0.00913388907909
****Stage 1 average time 0.0153734661341
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.4891741276
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01738369047641754, 0.01972397565841674)
('****Total time: ', 2.814767448782921, 5.398023450374603)
('****Preprocess time: ', 0.005059939622879028, 0.005327188968658446)
('****Data time: ', 0.00043645763397216796, 0.00048089027404785156)
('****Fetch time: ', 0.00010622406005859375, 0.00012803077697753906)
('****Sort time: ', 0.0010355123281478881, 0.0010979175567626953)
****Stage 0 average time 0.00908269536495
****Stage 1 average time 0.0149391287565
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  16.6341869831
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.017291509866714478, 0.018710279464721664)
('****Total time: ', 1.4851400022506713, 2.758583581447601)
('****Preprocess time: ', 0.0049418176412582395, 0.005185174942016602)
('****Data time: ', 0.000397013783454895, 0.00046181678771972656)
('****Fetch time: ', 0.00013265538215637208, 0.00015115737915039062)
('****Sort time: ', 0.0010181849002838135, 0.001205062866210937)
****Stage 0 average time 0.00868938827515
****Stage 1 average time 0.0150917932987
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.2421979904
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.017654643535614013, 0.020387458801269527)
('****Total time: ', 0.04098790240287781, 0.093717086315155)
('****Preprocess time: ', 0.004924567699432373, 0.005035209655761718)
('****Data time: ', 0.000382875919342041, 0.00041103363037109375)
('****Fetch time: ', 0.00014083921909332275, 0.00015020370483398438)
('****Sort time: ', 0.0009886388778686524, 0.0010433435440063475)
****Stage 0 average time 0.00863742375374
****Stage 1 average time 0.0154541414976
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.4718029499
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.01778949499130249, 0.020101547241210934)
('****Total time: ', 0.02733461046218872, 0.03156464099884033)
('****Preprocess time: ', 0.005185657501220703, 0.005468904972076416)
('****Data time: ', 0.0004399771690368652, 0.0004918694496154785)
('****Fetch time: ', 0.00010708928108215333, 0.0001239776611328125)
('****Sort time: ', 0.0010916926860809325, 0.0012967705726623533)
****Stage 0 average time 0.00929645109177
****Stage 1 average time 0.015317460537
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.4297778606
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.017803866386413573, 0.02014017105102539)
('****Total time: ', 0.02712350356578827, 0.030622601509094217)
('****Preprocess time: ', 0.0051424986124038695, 0.0054569244384765625)
('****Data time: ', 0.00045340526103973387, 0.00051116943359375)
('****Fetch time: ', 0.00010398304462432862, 0.0001239776611328125)
('****Sort time: ', 0.0010498721599578858, 0.0011432290077209458)
****Stage 0 average time 0.00927294933796
****Stage 1 average time 0.0152806761265
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  32.4715847969
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.01773430573940277, 0.020541501045227048)
('****Total time: ', 0.026651665806770326, 0.029811012744903564)
('****Preprocess time: ', 0.005140767931938172, 0.0056362271308898915)
('****Data time: ', 0.0004439748525619507, 0.0005068898200988769)
('****Fetch time: ', 0.00010622012615203857, 0.00013113021850585938)
('****Sort time: ', 0.0010329899787902832, 0.0011671066284179685)
****Stage 0 average time 0.0092452121973
****Stage 1 average time 0.0152130464315
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [3200, 1024])
****DCGs @ 4: 0.99418691902
****DCGs @ 8: 0.98688879814
****DCGs @ 16: 0.967334160989
****DCGs @ 32: 0.942105526718
****DCGs @ 64: 0.909347231975
****Error : 0.3440625
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  7.49709510803
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03532198917865753, 0.050605809688568114)
('****Total time: ', 2.0248301084041596, 3.6513946056365962)
('****Preprocess time: ', 0.006708746671676636, 0.010554993152618406)
('****Data time: ', 0.0005875524282455445, 0.0007449626922607414)
('****Fetch time: ', 7.464969158172607e-05, 8.608102798461908e-05)
('****Sort time: ', 0.0007287143468856812, 0.0009100437164306641)
****Stage 0 average time 0.0397316756248
****Stage 1 average time 0.0036899766922
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992798555995
****DCGs @ 16: 0.975260580872
****DCGs @ 32: 0.948255364828
****DCGs @ 64: 0.925085218714
****Error : 0.1494453125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.6121969223
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.03254885005950928, 0.04493285417556761)
('****Total time: ', 1.647427747130394, 2.993504726886749)
('****Preprocess time: ', 0.006175905227661133, 0.00943303108215332)
('****Data time: ', 0.0005411626100540161, 0.0006468415260314941)
('****Fetch time: ', 7.198739051818848e-05, 8.392333984375e-05)
('****Sort time: ', 0.0007033984661102295, 0.0008599758148193359)
****Stage 0 average time 0.0362909985781
****Stage 1 average time 0.00375030517578
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992785483211
****DCGs @ 16: 0.975074927251
****DCGs @ 32: 0.948161134149
****DCGs @ 64: 0.925063889851
****Error : 0.14940234375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.88732981682
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03298907959461212, 0.04587174654006955)
('****Total time: ', 1.3470789421796798, 2.456594669818877)
('****Preprocess time: ', 0.006204673051834106, 0.009265196323394774)
('****Data time: ', 0.0005630838871002197, 0.0006931304931640622)
('****Fetch time: ', 7.686567306518555e-05, 8.916854858398438e-05)
('****Sort time: ', 0.0007130827903747559, 0.0008680820465087891)
****Stage 0 average time 0.036678552866
****Stage 1 average time 0.003868232131
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996272105677
****DCGs @ 8: 0.993010556949
****DCGs @ 16: 0.975289200987
****DCGs @ 32: 0.948227037209
****DCGs @ 64: 0.925119395877
****Error : 0.14938671875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.63852286339
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.031875813603401186, 0.03853572607040402)
('****Total time: ', 0.5190614297389984, 0.9377541065216064)
('****Preprocess time: ', 0.005947765827178955, 0.00838717222213744)
('****Data time: ', 0.0005398130416870117, 0.0006392002105712891)
('****Fetch time: ', 7.309293746948242e-05, 8.296966552734375e-05)
('****Sort time: ', 0.0007242748737335206, 0.0008769154548645019)
****Stage 0 average time 0.0353813457489
****Stage 1 average time 0.00377941453457
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992650627235
****DCGs @ 16: 0.975222278714
****DCGs @ 32: 0.948238238977
****DCGs @ 64: 0.925108865872
****Error : 0.14944921875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.95187211037
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.03238959491252899, 0.04203537702560424)
('****Total time: ', 0.05216015899181366, 0.07307771444320678)
('****Preprocess time: ', 0.005891106128692627, 0.00824639797210693)
('****Data time: ', 0.0005344597101211547, 0.0006279945373535156)
('****Fetch time: ', 7.364583015441894e-05, 8.58306884765625e-05)
('****Sort time: ', 0.0006876699924468994, 0.0007870793342590329)
****Stage 0 average time 0.0354896142483
****Stage 1 average time 0.00408686232567
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996258574432
****DCGs @ 8: 0.99275176143
****DCGs @ 16: 0.975071117704
****DCGs @ 32: 0.948252162214
****DCGs @ 64: 0.925136325843
****Error : 0.1493671875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.1408140659
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.03181456792354584, 0.04128198623657227)
('****Total time: ', 0.04379697179794312, 0.056848561763763385)
('****Preprocess time: ', 0.00584573221206665, 0.008069038391113281)
('****Data time: ', 0.0005330681800842285, 0.00062180757522583)
('****Fetch time: ', 7.199275493621826e-05, 8.488893508911126e-05)
('****Sort time: ', 0.0006827750205993653, 0.0007500648498535156)
****Stage 0 average time 0.0348700501919
****Stage 1 average time 0.00407808589935
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996272105677
****DCGs @ 8: 0.993003144366
****DCGs @ 16: 0.97519546179
****DCGs @ 32: 0.948256998738
****DCGs @ 64: 0.925067179395
****Error : 0.1494453125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.0637290478
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.031084909796714782, 0.03673956394195555)
('****Total time: ', 0.04141074585914612, 0.04939255714416503)
('****Preprocess time: ', 0.005699118733406067, 0.007450151443481445)
('****Data time: ', 0.0005208100080490112, 0.0006010532379150391)
('****Fetch time: ', 7.157719135284424e-05, 7.891654968261719e-05)
('****Sort time: ', 0.000684798002243042, 0.000760805606842041)
****Stage 0 average time 0.0342354204655
****Stage 1 average time 0.0038257932663
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992698570126
****DCGs @ 16: 0.975227241368
****DCGs @ 32: 0.948219081548
****DCGs @ 64: 0.925104818632
****Error : 0.1494609375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.8911991119
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.03116995584964752, 0.03982061147689817)
('****Total time: ', 0.040988863706588746, 0.0517382264137268)
('****Preprocess time: ', 0.005745671153068542, 0.008052325248718253)
('****Data time: ', 0.0005127465724945068, 0.0005970478057861326)
('****Fetch time: ', 6.797218322753906e-05, 7.82012939453125e-05)
('****Sort time: ', 0.0006855309009552002, 0.0007491588592529294)
****Stage 0 average time 0.0345176100731
****Stage 1 average time 0.0036642665863
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992878182071
****DCGs @ 16: 0.975076979147
****DCGs @ 32: 0.948218239453
****DCGs @ 64: 0.925080290701
****Error : 0.149328125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.725509882
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.029936776995658873, 0.0356705904006958)
('****Total time: ', 0.03932893621921539, 0.046687161922454826)
('****Preprocess time: ', 0.005573541045188903, 0.006221556663513181)
('****Data time: ', 0.0005210145711898804, 0.000598907470703125)
('****Fetch time: ', 6.816995143890381e-05, 7.700920104980469e-05)
('****Sort time: ', 0.0007044928073883057, 0.0007660508155822753)
****Stage 0 average time 0.0330236560106
****Stage 1 average time 0.00378033936024
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992836193417
****DCGs @ 16: 0.975203791499
****DCGs @ 32: 0.948264120062
****DCGs @ 64: 0.92513759608
****Error : 0.1494453125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  23.1898880005
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.030416505694389345, 0.03678525686264038)
('****Total time: ', 0.040092982411384585, 0.047295141220092776)
('****Preprocess time: ', 0.005616107583045959, 0.006570720672607418)
('****Data time: ', 0.0005290696620941163, 0.0006139278411865234)
('****Fetch time: ', 7.074737548828125e-05, 8.702278137207031e-05)
('****Sort time: ', 0.0006879173517227173, 0.0007429242134094238)
****Stage 0 average time 0.0329355033636
****Stage 1 average time 0.00438484430313
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992775471778
****DCGs @ 16: 0.975141992596
****DCGs @ 32: 0.948260510387
****DCGs @ 64: 0.925052656864
****Error : 0.14943359375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.9203250408
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.030550941705703737, 0.03627334833145141)
('****Total time: ', 0.040064855217933654, 0.04672524929046629)
('****Preprocess time: ', 0.005707792758941651, 0.007395219802856444)
('****Data time: ', 0.0005421444177627564, 0.0006199002265930175)
('****Fetch time: ', 7.124400138854981e-05, 8.20159912109375e-05)
('****Sort time: ', 0.0007075973749160766, 0.0007419586181640625)
****Stage 0 average time 0.0336628600359
****Stage 1 average time 0.00391686022282
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996188041909
****DCGs @ 8: 0.993016302876
****DCGs @ 16: 0.975248834837
****DCGs @ 32: 0.948335604824
****DCGs @ 64: 0.925104107357
****Error : 0.14936328125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  33.0762219429
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.030663830518722533, 0.03533824682235718)
('****Total time: ', 0.039908588767051695, 0.04531596899032592)
('****Preprocess time: ', 0.005597200870513916, 0.006464540958404539)
('****Data time: ', 0.0005389353036880494, 0.0006168365478515622)
('****Fetch time: ', 6.953656673431397e-05, 8.0108642578125e-05)
('****Sort time: ', 0.0006854438781738281, 0.0007410526275634763)
****Stage 0 average time 0.0336891208887
****Stage 1 average time 0.00386582624912
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992761551613
****DCGs @ 16: 0.975328829519
****DCGs @ 32: 0.948233655249
****DCGs @ 64: 0.925182580038
****Error : 0.1494140625
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  4.36154389381
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.031944035649299624, 0.03655813932418823)
('****Total time: ', 0.39985683727264404, 0.7702581405639648)
('****Preprocess time: ', 0.0058762990236282345, 0.007411527633666988)
('****Data time: ', 0.0005896574258804321, 0.0007069110870361328)
('****Fetch time: ', 6.110107898712158e-05, 7.104873657226562e-05)
('****Sort time: ', 0.0007088167667388916, 0.0009110927581787104)
****Stage 0 average time 0.034028678298
****Stage 1 average time 0.00515123164654
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992798555995
****DCGs @ 16: 0.975260580872
****DCGs @ 32: 0.948255364828
****DCGs @ 64: 0.925085218714
****Error : 0.1494453125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.60997009277
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.03260523319244385, 0.038809943199157704)
('****Total time: ', 0.05082000410556793, 0.07335081100463867)
('****Preprocess time: ', 0.00595058012008667, 0.008542847633361815)
('****Data time: ', 0.0005682735443115235, 0.0006812095642089841)
('****Fetch time: ', 6.341314315795898e-05, 7.295608520507812e-05)
('****Sort time: ', 0.0007029753923416137, 0.0008568763732910156)
****Stage 0 average time 0.0347414946556
****Stage 1 average time 0.00514898073673
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992785483211
****DCGs @ 16: 0.975074927251
****DCGs @ 32: 0.948161134149
****DCGs @ 64: 0.925063889851
****Error : 0.14940234375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.76969504356
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03333858454227447, 0.04216705560684202)
('****Total time: ', 0.043793933033943175, 0.0545503735542297)
('****Preprocess time: ', 0.0061001540422439575, 0.00912158489227294)
('****Data time: ', 0.0005921783447265625, 0.0007129192352294919)
('****Fetch time: ', 6.267380714416504e-05, 7.081031799316406e-05)
('****Sort time: ', 0.000701736330986023, 0.000837123394012451)
****Stage 0 average time 0.035741989851
****Stage 1 average time 0.00505333721638
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996272105677
****DCGs @ 8: 0.993010556949
****DCGs @ 16: 0.975289200987
****DCGs @ 32: 0.948227037209
****DCGs @ 64: 0.925119395877
****Error : 0.14938671875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  6.89968585968
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.032836326837539676, 0.04060840606689453)
('****Total time: ', 0.0431992826461792, 0.05294218063354492)
('****Preprocess time: ', 0.005991250038146973, 0.008490097522735595)
('****Data time: ', 0.0005809524059295654, 0.0006771922111511226)
('****Fetch time: ', 5.817162990570068e-05, 6.794929504394531e-05)
('****Sort time: ', 0.0007193505764007569, 0.0008211970329284663)
****Stage 0 average time 0.0351833069324
****Stage 1 average time 0.00500274455547
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992650627235
****DCGs @ 16: 0.975222278714
****DCGs @ 32: 0.948238238977
****DCGs @ 64: 0.925108865872
****Error : 0.14944921875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.8895418644
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.0315716552734375, 0.035636162757873534)
('****Total time: ', 0.04143335175514221, 0.046417057514190674)
('****Preprocess time: ', 0.005882977962493896, 0.00784623622894287)
('****Data time: ', 0.0005691215991973877, 0.0006699681282043456)
('****Fetch time: ', 5.545675754547119e-05, 6.486177444458001e-05)
('****Sort time: ', 0.000695263147354126, 0.0007870554924011229)
****Stage 0 average time 0.0338730174303
****Stage 1 average time 0.00490145730972
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996258574432
****DCGs @ 8: 0.99275176143
****DCGs @ 16: 0.975071117704
****DCGs @ 32: 0.948252162214
****DCGs @ 64: 0.925136325843
****Error : 0.1493671875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.1103210449
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.03124793815612793, 0.03564000129699707)
('****Total time: ', 0.04107769072055817, 0.04618142843246459)
('****Preprocess time: ', 0.005764713883399964, 0.00719928741455078)
('****Data time: ', 0.0005650597810745239, 0.0006577968597412109)
('****Fetch time: ', 5.303287506103516e-05, 6.103515625e-05)
('****Sort time: ', 0.0006981924772262574, 0.0007601380348205563)
****Stage 0 average time 0.0335039525032
****Stage 1 average time 0.00482498466969
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996272105677
****DCGs @ 8: 0.993003144366
****DCGs @ 16: 0.97519546179
****DCGs @ 32: 0.948256998738
****DCGs @ 64: 0.925067179395
****Error : 0.1494453125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.9856419563
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03097049057483673, 0.036128437519073485)
('****Total time: ', 0.040733430981636044, 0.046788525581359854)
('****Preprocess time: ', 0.005812190055847168, 0.007644748687744136)
('****Data time: ', 0.0005630801916122436, 0.0006399273872375488)
('****Fetch time: ', 5.136561393737793e-05, 6.008148193359375e-05)
('****Sort time: ', 0.0006909970045089721, 0.0007529735565185544)
****Stage 0 average time 0.0333237948418
****Stage 1 average time 0.00476432859898
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992698570126
****DCGs @ 16: 0.975227241368
****DCGs @ 32: 0.948219081548
****DCGs @ 64: 0.925104818632
****Error : 0.1494609375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.0937149525
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.030406465768814086, 0.03570783138275146)
('****Total time: ', 0.04006169545650482, 0.04617128372192383)
('****Preprocess time: ', 0.005728715062141418, 0.0071909546852111815)
('****Data time: ', 0.0005557088851928711, 0.000631129741668701)
('****Fetch time: ', 5.2824497222900393e-05, 5.91278076171875e-05)
('****Sort time: ', 0.0006992230415344238, 0.000762951374053955)
****Stage 0 average time 0.0328601373434
****Stage 1 average time 0.0045827999115
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992878182071
****DCGs @ 16: 0.975076979147
****DCGs @ 32: 0.948218239453
****DCGs @ 64: 0.925080290701
****Error : 0.149328125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  18.2674880028
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.029607477307319642, 0.03420877456665039)
('****Total time: ', 0.0393157172203064, 0.044523501396179194)
('****Preprocess time: ', 0.005687772274017334, 0.0069133877754211075)
('****Data time: ', 0.0005375761985778808, 0.0006127476692199706)
('****Fetch time: ', 4.716932773590088e-05, 5.5789947509765625e-05)
('****Sort time: ', 0.0006928384304046631, 0.0007321834564208984)
****Stage 0 average time 0.032393499732
****Stage 1 average time 0.00417933380604
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992836193417
****DCGs @ 16: 0.975203791499
****DCGs @ 32: 0.948264120062
****DCGs @ 64: 0.92513759608
****Error : 0.1494453125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  23.2490460873
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.02908565890789032, 0.03372641801834106)
('****Total time: ', 0.038573734641075136, 0.04360828399658203)
('****Preprocess time: ', 0.0056138930320739746, 0.006546342372894279)
('****Data time: ', 0.0005370045900344848, 0.0006148815155029297)
('****Fetch time: ', 4.809117317199707e-05, 5.415678024291973e-05)
('****Sort time: ', 0.0006955080032348633, 0.0007350444793701172)
****Stage 0 average time 0.0318595993519
****Stage 1 average time 0.00412055635452
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992775471778
****DCGs @ 16: 0.975141992596
****DCGs @ 32: 0.948260510387
****DCGs @ 64: 0.925052656864
****Error : 0.14943359375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  27.1379778385
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.02864407455921173, 0.032802414894104)
('****Total time: ', 0.038243774771690366, 0.04281051158905029)
('****Preprocess time: ', 0.0055937981605529786, 0.006167984008789062)
('****Data time: ', 0.0005460706949234009, 0.0006151199340820312)
('****Fetch time: ', 4.781711101531983e-05, 5.412101745605469e-05)
('****Sort time: ', 0.000691119909286499, 0.0007281661033630369)
****Stage 0 average time 0.0314504374266
****Stage 1 average time 0.00407244300842
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996188041909
****DCGs @ 8: 0.993016302876
****DCGs @ 16: 0.975248834837
****DCGs @ 32: 0.948335604824
****DCGs @ 64: 0.925104107357
****Error : 0.14936328125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  33.1881511211
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.028503687262535094, 0.03324333429336548)
('****Total time: ', 0.03795520460605621, 0.04302846193313596)
('****Preprocess time: ', 0.005530153632164001, 0.005970191955566405)
('****Data time: ', 0.0005445263385772705, 0.0006153821945190428)
('****Fetch time: ', 4.716360569000244e-05, 5.412101745605469e-05)
('****Sort time: ', 0.0006898533105850219, 0.0007319450378417969)
****Stage 0 average time 0.0312506896257
****Stage 1 average time 0.00406469452381
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992761551613
****DCGs @ 16: 0.975328829519
****DCGs @ 32: 0.948233655249
****DCGs @ 64: 0.925182580038
****Error : 0.1494140625
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  19.2468280792
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008340033650398255, 0.009108614921569821)
('****Total time: ', 8.252467746138572, 15.544174027442931)
('****Preprocess time: ', 0.004552300214767456, 0.004823017120361327)
('****Data time: ', 0.0003343789577484131, 0.00035477876663208)
('****Fetch time: ', 0.00017552399635314942, 0.0001862049102783203)
('****Sort time: ', 0.000628740668296814, 0.0006611704826354979)
****Stage 0 average time 0.00990438246727
****Stage 1 average time 0.00412659502029
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992798555995
****DCGs @ 16: 0.975260580872
****DCGs @ 32: 0.948255364828
****DCGs @ 64: 0.925085191952
****Error : 0.1494453125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.504502058
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.008702832698822022, 0.00910806655883789)
('****Total time: ', 8.259936037182808, 15.818330645561215)
('****Preprocess time: ', 0.004664517879486084, 0.004786968231201172)
('****Data time: ', 0.00033765578269958496, 0.00035691261291503906)
('****Fetch time: ', 0.00014438867568969727, 0.0001709461212158203)
('****Sort time: ', 0.0006249415874481202, 0.0006551742553710938)
****Stage 0 average time 0.0105209845304
****Stage 1 average time 0.0039533520937
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992785483211
****DCGs @ 16: 0.975074927251
****DCGs @ 32: 0.948161134149
****DCGs @ 64: 0.925063920883
****Error : 0.14940234375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.7936489582
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008862470269203187, 0.009224939346313476)
('****Total time: ', 7.913912586331367, 15.041581380367276)
('****Preprocess time: ', 0.004674283862113953, 0.004767215251922608)
('****Data time: ', 0.00033774054050445554, 0.0003528594970703125)
('****Fetch time: ', 0.00014088237285614014, 0.0001480579376220703)
('****Sort time: ', 0.0006305216550827026, 0.0006589889526367188)
****Stage 0 average time 0.0106746916771
****Stage 1 average time 0.00397120702267
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996272105677
****DCGs @ 8: 0.993010556949
****DCGs @ 16: 0.975289200987
****DCGs @ 32: 0.948227037209
****DCGs @ 64: 0.925119400147
****Error : 0.14938671875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  19.3195581436
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.00821047830581665, 0.008578789234161376)
('****Total time: ', 6.647726195931434, 12.56239603757858)
('****Preprocess time: ', 0.004615216493606567, 0.004704010486602783)
('****Data time: ', 0.0003106924295425415, 0.0003268718719482422)
('****Fetch time: ', 0.00017639291286468506, 0.000186920166015625)
('****Sort time: ', 0.0006345630884170532, 0.0006618499755859375)
****Stage 0 average time 0.00994775545597
****Stage 1 average time 0.00399958777428
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992650627235
****DCGs @ 16: 0.975222278714
****DCGs @ 32: 0.948238238977
****DCGs @ 64: 0.925108839111
****Error : 0.14944921875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.6783850193
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.008851665139198304, 0.009212982654571534)
('****Total time: ', 6.317264404773712, 11.943310952186582)
('****Preprocess time: ', 0.0046456618309020994, 0.0047359466552734375)
('****Data time: ', 0.0003355093002319336, 0.0003509521484375)
('****Fetch time: ', 0.00014207756519317628, 0.00014901161193847656)
('****Sort time: ', 0.0006303043365478516, 0.0006568431854248047)
****Stage 0 average time 0.0106137653589
****Stage 1 average time 0.00399145281315
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996258574432
****DCGs @ 8: 0.99275176143
****DCGs @ 16: 0.975071117704
****DCGs @ 32: 0.948252162214
****DCGs @ 64: 0.925136356875
****Error : 0.1493671875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.4262080193
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.008769902229309082, 0.009279966354370117)
('****Total time: ', 5.030098389625549, 9.748270142078399)
('****Preprocess time: ', 0.0046382445096969606, 0.004748022556304931)
('****Data time: ', 0.0003329864740371704, 0.00035001039505004876)
('****Fetch time: ', 0.00014748132228851318, 0.00017595291137695312)
('****Sort time: ', 0.0006285338401794434, 0.0006606698036193847)
****Stage 0 average time 0.0104893175364
****Stage 1 average time 0.00402783083916
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996272105677
****DCGs @ 8: 0.993003144366
****DCGs @ 16: 0.97519546179
****DCGs @ 32: 0.948256998738
****DCGs @ 64: 0.925067152634
****Error : 0.1494453125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.6873219013
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.00887427544593811, 0.00928807258605957)
('****Total time: ', 4.274162107825279, 8.126316118240355)
('****Preprocess time: ', 0.004645506501197815, 0.004738867282867432)
('****Data time: ', 0.00033401167392730713, 0.0003490447998046875)
('****Fetch time: ', 0.0001430201530456543, 0.0001499652862548828)
('****Sort time: ', 0.0006322880983352661, 0.0006589889526367188)
****Stage 0 average time 0.0106179008484
****Stage 1 average time 0.00401120102406
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992698570126
****DCGs @ 16: 0.975227241368
****DCGs @ 32: 0.948219081548
****DCGs @ 64: 0.925104849665
****Error : 0.1494609375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.5311779976
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.008788312435150146, 0.009296679496765136)
('****Total time: ', 3.0488702130317686, 6.014602661132812)
('****Preprocess time: ', 0.004648710012435913, 0.004765081405639649)
('****Data time: ', 0.00033717834949493407, 0.0003490447998046875)
('****Fetch time: ', 0.00014620113372802734, 0.00017595291137695312)
('****Sort time: ', 0.000628463625907898, 0.0006570816040039062)
****Stage 0 average time 0.0105409015417
****Stage 1 average time 0.00400796401501
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992878182071
****DCGs @ 16: 0.975076979147
****DCGs @ 32: 0.948218239453
****DCGs @ 64: 0.925080294971
****Error : 0.149328125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.6310698986
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.008878132104873657, 0.009333956241607665)
('****Total time: ', 1.725931185245514, 3.230260634422302)
('****Preprocess time: ', 0.004653463006019592, 0.004794895648956299)
('****Data time: ', 0.00033435332775115967, 0.00034999847412109375)
('****Fetch time: ', 0.00014291536808013917, 0.00015091896057128906)
('****Sort time: ', 0.0006288803815841674, 0.0006587505340576172)
****Stage 0 average time 0.0105916113853
****Stage 1 average time 0.00404613280296
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992836193417
****DCGs @ 16: 0.975203791499
****DCGs @ 32: 0.948264120062
****DCGs @ 64: 0.925137569318
****Error : 0.1494453125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.5835289955
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.008482764720916748, 0.00934401750564575)
('****Total time: ', 0.01924069380760193, 0.02776918411254881)
('****Preprocess time: ', 0.004673355460166931, 0.005056202411651611)
('****Data time: ', 0.0003368133306503296, 0.00038986206054687474)
('****Fetch time: ', 0.00015687298774719237, 0.00017881393432617188)
('****Sort time: ', 0.000628604531288147, 0.0006602048873901366)
****Stage 0 average time 0.0102691973448
****Stage 1 average time 0.00400921368599
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992775471778
****DCGs @ 16: 0.975141992596
****DCGs @ 32: 0.948260510387
****DCGs @ 64: 0.925052687896
****Error : 0.14943359375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.3944740295
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.008269400477409363, 0.009413039684295655)
('****Total time: ', 0.016464953541755676, 0.01980795860290525)
('****Preprocess time: ', 0.004712963819503784, 0.005331993103027344)
('****Data time: ', 0.00033500146865844726, 0.0004631042480468745)
('****Fetch time: ', 0.00016288745403289794, 0.0001780986785888672)
('****Sort time: ', 0.0006188625097274781, 0.0006649494171142578)
****Stage 0 average time 0.010028188467
****Stage 1 average time 0.00407092726231
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996188041909
****DCGs @ 8: 0.993016302876
****DCGs @ 16: 0.975248834837
****DCGs @ 32: 0.948335604824
****DCGs @ 64: 0.925104111627
****Error : 0.14936328125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  32.5137619972
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.008293569207191468, 0.009310603141784664)
('****Total time: ', 0.016052287936210632, 0.018069076538085937)
('****Preprocess time: ', 0.004693161368370056, 0.0053161740303039485)
('****Data time: ', 0.0003382992744445801, 0.0004718422889709472)
('****Fetch time: ', 0.0001616966724395752, 0.0001780986785888672)
('****Sort time: ', 0.0006180944442749024, 0.0006718635559082031)
****Stage 0 average time 0.0100503460169
****Stage 1 average time 0.00405447494984
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 128])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992761551613
****DCGs @ 16: 0.975328829519
****DCGs @ 32: 0.948233655249
****DCGs @ 64: 0.925182553276
****Error : 0.1494140625
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
****Total experiment time (s):  8.6658449173
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.040275718808174134, 0.0582950472831725)
('****Total time: ', 2.2959436908960345, 4.195612454414367)
('****Preprocess time: ', 0.007862713098526, 0.012023186683654784)
('****Data time: ', 0.0006314080953598023, 0.0008092403411865232)
('****Fetch time: ', 8.550238609313965e-05, 0.00010086297988891595)
('****Sort time: ', 0.0009163830280303955, 0.001135110855102539)
****Stage 0 average time 0.0454193180799
****Stage 1 average time 0.00435240733624
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992668219714
****DCGs @ 16: 0.975243033681
****DCGs @ 32: 0.948242604583
****DCGs @ 64: 0.924673140758
****Error : 0.32323046875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.72175002098
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.03355858826637268, 0.04826108217239379)
('****Total time: ', 2.0660571962594987, 3.8551014780998223)
('****Preprocess time: ', 0.006859873771667481, 0.010383903980255125)
('****Data time: ', 0.0005601267814636231, 0.0006761550903320312)
('****Fetch time: ', 8.108770847320556e-05, 9.489059448242188e-05)
('****Sort time: ', 0.0008863661289215088, 0.0010666966438293455)
****Stage 0 average time 0.0375274760723
****Stage 1 average time 0.00441856658459
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992669667197
****DCGs @ 16: 0.975089394203
****DCGs @ 32: 0.948117546759
****DCGs @ 64: 0.924587417508
****Error : 0.323180664063
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.94050002098
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03226495742797852, 0.044562029838561994)
('****Total time: ', 1.8172283217906953, 3.2560433864593503)
('****Preprocess time: ', 0.006436609625816345, 0.009397304058074943)
('****Data time: ', 0.0005480201244354248, 0.0006480336189270019)
('****Fetch time: ', 8.109235763549804e-05, 9.298324584960938e-05)
('****Sort time: ', 0.0008726359605789185, 0.0010412096977233884)
****Stage 0 average time 0.0357066208124
****Stage 1 average time 0.00449669468403
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996272105677
****DCGs @ 8: 0.992920117937
****DCGs @ 16: 0.975276826473
****DCGs @ 32: 0.94820630152
****DCGs @ 64: 0.924577550786
****Error : 0.323168945313
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.79673099518
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.03172211003303528, 0.04301795959472653)
('****Total time: ', 1.294854303598404, 2.3159377694129946)
('****Preprocess time: ', 0.006239192008972168, 0.00848299264907837)
('****Data time: ', 0.0005389642715454101, 0.0006270408630371094)
('****Fetch time: ', 7.659029960632324e-05, 8.702278137207031e-05)
('****Sort time: ', 0.0008708804845809937, 0.0010280966758728026)
****Stage 0 average time 0.0350186105967
****Stage 1 average time 0.00442912650108
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.99252804254
****DCGs @ 16: 0.97522883671
****DCGs @ 32: 0.948228829565
****DCGs @ 64: 0.924697912916
****Error : 0.323180664063
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  8.89822602272
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.031448646187782286, 0.04021611213684079)
('****Total time: ', 0.08179329991340638, 0.12666585445404052)
('****Preprocess time: ', 0.006167897462844849, 0.007959449291229248)
('****Data time: ', 0.0005321058034896851, 0.0006072759628295897)
('****Fetch time: ', 7.872045040130615e-05, 8.702278137207031e-05)
('****Sort time: ', 0.0008492133617401123, 0.00098423957824707)
****Stage 0 average time 0.0346405848265
****Stage 1 average time 0.00443599843979
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996258574432
****DCGs @ 8: 0.992671966892
****DCGs @ 16: 0.975084750685
****DCGs @ 32: 0.948206011444
****DCGs @ 64: 0.924549009055
****Error : 0.323211914062
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.5484540462
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.030422677278518676, 0.03801653385162353)
('****Total time: ', 0.04288074779510498, 0.05220924615859982)
('****Preprocess time: ', 0.006025499820709228, 0.006743156909942626)
('****Data time: ', 0.0005191036462783813, 0.0005979537963867188)
('****Fetch time: ', 7.653295993804932e-05, 8.511543273925781e-05)
('****Sort time: ', 0.0008442918062210083, 0.0009930133819580078)
****Stage 0 average time 0.0334770277739
****Stage 1 average time 0.00441107773781
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996272105677
****DCGs @ 8: 0.992912705354
****DCGs @ 16: 0.975181003883
****DCGs @ 32: 0.948226087378
****DCGs @ 64: 0.924667727667
****Error : 0.32317578125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.6778371334
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.031143698930740357, 0.0417113423347473)
('****Total time: ', 0.043711715698242185, 0.057535934448242176)
('****Preprocess time: ', 0.006227154850959778, 0.008461010456085206)
('****Data time: ', 0.0005382897853851319, 0.0006242156028747557)
('****Fetch time: ', 7.811152935028076e-05, 9.512901306152344e-05)
('****Sort time: ', 0.0008475645780563354, 0.0009337663650512689)
****Stage 0 average time 0.0340786209106
****Stage 1 average time 0.00475619876385
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992539963955
****DCGs @ 16: 0.975219124878
****DCGs @ 32: 0.948223750445
****DCGs @ 64: 0.924637156723
****Error : 0.323186523437
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.8010780811
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.029900294065475463, 0.0365852952003479)
('****Total time: ', 0.040365333318710325, 0.04858824014663696)
('****Preprocess time: ', 0.005939460873603821, 0.006439018249511718)
('****Data time: ', 0.0005189242362976074, 0.0005991458892822266)
('****Fetch time: ', 7.470512390136719e-05, 8.58306884765625e-05)
('****Sort time: ', 0.0008367544412612915, 0.0008959770202636719)
****Stage 0 average time 0.0328602867126
****Stage 1 average time 0.00440985202789
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.99275461447
****DCGs @ 16: 0.97510503674
****DCGs @ 32: 0.94813704684
****DCGs @ 64: 0.924501266479
****Error : 0.323171875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.3722770214
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.02988412821292877, 0.036533534526824944)
('****Total time: ', 0.039640990257263184, 0.047812628746032704)
('****Preprocess time: ', 0.00594627034664154, 0.0064579606056213365)
('****Data time: ', 0.0005196471214294434, 0.0006010890007019041)
('****Fetch time: ', 7.676351070404052e-05, 8.53776931762694e-05)
('****Sort time: ', 0.0008334805965423584, 0.0008897900581359863)
****Stage 0 average time 0.0328347036839
****Stage 1 average time 0.00442558610439
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992825548943
****DCGs @ 16: 0.975193189002
****DCGs @ 32: 0.948276817024
****DCGs @ 64: 0.924706324224
****Error : 0.323177734375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.9773440361
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.029591760754585267, 0.036134195327758786)
('****Total time: ', 0.0394085373878479, 0.046877813339233396)
('****Preprocess time: ', 0.0059364520311355595, 0.0065302371978759755)
('****Data time: ', 0.0005248343944549561, 0.0006110668182373047)
('****Fetch time: ', 7.500779628753662e-05, 8.324384689331035e-05)
('****Sort time: ', 0.0008294731378555298, 0.0008809566497802734)
****Stage 0 average time 0.0325521599054
****Stage 1 average time 0.00440536820889
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992579861224
****DCGs @ 16: 0.975113497694
****DCGs @ 32: 0.948233701626
****DCGs @ 64: 0.924622696597
****Error : 0.323173828125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.6479809284
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.029347100257873536, 0.035749614238739014)
('****Total time: ', 0.03905132818222046, 0.045975553989410396)
('****Preprocess time: ', 0.005928629279136658, 0.00658111572265625)
('****Data time: ', 0.0005310709476470947, 0.0006258487701416016)
('****Fetch time: ', 7.74451494216919e-05, 9.107589721679688e-05)
('****Sort time: ', 0.000841570496559143, 0.0008878707885742188)
****Stage 0 average time 0.032097422123
****Stage 1 average time 0.00462839400768
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996188041909
****DCGs @ 8: 0.992889842388
****DCGs @ 16: 0.97529550385
****DCGs @ 32: 0.948274149133
****DCGs @ 64: 0.924573309762
****Error : 0.32318359375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  32.7743330002
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.029482646346092226, 0.036177277565002414)
('****Total time: ', 0.03904344439506531, 0.04630101919174192)
('****Preprocess time: ', 0.005934222340583801, 0.0064950346946716295)
('****Data time: ', 0.0005423355102539062, 0.0006339550018310547)
('****Fetch time: ', 7.862389087677001e-05, 9.107589721679688e-05)
('****Sort time: ', 0.0008240338563919068, 0.0008900165557861328)
****Stage 0 average time 0.0321203154325
****Stage 1 average time 0.00474154651165
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.99275090714
****DCGs @ 16: 0.975317154754
****DCGs @ 32: 0.948235820702
****DCGs @ 64: 0.92470239895
****Error : 0.3231640625
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  4.44236922264
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.038714291334152225, 0.04748761653900146)
('****Total time: ', 0.5434127722978592, 0.9537979125976562)
('****Preprocess time: ', 0.006580132842063904, 0.00976828336715696)
('****Data time: ', 0.0006269470453262329, 0.0007510662078857419)
('****Fetch time: ', 7.18151330947876e-05, 8.61048698425291e-05)
('****Sort time: ', 0.0009388120174407959, 0.001244091987609862)
****Stage 0 average time 0.0350319840908
****Stage 1 average time 0.0119000142813
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992668219714
****DCGs @ 16: 0.975243033681
****DCGs @ 32: 0.948242604583
****DCGs @ 64: 0.924673140758
****Error : 0.32323046875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  4.6270570755
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.0391783686876297, 0.0464760422706604)
('****Total time: ', 0.0716876071691513, 0.11757181882858275)
('****Preprocess time: ', 0.0065909427404403685, 0.009157574176788329)
('****Data time: ', 0.0006412508487701416, 0.0007550716400146484)
('****Fetch time: ', 7.980895042419433e-05, 8.53776931762694e-05)
('****Sort time: ', 0.0009476982355117797, 0.0013051748275756821)
****Stage 0 average time 0.03573945117
****Stage 1 average time 0.0116986182928
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992669667197
****DCGs @ 16: 0.975089394203
****DCGs @ 32: 0.948117546759
****DCGs @ 64: 0.924587417508
****Error : 0.323180664063
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.95659899712
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.038352527499198916, 0.0461113691329956)
('****Total time: ', 0.04969151997566223, 0.05888694524765012)
('****Preprocess time: ', 0.006763348698616028, 0.010143017768859862)
('****Data time: ', 0.0006270824670791626, 0.0007551670074462885)
('****Fetch time: ', 6.801307201385498e-05, 7.891654968261719e-05)
('****Sort time: ', 0.0009316474199295044, 0.0011470317840576172)
****Stage 0 average time 0.0357762672901
****Stage 1 average time 0.0109663518667
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996272105677
****DCGs @ 8: 0.992920117937
****DCGs @ 16: 0.975276826473
****DCGs @ 32: 0.94820630152
****DCGs @ 64: 0.924577550786
****Error : 0.323168945313
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  6.78489995003
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.03790828061103821, 0.04552915096282958)
('****Total time: ', 0.04866055631637573, 0.05856047868728636)
('****Preprocess time: ', 0.006632634878158569, 0.009502589702606198)
('****Data time: ', 0.0006269800662994385, 0.0007293462753295897)
('****Fetch time: ', 6.936728954315185e-05, 7.82012939453125e-05)
('****Sort time: ', 0.0009244248867034912, 0.0011361479759216305)
****Stage 0 average time 0.0356663537025
****Stage 1 average time 0.0104953340292
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.99252804254
****DCGs @ 16: 0.97522883671
****DCGs @ 32: 0.948228829565
****DCGs @ 64: 0.924697912916
****Error : 0.323180664063
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.03392887115
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.037266601920127866, 0.04431359767913817)
('****Total time: ', 0.04800555324554443, 0.05632264614105223)
('****Preprocess time: ', 0.006635814905166626, 0.009522402286529539)
('****Data time: ', 0.000618729829788208, 0.0007191061973571775)
('****Fetch time: ', 6.299173831939697e-05, 7.323026657104473e-05)
('****Sort time: ', 0.0009091925621032714, 0.0010710239410400388)
****Stage 0 average time 0.0349900507927
****Stage 1 average time 0.0105032801628
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996258574432
****DCGs @ 8: 0.992671966892
****DCGs @ 16: 0.975084750685
****DCGs @ 32: 0.948206011444
****DCGs @ 64: 0.924549009055
****Error : 0.323211914062
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  10.9856860638
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.036344422101974486, 0.04300019741058348)
('****Total time: ', 0.04698681271076202, 0.05485551357269287)
('****Preprocess time: ', 0.006514313697814941, 0.009151554107665992)
('****Data time: ', 0.000611017107963562, 0.0007040500640869141)
('****Fetch time: ', 6.117069721221923e-05, 7.200241088867188e-05)
('****Sort time: ', 0.0009262545108795166, 0.0010621905326843259)
****Stage 0 average time 0.0342517035007
****Stage 1 average time 0.0102054746151
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996272105677
****DCGs @ 8: 0.992912705354
****DCGs @ 16: 0.975181003883
****DCGs @ 32: 0.948226087378
****DCGs @ 64: 0.924667727667
****Error : 0.32317578125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  12.7864859104
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03573824107646942, 0.041547167301177974)
('****Total time: ', 0.04607470309734345, 0.053076231479644756)
('****Preprocess time: ', 0.006392213821411133, 0.008260774612426754)
('****Data time: ', 0.0005968406200408936, 0.0006868839263916016)
('****Fetch time: ', 5.941295623779297e-05, 7.082223892211908e-05)
('****Sort time: ', 0.0009078017473220825, 0.0010440349578857422)
****Stage 0 average time 0.0341132547855
****Stage 1 average time 0.00958125543594
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992539963955
****DCGs @ 16: 0.975219124878
****DCGs @ 32: 0.948223750445
****DCGs @ 64: 0.924637156723
****Error : 0.323186523437
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.9657649994
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.0360434730052948, 0.04311459064483642)
('****Total time: ', 0.04660133588314056, 0.05473233461380003)
('****Preprocess time: ', 0.006429283022880554, 0.008804404735565185)
('****Data time: ', 0.0006049772500991822, 0.0006909489631652831)
('****Fetch time: ', 5.877780914306641e-05, 6.985664367675781e-05)
('****Sort time: ', 0.0009079610109329224, 0.0010399818420410156)
****Stage 0 average time 0.0342062190771
****Stage 1 average time 0.00983825302124
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.99275461447
****DCGs @ 16: 0.97510503674
****DCGs @ 32: 0.94813704684
****DCGs @ 64: 0.924501266479
****Error : 0.323171875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  18.1807420254
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.035069262385368345, 0.040981304645538334)
('****Total time: ', 0.045588093638420105, 0.05243129730224609)
('****Preprocess time: ', 0.006271830916404724, 0.007491409778594969)
('****Data time: ', 0.0005949498414993287, 0.00067906379699707)
('****Fetch time: ', 5.747127532958984e-05, 6.794929504394531e-05)
('****Sort time: ', 0.0009133843183517456, 0.0010597705841064453)
****Stage 0 average time 0.0333283721209
****Stage 1 average time 0.0095785266161
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992825548943
****DCGs @ 16: 0.975193189002
****DCGs @ 32: 0.948276817024
****DCGs @ 64: 0.924706324224
****Error : 0.323177734375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  23.2750239372
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.03475279414653778, 0.041694569587707495)
('****Total time: ', 0.04514386010169983, 0.05285893678665161)
('****Preprocess time: ', 0.00623929238319397, 0.007231390476226804)
('****Data time: ', 0.0005909560918807983, 0.0006649494171142578)
('****Fetch time: ', 5.666935443878174e-05, 6.604194641113281e-05)
('****Sort time: ', 0.0009036421775817871, 0.0009714007377624507)
****Stage 0 average time 0.0332840265036
****Stage 1 average time 0.00925932765007
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992579861224
****DCGs @ 16: 0.975113497694
****DCGs @ 32: 0.948233701626
****DCGs @ 64: 0.924622696597
****Error : 0.323173828125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  27.1064610481
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.034837446570396426, 0.04152590036392212)
('****Total time: ', 0.04524019277095795, 0.05266519784927368)
('****Preprocess time: ', 0.006209929227828979, 0.007264947891235346)
('****Data time: ', 0.0005914647579193115, 0.0006680488586425781)
('****Fetch time: ', 5.720841884613037e-05, 6.771087646484375e-05)
('****Sort time: ', 0.0009140257835388184, 0.0009899139404296875)
****Stage 0 average time 0.033271335721
****Stage 1 average time 0.00933873903751
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996188041909
****DCGs @ 8: 0.992889842388
****DCGs @ 16: 0.97529550385
****DCGs @ 32: 0.948274149133
****DCGs @ 64: 0.924573309762
****Error : 0.32318359375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  33.2354240417
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.03414104270935059, 0.040682303905487056)
('****Total time: ', 0.0443237966299057, 0.05167970657348632)
('****Preprocess time: ', 0.006148075938224792, 0.00686482191085815)
('****Data time: ', 0.0005814775228500367, 0.00066375732421875)
('****Fetch time: ', 5.74345588684082e-05, 6.890296936035156e-05)
('****Sort time: ', 0.0009111168384552002, 0.000965118408203125)
****Stage 0 average time 0.0326363966465
****Stage 1 average time 0.00920275092125
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.99275090714
****DCGs @ 16: 0.975317154754
****DCGs @ 32: 0.948235820702
****DCGs @ 64: 0.92470239895
****Error : 0.3231640625
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  20.4076640606
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01250136935710907, 0.01485248804092407)
('****Total time: ', 8.825769731521607, 16.659422683715817)
('****Preprocess time: ', 0.005408045649528503, 0.005719006061553955)
('****Data time: ', 0.0004045711755752564, 0.0004420280456542969)
('****Fetch time: ', 0.00016285920143127442, 0.00018215179443359375)
('****Sort time: ', 0.0008683607578277588, 0.0009081363677978516)
****Stage 0 average time 0.0105278983116
****Stage 1 average time 0.00881730782986
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992668219714
****DCGs @ 16: 0.975243033681
****DCGs @ 32: 0.948242604583
****DCGs @ 64: 0.92467316752
****Error : 0.32323046875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.3414120674
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.012920590281486512, 0.01373016834259033)
('****Total time: ', 8.713129086375236, 16.60024672746658)
('****Preprocess time: ', 0.005332915186882019, 0.005483865737915039)
('****Data time: ', 0.00040611863136291504, 0.0004420280456542969)
('****Fetch time: ', 0.00013415932655334474, 0.00017595291137695312)
('****Sort time: ', 0.0008705407381057739, 0.0009050369262695312)
****Stage 0 average time 0.0109984596968
****Stage 1 average time 0.00866586446762
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992669667197
****DCGs @ 16: 0.975089394203
****DCGs @ 32: 0.948117546759
****DCGs @ 64: 0.924587437758
****Error : 0.323180664063
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.3763959408
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01244912600517273, 0.015001070499420165)
('****Total time: ', 7.706185445189476, 14.641071569919584)
('****Preprocess time: ', 0.005448623657226563, 0.00867987871170044)
('****Data time: ', 0.0003959764242172241, 0.0004611372947692869)
('****Fetch time: ', 0.0001662667989730835, 0.00018596649169921875)
('****Sort time: ', 0.0008718293905258179, 0.0009069442749023438)
****Stage 0 average time 0.0105337092876
****Stage 1 average time 0.00879811298847
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996272105677
****DCGs @ 8: 0.992920117937
****DCGs @ 16: 0.975276826473
****DCGs @ 32: 0.94820630152
****DCGs @ 64: 0.924577597797
****Error : 0.323168945313
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  19.776376009
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.01226627218723297, 0.013252687454223618)
('****Total time: ', 6.909030915498733, 13.116264784336087)
('****Preprocess time: ', 0.005200508594512939, 0.005351114273071288)
('****Data time: ', 0.0003875833749771118, 0.0004222631454467772)
('****Fetch time: ', 0.000167771577835083, 0.00018477439880371094)
('****Sort time: ', 0.0008781245946884156, 0.0009153246879577635)
****Stage 0 average time 0.0102448027134
****Stage 1 average time 0.00865545761585
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.99252804254
****DCGs @ 16: 0.97522883671
****DCGs @ 32: 0.948228829565
****DCGs @ 64: 0.924697939678
****Error : 0.323180664063
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  19.8685941696
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.012222366571426392, 0.013206601142883297)
('****Total time: ', 5.932325083732605, 11.225246453285218)
('****Preprocess time: ', 0.005215421915054321, 0.005362987518310547)
('****Data time: ', 0.00039224588871002196, 0.00042701959609985345)
('****Fetch time: ', 0.00016407251358032226, 0.00018095970153808594)
('****Sort time: ', 0.0008703583478927613, 0.0009050369262695312)
****Stage 0 average time 0.0102752783298
****Stage 1 average time 0.00858918690681
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996258574432
****DCGs @ 8: 0.992671966892
****DCGs @ 16: 0.975084750685
****DCGs @ 32: 0.948206011444
****DCGs @ 64: 0.924549029305
****Error : 0.323211914062
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  19.7030870914
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.012108755946159363, 0.013003516197204587)
('****Total time: ', 4.749143897414207, 9.053084611892698)
('****Preprocess time: ', 0.00518404757976532, 0.005370867252349853)
('****Data time: ', 0.00038447535037994387, 0.0004200935363769531)
('****Fetch time: ', 0.00016870689392089842, 0.00018622875213623034)
('****Sort time: ', 0.0008876124620437622, 0.0009050369262695312)
****Stage 0 average time 0.0101982960701
****Stage 1 average time 0.00853530216217
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996272105677
****DCGs @ 8: 0.992912705354
****DCGs @ 16: 0.975181003883
****DCGs @ 32: 0.948226087378
****DCGs @ 64: 0.924667754428
****Error : 0.32317578125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  19.8111598492
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.01213747239112854, 0.012980258464813233)
('****Total time: ', 3.8451097990274428, 7.305671834945679)
('****Preprocess time: ', 0.005210016131401062, 0.005401325225830077)
('****Data time: ', 0.0003868633508682251, 0.0004200935363769531)
('****Fetch time: ', 0.00016634023189544678, 0.0001850128173828125)
('****Sort time: ', 0.0008665771484375, 0.0009048104286193847)
****Stage 0 average time 0.0102476998568
****Stage 1 average time 0.00851956939697
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992539963955
****DCGs @ 16: 0.975219124878
****DCGs @ 32: 0.948223750445
****DCGs @ 64: 0.924637176973
****Error : 0.323186523437
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  19.2832548618
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.012126938819885254, 0.013023388385772704)
('****Total time: ', 2.516325824379921, 4.835824120044706)
('****Preprocess time: ', 0.005100582957267761, 0.00527501106262207)
('****Data time: ', 0.0003586902618408203, 0.00040984153747558594)
('****Fetch time: ', 0.0001773850917816162, 0.00019121170043945312)
('****Sort time: ', 0.0008446348905563354, 0.0009007573127746581)
****Stage 0 average time 0.0100040035248
****Stage 1 average time 0.00860422849655
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.99275461447
****DCGs @ 16: 0.97510503674
****DCGs @ 32: 0.94813704684
****DCGs @ 64: 0.924501313491
****Error : 0.323171875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  19.6953420639
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.012241571307182312, 0.013246536254882809)
('****Total time: ', 1.2489385353326798, 2.3477210998535156)
('****Preprocess time: ', 0.0051745845079422, 0.005333960056304932)
('****Data time: ', 0.0003870023488998413, 0.0004220008850097656)
('****Fetch time: ', 0.00016920769214630126, 0.0001850128173828125)
('****Sort time: ', 0.0008712724447250366, 0.0009640336036682123)
****Stage 0 average time 0.0101954218149
****Stage 1 average time 0.00864821648598
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992825548943
****DCGs @ 16: 0.975193189002
****DCGs @ 32: 0.948276817024
****DCGs @ 64: 0.924706350985
****Error : 0.323177734375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.5102438927
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.012380425930023193, 0.014223361015319824)
('****Total time: ', 0.023106114625930787, 0.031246590614318788)
('****Preprocess time: ', 0.005233147263526917, 0.005865514278411864)
('****Data time: ', 0.0003749359846115112, 0.00046018362045288066)
('****Fetch time: ', 0.00016808032989501954, 0.00019097328186035156)
('****Sort time: ', 0.0008562210798263549, 0.0009103178977966307)
****Stage 0 average time 0.0101727007627
****Stage 1 average time 0.00884010982513
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996174510664
****DCGs @ 8: 0.992579861224
****DCGs @ 16: 0.975113497694
****DCGs @ 32: 0.948233701626
****DCGs @ 64: 0.924622716847
****Error : 0.323173828125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.3498039246
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.012321598768234254, 0.01392005681991577)
('****Total time: ', 0.021315188050270082, 0.024911427497863767)
('****Preprocess time: ', 0.005223136305809021, 0.005742228031158447)
('****Data time: ', 0.000384979248046875, 0.0004721164703369138)
('****Fetch time: ', 0.00016490805149078368, 0.00018405914306640625)
('****Sort time: ', 0.0008453925848007203, 0.0008878827095031738)
****Stage 0 average time 0.0102148760557
****Stage 1 average time 0.00872513890266
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996188041909
****DCGs @ 8: 0.992889842388
****DCGs @ 16: 0.97529550385
****DCGs @ 32: 0.948274149133
****DCGs @ 64: 0.924573356773
****Error : 0.32318359375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  32.5845999718
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.012299580216407776, 0.013833522796630854)
('****Total time: ', 0.021001369833946227, 0.023542177677154535)
('****Preprocess time: ', 0.005237204313278198, 0.0059410095214843745)
('****Data time: ', 0.0003894366025924683, 0.0005328774452209472)
('****Fetch time: ', 0.00016339719295501708, 0.00018286705017089844)
('****Sort time: ', 0.0008439191579818725, 0.0008730888366699219)
****Stage 0 average time 0.0102175502777
****Stage 1 average time 0.00871598720551
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 512])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.99275090714
****DCGs @ 16: 0.975317154754
****DCGs @ 32: 0.948235820702
****DCGs @ 64: 0.924702425712
****Error : 0.3231640625
****GPU Flags [True, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
Launched inference engine 0/16
Launched inference engine 0/17
Launched inference engine 0/18
Launched inference engine 0/19
Launched inference engine 0/20
Launched inference engine 0/21
Launched inference engine 0/22
Launched inference engine 0/23
Launched inference engine 0/24
Launched inference engine 0/25
Launched inference engine 0/26
Launched inference engine 0/27
Launched inference engine 0/28
Launched inference engine 0/29
Launched inference engine 0/30
Launched inference engine 0/31
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  15.1193230152
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.04065834081172943, 0.05929843187332148)
('****Total time: ', 5.756915531396865, 10.451819908618921)
('****Preprocess time: ', 0.00955950677394867, 0.01369892358779907)
('****Data time: ', 0.0006939090490341186, 0.0008950591087341307)
('****Fetch time: ', 0.0001194237470626831, 0.00013589859008789062)
('****Sort time: ', 0.0016847083568572998, 0.0023267388343811033)
****Stage 0 average time 0.0447210847139
****Stage 1 average time 0.0079948040247
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.99262316971
****DCGs @ 16: 0.975169596284
****DCGs @ 32: 0.948225934654
****DCGs @ 64: 0.92466550044
****Error : 0.295265380859
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.1348001957
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.03566537594795227, 0.05081751346588134)
('****Total time: ', 5.557375115275383, 9.91222730875015)
('****Preprocess time: ', 0.00863304340839386, 0.012059259414672851)
('****Data time: ', 0.0006563616991043091, 0.0008018136024475097)
('****Fetch time: ', 0.00011169326305389405, 0.0001239776611328125)
('****Sort time: ', 0.0016566580533981324, 0.0021462440490722643)
****Stage 0 average time 0.0387176439762
****Stage 1 average time 0.00800548839569
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996342638201
****DCGs @ 8: 0.992736997839
****DCGs @ 16: 0.975025805606
****DCGs @ 32: 0.948154986986
****DCGs @ 64: 0.924591199734
****Error : 0.295278320313
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.0566320419
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.034245972633361814, 0.04761456251144409)
('****Total time: ', 4.915561412096023, 9.056571066379547)
('****Preprocess time: ', 0.008276554346084595, 0.011498260498046874)
('****Data time: ', 0.0006256133317947387, 0.0007469654083251953)
('****Fetch time: ', 0.00010413360595703124, 0.0001201629638671875)
('****Sort time: ', 0.0016139999628067016, 0.0019652366638183583)
****Stage 0 average time 0.0369047801495
****Stage 1 average time 0.00796149373055
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996272105677
****DCGs @ 8: 0.992917868952
****DCGs @ 16: 0.975194778615
****DCGs @ 32: 0.948196391146
****DCGs @ 64: 0.92458974278
****Error : 0.295274902344
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.0541348457
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.03337459754943848, 0.0437974214553833)
('****Total time: ', 4.399844739437103, 8.002579045295715)
('****Preprocess time: ', 0.008073727011680604, 0.01058038473129272)
('****Data time: ', 0.0006215575933456421, 0.0007431864738464354)
('****Fetch time: ', 0.00010579407215118409, 0.0001247048377990722)
('****Sort time: ', 0.0016378356218338013, 0.001971340179443359)
****Stage 0 average time 0.0358402929306
****Stage 1 average time 0.00797321891785
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996342638201
****DCGs @ 8: 0.992567736331
****DCGs @ 16: 0.975143075611
****DCGs @ 32: 0.948237296768
****DCGs @ 64: 0.924687982893
****Error : 0.295283691406
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.0585439205
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.03309829580783844, 0.04233468770980833)
('****Total time: ', 3.485192607760429, 6.377707922458647)
('****Preprocess time: ', 0.007963601350784302, 0.010152506828308103)
('****Data time: ', 0.0006070181131362915, 0.0006990432739257812)
('****Fetch time: ', 9.778392314910888e-05, 0.00011730194091796875)
('****Sort time: ', 0.0016084835529327393, 0.0019040584564208982)
****Stage 0 average time 0.035412932992
****Stage 1 average time 0.00796224975586
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996426701969
****DCGs @ 8: 0.992704553
****DCGs @ 16: 0.97502275095
****DCGs @ 32: 0.948225543129
****DCGs @ 64: 0.924592687098
****Error : 0.295283447266
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.9604048729
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.03241898310184479, 0.040809094905853265)
('****Total time: ', 2.2381627031564713, 4.079518628120422)
('****Preprocess time: ', 0.00781672990322113, 0.009481287002563458)
('****Data time: ', 0.0006010657548904418, 0.0006821155548095703)
('****Fetch time: ', 9.832215309143066e-05, 0.00011610984802246094)
('****Sort time: ', 0.0016183456182479858, 0.0019180893898010254)
****Stage 0 average time 0.0346547682285
****Stage 1 average time 0.00789867830276
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996272105677
****DCGs @ 8: 0.992867666213
****DCGs @ 16: 0.97511889405
****DCGs @ 32: 0.948224985708
****DCGs @ 64: 0.924629803702
****Error : 0.295275634766
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.8953099251
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03220536839962006, 0.03971247673034668)
('****Total time: ', 1.1174134330749512, 2.2317140340805053)
('****Preprocess time: ', 0.007798739790916443, 0.009289705753326402)
('****Data time: ', 0.0005938488245010375, 0.000676929950714111)
('****Fetch time: ', 0.00010017430782318115, 0.00011610984802246094)
('****Sort time: ', 0.001676777720451355, 0.002053976058959961)
****Stage 0 average time 0.0344282172918
****Stage 1 average time 0.00794669175148
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996342638201
****DCGs @ 8: 0.992655576492
****DCGs @ 16: 0.97515133502
****DCGs @ 32: 0.948242198311
****DCGs @ 64: 0.924653860076
****Error : 0.29527734375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  14.9503829479
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.031877143144607545, 0.03885637521743774)
('****Total time: ', 0.323423672914505, 0.6449211120605469)
('****Preprocess time: ', 0.007700793027877808, 0.008225440979003905)
('****Data time: ', 0.0005847080945968628, 0.0006539821624755859)
('****Fetch time: ', 0.00010006666183471679, 0.00011492967605590814)
('****Sort time: ', 0.0016047542095184327, 0.0018089890480041497)
****Stage 0 average time 0.0339868019819
****Stage 1 average time 0.00788066315651
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996342638201
****DCGs @ 8: 0.992791076371
****DCGs @ 16: 0.975003987408
****DCGs @ 32: 0.948145102429
****DCGs @ 64: 0.924550277079
****Error : 0.295271484375
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.8404009342
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03162009978294372, 0.03816440105438232)
('****Total time: ', 0.04736896729469299, 0.057161104679107656)
('****Preprocess time: ', 0.007663166522979737, 0.008195471763610837)
('****Data time: ', 0.0005838687419891357, 0.0006661415100097656)
('****Fetch time: ', 9.704780578613281e-05, 0.00011301040649414062)
('****Sort time: ', 0.0015781129598617554, 0.0016902446746826167)
****Stage 0 average time 0.0336425665617
****Stage 1 average time 0.00789972925186
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992742228478
****DCGs @ 16: 0.97515643331
****DCGs @ 32: 0.948270173084
****DCGs @ 64: 0.924665709833
****Error : 0.295283203125
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  23.0693581104
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.03127591001987457, 0.037923300266265864)
('****Total time: ', 0.0445649083852768, 0.05322455167770385)
('****Preprocess time: ', 0.007677051782608032, 0.008414125442504883)
('****Data time: ', 0.0005926692485809326, 0.0006831169128417966)
('****Fetch time: ', 9.567630290985108e-05, 0.00011086463928222656)
('****Sort time: ', 0.0015781335830688476, 0.001672983169555664)
****Stage 0 average time 0.0333134407997
****Stage 1 average time 0.00790600013733
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996342638201
****DCGs @ 8: 0.992614063277
****DCGs @ 16: 0.975036400613
****DCGs @ 32: 0.948255824094
****DCGs @ 64: 0.924646043927
****Error : 0.295279296875
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.8132629395
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.031093981862068177, 0.03787692785263061)
('****Total time: ', 0.04399506008625031, 0.05143849849700926)
('****Preprocess time: ', 0.007655310273170471, 0.008250308036804198)
('****Data time: ', 0.0005975949764251709, 0.0007009506225585938)
('****Fetch time: ', 9.293663501739502e-05, 0.00010992288589477533)
('****Sort time: ', 0.001606676459312439, 0.0016830444335937497)
****Stage 0 average time 0.0330854090452
****Stage 1 average time 0.00796109116077
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.993012234468
****DCGs @ 16: 0.975202741092
****DCGs @ 32: 0.948299515884
****DCGs @ 64: 0.924594297958
****Error : 0.295270751953
****GPU Flags [False, True]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  33.1756370068
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.03066094446182251, 0.037518620491027825)
('****Total time: ', 0.04315485227108002, 0.05026272535324096)
('****Preprocess time: ', 0.007587442874908448, 0.008114194869995118)
('****Data time: ', 0.0006006871461868286, 0.0007088303565979003)
('****Fetch time: ', 9.337949752807617e-05, 0.00011086463928222656)
('****Sort time: ', 0.0015834907293319701, 0.0016710877418518067)
****Stage 0 average time 0.0325850589275
****Stage 1 average time 0.00794088578224
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992668219714
****DCGs @ 16: 0.975242847665
****DCGs @ 32: 0.948218316413
****DCGs @ 64: 0.924666918708
****Error : 0.295272460937
****GPU Flags [False, True]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 0/0
Launched inference engine 0/1
Launched inference engine 0/2
Launched inference engine 0/3
Launched inference engine 0/4
Launched inference engine 0/5
Launched inference engine 0/6
Launched inference engine 0/7
Launched inference engine 0/8
Launched inference engine 0/9
Launched inference engine 0/10
Launched inference engine 0/11
Launched inference engine 0/12
Launched inference engine 0/13
Launched inference engine 0/14
Launched inference engine 0/15
===================================================
****Epoch  0
****Total experiment time (s):  5.25498604774
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.06902825105190277, 0.09343820810317988)
('****Total time: ', 0.51346959233284, 0.8420050978660584)
('****Preprocess time: ', 0.01001550042629242, 0.015392506122589099)
('****Data time: ', 0.0009384233951568603, 0.0011387109756469725)
('****Fetch time: ', 0.00010488343238830567, 0.0001208901405334472)
('****Sort time: ', 0.0021945910453796385, 0.0030273437499999992)
****Stage 0 average time 0.0416641050577
****Stage 1 average time 0.0406175442934
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.99262316971
****DCGs @ 16: 0.975169596284
****DCGs @ 32: 0.948225934654
****DCGs @ 64: 0.924665476419
****Error : 0.295265380859
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  5.93393087387
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.06886781740188598, 0.09248101711273193)
('****Total time: ', 0.10246536362171173, 0.16954413652420045)
('****Preprocess time: ', 0.010292211532592773, 0.015691792964935284)
('****Data time: ', 0.0009025145769119263, 0.0011141657829284667)
('****Fetch time: ', 0.0001114201545715332, 0.00012001991271972604)
('****Sort time: ', 0.0019813469648361204, 0.002702045440673828)
****Stage 0 average time 0.0425891114473
****Stage 1 average time 0.0395661991835
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996342638201
****DCGs @ 8: 0.992736997839
****DCGs @ 16: 0.975025805606
****DCGs @ 32: 0.948154986986
****DCGs @ 64: 0.924591199734
****Error : 0.295278320313
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  6.49378800392
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.06619989371299743, 0.08635696172714233)
('****Total time: ', 0.08405890738964081, 0.10922132730484006)
('****Preprocess time: ', 0.010097894549369811, 0.015274333953857414)
('****Data time: ', 0.0008819459676742554, 0.0010641694068908684)
('****Fetch time: ', 0.00010567426681518555, 0.00011301040649414062)
('****Sort time: ', 0.001898199200630188, 0.0025800824165344233)
****Stage 0 average time 0.0413001669645
****Stage 1 average time 0.037883440733
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996272105677
****DCGs @ 8: 0.992917868952
****DCGs @ 16: 0.975194778615
****DCGs @ 32: 0.948196391146
****DCGs @ 64: 0.924589718759
****Error : 0.295274902344
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  7.35745787621
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.06233798551559448, 0.0805341243743896)
('****Total time: ', 0.07828509294986725, 0.09918762445449826)
('****Preprocess time: ', 0.009415623664855956, 0.0133691668510437)
('****Data time: ', 0.0008354917764663697, 0.0009932875633239745)
('****Fetch time: ', 9.903383255004882e-05, 0.00010613203048706035)
('****Sort time: ', 0.0018917243480682372, 0.002513027191162109)
****Stage 0 average time 0.0392726463079
****Stage 1 average time 0.0353072128296
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996342638201
****DCGs @ 8: 0.992567736331
****DCGs @ 16: 0.975143075611
****DCGs @ 32: 0.948237296768
****DCGs @ 64: 0.924687982893
****Error : 0.295283691406
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  9.09665417671
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.059873392581939695, 0.0759804844856262)
('****Total time: ', 0.07455448639392853, 0.0924885034561157)
('****Preprocess time: ', 0.00929953920841217, 0.013167035579681392)
('****Data time: ', 0.0008107999563217163, 0.0009469985961914062)
('****Fetch time: ', 8.94855260848999e-05, 9.894371032714844e-05)
('****Sort time: ', 0.0017691028118133544, 0.0023410797119140622)
****Stage 0 average time 0.0377703198195
****Stage 1 average time 0.0340720002651
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996426701969
****DCGs @ 8: 0.992704553
****DCGs @ 16: 0.97502275095
****DCGs @ 32: 0.948225543129
****DCGs @ 64: 0.924592663076
****Error : 0.295283447266
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  11.001019001
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.05577402710914612, 0.06780358552932733)
('****Total time: ', 0.06965360176563264, 0.08373304605484008)
('****Preprocess time: ', 0.008761579155921935, 0.011743080615997313)
('****Data time: ', 0.0007675284147262573, 0.0008903026580810544)
('****Fetch time: ', 7.8238844871521e-05, 9.393692016601562e-05)
('****Sort time: ', 0.0017157340049743653, 0.0020831584930419917)
****Stage 0 average time 0.0352245115042
****Stage 1 average time 0.0318725960255
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996272105677
****DCGs @ 8: 0.992867666213
****DCGs @ 16: 0.97511889405
****DCGs @ 32: 0.948224985708
****DCGs @ 64: 0.92462977968
****Error : 0.295275634766
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  13.1509149075
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.05655809259414673, 0.07057365179061888)
('****Total time: ', 0.07060235965251922, 0.08622736930847164)
('****Preprocess time: ', 0.008884778141975403, 0.01197313070297241)
('****Data time: ', 0.0007745759487152099, 0.0009050965309143063)
('****Fetch time: ', 8.068168163299561e-05, 9.417533874511719e-05)
('****Sort time: ', 0.001715099811553955, 0.0020863056182861316)
****Stage 0 average time 0.0359297168255
****Stage 1 average time 0.0320835113525
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996342638201
****DCGs @ 8: 0.992655576492
****DCGs @ 16: 0.97515133502
****DCGs @ 32: 0.948242198311
****DCGs @ 64: 0.924653860076
****Error : 0.29527734375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  15.0698459148
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.05718190085887909, 0.07012975215911864)
('****Total time: ', 0.07185118699073792, 0.08650453090667722)
('****Preprocess time: ', 0.008938373923301697, 0.011834108829498289)
('****Data time: ', 0.0007912298440933228, 0.0009153246879577635)
('****Fetch time: ', 7.979917526245117e-05, 9.703636169433594e-05)
('****Sort time: ', 0.0017313363552093506, 0.0021530747413635244)
****Stage 0 average time 0.0365767451525
****Stage 1 average time 0.0321458950043
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996342638201
****DCGs @ 8: 0.992791076371
****DCGs @ 16: 0.975003987408
****DCGs @ 32: 0.948145102429
****DCGs @ 64: 0.924550253057
****Error : 0.295271484375
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  17.8372831345
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.05516671025753021, 0.06714440584182738)
('****Total time: ', 0.06884813690185547, 0.08220479488372802)
('****Preprocess time: ', 0.008685187458992005, 0.011281847953796387)
('****Data time: ', 0.000766392469406128, 0.0008640289306640625)
('****Fetch time: ', 7.674503326416016e-05, 9.202957153320312e-05)
('****Sort time: ', 0.0017103477716445923, 0.0020580768585205076)
****Stage 0 average time 0.0357636742592
****Stage 1 average time 0.0306417087317
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992742228478
****DCGs @ 16: 0.97515643331
****DCGs @ 32: 0.948270173084
****DCGs @ 64: 0.924665685811
****Error : 0.295283203125
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  22.9731140137
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.05507619309425354, 0.06604975461959836)
('****Total time: ', 0.06890315353870392, 0.08142256736755368)
('****Preprocess time: ', 0.008754398703575134, 0.01189841032028198)
('****Data time: ', 0.0007715107202529907, 0.0008662104606628416)
('****Fetch time: ', 7.899403572082519e-05, 9.202957153320312e-05)
('****Sort time: ', 0.0017030071020126343, 0.0020671367645263665)
****Stage 0 average time 0.0356436811686
****Stage 1 average time 0.0307404224873
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996342638201
****DCGs @ 8: 0.992614063277
****DCGs @ 16: 0.975036400613
****DCGs @ 32: 0.948255824094
****DCGs @ 64: 0.924646043927
****Error : 0.295279296875
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  27.1158051491
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.054406521916389464, 0.06733627319335937)
('****Total time: ', 0.06850495541095733, 0.08285429477691647)
('****Preprocess time: ', 0.008704485893249512, 0.011537563800811754)
('****Data time: ', 0.0007429485321044922, 0.0008399486541748047)
('****Fetch time: ', 7.48593807220459e-05, 8.702278137207031e-05)
('****Sort time: ', 0.0016854857206344605, 0.0018308281898498533)
****Stage 0 average time 0.035215136528
****Stage 1 average time 0.0303991649151
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.993012234468
****DCGs @ 16: 0.975202741092
****DCGs @ 32: 0.948299515884
****DCGs @ 64: 0.924594273937
****Error : 0.295270751953
****GPU Flags [False, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
****Total experiment time (s):  33.3860430717
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.05054707932472229, 0.0575817584991455)
('****Total time: ', 0.06384326207637787, 0.07200208902359008)
('****Preprocess time: ', 0.008125320434570312, 0.009784638881683346)
('****Data time: ', 0.0007131562232971191, 0.0007987022399902344)
('****Fetch time: ', 7.272231578826904e-05, 8.177757263183594e-05)
('****Sort time: ', 0.0017170753479003906, 0.0018450260162353508)
****Stage 0 average time 0.0323747216463
****Stage 1 average time 0.028800632
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992668219714
****DCGs @ 16: 0.975242847665
****DCGs @ 32: 0.948218316413
****DCGs @ 64: 0.924666894687
****Error : 0.295272460937
****GPU Flags [False, False]
===================================================
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Launched inference engine 1/0
Launched inference engine 1/1
Launched inference engine 1/2
Launched inference engine 1/3
Launched inference engine 1/4
Launched inference engine 1/5
Launched inference engine 1/6
Launched inference engine 1/7
Launched inference engine 1/8
Launched inference engine 1/9
Launched inference engine 1/10
Launched inference engine 1/11
Launched inference engine 1/12
Launched inference engine 1/13
Launched inference engine 1/14
Launched inference engine 1/15
Launched inference engine 1/16
Launched inference engine 1/17
Launched inference engine 1/18
Launched inference engine 1/19
Launched inference engine 1/20
Launched inference engine 1/21
Launched inference engine 1/22
Launched inference engine 1/23
Launched inference engine 1/24
Launched inference engine 1/25
Launched inference engine 1/26
Launched inference engine 1/27
Launched inference engine 1/28
Launched inference engine 1/29
Launched inference engine 1/30
Launched inference engine 1/31
Launched inference engine 0/0
===================================================
****Epoch  0
Using 1 GPU(s)...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_0_16.pth
****Total experiment time (s):  20.3896298409
('****Average Arrival Rate: ', 0.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.03000198984146118, 0.03747611045837402)
('****Total time: ', 8.948996938347817, 16.639541435241696)
('****Preprocess time: ', 0.007387550473213196, 0.008382081985473633)
('****Data time: ', 0.0005713716745376587, 0.0007191300392150876)
('****Fetch time: ', 0.00016123032569885254, 0.00019097328186035156)
('****Sort time: ', 0.0016793097257614136, 0.0020092010498046872)
****Stage 0 average time 0.0108366620541
****Stage 1 average time 0.0289647899866
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.99262316971
****DCGs @ 16: 0.975169596284
****DCGs @ 32: 0.948225934654
****DCGs @ 64: 0.924665400502
****Error : 0.295265380859
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.5508770943
('****Average Arrival Rate: ', 1)
('****Total queries: ', 2000)
('****Inference time: ', 0.02983983111381531, 0.03327003717422485)
('****Total time: ', 8.557497675299645, 15.896546578407285)
('****Preprocess time: ', 0.007431138157844543, 0.00784693956375122)
('****Data time: ', 0.0005825835466384887, 0.0006702303886413572)
('****Fetch time: ', 0.00015244662761688233, 0.0001900196075439453)
('****Sort time: ', 0.0016507807970046998, 0.0017359375953674317)
****Stage 0 average time 0.0108882100582
****Stage 1 average time 0.0287685701847
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996342638201
****DCGs @ 8: 0.992736997839
****DCGs @ 16: 0.975025805606
****DCGs @ 32: 0.948154986986
****DCGs @ 64: 0.924591223146
****Error : 0.295278320313
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  20.0779931545
('****Average Arrival Rate: ', 1.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.029663241982460023, 0.03444550037384033)
('****Total time: ', 7.521267246961593, 14.288340306282041)
('****Preprocess time: ', 0.007263150095939636, 0.007986843585968018)
('****Data time: ', 0.0005358918905258178, 0.0006279945373535156)
('****Fetch time: ', 0.00016739928722381593, 0.00019123554229736315)
('****Sort time: ', 0.0016553699970245361, 0.001815640926361081)
****Stage 0 average time 0.0106897522211
****Stage 1 average time 0.0285953010321
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996272105677
****DCGs @ 8: 0.992917868952
****DCGs @ 16: 0.975194778615
****DCGs @ 32: 0.948196391146
****DCGs @ 64: 0.924589597865
****Error : 0.295274902344
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  19.7414338589
('****Average Arrival Rate: ', 2)
('****Total queries: ', 2000)
('****Inference time: ', 0.030235998868942262, 0.03635482788085937)
('****Total time: ', 6.838109126567841, 12.94477833509445)
('****Preprocess time: ', 0.00716756010055542, 0.007769107818603516)
('****Data time: ', 0.0005027182102203369, 0.0006029725074768066)
('****Fetch time: ', 0.00017788958549499513, 0.00019311904907226562)
('****Sort time: ', 0.0016347918510437012, 0.0020189762115478513)
****Stage 0 average time 0.0105268788338
****Stage 1 average time 0.0291920797825
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996342638201
****DCGs @ 8: 0.992567736331
****DCGs @ 16: 0.975143075611
****DCGs @ 32: 0.948237296768
****DCGs @ 64: 0.924687906976
****Error : 0.295283691406
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  19.6741781235
('****Average Arrival Rate: ', 3)
('****Total queries: ', 2000)
('****Inference time: ', 0.029890168190002443, 0.035824966430664046)
('****Total time: ', 5.819068065285682, 10.992516219615935)
('****Preprocess time: ', 0.007106185436248779, 0.0074880123138427734)
('****Data time: ', 0.0004921672344207764, 0.0005650639533996581)
('****Fetch time: ', 0.00017849206924438476, 0.00019288063049316406)
('****Sort time: ', 0.0016330666542053224, 0.0020042300224304196)
****Stage 0 average time 0.0105010921955
****Stage 1 average time 0.0287989873886
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996426701969
****DCGs @ 8: 0.992704553
****DCGs @ 16: 0.97502275095
****DCGs @ 32: 0.948225543129
****DCGs @ 64: 0.924592686488
****Error : 0.295283447266
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.6084530354
('****Average Arrival Rate: ', 4)
('****Total queries: ', 2000)
('****Inference time: ', 0.031781450986862185, 0.03597997426986694)
('****Total time: ', 5.589465433239937, 10.510266077518462)
('****Preprocess time: ', 0.007801313042640686, 0.008273947238922118)
('****Data time: ', 0.0006349393129348754, 0.0006837964057922363)
('****Fetch time: ', 0.00013099074363708495, 0.00015808343887329095)
('****Sort time: ', 0.0016519654989242555, 0.0017361640930175781)
****Stage 0 average time 0.0114135849476
****Stage 1 average time 0.0305870746374
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996272105677
****DCGs @ 8: 0.992867666213
****DCGs @ 16: 0.97511889405
****DCGs @ 32: 0.948224985708
****DCGs @ 64: 0.924629669569
****Error : 0.295275634766
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.370773077
('****Average Arrival Rate: ', 5)
('****Total queries: ', 2000)
('****Inference time: ', 0.031396880388259885, 0.03596900701522827)
('****Total time: ', 4.4624355635643, 8.499994421005248)
('****Preprocess time: ', 0.007726401686668396, 0.008030140399932861)
('****Data time: ', 0.000627166748046875, 0.0006668567657470703)
('****Fetch time: ', 0.00013746392726898194, 0.00016117095947265625)
('****Sort time: ', 0.0016831269264221192, 0.0020148873329162596)
****Stage 0 average time 0.0113195072412
****Stage 1 average time 0.0302515324354
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996342638201
****DCGs @ 8: 0.992655576492
****DCGs @ 16: 0.97515133502
****DCGs @ 32: 0.948242198311
****DCGs @ 64: 0.924653883488
****Error : 0.29527734375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.9097578526
('****Average Arrival Rate: ', 6)
('****Total queries: ', 2000)
('****Inference time: ', 0.031654865026474, 0.03645745515823364)
('****Total time: ', 3.5591906089782714, 7.16207661628723)
('****Preprocess time: ', 0.007932873129844666, 0.009966957569122314)
('****Data time: ', 0.0006370581388473511, 0.0007101058959960932)
('****Fetch time: ', 0.00013657641410827636, 0.0001621246337890625)
('****Sort time: ', 0.0016481437683105468, 0.0017151832580566406)
****Stage 0 average time 0.0115403259993
****Stage 1 average time 0.0304691904783
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996342638201
****DCGs @ 8: 0.992791076371
****DCGs @ 16: 0.975003987408
****DCGs @ 32: 0.948145102429
****DCGs @ 64: 0.924550132163
****Error : 0.295271484375
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  21.0050821304
('****Average Arrival Rate: ', 7.5)
('****Total queries: ', 2000)
('****Inference time: ', 0.031227696418762208, 0.03606036901473999)
('****Total time: ', 1.7780222654342652, 3.419518494606018)
('****Preprocess time: ', 0.007618174314498901, 0.008053207397460937)
('****Data time: ', 0.0005986524820327759, 0.0006589889526367188)
('****Fetch time: ', 0.00014734673500061036, 0.00019097328186035156)
('****Sort time: ', 0.0017182537317276, 0.002235889434814453)
****Stage 0 average time 0.0111579934359
****Stage 1 average time 0.0301521302462
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992742228478
****DCGs @ 16: 0.97515643331
****DCGs @ 32: 0.948270173084
****DCGs @ 64: 0.924665609895
****Error : 0.295283203125
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  23.3240911961
('****Average Arrival Rate: ', 10)
('****Total queries: ', 2000)
('****Inference time: ', 0.031318377256393436, 0.035804128646850585)
('****Total time: ', 0.04985438334941864, 0.06707338094711299)
('****Preprocess time: ', 0.007850247263908386, 0.009496378898620603)
('****Data time: ', 0.0006250715255737304, 0.0006899952888488769)
('****Fetch time: ', 0.0001325676441192627, 0.00015306472778320312)
('****Sort time: ', 0.001751496434211731, 0.002262115478515625)
****Stage 0 average time 0.0116401361227
****Stage 1 average time 0.0300376240015
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996342638201
****DCGs @ 8: 0.992614063277
****DCGs @ 16: 0.975036400613
****DCGs @ 32: 0.948255824094
****DCGs @ 64: 0.924646067339
****Error : 0.295279296875
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
****Total experiment time (s):  26.7274711132
('****Average Arrival Rate: ', 12)
('****Total queries: ', 2000)
('****Inference time: ', 0.030968201637268065, 0.03531845808029174)
('****Total time: ', 0.04410658359527588, 0.05021873712539672)
('****Preprocess time: ', 0.007644791483879089, 0.00813899040222168)
('****Data time: ', 0.0006136463880538941, 0.0006849765777587891)
('****Fetch time: ', 0.00013841235637664795, 0.00018907785415649408)
('****Sort time: ', 0.0016918292045593262, 0.002164125442504883)
****Stage 0 average time 0.0113226854801
****Stage 1 average time 0.02973419559
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.993012234468
****DCGs @ 16: 0.975202741092
****DCGs @ 32: 0.948299515884
****DCGs @ 64: 0.924594153043
****Error : 0.295270751953
****GPU Flags [True, False]
===================================================
===================================================
****Epoch  0
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Using CPU...
Reading pre-processed data=/data/rec/criteo_artifact///kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Length of ids is:  100000
Defined test indices...
Randomized indices across days ...
Handling test data
Split data according to indices...
Created dataset
Loading saved model /data/rec/recpipe_artifact/r2_model_51_32.pth
Mon Jul 26 01:54:01 UTC 2021
****Total experiment time (s):  32.9873361588
('****Average Arrival Rate: ', 15)
('****Total queries: ', 2000)
('****Inference time: ', 0.031170573592185974, 0.03599724769592285)
('****Total time: ', 0.044173208713531496, 0.051205623149871815)
('****Preprocess time: ', 0.007980040073394775, 0.011072468757629364)
('****Data time: ', 0.0006280089616775513, 0.0007000088691711425)
('****Fetch time: ', 0.0001321568489074707, 0.0001518726348876953)
('****Sort time: ', 0.0016129285097122193, 0.0017202377319335935)
****Stage 0 average time 0.0117205280066
****Stage 1 average time 0.0298031799793
('****model config: ', u'configs/model_configs/dim_16.json,configs/model_configs/dim_32_0.json')
('****batch_size: ', [4096, 2048])
****DCGs @ 4: 0.996356169445
****DCGs @ 8: 0.992668219714
****DCGs @ 16: 0.975242847665
****DCGs @ 32: 0.948218316413
****DCGs @ 64: 0.92466681877
****Error : 0.295272460937
****GPU Flags [True, False]
===================================================
Mon Jul 26 01:54:01 UTC 2021
